(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{8408:(Ye,N,Y)=>{"use strict";function I(t){return"function"==typeof t}function A(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}Y.d(N,{h:()=>oa});const x=A(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function f(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class p{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(I(i))try{i()}catch(o){n=o instanceof x?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{S(o)}catch(s){n=n??[],s instanceof x?n=[...n,...s.errors]:n.push(s)}}if(n)throw new x(n)}}add(n){var e;if(n&&n!==this)if(this.closed)S(n);else{if(n instanceof p){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&f(e,n)}remove(n){const{_finalizers:e}=this;e&&f(e,n),n instanceof p&&n._removeParent(this)}}p.EMPTY=(()=>{const t=new p;return t.closed=!0,t})();const b=p.EMPTY;function T(t){return t instanceof p||t&&"closed"in t&&I(t.remove)&&I(t.add)&&I(t.unsubscribe)}function S(t){I(t)?t():t.unsubscribe()}const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},d={setTimeout(t,n,...e){const{delegate:i}=d;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=d;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function _(t){d.setTimeout(()=>{const{onUnhandledError:n}=m;if(!n)throw t;n(t)})}function v(){}const M=W("C",void 0,void 0);function W(t,n,e){return{kind:t,value:n,error:e}}let ne=null;function B(t){if(m.useDeprecatedSynchronousErrorHandling){const n=!ne;if(n&&(ne={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=ne;if(ne=null,e)throw i}}else t()}class z extends p{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,T(n)&&n.add(this)):this.destination=pe}static create(n,e,i){return new Ce(n,e,i)}next(n){this.isStopped?C(function R(t){return W("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?C(function w(t){return W("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?C(M,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const te=Function.prototype.bind;function ee(t,n){return te.call(t,n)}class q{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){$(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){$(i)}else $(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){$(e)}}}class Ce extends z{constructor(n,e,i){let r;if(super(),I(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&m.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&ee(n.next,o),error:n.error&&ee(n.error,o),complete:n.complete&&ee(n.complete,o)}):r=n}this.destination=new q(r)}}function $(t){m.useDeprecatedSynchronousErrorHandling?function V(t){m.useDeprecatedSynchronousErrorHandling&&ne&&(ne.errorThrown=!0,ne.error=t)}(t):_(t)}function C(t,n){const{onStoppedNotification:e}=m;e&&d.setTimeout(()=>e(t,n))}const pe={closed:!0,next:v,error:function ae(t){throw t},complete:v},ze="function"==typeof Symbol&&Symbol.observable||"@@observable";function le(t){return t}let xe=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function Je(t){return t&&t instanceof z||function me(t){return t&&I(t.next)&&I(t.error)&&I(t.complete)}(t)&&T(t)}(e)?e:new Ce(e,i,r);return B(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=he(i))((r,o)=>{const s=new Ce({next:a=>{try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ze](){return this}pipe(...e){return function ve(t){return 0===t.length?le:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=he(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function he(t){var n;return null!==(n=t??m.Promise)&&void 0!==n?n:Promise}const Ge=A(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ue=(()=>{class t extends xe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new qt(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Ge}next(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){B(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?b:(this.currentObservers=null,o.push(e),new p(()=>{this.currentObservers=null,f(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new xe;return e.source=this,e}}return t.create=(n,e)=>new qt(n,e),t})();class qt extends Ue{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:b}}function Ie(t){return n=>{if(function Ve(t){return I(t?.lift)}(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Fe(t,n,e,i,r){return new pt(t,n,e,i,r)}class pt extends z{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function nt(t,n){return Ie((e,i)=>{let r=0;e.subscribe(Fe(i,o=>{i.next(t.call(n,o,r++))}))})}function K(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Ti(t){return this instanceof Ti?(this.v=t,this):new Ti(t)}function yo(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function en(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}const Qo=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function bd(t){return I(t?.then)}function Ec(t){return I(t[ze])}function Tc(t){return Symbol.asyncIterator&&I(t?.[Symbol.asyncIterator])}function el(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Cd=function hp(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function wd(t){return I(t?.[Cd])}function xc(t){return function mn(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(g){i[g]&&(r[g]=function(E){return new Promise(function(L,Z){o.push([g,E,L,Z])>1||a(g,E)})})}function a(g,E){try{!function l(g){g.value instanceof Ti?Promise.resolve(g.value.v).then(c,u):h(o[0][2],g)}(i[g](E))}catch(L){h(o[0][3],L)}}function c(g){a("next",g)}function u(g){a("throw",g)}function h(g,E){g(E),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Ti(e.read());if(r)return yield Ti(void 0);yield yield Ti(i)}}finally{e.releaseLock()}})}function Ed(t){return I(t?.getReader)}function eo(t){if(t instanceof xe)return t;if(null!=t){if(Ec(t))return function fp(t){return new xe(n=>{const e=t[ze]();if(I(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Qo(t))return function tl(t){return new xe(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(bd(t))return function pp(t){return new xe(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,_)})}(t);if(Tc(t))return Sc(t);if(wd(t))return function gp(t){return new xe(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Ed(t))return function Dc(t){return Sc(xc(t))}(t)}throw el(t)}function Sc(t){return new xe(n=>{(function mp(t,n){var e,i,r,o;return function Ne(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(u){try{c(i.next(u))}catch(h){s(h)}}function l(u){try{c(i.throw(u))}catch(h){s(h)}}function c(u){u.done?o(u.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(u.value).then(a,l)}c((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=yo(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function to(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function Mc(t,n,e=1/0){return I(n)?Mc((i,r)=>nt((o,s)=>n(i,o,r,s))(eo(t(i,r))),e):("number"==typeof n&&(e=n),Ie((i,r)=>function _p(t,n,e,i,r,o,s,a){const l=[];let c=0,u=0,h=!1;const g=()=>{h&&!l.length&&!c&&n.complete()},E=Z=>c<i?L(Z):l.push(Z),L=Z=>{o&&n.next(Z),c++;let re=!1;eo(e(Z,u++)).subscribe(Fe(n,oe=>{r?.(oe),o?E(oe):n.next(oe)},()=>{re=!0},void 0,()=>{if(re)try{for(c--;l.length&&c<i;){const oe=l.shift();s?to(n,s,()=>L(oe)):L(oe)}g()}catch(oe){n.error(oe)}}))};return t.subscribe(Fe(n,E,()=>{h=!0,g()})),()=>{a?.()}}(i,r,t,e)))}const kc=new xe(t=>t.complete());function es(t){return t[t.length-1]}function xd(t,n=0){return Ie((e,i)=>{e.subscribe(Fe(i,r=>to(i,t,()=>i.next(r),n),()=>to(i,t,()=>i.complete(),n),r=>to(i,t,()=>i.error(r),n)))})}function Sd(t,n=0){return Ie((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function Ir(t,n){if(!t)throw new Error("Iterable cannot be null");return new xe(e=>{to(e,n,()=>{const i=t[Symbol.asyncIterator]();to(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Ar(t,n){return n?function Or(t,n){if(null!=t){if(Ec(t))return function il(t,n){return eo(t).pipe(Sd(n),xd(n))}(t,n);if(Qo(t))return function ks(t,n){return new xe(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(bd(t))return function tr(t,n){return eo(t).pipe(Sd(n),xd(n))}(t,n);if(Tc(t))return Ir(t,n);if(wd(t))return function bo(t,n){return new xe(e=>{let i;return to(e,n,()=>{i=t[Cd](),to(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>I(i?.return)&&i.return()})}(t,n);if(Ed(t))return function aa(t,n){return Ir(xc(t),n)}(t,n)}throw el(t)}(t,n):eo(t)}function Dd(...t){const n=function nl(t){return function Jo(t){return t&&I(t.schedule)}(es(t))?t.pop():void 0}(t),e=function Oc(t,n){return"number"==typeof es(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?eo(i[0]):function Td(t=1/0){return Mc(le,t)}(e)(Ar(i,n)):kc}function Is(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new Ce({next:()=>{i.unsubscribe(),t()}});return eo(n(...e)).subscribe(i)}function Ut(t){for(let n in t)if(t[n]===Ut)return n;throw Error("Could not find renamed property on target object.")}function Os(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function sn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(sn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function la(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Ac=Ut({__forward_ref__:Ut});function an(t){return t.__forward_ref__=an,t.toString=function(){return sn(this())},t}function ut(t){return no(t)?t():t}function no(t){return"function"==typeof t&&t.hasOwnProperty(Ac)&&t.__forward_ref__===an}function Pc(t){return t&&!!t.\u0275providers}const As="https://g.co/ng/security#xss";class Se extends Error{constructor(n,e){super(rl(n,e)),this.code=n}}function rl(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}function Tt(t){return"string"==typeof t?t:null==t?"":String(t)}function Oe(t,n){throw new Se(-201,!1)}function Pr(t,n){null==t&&function ln(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function Mt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Co(t){return{providers:t.providers||[],imports:t.imports||[]}}function kd(t){return vv(t,Id)||vv(t,bv)}function vv(t,n){return t.hasOwnProperty(n)?t[n]:null}function yv(t){return t&&(t.hasOwnProperty(bp)||t.hasOwnProperty(VM))?t[bp]:null}const Id=Ut({\u0275prov:Ut}),bp=Ut({\u0275inj:Ut}),bv=Ut({ngInjectableDef:Ut}),VM=Ut({ngInjectorDef:Ut});var xt=(()=>((xt=xt||{})[xt.Default=0]="Default",xt[xt.Host=1]="Host",xt[xt.Self=2]="Self",xt[xt.SkipSelf=4]="SkipSelf",xt[xt.Optional=8]="Optional",xt))();let Cp;function Fr(t){const n=Cp;return Cp=t,n}function Cv(t,n,e){const i=kd(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&xt.Optional?null:void 0!==n?n:void Oe(sn(t))}const bn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Fc={},wp="__NG_DI_FLAG__",Od="ngTempTokenPath",HM="ngTokenPath",GM=/\n/gm,$M="\u0275",wv="__source";let Nc;function ol(t){const n=Nc;return Nc=t,n}function WM(t,n=xt.Default){if(void 0===Nc)throw new Se(-203,!1);return null===Nc?Cv(t,void 0,n):Nc.get(t,n&xt.Optional?null:void 0,n)}function bt(t,n=xt.Default){return(function jM(){return Cp}()||WM)(ut(t),n)}function Tv(t,n=xt.Default){return bt(t,Ad(n))}function Ad(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Ep(t){const n=[];for(let e=0;e<t.length;e++){const i=ut(t[e]);if(Array.isArray(i)){if(0===i.length)throw new Se(900,!1);let r,o=xt.Default;for(let s=0;s<i.length;s++){const a=i[s],l=ZM(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}n.push(bt(r,o))}else n.push(bt(i))}return n}function Rc(t,n){return t[wp]=n,t.prototype[wp]=n,t}function ZM(t){return t[wp]}function ts(t){return{toString:t}.toString()}var wo=(()=>((wo=wo||{})[wo.OnPush=0]="OnPush",wo[wo.Default=1]="Default",wo))(),ro=(()=>{return(t=ro||(ro={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",ro;var t})();const ns={},tn=[],Pd=Ut({\u0275cmp:Ut}),Tp=Ut({\u0275dir:Ut}),xp=Ut({\u0275pipe:Ut}),xv=Ut({\u0275mod:Ut}),is=Ut({\u0275fac:Ut}),Lc=Ut({__NG_ELEMENT_ID__:Ut});let KM=0;function Wt(t){return ts(()=>{const n=Mv(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===wo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,data:t.data||{},encapsulation:t.encapsulation||ro.Emulated,id:"c"+KM++,styles:t.styles||tn,_:null,schemas:t.schemas||null,tView:null};kv(e);const i=t.dependencies;return e.directiveDefs=Fd(i,!1),e.pipeDefs=Fd(i,!0),e})}function XM(t){return cn(t)||xi(t)}function QM(t){return null!==t}function rs(t){return ts(()=>({type:t.type,bootstrap:t.bootstrap||tn,declarations:t.declarations||tn,imports:t.imports||tn,exports:t.exports||tn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function Dv(t,n){if(null==t)return ns;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,n&&(n[r]=o)}return e}function vt(t){return ts(()=>{const n=Mv(t);return kv(n),n})}function Vi(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function cn(t){return t[Pd]||null}function xi(t){return t[Tp]||null}function nr(t){return t[xp]||null}function Mv(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,exportAs:t.exportAs||null,standalone:!0===t.standalone,selectors:t.selectors||tn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Dv(t.inputs,n),outputs:Dv(t.outputs)}}function kv(t){t.features?.forEach(n=>n(t))}function Fd(t,n){if(!t)return null;const e=n?nr:XM;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(QM)}const os=0,Qe=1,Ft=2,Rn=3,oo=4,ca=5,Si=6,sl=7,jn=8,Nd=9,Rd=10,Lt=11,Sp=12,zc=13,Iv=14,al=15,Di=16,Uc=17,ll=18,Eo=19,Vc=20,Ov=21,Cn=22,Dp=1,Av=2,Ld=7,Bd=8,cl=9,ji=10;function gr(t){return Array.isArray(t)&&"object"==typeof t[Dp]}function so(t){return Array.isArray(t)&&!0===t[Dp]}function Mp(t){return 0!=(4&t.flags)}function jc(t){return t.componentOffset>-1}function zd(t){return 1==(1&t.flags)}function ao(t){return!!t.template}function ek(t){return 0!=(256&t[Ft])}function ua(t,n){return t.hasOwnProperty(is)?t[is]:null}class ik{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Mn(){return Nv}function Nv(t){return t.type.prototype.ngOnChanges&&(t.setInput=ok),rk}function rk(){const t=Lv(this),n=t?.current;if(n){const e=t.previous;if(e===ns)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function ok(t,n,e,i){const r=this.declaredInputs[e],o=Lv(t)||function sk(t,n){return t[Rv]=n}(t,{previous:ns,current:null}),s=o.current||(o.current={}),a=o.previous,l=a[r];s[r]=new ik(l&&l.currentValue,n,a===ns),t[i]=n}Mn.ngInherit=!0;const Rv="__ngSimpleChanges__";function Lv(t){return t[Rv]||null}const Nr=function(t,n,e){},Bv="svg";function gi(t){for(;Array.isArray(t);)t=t[os];return t}function Ud(t,n){return gi(n[t])}function mr(t,n){return gi(n[t.index])}function Uv(t,n){return t.data[n]}function ul(t,n){return t[n]}function ir(t,n){const e=n[t];return gr(e)?e:e[os]}function Vd(t){return 64==(64&t[Ft])}function Ps(t,n){return null==n?null:t[n]}function Vv(t){t[ll]=0}function Ip(t,n){t[ca]+=n;let e=t,i=t[Rn];for(;null!==i&&(1===n&&1===e[ca]||-1===n&&0===e[ca]);)i[ca]+=n,e=i,i=i[Rn]}const It={lFrame:Xv(null),bindingsEnabled:!0};function Hv(){return It.bindingsEnabled}function De(){return It.lFrame.lView}function Jt(){return It.lFrame.tView}function Me(t){return It.lFrame.contextLView=t,t[jn]}function ke(t){return It.lFrame.contextLView=null,t}function mi(){let t=Gv();for(;null!==t&&64===t.type;)t=t.parent;return t}function Gv(){return It.lFrame.currentTNode}function To(t,n){const e=It.lFrame;e.currentTNode=t,e.isParent=n}function Op(){return It.lFrame.isParent}function Ap(){It.lFrame.isParent=!1}function Hi(){const t=It.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function dl(){return It.lFrame.bindingIndex++}function as(t){const n=It.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function yk(t,n){const e=It.lFrame;e.bindingIndex=e.bindingRootIndex=t,Pp(n)}function Pp(t){It.lFrame.currentDirectiveIndex=t}function Yv(){return It.lFrame.currentQueryIndex}function Np(t){It.lFrame.currentQueryIndex=t}function Ck(t){const n=t[Qe];return 2===n.type?n.declTNode:1===n.type?t[Si]:null}function qv(t,n,e){if(e&xt.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&xt.Host||(r=Ck(o),null===r||(o=o[al],10&r.type))););if(null===r)return!1;n=r,t=o}const i=It.lFrame=Kv();return i.currentTNode=n,i.lView=t,!0}function Rp(t){const n=Kv(),e=t[Qe];It.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Kv(){const t=It.lFrame,n=null===t?null:t.child;return null===n?Xv(t):n}function Xv(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function Qv(){const t=It.lFrame;return It.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Jv=Qv;function Lp(){const t=Qv();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Gi(){return It.lFrame.selectedIndex}function da(t){It.lFrame.selectedIndex=t}function kn(){const t=It.lFrame;return Uv(t.tView,t.selectedIndex)}function jd(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(t.contentHooks??(t.contentHooks=[])).push(-e,s),a&&((t.contentHooks??(t.contentHooks=[])).push(e,a),(t.contentCheckHooks??(t.contentCheckHooks=[])).push(e,a)),l&&(t.viewHooks??(t.viewHooks=[])).push(-e,l),c&&((t.viewHooks??(t.viewHooks=[])).push(e,c),(t.viewCheckHooks??(t.viewCheckHooks=[])).push(e,c)),null!=u&&(t.destroyHooks??(t.destroyHooks=[])).push(e,u)}}function Hd(t,n,e){ty(t,n,3,e)}function Gd(t,n,e,i){(3&t[Ft])===e&&ty(t,n,e,i)}function Bp(t,n){let e=t[Ft];(3&e)===n&&(e&=2047,e+=1,t[Ft]=e)}function ty(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let l=void 0!==i?65535&t[ll]:0;l<s;l++)if("number"==typeof n[l+1]){if(a=n[l],null!=i&&a>=i)break}else n[l]<0&&(t[ll]+=65536),(a<o||-1==o)&&(kk(t,e,n,l),t[ll]=(4294901760&t[ll])+l+2),l++}function kk(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[Ft]>>11<t[ll]>>16&&(3&t[Ft])===n){t[Ft]+=2048,Nr(4,a,o);try{o.call(a)}finally{Nr(5,a,o)}}}else{Nr(4,a,o);try{o.call(a)}finally{Nr(5,a,o)}}}const hl=-1;class Gc{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Up(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];iy(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function ny(t){return 3===t||4===t||6===t}function iy(t){return 64===t.charCodeAt(0)}function $c(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||ry(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function ry(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function oy(t){return t!==hl}function $d(t){return 32767&t}function Wd(t,n){let e=function Pk(t){return t>>16}(t),i=n;for(;e>0;)i=i[al],e--;return i}let Vp=!0;function Zd(t){const n=Vp;return Vp=t,n}const sy=255,ay=5;let Fk=0;const xo={};function Yd(t,n){const e=ly(t,n);if(-1!==e)return e;const i=n[Qe];i.firstCreatePass&&(t.injectorIndex=n.length,jp(i.data,t),jp(n,null),jp(i.blueprint,null));const r=Hp(t,n),o=t.injectorIndex;if(oy(r)){const s=$d(r),a=Wd(r,n),l=a[Qe].data;for(let c=0;c<8;c++)n[o+c]=a[s+c]|l[s+c]}return n[o+8]=r,o}function jp(t,n){t.push(0,0,0,0,0,0,0,0,n)}function ly(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Hp(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=gy(r),null===i)return hl;if(e++,r=r[al],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return hl}function Gp(t,n,e){!function Nk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Lc)&&(i=e[Lc]),null==i&&(i=e[Lc]=Fk++);const r=i&sy;n.data[t+(r>>ay)]|=1<<r}(t,n,e)}function cy(t,n,e){if(e&xt.Optional||void 0!==t)return t;Oe()}function uy(t,n,e,i){if(e&xt.Optional&&void 0===i&&(i=null),!(e&(xt.Self|xt.Host))){const r=t[Nd],o=Fr(void 0);try{return r?r.get(n,i,e&xt.Optional):Cv(n,i,e&xt.Optional)}finally{Fr(o)}}return cy(i,0,e)}function dy(t,n,e,i=xt.Default,r){if(null!==t){if(1024&n[Ft]){const s=function Uk(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&1024&s[Ft]&&!(256&s[Ft]);){const a=hy(o,s,e,i|xt.Self,xo);if(a!==xo)return a;let l=o.parent;if(!l){const c=s[Ov];if(c){const u=c.get(e,xo,i);if(u!==xo)return u}l=gy(s),s=s[al]}o=l}return r}(t,n,e,i,xo);if(s!==xo)return s}const o=hy(t,n,e,i,xo);if(o!==xo)return o}return uy(n,e,i,r)}function hy(t,n,e,i,r){const o=function Bk(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Lc)?t[Lc]:void 0;return"number"==typeof n?n>=0?n&sy:zk:n}(e);if("function"==typeof o){if(!qv(n,t,i))return i&xt.Host?cy(r,0,i):uy(n,e,i,r);try{const s=o(i);if(null!=s||i&xt.Optional)return s;Oe()}finally{Jv()}}else if("number"==typeof o){let s=null,a=ly(t,n),l=hl,c=i&xt.Host?n[Di][Si]:null;for((-1===a||i&xt.SkipSelf)&&(l=-1===a?Hp(t,n):n[a+8],l!==hl&&py(i,!1)?(s=n[Qe],a=$d(l),n=Wd(l,n)):a=-1);-1!==a;){const u=n[Qe];if(fy(o,a,u.data)){const h=Lk(a,n,e,s,i,c);if(h!==xo)return h}l=n[a+8],l!==hl&&py(i,n[Qe].data[a+8]===c)&&fy(o,a,n)?(s=u,a=$d(l),n=Wd(l,n)):a=-1}}return r}function Lk(t,n,e,i,r,o){const s=n[Qe],a=s.data[t+8],u=qd(a,s,e,null==i?jc(a)&&Vp:i!=s&&0!=(3&a.type),r&xt.Host&&o===a);return null!==u?ha(n,s,u,a):xo}function qd(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,l=t.directiveStart,u=o>>20,g=r?a+u:t.directiveEnd;for(let E=i?a:a+u;E<g;E++){const L=s[E];if(E<l&&e===L||E>=l&&L.type===e)return E}if(r){const E=s[l];if(E&&ao(E)&&E.type===e)return l}return null}function ha(t,n,e,i){let r=t[e];const o=n.data;if(function Ik(t){return t instanceof Gc}(r)){const s=r;s.resolving&&function j(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new Se(-200,`Circular dependency in DI detected for ${t}${e}`)}(function P(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Tt(t)}(o[e]));const a=Zd(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Fr(s.injectImpl):null;qv(t,i,xt.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function Mk(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=Nv(n);(e.preOrderHooks??(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,s)}r&&(e.preOrderHooks??(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks??(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==l&&Fr(l),Zd(a),s.resolving=!1,Jv()}}return r}function fy(t,n,e){return!!(e[n+(t>>ay)]&1<<t)}function py(t,n){return!(t&xt.Self||t&xt.Host&&n)}class fl{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return dy(this._tNode,this._lView,n,Ad(i),e)}}function zk(){return new fl(mi(),De())}function Mi(t){return ts(()=>{const n=t.prototype.constructor,e=n[is]||$p(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[is]||$p(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function $p(t){return no(t)?()=>{const n=$p(ut(t));return n&&n()}:ua(t)}function gy(t){const n=t[Qe],e=n.type;return 2===e?n.declTNode:1===e?t[Si]:null}const gl="__parameters__";function _l(t,n,e){return ts(()=>{const i=function Zp(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,c,u){const h=l.hasOwnProperty(gl)?l[gl]:Object.defineProperty(l,gl,{value:[]})[gl];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(s),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class St{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Mt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function fa(t,n){t.forEach(e=>Array.isArray(e)?fa(e,n):n(e))}function _y(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Kd(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Yc(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function _r(t,n,e){let i=vl(t,n);return i>=0?t[1|i]=e:(i=~i,function Gk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function qp(t,n){const e=vl(t,n);if(e>=0)return t[1|e]}function vl(t,n){return function vy(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const Qd=Rc(_l("Optional"),8),Jd=Rc(_l("SkipSelf"),4);var rr=(()=>((rr=rr||{})[rr.Important=1]="Important",rr[rr.DashCase=2]="DashCase",rr))();const tg=new Map;let h2=0;const ig="__ngContext__";function ki(t,n){gr(n)?(t[ig]=n[Vc],function p2(t){tg.set(t[Vc],t)}(n)):t[ig]=n}let rg;function og(t,n){return rg(t,n)}function Qc(t){const n=t[Rn];return so(n)?n[Rn]:n}function sg(t){return By(t[zc])}function ag(t){return By(t[oo])}function By(t){for(;null!==t&&!so(t);)t=t[oo];return t}function bl(t,n,e,i,r){if(null!=i){let o,s=!1;so(i)?o=i:gr(i)&&(s=!0,i=i[os]);const a=gi(i);0===t&&null!==e?null==r?Gy(n,e,a):pa(n,e,a,r||null,!0):1===t&&null!==e?pa(n,e,a,r||null,!0):2===t?function pg(t,n,e){const i=nh(t,n);i&&function F2(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function L2(t,n,e,i,r){const o=e[Ld];o!==gi(e)&&bl(n,t,i,o,r);for(let a=ji;a<e.length;a++){const l=e[a];Jc(l[Qe],l,t,n,i,o)}}(n,t,o,e,r)}}function cg(t,n,e){return t.createElement(n,e)}function Uy(t,n){const e=t[cl],i=e.indexOf(n),r=n[Rn];512&n[Ft]&&(n[Ft]&=-513,Ip(r,-1)),e.splice(i,1)}function ug(t,n){if(t.length<=ji)return;const e=ji+n,i=t[e];if(i){const r=i[Uc];null!==r&&r!==t&&Uy(r,i),n>0&&(t[e-1][oo]=i[oo]);const o=Kd(t,ji+n);!function S2(t,n){Jc(t,n,n[Lt],2,null,null),n[os]=null,n[Si]=null}(i[Qe],i);const s=o[Eo];null!==s&&s.detachView(o[Qe]),i[Rn]=null,i[oo]=null,i[Ft]&=-65}return i}function Vy(t,n){if(!(128&n[Ft])){const e=n[Lt];e.destroyNode&&Jc(t,n,e,3,null,null),function k2(t){let n=t[zc];if(!n)return dg(t[Qe],t);for(;n;){let e=null;if(gr(n))e=n[zc];else{const i=n[ji];i&&(e=i)}if(!e){for(;n&&!n[oo]&&n!==t;)gr(n)&&dg(n[Qe],n),n=n[Rn];null===n&&(n=t),gr(n)&&dg(n[Qe],n),e=n&&n[oo]}n=e}}(n)}}function dg(t,n){if(!(128&n[Ft])){n[Ft]&=-65,n[Ft]|=128,function P2(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof Gc)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];Nr(4,a,l);try{l.call(a)}finally{Nr(5,a,l)}}else{Nr(4,r,o);try{o.call(r)}finally{Nr(5,r,o)}}}}}(t,n),function A2(t,n){const e=t.cleanup,i=n[sl];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?i[r=s]():i[r=-s].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)(0,i[o])();n[sl]=null}}(t,n),1===n[Qe].type&&n[Lt].destroy();const e=n[Uc];if(null!==e&&so(n[Rn])){e!==n[Rn]&&Uy(e,n);const i=n[Eo];null!==i&&i.detachView(t)}!function g2(t){tg.delete(t[Vc])}(n)}}function jy(t,n,e){return function Hy(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[os];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=t.data[i.directiveStart+r];if(o===ro.None||o===ro.Emulated)return null}return mr(i,e)}}(t,n.parent,e)}function pa(t,n,e,i,r){t.insertBefore(n,e,i,r)}function Gy(t,n,e){t.appendChild(n,e)}function $y(t,n,e,i,r){null!==i?pa(t,n,e,i,r):Gy(t,n,e)}function nh(t,n){return t.parentNode(n)}function Wy(t,n,e){return Yy(t,n,e)}let hg,oh,_g,Yy=function Zy(t,n,e){return 40&t.type?mr(t,e):null};function ih(t,n,e,i){const r=jy(t,i,n),o=n[Lt],a=Wy(i.parent||n[Si],i,n);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)$y(o,r,e[l],a,!1);else $y(o,r,e,a,!1);void 0!==hg&&hg(o,i,n,e,r)}function rh(t,n){if(null!==n){const e=n.type;if(3&e)return mr(n,t);if(4&e)return fg(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return rh(t,i);{const r=t[n.index];return so(r)?fg(-1,r):gi(r)}}if(32&e)return og(n,t)()||gi(t[n.index]);{const i=Ky(t,n);return null!==i?Array.isArray(i)?i[0]:rh(Qc(t[Di]),i):rh(t,n.next)}}return null}function Ky(t,n){return null!==n?t[Di][Si].projection[n.projection]:null}function fg(t,n){const e=ji+t+1;if(e<n.length){const i=n[e],r=i[Qe].firstChild;if(null!==r)return rh(i,r)}return n[Ld]}function gg(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],l=e.type;if(s&&0===n&&(a&&ki(gi(a),i),e.flags|=2),32!=(32&e.flags))if(8&l)gg(t,n,e.child,i,r,o,!1),bl(n,t,r,a,o);else if(32&l){const c=og(e,i);let u;for(;u=c();)bl(n,t,r,u,o);bl(n,t,r,a,o)}else 16&l?Xy(t,n,i,e,r,o):bl(n,t,r,a,o);e=s?e.projectionNext:e.next}}function Jc(t,n,e,i,r,o){gg(e,i,t.firstChild,n,r,o,!1)}function Xy(t,n,e,i,r,o){const s=e[Di],l=s[Si].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)bl(n,t,r,l[c],o);else gg(t,n,l,s[Rn],r,o,!0)}function Qy(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Jy(t,n,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&Up(t,n,i),null!==r&&Qy(t,n,r),null!==o&&function z2(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}function Cl(t){return function mg(){if(void 0===oh&&(oh=null,bn.trustedTypes))try{oh=bn.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return oh}()?.createHTML(t)||t}class ga{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${As})`}}class G2 extends ga{getTypeName(){return"HTML"}}class $2 extends ga{getTypeName(){return"Style"}}class W2 extends ga{getTypeName(){return"Script"}}class Z2 extends ga{getTypeName(){return"URL"}}class Y2 extends ga{getTypeName(){return"ResourceURL"}}function vr(t){return t instanceof ga?t.changingThisBreaksApplicationSecurity:t}function So(t,n){const e=function q2(t){return t instanceof ga&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${As})`)}return e===n}class tI{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(Cl(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class nI{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=Cl(n),e}}const rI=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function ah(t){return(t=String(t)).match(rI)?t:"unsafe:"+t}function ls(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function eu(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const ob=ls("area,br,col,hr,img,wbr"),sb=ls("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),ab=ls("rp,rt"),yg=eu(ob,eu(sb,ls("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),eu(ab,ls("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),eu(ab,sb)),bg=ls("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),lb=eu(bg,ls("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ls("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),oI=ls("script,style,template");class sI{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!yg.hasOwnProperty(e))return this.sanitizedSomething=!0,!oI.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!lb.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;bg[a]&&(l=ah(l)),this.buf.push(" ",s,'="',cb(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();yg.hasOwnProperty(e)&&!ob.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(cb(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const aI=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lI=/([^\#-~ |!])/g;function cb(t){return t.replace(/&/g,"&amp;").replace(aI,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(lI,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let lh;function ub(t,n){let e=null;try{lh=lh||function rb(t){const n=new nI(t);return function iI(){try{return!!(new window.DOMParser).parseFromString(Cl(""),"text/html")}catch{return!1}}()?new tI(n):n}(t);let i=n?String(n):"";e=lh.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=lh.getInertBodyElement(i)}while(i!==o);return Cl((new sI).sanitizeChildren(Cg(e)||e))}finally{if(e){const i=Cg(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Cg(t){return"content"in t&&function cI(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var _n=(()=>((_n=_n||{})[_n.NONE=0]="NONE",_n[_n.HTML=1]="HTML",_n[_n.STYLE=2]="STYLE",_n[_n.SCRIPT=3]="SCRIPT",_n[_n.URL=4]="URL",_n[_n.RESOURCE_URL=5]="RESOURCE_URL",_n))();function Kn(t){const n=function tu(){const t=De();return t&&t[Sp]}();return n?n.sanitize(_n.URL,t)||"":So(t,"URL")?vr(t):ah(Tt(t))}const hb=new St("ENVIRONMENT_INITIALIZER"),fb=new St("INJECTOR",-1),pb=new St("INJECTOR_DEF_TYPES");class gb{get(n,e=Fc){if(e===Fc){const i=new Error(`NullInjectorError: No provider for ${sn(n)}!`);throw i.name="NullInjectorError",i}return e}}function _I(...t){return{\u0275providers:mb(0,t),\u0275fromNgModule:!0}}function mb(t,...n){const e=[],i=new Set;let r;return fa(n,o=>{const s=o;wg(s,e,[],i)&&(r||(r=[]),r.push(s))}),void 0!==r&&_b(r,e),e}function _b(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];Eg(r,o=>{n.push(o)})}}function wg(t,n,e,i){if(!(t=ut(t)))return!1;let r=null,o=yv(t);const s=!o&&cn(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const l=t.ngModule;if(o=yv(l),!o)return!1;r=l}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const c of l)wg(c,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let c;i.add(r);try{fa(o.imports,u=>{wg(u,n,e,i)&&(c||(c=[]),c.push(u))})}finally{}void 0!==c&&_b(c,n)}if(!a){const c=ua(r)||(()=>new r);n.push({provide:r,useFactory:c,deps:tn},{provide:pb,useValue:r,multi:!0},{provide:hb,useValue:()=>bt(r),multi:!0})}const l=o.providers;null==l||a||Eg(l,u=>{n.push(u)})}}return r!==t&&void 0!==t.providers}function Eg(t,n){for(let e of t)Pc(e)&&(e=e.\u0275providers),Array.isArray(e)?Eg(e,n):n(e)}const vI=Ut({provide:String,useValue:Ut});function Tg(t){return null!==t&&"object"==typeof t&&vI in t}function ma(t){return"function"==typeof t}const xg=new St("Set Injector scope."),ch={},bI={};let Sg;function uh(){return void 0===Sg&&(Sg=new gb),Sg}class wl{}class bb extends wl{get destroyed(){return this._destroyed}constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Mg(n,s=>this.processProvider(s)),this.records.set(fb,El(void 0,this)),r.has("environment")&&this.records.set(wl,El(void 0,this));const o=this.records.get(xg);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(pb.multi,tn,xt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=ol(this),i=Fr(void 0);try{return n()}finally{ol(e),Fr(i)}}get(n,e=Fc,i=xt.Default){this.assertNotDestroyed(),i=Ad(i);const r=ol(this),o=Fr(void 0);try{if(!(i&xt.SkipSelf)){let a=this.records.get(n);if(void 0===a){const l=function xI(t){return"function"==typeof t||"object"==typeof t&&t instanceof St}(n)&&kd(n);a=l&&this.injectableDefInScope(l)?El(Dg(n),ch):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&xt.Self?uh():this.parent).get(n,e=i&xt.Optional&&e===Fc?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[Od]=s[Od]||[]).unshift(sn(n)),r)throw s;return function YM(t,n,e,i){const r=t[Od];throw n[wv]&&r.unshift(n[wv]),t.message=function qM(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&t.charAt(1)==$M?t.slice(2):t;let r=sn(n);if(Array.isArray(n))r=n.map(sn).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):sn(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(GM,"\n  ")}`}("\n"+t.message,r,e,i),t[HM]=r,t[Od]=null,t}(s,n,"R3InjectorError",this.source)}throw s}finally{Fr(o),ol(r)}}resolveInjectorInitializers(){const n=ol(this),e=Fr(void 0);try{const i=this.get(hb.multi,tn,xt.Self);for(const r of i)r()}finally{ol(n),Fr(e)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(sn(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Se(205,!1)}processProvider(n){let e=ma(n=ut(n))?n:ut(n&&n.provide);const i=function wI(t){return Tg(t)?El(void 0,t.useValue):El(Cb(t),ch)}(n);if(ma(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=El(void 0,ch,!0),r.factory=()=>Ep(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){return e.value===ch&&(e.value=bI,e.value=e.factory()),"object"==typeof e.value&&e.value&&function TI(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=ut(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Dg(t){const n=kd(t),e=null!==n?n.factory:ua(t);if(null!==e)return e;if(t instanceof St)throw new Se(204,!1);if(t instanceof Function)return function CI(t){const n=t.length;if(n>0)throw Yc(n,"?"),new Se(204,!1);const e=function UM(t){return t&&(t[Id]||t[bv])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Se(204,!1)}function Cb(t,n,e){let i;if(ma(t)){const r=ut(t);return ua(r)||Dg(r)}if(Tg(t))i=()=>ut(t.useValue);else if(function yb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Ep(t.deps||[]));else if(function vb(t){return!(!t||!t.useExisting)}(t))i=()=>bt(ut(t.useExisting));else{const r=ut(t&&(t.useClass||t.provide));if(!function EI(t){return!!t.deps}(t))return ua(r)||Dg(r);i=()=>new r(...Ep(t.deps))}return i}function El(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Mg(t,n){for(const e of t)Array.isArray(e)?Mg(e,n):e&&Pc(e)?Mg(e.\u0275providers,n):n(e)}class SI{}class wb{}class MI{resolveComponentFactory(n){throw function DI(t){const n=Error(`No component factory found for ${sn(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let dh=(()=>{class t{}return t.NULL=new MI,t})();function kI(){return Tl(mi(),De())}function Tl(t,n){return new Ln(mr(t,n))}let Ln=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=kI,t})();function II(t){return t instanceof Ln?t.nativeElement:t}class nu{}let _a=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function OI(){const t=De(),e=ir(mi().index,t);return(gr(e)?e:t)[Lt]}(),t})(),AI=(()=>{class t{}return t.\u0275prov=Mt({token:t,providedIn:"root",factory:()=>null}),t})();class hh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const PI=new hh("15.2.8"),kg={},Ig="ngOriginalError";function Og(t){return t[Ig]}class xl{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Og(n);for(;e&&Og(e);)e=Og(e);return e||null}}function iu(t){return t.ownerDocument}function xb(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}const Sb="ng-template";function HI(t,n,e){let i=0,r=!0;for(;i<t.length;){let o=t[i++];if("string"==typeof o&&r){const s=t[i++];if(e&&"class"===o&&-1!==xb(s.toLowerCase(),n,0))return!0}else{if(1===o){for(;i<t.length&&"string"==typeof(o=t[i++]);)if(o.toLowerCase()===n)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function Db(t){return 4===t.type&&t.value!==Sb}function GI(t,n,e){return n===(4!==t.type||e?t.value:Sb)}function $I(t,n,e){let i=4;const r=t.attrs||[],o=function YI(t){for(let n=0;n<t.length;n++)if(ny(t[n]))return n;return t.length}(r);let s=!1;for(let a=0;a<n.length;a++){const l=n[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!GI(t,l,e)||""===l&&1===n.length){if(lo(i))return!1;s=!0}}else{const c=8&i?l:n[++a];if(8&i&&null!==t.attrs){if(!HI(t.attrs,c,e)){if(lo(i))return!1;s=!0}continue}const h=WI(8&i?"class":l,r,Db(t),e);if(-1===h){if(lo(i))return!1;s=!0;continue}if(""!==c){let g;g=h>o?"":r[h+1].toLowerCase();const E=8&i?g:null;if(E&&-1!==xb(E,c,0)||2&i&&c!==g){if(lo(i))return!1;s=!0}}}}else{if(!s&&!lo(i)&&!lo(l))return!1;if(s&&lo(l))continue;s=!1,i=l|1&i}}return lo(i)||s}function lo(t){return 0==(1&t)}function WI(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function qI(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function Mb(t,n,e=!1){for(let i=0;i<n.length;i++)if($I(t,n[i],e))return!0;return!1}function KI(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function kb(t,n){return t?":not("+n.trim()+")":n}function XI(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!lo(s)&&(n+=kb(o,r),r=""),i=s,o=o||!lo(i);e++}return""!==r&&(n+=kb(o,r)),n}const Ot={};function k(t){Ib(Jt(),De(),Gi()+t,!1)}function Ib(t,n,e,i){if(!i)if(3==(3&n[Ft])){const o=t.preOrderCheckHooks;null!==o&&Hd(n,o,e)}else{const o=t.preOrderHooks;null!==o&&Gd(n,o,0,e)}da(e)}function Fb(t,n=null,e=null,i){const r=Nb(t,n,e,i);return r.resolveInjectorInitializers(),r}function Nb(t,n=null,e=null,i,r=new Set){const o=[e||tn,_I(t)];return i=i||("object"==typeof t?void 0:sn(t)),new bb(o,n||uh(),i||null,r)}let Do=(()=>{class t{static create(e,i){if(Array.isArray(e))return Fb({name:""},i,e,"");{const r=e.name??"";return Fb({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=Fc,t.NULL=new gb,t.\u0275prov=Mt({token:t,providedIn:"any",factory:()=>bt(fb)}),t.__NG_ELEMENT_ID__=-1,t})();function J(t,n=xt.Default){const e=De();return null===e?bt(t,n):dy(mi(),e,ut(t),n)}function jb(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const o=e[i+1];if(-1!==o){const s=t.data[o];Np(e[i]),s.contentQueries(2,n[o],o)}}}function ph(t,n,e,i,r,o,s,a,l,c,u){const h=n.blueprint.slice();return h[os]=r,h[Ft]=76|i,(null!==u||t&&1024&t[Ft])&&(h[Ft]|=1024),Vv(h),h[Rn]=h[al]=t,h[jn]=e,h[Rd]=s||t&&t[Rd],h[Lt]=a||t&&t[Lt],h[Sp]=l||t&&t[Sp]||null,h[Nd]=c||t&&t[Nd]||null,h[Si]=o,h[Vc]=function f2(){return h2++}(),h[Ov]=u,h[Di]=2==n.type?t[Di]:h,h}function Ml(t,n,e,i,r){let o=t.data[n];if(null===o)o=function Rg(t,n,e,i,r){const o=Gv(),s=Op(),l=t.data[n]=function TO(t,n,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l,l.prev=o)),l}(t,n,e,i,r),function vk(){return It.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function Hc(){const t=It.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return To(o,!0),o}function ru(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Lg(t,n,e){Rp(n);try{const i=t.viewQuery;null!==i&&Wg(1,i,e);const r=t.template;null!==r&&Hb(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&jb(t,n),t.staticViewQueries&&Wg(2,t.viewQuery,e);const o=t.components;null!==o&&function CO(t,n){for(let e=0;e<n.length;e++)GO(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[Ft]&=-5,Lp()}}function gh(t,n,e,i){const r=n[Ft];if(128!=(128&r)){Rp(n);try{Vv(n),function Wv(t){return It.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Hb(t,n,e,2,i);const s=3==(3&r);if(s){const c=t.preOrderCheckHooks;null!==c&&Hd(n,c,null)}else{const c=t.preOrderHooks;null!==c&&Gd(n,c,0,null),Bp(n,0)}if(function jO(t){for(let n=sg(t);null!==n;n=ag(n)){if(!n[Av])continue;const e=n[cl];for(let i=0;i<e.length;i++){const r=e[i];512&r[Ft]||Ip(r[Rn],1),r[Ft]|=512}}}(n),function VO(t){for(let n=sg(t);null!==n;n=ag(n))for(let e=ji;e<n.length;e++){const i=n[e],r=i[Qe];Vd(i)&&gh(r,i,r.template,i[jn])}}(n),null!==t.contentQueries&&jb(t,n),s){const c=t.contentCheckHooks;null!==c&&Hd(n,c)}else{const c=t.contentHooks;null!==c&&Gd(n,c,1),Bp(n,1)}!function yO(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)da(~r);else{const o=r,s=e[++i],a=e[++i];yk(s,o),a(2,n[o])}}}finally{da(-1)}}(t,n);const a=t.components;null!==a&&function bO(t,n){for(let e=0;e<n.length;e++)HO(t,n[e])}(n,a);const l=t.viewQuery;if(null!==l&&Wg(2,l,i),s){const c=t.viewCheckHooks;null!==c&&Hd(n,c)}else{const c=t.viewHooks;null!==c&&Gd(n,c,2),Bp(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Ft]&=-41,512&n[Ft]&&(n[Ft]&=-513,Ip(n[Rn],-1))}finally{Lp()}}}function Hb(t,n,e,i,r){const o=Gi(),s=2&i;try{da(-1),s&&n.length>Cn&&Ib(t,n,Cn,!1),Nr(s?2:0,r),e(i,r)}finally{da(o),Nr(s?3:1,r)}}function Bg(t,n,e){if(Mp(n)){const r=n.directiveEnd;for(let o=n.directiveStart;o<r;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function zg(t,n,e){Hv()&&(function OO(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;jc(e)&&function BO(t,n,e){const i=mr(n,t),r=Gb(e),o=t[Rd],s=mh(t,ph(t,r,null,e.onPush?32:16,i,n,o,o.createRenderer(i,e),null,null,null));t[n.index]=s}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Yd(e,n),ki(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const l=t.data[a],c=ha(n,t,a,e);ki(c,n),null!==s&&zO(0,a-r,c,l,0,s),ao(l)&&(ir(e.index,n)[jn]=ha(n,t,a,e))}}(t,n,e,mr(e,n)),64==(64&e.flags)&&qb(t,n,e))}function Ug(t,n,e=mr){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function Gb(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Vg(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Vg(t,n,e,i,r,o,s,a,l,c){const u=Cn+i,h=u+r,g=function wO(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Ot);return e}(u,h),E="function"==typeof c?c():c;return g[Qe]={type:t,blueprint:g,template:e,queries:null,viewQuery:a,declTNode:n,data:g.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:E,incompleteFirstPass:!1}}function $b(t,n,e,i){const r=Xb(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Qb(t).push(i,r.length-1))}function Wb(t,n,e,i){for(let r in t)if(t.hasOwnProperty(r)){e=null===e?{}:e;const o=t[r];null===i?Zb(e,n,r,o):i.hasOwnProperty(r)&&Zb(e,n,i[r],o)}return e}function Zb(t,n,e,i){t.hasOwnProperty(e)?t[e].push(n,i):t[e]=[n,i]}function yr(t,n,e,i,r,o,s,a){const l=mr(n,e);let u,c=n.inputs;!a&&null!=c&&(u=c[i])?(Zg(t,e,u,i,r),jc(n)&&function DO(t,n){const e=ir(n,t);16&e[Ft]||(e[Ft]|=32)}(e,n.index)):3&n.type&&(i=function SO(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(l,i,r))}function jg(t,n,e,i){if(Hv()){const r=null===i?null:{"":-1},o=function PO(t,n){const e=t.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(Mb(n,s.selectors,!1))if(i||(i=[]),ao(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),Hg(t,n,a.length)}else i.unshift(s),Hg(t,n,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(t,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&Yb(t,n,e,s,r,a),r&&function FO(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new Se(-301,!1);i.push(n[r],o)}}}(e,i,r)}e.mergedAttrs=$c(e.mergedAttrs,e.attrs)}function Yb(t,n,e,i,r,o){for(let c=0;c<i.length;c++)Gp(Yd(e,n),t,i[c].type);!function RO(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,l=ru(t,n,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];e.mergedAttrs=$c(e.mergedAttrs,u.hostAttrs),LO(t,e,n,l,u),NO(l,u,r),null!==u.contentQueries&&(e.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(e.flags|=64);const h=u.type.prototype;!s&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((t.preOrderHooks??(t.preOrderHooks=[])).push(e.index),s=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(e.index),a=!0),l++}!function xO(t,n,e){const r=n.directiveEnd,o=t.data,s=n.attrs,a=[];let l=null,c=null;for(let u=n.directiveStart;u<r;u++){const h=o[u],g=e?e.get(h):null,L=g?g.outputs:null;l=Wb(h.inputs,u,l,g?g.inputs:null),c=Wb(h.outputs,u,c,L);const Z=null===l||null===s||Db(n)?null:UO(l,u,s);a.push(Z)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=c}(t,e,o)}function qb(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function bk(){return It.lFrame.currentDirectiveIndex}();try{da(o);for(let a=i;a<r;a++){const l=t.data[a],c=n[a];Pp(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&AO(l,c)}}finally{da(-1),Pp(s)}}function AO(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function Hg(t,n,e){n.componentOffset=e,(t.components??(t.components=[])).push(n.index)}function NO(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;ao(n)&&(e[""]=t)}}function LO(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=ua(r.type)),s=new Gc(o,ao(r),J);t.blueprint[i]=s,e[i]=s,function kO(t,n,e,i,r){const o=r.hostBindings;if(o){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~n.index;(function IO(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,i,o)}}(t,n,i,ru(t,e,r.hostVars,Ot),r)}function Mo(t,n,e,i,r,o){const s=mr(t,n);!function Gg(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?Tt(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[Lt],s,o,t.value,e,i,r)}function zO(t,n,e,i,r,o){const s=o[n];if(null!==s){const a=i.setInput;for(let l=0;l<s.length;){const c=s[l++],u=s[l++],h=s[l++];null!==a?i.setInput(e,h,c,u):e[u]=h}}}function UO(t,n,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===i&&(i=[]);const s=t[o];for(let a=0;a<s.length;a+=2)if(s[a]===n){i.push(o,s[a+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function Kb(t,n,e,i){return[t,!0,!1,n,null,0,i,e,null,null]}function HO(t,n){const e=ir(n,t);if(Vd(e)){const i=e[Qe];48&e[Ft]?gh(i,e,i.template,e[jn]):e[ca]>0&&$g(e)}}function $g(t){for(let i=sg(t);null!==i;i=ag(i))for(let r=ji;r<i.length;r++){const o=i[r];if(Vd(o))if(512&o[Ft]){const s=o[Qe];gh(s,o,s.template,o[jn])}else o[ca]>0&&$g(o)}const e=t[Qe].components;if(null!==e)for(let i=0;i<e.length;i++){const r=ir(e[i],t);Vd(r)&&r[ca]>0&&$g(r)}}function GO(t,n){const e=ir(n,t),i=e[Qe];(function $O(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),Lg(i,e,e[jn])}function mh(t,n){return t[zc]?t[Iv][oo]=n:t[zc]=n,t[Iv]=n,n}function _h(t){for(;t;){t[Ft]|=32;const n=Qc(t);if(ek(t)&&!n)return t;t=n}return null}function vh(t,n,e,i=!0){const r=n[Rd];r.begin&&r.begin();try{gh(t,n,t.template,e)}catch(s){throw i&&e1(n,s),s}finally{r.end&&r.end()}}function Wg(t,n,e){Np(0),n(t,e)}function Xb(t){return t[sl]||(t[sl]=[])}function Qb(t){return t.cleanup||(t.cleanup=[])}function e1(t,n){const e=t[Nd],i=e?e.get(xl,null):null;i&&i.handleError(n)}function Zg(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],l=n[s],c=t.data[s];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function us(t,n,e){const i=Ud(n,t);!function zy(t,n,e){t.setValue(n,e)}(t[Lt],i,e)}function yh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=la(r,a):2==o&&(i=la(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}function bh(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&i.push(gi(o)),so(o))for(let a=ji;a<o.length;a++){const l=o[a],c=l[Qe].firstChild;null!==c&&bh(l[Qe],l,c,i)}const s=e.type;if(8&s)bh(t,n,e.child,i);else if(32&s){const a=og(e,n);let l;for(;l=a();)i.push(l)}else if(16&s){const a=Ky(n,e);if(Array.isArray(a))i.push(...a);else{const l=Qc(n[Di]);bh(l[Qe],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class ou{get rootNodes(){const n=this._lView,e=n[Qe];return bh(e,n,e.firstChild,[])}constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[jn]}set context(n){this._lView[jn]=n}get destroyed(){return 128==(128&this._lView[Ft])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Rn];if(so(n)){const e=n[Bd],i=e?e.indexOf(this):-1;i>-1&&(ug(n,i),Kd(e,i))}this._attachedToViewContainer=!1}Vy(this._lView[Qe],this._lView)}onDestroy(n){$b(this._lView[Qe],this._lView,null,n)}markForCheck(){_h(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ft]&=-65}reattach(){this._lView[Ft]|=64}detectChanges(){vh(this._lView[Qe],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function M2(t,n){Jc(t,n,n[Lt],2,null,null)}(this._lView[Qe],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Se(902,!1);this._appRef=n}}class WO extends ou{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;vh(n[Qe],n,n[jn],!1)}checkNoChanges(){}get context(){return null}}class t1 extends dh{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=cn(n);return new su(e,this.ngModule)}}function n1(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class YO{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=Ad(i);const r=this.injector.get(n,kg,i);return r!==kg||e===kg?r:this.parentInjector.get(n,e,i)}}class su extends wb{get inputs(){return n1(this.componentDef.inputs)}get outputs(){return n1(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function QI(t){return t.map(XI).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,r){let o=(r=r||this.ngModule)instanceof wl?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new YO(n,o):n,a=s.get(nu,null);if(null===a)throw new Se(407,!1);const l=s.get(AI,null),c=a.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=i?function EO(t,n,e){return t.selectRootElement(n,e===ro.ShadowDom)}(c,i,this.componentDef.encapsulation):cg(c,u,function ZO(t){const n=t.toLowerCase();return"svg"===n?Bv:"math"===n?"math":null}(u)),g=this.componentDef.onPush?288:272,E=Vg(0,null,null,1,0,null,null,null,null,null),L=ph(null,E,null,g,null,null,a,c,l,s,null);let Z,re;Rp(L);try{const oe=this.componentDef;let ce,ue=null;oe.findHostDirectiveDefs?(ce=[],ue=new Map,oe.findHostDirectiveDefs(oe,ce,ue),ce.push(oe)):ce=[oe];const be=function KO(t,n){const e=t[Qe],i=Cn;return t[i]=n,Ml(e,i,2,"#host",null)}(L,h),Ke=function XO(t,n,e,i,r,o,s,a){const l=r[Qe];!function QO(t,n,e,i){for(const r of t)n.mergedAttrs=$c(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(yh(n,n.mergedAttrs,!0),null!==e&&Jy(i,e,n))}(i,t,n,s);const c=o.createRenderer(n,e),u=ph(r,Gb(e),null,e.onPush?32:16,r[t.index],t,o,c,a||null,null,null);return l.firstCreatePass&&Hg(l,t,i.length-1),mh(r,u),r[t.index]=u}(be,h,oe,ce,L,a,c);re=Uv(E,Cn),h&&function eA(t,n,e,i){if(i)Up(t,e,["ng-version",PI.full]);else{const{attrs:r,classes:o}=function JI(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!lo(r))break;r=o}i++}return{attrs:n,classes:e}}(n.selectors[0]);r&&Up(t,e,r),o&&o.length>0&&Qy(t,e,o.join(" "))}}(c,oe,h,i),void 0!==e&&function tA(t,n,e){const i=t.projection=[];for(let r=0;r<n.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(re,this.ngContentSelectors,e),Z=function JO(t,n,e,i,r,o){const s=mi(),a=r[Qe],l=mr(s,r);Yb(a,r,s,e,null,i);for(let u=0;u<e.length;u++)ki(ha(r,a,s.directiveStart+u,s),r);qb(a,r,s),l&&ki(l,r);const c=ha(r,a,s.directiveStart+s.componentOffset,s);if(t[jn]=r[jn]=c,null!==o)for(const u of o)u(c,n);return Bg(a,s,t),c}(Ke,oe,ce,ue,L,[nA]),Lg(E,L,null)}finally{Lp()}return new qO(this.componentType,Z,Tl(re,L),L,re)}}class qO extends SI{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new WO(r),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){const o=this._rootLView;Zg(o[Qe],o,r,n,e),_h(ir(this._tNode.index,o))}}get injector(){return new fl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function nA(){const t=mi();jd(De()[Qe],t)}function hn(t){let n=function i1(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(ao(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Se(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=Yg(t.inputs),s.declaredInputs=Yg(t.declaredInputs),s.outputs=Yg(t.outputs);const a=r.hostBindings;a&&sA(t,a);const l=r.viewQuery,c=r.contentQueries;if(l&&rA(t,l),c&&oA(t,c),Os(t.inputs,r.inputs),Os(t.declaredInputs,r.declaredInputs),Os(t.outputs,r.outputs),ao(r)&&r.data.animation){const u=t.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===hn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function iA(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=$c(r.hostAttrs,e=$c(e,r.hostAttrs))}}(i)}function Yg(t){return t===ns?{}:t===tn?[]:t}function rA(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function oA(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function sA(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}function Ch(t){return!!qg(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function qg(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ko(t,n,e){return t[n]=e}function Ii(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function va(t,n,e,i){const r=Ii(t,n,e);return Ii(t,n+1,i)||r}function Br(t,n,e,i){const r=De();return Ii(r,dl(),n)&&(Jt(),Mo(kn(),r,t,n,e,i)),Br}function Il(t,n,e,i){return Ii(t,dl(),e)?n+Tt(e)+i:Ot}function Ol(t,n,e,i,r,o){const a=va(t,function ss(){return It.lFrame.bindingIndex}(),e,r);return as(2),a?n+Tt(e)+i+Tt(r)+o:Ot}function X(t,n,e,i,r,o,s,a){const l=De(),c=Jt(),u=t+Cn,h=c.firstCreatePass?function mA(t,n,e,i,r,o,s,a,l){const c=n.consts,u=Ml(n,t,4,s||null,Ps(c,a));jg(n,e,u,Ps(c,l)),jd(n,u);const h=u.tView=Vg(2,u,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,c);return null!==n.queries&&(n.queries.template(n,u),h.queries=n.queries.embeddedTView(u)),u}(u,c,l,n,e,i,r,o,s):c.data[u];To(h,!1);const g=l[Lt].createComment("");ih(c,l,g,h),ki(g,l),mh(l,l[u]=Kb(g,l,g,h)),zd(h)&&zg(c,l,h),null!=s&&Ug(l,h,a)}function Pt(t){return ul(function _k(){return It.lFrame.contextLView}(),Cn+t)}function D(t,n,e){const i=De();return Ii(i,dl(),n)&&yr(Jt(),kn(),i,t,n,i[Lt],e,!1),D}function Kg(t,n,e,i,r){const s=r?"class":"style";Zg(t,e,n.inputs[s],s,i)}function O(t,n,e,i){const r=De(),o=Jt(),s=Cn+t,a=r[Lt],l=o.firstCreatePass?function vA(t,n,e,i,r,o){const s=n.consts,l=Ml(n,t,2,i,Ps(s,r));return jg(n,e,l,Ps(s,o)),null!==l.attrs&&yh(l,l.attrs,!1),null!==l.mergedAttrs&&yh(l,l.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,l),l}(s,o,r,n,e,i):o.data[s],c=r[s]=cg(a,n,function Dk(){return It.lFrame.currentNamespace}()),u=zd(l);return To(l,!0),Jy(a,c,l),32!=(32&l.flags)&&ih(o,r,c,l),0===function hk(){return It.lFrame.elementDepthCount}()&&ki(c,r),function fk(){It.lFrame.elementDepthCount++}(),u&&(zg(o,r,l),Bg(o,l,r)),null!==i&&Ug(r,l),O}function F(){let t=mi();Op()?Ap():(t=t.parent,To(t,!1));const n=t;!function pk(){It.lFrame.elementDepthCount--}();const e=Jt();return e.firstCreatePass&&(jd(e,t),Mp(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Ok(t){return 0!=(8&t.flags)}(n)&&Kg(e,n,De(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Ak(t){return 0!=(16&t.flags)}(n)&&Kg(e,n,De(),n.stylesWithoutHost,!1),F}function Le(t,n,e,i){return O(t,n,e,i),F(),Le}function je(t,n,e){const i=De(),r=Jt(),o=t+Cn,s=r.firstCreatePass?function yA(t,n,e,i,r){const o=n.consts,s=Ps(o,i),a=Ml(n,t,8,"ng-container",s);return null!==s&&yh(a,s,!0),jg(n,e,a,Ps(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];To(s,!0);const a=i[o]=i[Lt].createComment("");return ih(r,i,a,s),ki(a,i),zd(s)&&(zg(r,i,s),Bg(r,s,i)),null!=e&&Ug(i,s),je}function He(){let t=mi();const n=Jt();return Op()?Ap():(t=t.parent,To(t,!1)),n.firstCreatePass&&(jd(n,t),Mp(t)&&n.queries.elementEnd(t)),He}function wn(t,n,e){return je(t,n,e),He(),wn}function et(){return De()}function Eh(t){return!!t&&"function"==typeof t.then}const _1=function m1(t){return!!t&&"function"==typeof t.subscribe};function ge(t,n,e,i){const r=De(),o=Jt(),s=mi();return function y1(t,n,e,i,r,o,s){const a=zd(i),c=t.firstCreatePass&&Qb(t),u=n[jn],h=Xb(n);let g=!0;if(3&i.type||s){const Z=mr(i,n),re=s?s(Z):Z,oe=h.length,ce=s?be=>s(gi(be[i.index])):i.index;let ue=null;if(!s&&a&&(ue=function bA(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[sl],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==ue)(ue.__ngLastListenerFn__||ue).__ngNextListenerFn__=o,ue.__ngLastListenerFn__=o,g=!1;else{o=C1(i,n,u,o,!1);const be=e.listen(re,r,o);h.push(o,be),c&&c.push(r,ce,oe,oe+1)}}else o=C1(i,n,u,o,!1);const E=i.outputs;let L;if(g&&null!==E&&(L=E[r])){const Z=L.length;if(Z)for(let re=0;re<Z;re+=2){const Ke=n[L[re]][L[re+1]].subscribe(o),ft=h.length;h.push(o,Ke),c&&c.push(r,i.index,ft,-(ft+1))}}}(o,r,r[Lt],s,t,n,i),ge}function b1(t,n,e,i){try{return Nr(6,n,e),!1!==e(i)}catch(r){return e1(t,r),!1}finally{Nr(7,n,e)}}function C1(t,n,e,i,r){return function o(s){if(s===Function)return i;_h(t.componentOffset>-1?ir(t.index,n):n);let l=b1(n,e,i,s),c=o.__ngNextListenerFn__;for(;c;)l=b1(n,e,c,s)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(s.preventDefault(),s.returnValue=!1),l}}function H(t=1){return function wk(t){return(It.lFrame.contextLView=function Ek(t,n){for(;t>0;)n=n[al],t--;return n}(t,It.lFrame.contextLView))[jn]}(t)}function CA(t,n){let e=null;const i=function ZI(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?Mb(t,o,!0):KI(i,o))return r}else e=r}return e}function Xg(t){const n=De()[Di][Si];if(!n.projection){const i=n.projection=Yc(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?CA(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function Qg(t,n=0,e){const i=De(),r=Jt(),o=Ml(r,Cn+t,16,null,e||null);null===o.projection&&(o.projection=n),Ap(),32!=(32&o.flags)&&function R2(t,n,e){Xy(n[Lt],0,n,e,jy(t,e,n),Wy(e.parent||n[Si],e,n))}(r,i,o)}function vn(t,n,e){return Jg(t,"",n,"",e),vn}function Jg(t,n,e,i,r){const o=De(),s=Il(o,n,e,i);return s!==Ot&&yr(Jt(),kn(),o,t,s,o[Lt],r,!1),Jg}function Th(t,n){return t<<17|n<<2}function Fs(t){return t>>17&32767}function em(t){return 2|t}function ya(t){return(131068&t)>>2}function tm(t,n){return-131069&t|n<<2}function nm(t){return 1|t}function I1(t,n,e,i,r){const o=t[e+1],s=null===n;let a=i?Fs(o):ya(o),l=!1;for(;0!==a&&(!1===l||s);){const u=t[a+1];DA(t[a],n)&&(l=!0,t[a+1]=i?nm(u):em(u)),a=i?Fs(u):ya(u)}l&&(t[e+1]=i?em(o):nm(o))}function DA(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&vl(t,n)>=0}const oi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function O1(t){return t.substring(oi.key,oi.keyEnd)}function MA(t){return t.substring(oi.value,oi.valueEnd)}function P1(t,n){const e=oi.textEnd;let i=oi.key=Bl(t,n,e);return e===i?-1:(i=oi.keyEnd=function AA(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=N1(t,i,e),i=oi.value=Bl(t,i,e),i=oi.valueEnd=function PA(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const l=t.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=R1(t,l,s,e):n===s-4&&85===o&&82===r&&76===i&&40===l?a=s=R1(t,41,s,e):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(t,i,e),N1(t,i,e))}function Bl(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function N1(t,n,e,i){return(n=Bl(t,n,e))<e&&n++,n}function R1(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function un(t,n,e){return co(t,n,e,!1),un}function xh(t,n){return co(t,n,null,!0),xh}function br(t){!function uo(t,n,e,i){const r=Jt(),o=as(2);r.firstUpdatePass&&B1(r,null,o,i);const s=De();if(e!==Ot&&Ii(s,o,e)){const a=r.data[Gi()];if(j1(a,i)&&!L1(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=la(l,e||"")),Kg(r,a,s,e,i)}else!function jA(t,n,e,i,r,o,s,a){r===Ot&&(r=tn);let l=0,c=0,u=0<r.length?r[0]:null,h=0<o.length?o[0]:null;for(;null!==u||null!==h;){const g=l<r.length?r[l+1]:void 0,E=c<o.length?o[c+1]:void 0;let Z,L=null;u===h?(l+=2,c+=2,g!==E&&(L=h,Z=E)):null===h||null!==u&&u<h?(l+=2,L=u):(c+=2,L=h,Z=E),null!==L&&U1(t,n,e,i,L,Z,s,a),u=l<r.length?r[l]:null,h=c<o.length?o[c]:null}}(r,a,s,s[Lt],s[o+1],s[o+1]=function UA(t,n,e){if(null==e||""===e)return tn;const i=[],r=vr(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}(z1,FA,t,!1)}function FA(t,n){for(let e=function IA(t){return function F1(t){oi.key=0,oi.keyEnd=0,oi.value=0,oi.valueEnd=0,oi.textEnd=t.length}(t),P1(t,Bl(t,0,oi.textEnd))}(n);e>=0;e=P1(n,e))z1(t,O1(n),MA(n))}function co(t,n,e,i){const r=De(),o=Jt(),s=as(2);o.firstUpdatePass&&B1(o,t,s,i),n!==Ot&&Ii(r,s,n)&&U1(o,o.data[Gi()],r,r[Lt],t,r[s+1]=function HA(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=sn(vr(t)))),t}(n,e),i,s)}function L1(t,n){return n>=t.expandoStartIndex}function B1(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[Gi()],s=L1(t,e);j1(o,i)&&null===n&&!s&&(n=!1),n=function RA(t,n,e,i){const r=function Fp(t){const n=It.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=lu(e=im(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=im(r,t,n,e,i),null===o){let l=function LA(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==ya(i))return t[Fs(i)]}(t,n,i);void 0!==l&&Array.isArray(l)&&(l=im(null,t,n,l[1],i),l=lu(l,n.attrs,i),function BA(t,n,e,i){t[Fs(e?n.classBindings:n.styleBindings)]=i}(t,n,i,l))}else o=function zA(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=lu(i,t[o].hostAttrs,e);return lu(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function xA(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Fs(s),l=ya(s);t[i]=e;let u,c=!1;if(Array.isArray(e)?(u=e[1],(null===u||vl(e,u)>0)&&(c=!0)):u=e,r)if(0!==l){const g=Fs(t[a+1]);t[i+1]=Th(g,a),0!==g&&(t[g+1]=tm(t[g+1],i)),t[a+1]=function EA(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Th(a,0),0!==a&&(t[a+1]=tm(t[a+1],i)),a=i;else t[i+1]=Th(l,0),0===a?a=i:t[l+1]=tm(t[l+1],i),l=i;c&&(t[i+1]=em(t[i+1])),I1(t,u,i,!0),I1(t,u,i,!1),function SA(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&vl(o,n)>=0&&(e[i+1]=nm(e[i+1]))}(n,u,t,i,o),s=Th(a,l),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function im(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=lu(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function lu(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),_r(t,s,!!e||n[++o]))}return void 0===t?null:t}function z1(t,n,e){_r(t,n,vr(e))}function U1(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const l=t.data,c=l[a+1],u=function TA(t){return 1==(1&t)}(c)?V1(l,n,e,r,ya(c),s):void 0;Sh(u)||(Sh(o)||function wA(t){return 2==(2&t)}(c)&&(o=V1(l,null,e,r,a,s)),function B2(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:rr.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=rr.Important),t.setStyle(e,i,r,o))}}(i,s,Ud(Gi(),e),r,o))}function V1(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const l=t[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let g=e[r+1];g===Ot&&(g=h?tn:void 0);let E=h?qp(g,i):u===i?g:void 0;if(c&&!Sh(E)&&(E=qp(l,i)),Sh(E)&&(a=E,s))return a;const L=t[r+1];r=s?Fs(L):ya(L)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(a=qp(l,i))}return a}function Sh(t){return void 0!==t}function j1(t,n){return 0!=(t.flags&(n?8:16))}function Q(t,n=""){const e=De(),i=Jt(),r=t+Cn,o=i.firstCreatePass?Ml(i,r,1,n,null):i.data[r],s=e[r]=function lg(t,n){return t.createText(n)}(e[Lt],n);ih(i,e,s,o),To(o,!1)}function gt(t){return Hn("",t,""),gt}function Hn(t,n,e){const i=De(),r=Il(i,t,n,e);return r!==Ot&&us(i,Gi(),r),Hn}function zl(t,n,e,i,r){const o=De(),s=Ol(o,t,n,e,i,r);return s!==Ot&&us(o,Gi(),s),zl}const ba=void 0;var cP=["en",[["a","p"],["AM","PM"],ba],[["AM","PM"],ba,ba],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ba,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ba,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ba,"{1} 'at' {0}",ba],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function lP(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Ul={};function $i(t){const n=function uP(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=lC(n);if(e)return e;const i=n.split("-")[0];if(e=lC(i),e)return e;if("en"===i)return cP;throw new Se(701,!1)}function lC(t){return t in Ul||(Ul[t]=bn.ng&&bn.ng.common&&bn.ng.common.locales&&bn.ng.common.locales[t]),Ul[t]}var qe=(()=>((qe=qe||{})[qe.LocaleId=0]="LocaleId",qe[qe.DayPeriodsFormat=1]="DayPeriodsFormat",qe[qe.DayPeriodsStandalone=2]="DayPeriodsStandalone",qe[qe.DaysFormat=3]="DaysFormat",qe[qe.DaysStandalone=4]="DaysStandalone",qe[qe.MonthsFormat=5]="MonthsFormat",qe[qe.MonthsStandalone=6]="MonthsStandalone",qe[qe.Eras=7]="Eras",qe[qe.FirstDayOfWeek=8]="FirstDayOfWeek",qe[qe.WeekendRange=9]="WeekendRange",qe[qe.DateFormat=10]="DateFormat",qe[qe.TimeFormat=11]="TimeFormat",qe[qe.DateTimeFormat=12]="DateTimeFormat",qe[qe.NumberSymbols=13]="NumberSymbols",qe[qe.NumberFormats=14]="NumberFormats",qe[qe.CurrencyCode=15]="CurrencyCode",qe[qe.CurrencySymbol=16]="CurrencySymbol",qe[qe.CurrencyName=17]="CurrencyName",qe[qe.Currencies=18]="Currencies",qe[qe.Directionality=19]="Directionality",qe[qe.PluralCase=20]="PluralCase",qe[qe.ExtraData=21]="ExtraData",qe))();const Vl="en-US";let cC=Vl;function sm(t,n,e,i,r){if(t=ut(t),Array.isArray(t))for(let o=0;o<t.length;o++)sm(t[o],n,e,i,r);else{const o=Jt(),s=De();let a=ma(t)?t:ut(t.provide),l=Cb(t);const c=mi(),u=1048575&c.providerIndexes,h=c.directiveStart,g=c.providerIndexes>>20;if(ma(t)||!t.multi){const E=new Gc(l,r,J),L=lm(a,n,r?u:u+g,h);-1===L?(Gp(Yd(c,s),o,a),am(o,t,n.length),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(E),s.push(E)):(e[L]=E,s[L]=E)}else{const E=lm(a,n,u+g,h),L=lm(a,n,u,u+g),re=L>=0&&e[L];if(r&&!re||!r&&!(E>=0&&e[E])){Gp(Yd(c,s),o,a);const oe=function a3(t,n,e,i,r){const o=new Gc(t,e,J);return o.multi=[],o.index=n,o.componentProviders=0,FC(o,r,i&&!e),o}(r?s3:o3,e.length,r,i,l);!r&&re&&(e[L].providerFactory=oe),am(o,t,n.length,0),n.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(oe),s.push(oe)}else am(o,t,E>-1?E:L,FC(e[r?L:E],l,!r&&i));!r&&i&&re&&e[L].componentProviders++}}}function am(t,n,e,i){const r=ma(n),o=function yI(t){return!!t.useClass}(n);if(r||o){const l=(o?ut(n.useClass):n).prototype.ngOnDestroy;if(l){const c=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const u=c.indexOf(e);-1===u?c.push(e,[i,l]):c[u+1].push(i,l)}else c.push(e,l)}}}function FC(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function lm(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function o3(t,n,e,i){return cm(this.multi,[])}function s3(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=ha(e,e[Qe],this.providerFactory.index,i);o=a.slice(0,s),cm(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],cm(r,o);return o}function cm(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function En(t,n=[]){return e=>{e.providersResolver=(i,r)=>function r3(t,n,e){const i=Jt();if(i.firstCreatePass){const r=ao(t);sm(e,i.data,i.blueprint,r,!0),sm(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class jl{}class l3{}class NC extends jl{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new t1(this);const i=function pr(t,n){const e=t[xv]||null;if(!e&&!0===n)throw new Error(`Type ${sn(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function cs(t){return t instanceof Function?t():t}(i.bootstrap),this._r3Injector=Nb(n,e,[{provide:jl,useValue:this},{provide:dh,useValue:this.componentFactoryResolver}],sn(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class um extends l3{constructor(n){super(),this.moduleType=n}create(n){return new NC(this.moduleType,n)}}function Ca(t,n,e){const i=Hi()+t,r=De();return r[i]===Ot?ko(r,i,e?n.call(e):n()):function au(t,n){return t[n]}(r,i)}function dt(t,n,e,i){return function HC(t,n,e,i,r,o){const s=n+e;return Ii(t,s,r)?ko(t,s+1,o?i.call(o,r):i(r)):pu(t,s+1)}(De(),Hi(),t,n,e,i)}function _i(t,n,e,i,r){return GC(De(),Hi(),t,n,e,i,r)}function Oh(t,n,e,i,r,o){return function $C(t,n,e,i,r,o,s,a){const l=n+e;return function wh(t,n,e,i,r){const o=va(t,n,e,i);return Ii(t,n+2,r)||o}(t,l,r,o,s)?ko(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):pu(t,l+3)}(De(),Hi(),t,n,e,i,r,o)}function pu(t,n){const e=t[n];return e===Ot?void 0:e}function GC(t,n,e,i,r,o,s){const a=n+e;return va(t,a,r,o)?ko(t,a+2,s?i.call(s,r,o):i(r,o)):pu(t,a+2)}function Zt(t,n){const e=Jt();let i;const r=t+Cn;e.firstCreatePass?(i=function D3(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=ua(i.type)),s=Fr(J);try{const a=Zd(!1),l=o();return Zd(a),function _A(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,De(),r,l),l}finally{Fr(s)}}function Yt(t,n,e,i){const r=t+Cn,o=De(),s=ul(o,r);return function gu(t,n){return t[Qe].data[n].pure}(o,r)?GC(o,Hi(),n,s.transform,e,i,s):s.transform(e,i)}function hm(t){return n=>{setTimeout(t,void 0,n)}}const Ht=class A3 extends Ue{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const l=n;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=hm(o),r&&(r=hm(r)),s&&(s=hm(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof p&&n.add(a),a}};function P3(){return this._results[Symbol.iterator]()}class fm{get changes(){return this._changes||(this._changes=new Ht)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=fm.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=P3)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=function Rr(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function jk(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ds=(()=>{class t{}return t.__NG_ELEMENT_ID__=R3,t})();const F3=ds,N3=class extends F3{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n,e){const i=this._declarationTContainer.tView,r=ph(this._declarationLView,i,n,16,null,i.declTNode,null,null,null,null,e||null);r[Uc]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[Eo];return null!==s&&(r[Eo]=s.createEmbeddedView(i)),Lg(i,r,n),new ou(r)}};function R3(){return Ah(mi(),De())}function Ah(t,n){return 4&t.type?new N3(n,t,Tl(t,n)):null}let sr=(()=>{class t{}return t.__NG_ELEMENT_ID__=L3,t})();function L3(){return KC(mi(),De())}const B3=sr,YC=class extends B3{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Tl(this._hostTNode,this._hostLView)}get injector(){return new fl(this._hostTNode,this._hostLView)}get parentInjector(){const n=Hp(this._hostTNode,this._hostLView);if(oy(n)){const e=Wd(n,this._hostLView),i=$d(n);return new fl(e[Qe].data[i+8],e)}return new fl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=qC(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-ji}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=n.createEmbeddedView(e||{},o);return this.insert(s,r),s}createComponent(n,e,i,r,o){const s=n&&!function Zc(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const h=e||{};a=h.index,i=h.injector,r=h.projectableNodes,o=h.environmentInjector||h.ngModuleRef}const l=s?n:new su(cn(n)),c=i||this.parentInjector;if(!o&&null==l.ngModule){const g=(s?c:this.parentInjector).get(wl,null);g&&(o=g)}const u=l.create(c,r,void 0,o);return this.insert(u.hostView,a),u}insert(n,e){const i=n._lView,r=i[Qe];if(function dk(t){return so(t[Rn])}(i)){const u=this.indexOf(n);if(-1!==u)this.detach(u);else{const h=i[Rn],g=new YC(h,h[Si],h[Rn]);g.detach(g.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;!function I2(t,n,e,i){const r=ji+i,o=e.length;i>0&&(e[r-1][oo]=n),i<o-ji?(n[oo]=e[r],_y(e,ji+i,n)):(e.push(n),n[oo]=null),n[Rn]=e;const s=n[Uc];null!==s&&e!==s&&function O2(t,n){const e=t[cl];n[Di]!==n[Rn][Rn][Di]&&(t[Av]=!0),null===e?t[cl]=[n]:e.push(n)}(s,n);const a=n[Eo];null!==a&&a.insertView(t),n[Ft]|=64}(r,i,s,o);const a=fg(o,s),l=i[Lt],c=nh(l,s[Ld]);return null!==c&&function D2(t,n,e,i,r,o){i[os]=r,i[Si]=n,Jc(t,i,e,1,r,o)}(r,s[Si],l,i,c,a),n.attachToViewContainerRef(),_y(pm(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=qC(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=ug(this._lContainer,e);i&&(Kd(pm(this._lContainer),e),Vy(i[Qe],i))}detach(n){const e=this._adjustIndex(n,-1),i=ug(this._lContainer,e);return i&&null!=Kd(pm(this._lContainer),e)?new ou(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function qC(t){return t[Bd]}function pm(t){return t[Bd]||(t[Bd]=[])}function KC(t,n){let e;const i=n[t.index];if(so(i))e=i;else{let r;if(8&t.type)r=gi(i);else{const o=n[Lt];r=o.createComment("");const s=mr(t,n);pa(o,nh(o,s),r,function N2(t,n){return t.nextSibling(n)}(o,s),!1)}n[t.index]=e=Kb(i,n,r,t),mh(n,e)}return new YC(e,t,n)}class gm{constructor(n){this.queryList=n,this.matches=null}clone(){return new gm(this.queryList)}setDirty(){this.queryList.setDirty()}}class mm{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new mm(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==tw(n,e).matches&&this.queries[e].setDirty()}}class XC{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class _m{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new _m(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class vm{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new vm(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,z3(e,o)),this.matchTNodeWithReadOption(n,e,qd(e,n,o,!1,!1))}else i===ds?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,qd(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Ln||r===sr||r===ds&&4&e.type)this.addMatch(e.index,-2);else{const o=qd(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function z3(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function V3(t,n,e,i){return-1===e?function U3(t,n){return 11&t.type?Tl(t,n):4&t.type?Ah(t,n):null}(n,t):-2===e?function j3(t,n,e){return e===Ln?Tl(n,t):e===ds?Ah(n,t):e===sr?KC(n,t):void 0}(t,n,i):ha(t,t[Qe],e,n)}function QC(t,n,e,i){const r=n[Eo].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let l=0;l<s.length;l+=2){const c=s[l];a.push(c<0?null:V3(n,o[c],s[l+1],e.metadata.read))}r.matches=a}return r.matches}function ym(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=QC(t,n,r,e);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const c=o[a+1],u=n[-l];for(let h=ji;h<u.length;h++){const g=u[h];g[Uc]===g[Rn]&&ym(g[Qe],g,c,i)}if(null!==u[cl]){const h=u[cl];for(let g=0;g<h.length;g++){const E=h[g];ym(E[Qe],E,c,i)}}}}}return i}function In(t){const n=De(),e=Jt(),i=Yv();Np(i+1);const r=tw(e,i);if(t.dirty&&function uk(t){return 4==(4&t[Ft])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?ym(e,n,i,[]):QC(e,n,r,i);t.reset(o,II),t.notifyOnChanges()}return!0}return!1}function On(t,n,e){const i=Jt();i.firstCreatePass&&(function ew(t,n,e){null===t.queries&&(t.queries=new _m),t.queries.track(new vm(n,e))}(i,new XC(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function JC(t,n,e){const i=new fm(4==(4&e));$b(t,n,i,i.destroy),null===n[Eo]&&(n[Eo]=new mm),n[Eo].queries.push(new gm(i))}(i,De(),n)}function An(){return function G3(t,n){return t[Eo].queries[n].queryList}(De(),Yv())}function tw(t,n){return t.queries.getByIndex(n)}function zn(t,n){return Ah(t,n)}function Fh(...t){}const bw=new St("Application Initializer");let Nh=(()=>{class t{constructor(e){this.appInits=e,this.resolve=Fh,this.reject=Fh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(Eh(o))e.push(o);else if(_1(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(bt(bw,8))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const _u=new St("AppId",{providedIn:"root",factory:function Cw(){return`${Tm()}${Tm()}${Tm()}`}});function Tm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ww=new St("Platform Initializer"),Ew=new St("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Tw=new St("AnimationModuleType"),hs=new St("LocaleId",{providedIn:"root",factory:()=>Tv(hs,xt.Optional|xt.SkipSelf)||function dF(){return typeof $localize<"u"&&$localize.locale||Vl}()}),mF=(()=>Promise.resolve(0))();function xm(t){typeof Zone>"u"?mF.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Gt{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ht(!1),this.onMicrotaskEmpty=new Ht(!1),this.onStable=new Ht(!1),this.onError=new Ht(!1),typeof Zone>"u")throw new Se(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function _F(){let t=bn.requestAnimationFrame,n=bn.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function bF(t){const n=()=>{!function yF(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(bn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Dm(t),t.isCheckStableRunning=!0,Sm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Dm(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return Dw(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),Mw(t)}},onInvoke:(e,i,r,o,s,a,l)=>{try{return Dw(t),e.invoke(r,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),Mw(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,Dm(t),Sm(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gt.isInAngularZone())throw new Se(909,!1)}static assertNotInAngularZone(){if(Gt.isInAngularZone())throw new Se(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,vF,Fh,Fh);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const vF={};function Sm(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Dm(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Dw(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Mw(t){t._nesting--,Sm(t)}class CF{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ht,this.onMicrotaskEmpty=new Ht,this.onStable=new Ht,this.onError=new Ht}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}const kw=new St(""),Rh=new St("");let Im,Mm=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Im||(function wF(t){Im=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gt.assertNotInAngularZone(),xm(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())xm(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt),bt(km),bt(Rh))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),km=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return Im?.findTestabilityInTree(this,e,i)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();const fs=!1;let Ns=null;const Iw=new St("AllowMultipleToken"),Om=new St("PlatformDestroyListeners"),EF=new St("appBootstrapListener");function Aw(t,n,e=[]){const i=`Platform: ${n}`,r=new St(i);return(o=[])=>{let s=Am();if(!s||s.injector.get(Iw,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function SF(t){if(Ns&&!Ns.get(Iw,!1))throw new Se(400,!1);Ns=t;const n=t.get(Fw);(function Ow(t){const n=t.get(ww,null);n&&n.forEach(e=>e())})(t)}(function Pw(t=[],n){return Do.create({name:n,providers:[{provide:xg,useValue:"platform"},{provide:Om,useValue:new Set([()=>Ns=null])},...t]})}(a,i))}return function MF(t){const n=Am();if(!n)throw new Se(401,!1);return n}()}}function Am(){return Ns?.get(Fw)??null}let Fw=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function Rw(t,n){let e;return e="noop"===t?new CF:("zone.js"===t?void 0:t)||new Gt(n),e}(i?.ngZone,function Nw(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(i)),o=[{provide:Gt,useValue:r}];return r.run(()=>{const s=Do.create({providers:o,parent:this.injector,name:e.moduleType.name}),a=e.create(s),l=a.injector.get(xl,null);if(!l)throw new Se(402,!1);return r.runOutsideAngular(()=>{const c=r.onError.subscribe({next:u=>{l.handleError(u)}});a.onDestroy(()=>{Bh(this._modules,a),c.unsubscribe()})}),function Lw(t,n,e){try{const i=e();return Eh(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(l,r,()=>{const c=a.injector.get(Nh);return c.runInitializers(),c.donePromise.then(()=>(function uC(t){Pr(t,"Expected localeId to be defined"),"string"==typeof t&&(cC=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(hs,Vl)||Vl),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,i=[]){const r=Bw({},i);return function TF(t,n,e){const i=new um(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Lh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Se(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Se(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(Om,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(bt(Do))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function Bw(t,n){return Array.isArray(n)?n.reduce(Bw,t):{...t,...n}}let Lh=(()=>{class t{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,i,r){this._zone=e,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new xe(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new xe(a=>{let l;this._zone.runOutsideAngular(()=>{l=this._zone.onStable.subscribe(()=>{Gt.assertNotInAngularZone(),xm(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const c=this._zone.onUnstable.subscribe(()=>{Gt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{l.unsubscribe(),c.unsubscribe()}});this.isStable=Dd(o,s.pipe(function Md(t={}){const{connector:n=(()=>new Ue),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return o=>{let s,a,l,c=0,u=!1,h=!1;const g=()=>{a?.unsubscribe(),a=void 0},E=()=>{g(),s=l=void 0,u=h=!1},L=()=>{const Z=s;E(),Z?.unsubscribe()};return Ie((Z,re)=>{c++,!h&&!u&&g();const oe=l=l??n();re.add(()=>{c--,0===c&&!h&&!u&&(a=Is(L,r))}),oe.subscribe(re),!s&&c>0&&(s=new Ce({next:ce=>oe.next(ce),error:ce=>{h=!0,g(),a=Is(E,e,ce),oe.error(ce)},complete:()=>{u=!0,g(),a=Is(E,i),oe.complete()}}),eo(Z).subscribe(s))})(o)}}()))}bootstrap(e,i){const r=e instanceof wb;if(!this._injector.get(Nh).done){!r&&function Bc(t){const n=cn(t)||xi(t)||nr(t);return null!==n&&n.standalone}(e);throw new Se(405,fs)}let s;s=r?e:this._injector.get(dh).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function xF(t){return t.isBoundToModule}(s)?void 0:this._injector.get(jl),c=s.create(Do.NULL,[],i||s.selector,a),u=c.location.nativeElement,h=c.injector.get(kw,null);return h?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),Bh(this.components,c),h?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new Se(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Bh(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(EF,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Bh(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Se(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt),bt(wl),bt(xl))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Bh(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let Oi=(()=>{class t{}return t.__NG_ELEMENT_ID__=IF,t})();function IF(t){return function OF(t,n,e){if(jc(t)&&!e){const i=ir(t.index,n);return new ou(i,i)}return 47&t.type?new ou(n[Di],n):null}(mi(),De(),16==(16&t))}class Hw{constructor(){}supports(n){return Ch(n)}create(n){return new LF(n)}}const RF=(t,n)=>n;class LF{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||RF}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<$w(i,r,o)?e:i,a=$w(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const c=a-r,u=l-r;if(c!=u){for(let g=0;g<c;g++){const E=g<o.length?o[g]:o[g]=0,L=E+g;u<=L&&L<c&&(o[g]=E+1)}o[s.previousIndex]=u-c}}a!==l&&n(s,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Ch(n))throw new Se(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function fA(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new BF(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new Gw),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Gw),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class BF{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class zF{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class Gw{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new zF,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $w(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class Ww{constructor(){}supports(n){return n instanceof Map||qg(n)}create(){return new UF}}class UF{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||qg(n)))throw new Se(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new VF(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class VF{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Zw(){return new Vh([new Hw])}let Vh=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||Zw()),deps:[[t,new Jd,new Qd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new Se(901,!1)}}return t.\u0275prov=Mt({token:t,providedIn:"root",factory:Zw}),t})();function Yw(){return new vu([new Ww])}let vu=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||Yw()),deps:[[t,new Jd,new Qd]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new Se(901,!1)}}return t.\u0275prov=Mt({token:t,providedIn:"root",factory:Yw}),t})();const GF=Aw(null,"core",[]);let $F=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(bt(Lh))},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({}),t})();function Lm(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let Bm=null;function $l(){return Bm}class YF{}const Cr=new St("DocumentToken");var Gn=(()=>((Gn=Gn||{})[Gn.Format=0]="Format",Gn[Gn.Standalone=1]="Standalone",Gn))(),$t=(()=>(($t=$t||{})[$t.Narrow=0]="Narrow",$t[$t.Abbreviated=1]="Abbreviated",$t[$t.Wide=2]="Wide",$t[$t.Short=3]="Short",$t))(),Pn=(()=>((Pn=Pn||{})[Pn.Short=0]="Short",Pn[Pn.Medium=1]="Medium",Pn[Pn.Long=2]="Long",Pn[Pn.Full=3]="Full",Pn))(),mt=(()=>((mt=mt||{})[mt.Decimal=0]="Decimal",mt[mt.Group=1]="Group",mt[mt.List=2]="List",mt[mt.PercentSign=3]="PercentSign",mt[mt.PlusSign=4]="PlusSign",mt[mt.MinusSign=5]="MinusSign",mt[mt.Exponential=6]="Exponential",mt[mt.SuperscriptingExponent=7]="SuperscriptingExponent",mt[mt.PerMille=8]="PerMille",mt[mt.Infinity=9]="Infinity",mt[mt.NaN=10]="NaN",mt[mt.TimeSeparator=11]="TimeSeparator",mt[mt.CurrencyDecimal=12]="CurrencyDecimal",mt[mt.CurrencyGroup=13]="CurrencyGroup",mt))();function jh(t,n){return Ur($i(t)[qe.DateFormat],n)}function Hh(t,n){return Ur($i(t)[qe.TimeFormat],n)}function Gh(t,n){return Ur($i(t)[qe.DateTimeFormat],n)}function zr(t,n){const e=$i(t),i=e[qe.NumberSymbols][n];if(typeof i>"u"){if(n===mt.CurrencyDecimal)return e[qe.NumberSymbols][mt.Decimal];if(n===mt.CurrencyGroup)return e[qe.NumberSymbols][mt.Group]}return i}function Xw(t){if(!t[qe.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[qe.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ur(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function Um(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const cN=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,yu={},uN=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var si=(()=>((si=si||{})[si.Short=0]="Short",si[si.ShortGMT=1]="ShortGMT",si[si.Long=2]="Long",si[si.Extended=3]="Extended",si))(),yt=(()=>((yt=yt||{})[yt.FullYear=0]="FullYear",yt[yt.Month=1]="Month",yt[yt.Date=2]="Date",yt[yt.Hours=3]="Hours",yt[yt.Minutes=4]="Minutes",yt[yt.Seconds=5]="Seconds",yt[yt.FractionalSeconds=6]="FractionalSeconds",yt[yt.Day=7]="Day",yt))(),Nt=(()=>((Nt=Nt||{})[Nt.DayPeriods=0]="DayPeriods",Nt[Nt.Days=1]="Days",Nt[Nt.Months=2]="Months",Nt[Nt.Eras=3]="Eras",Nt))();function dN(t,n,e,i){let r=function bN(t){if(eE(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return $h(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(cN))return function CN(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,l,c),n}(i)}const n=new Date(t);if(!eE(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=ps(e,n)||n;let a,s=[];for(;n;){if(a=uN.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const u=s.pop();if(!u)break;n=u}}let l=r.getTimezoneOffset();i&&(l=Jw(i,l),r=function yN(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function vN(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(Jw(n,r)-r))}(r,i,!0));let c="";return s.forEach(u=>{const h=function _N(t){if(jm[t])return jm[t];let n;switch(t){case"G":case"GG":case"GGG":n=yn(Nt.Eras,$t.Abbreviated);break;case"GGGG":n=yn(Nt.Eras,$t.Wide);break;case"GGGGG":n=yn(Nt.Eras,$t.Narrow);break;case"y":n=Qn(yt.FullYear,1,0,!1,!0);break;case"yy":n=Qn(yt.FullYear,2,0,!0,!0);break;case"yyy":n=Qn(yt.FullYear,3,0,!1,!0);break;case"yyyy":n=Qn(yt.FullYear,4,0,!1,!0);break;case"Y":n=qh(1);break;case"YY":n=qh(2,!0);break;case"YYY":n=qh(3);break;case"YYYY":n=qh(4);break;case"M":case"L":n=Qn(yt.Month,1,1);break;case"MM":case"LL":n=Qn(yt.Month,2,1);break;case"MMM":n=yn(Nt.Months,$t.Abbreviated);break;case"MMMM":n=yn(Nt.Months,$t.Wide);break;case"MMMMM":n=yn(Nt.Months,$t.Narrow);break;case"LLL":n=yn(Nt.Months,$t.Abbreviated,Gn.Standalone);break;case"LLLL":n=yn(Nt.Months,$t.Wide,Gn.Standalone);break;case"LLLLL":n=yn(Nt.Months,$t.Narrow,Gn.Standalone);break;case"w":n=Vm(1);break;case"ww":n=Vm(2);break;case"W":n=Vm(1,!0);break;case"d":n=Qn(yt.Date,1);break;case"dd":n=Qn(yt.Date,2);break;case"c":case"cc":n=Qn(yt.Day,1);break;case"ccc":n=yn(Nt.Days,$t.Abbreviated,Gn.Standalone);break;case"cccc":n=yn(Nt.Days,$t.Wide,Gn.Standalone);break;case"ccccc":n=yn(Nt.Days,$t.Narrow,Gn.Standalone);break;case"cccccc":n=yn(Nt.Days,$t.Short,Gn.Standalone);break;case"E":case"EE":case"EEE":n=yn(Nt.Days,$t.Abbreviated);break;case"EEEE":n=yn(Nt.Days,$t.Wide);break;case"EEEEE":n=yn(Nt.Days,$t.Narrow);break;case"EEEEEE":n=yn(Nt.Days,$t.Short);break;case"a":case"aa":case"aaa":n=yn(Nt.DayPeriods,$t.Abbreviated);break;case"aaaa":n=yn(Nt.DayPeriods,$t.Wide);break;case"aaaaa":n=yn(Nt.DayPeriods,$t.Narrow);break;case"b":case"bb":case"bbb":n=yn(Nt.DayPeriods,$t.Abbreviated,Gn.Standalone,!0);break;case"bbbb":n=yn(Nt.DayPeriods,$t.Wide,Gn.Standalone,!0);break;case"bbbbb":n=yn(Nt.DayPeriods,$t.Narrow,Gn.Standalone,!0);break;case"B":case"BB":case"BBB":n=yn(Nt.DayPeriods,$t.Abbreviated,Gn.Format,!0);break;case"BBBB":n=yn(Nt.DayPeriods,$t.Wide,Gn.Format,!0);break;case"BBBBB":n=yn(Nt.DayPeriods,$t.Narrow,Gn.Format,!0);break;case"h":n=Qn(yt.Hours,1,-12);break;case"hh":n=Qn(yt.Hours,2,-12);break;case"H":n=Qn(yt.Hours,1);break;case"HH":n=Qn(yt.Hours,2);break;case"m":n=Qn(yt.Minutes,1);break;case"mm":n=Qn(yt.Minutes,2);break;case"s":n=Qn(yt.Seconds,1);break;case"ss":n=Qn(yt.Seconds,2);break;case"S":n=Qn(yt.FractionalSeconds,1);break;case"SS":n=Qn(yt.FractionalSeconds,2);break;case"SSS":n=Qn(yt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=Zh(si.Short);break;case"ZZZZZ":n=Zh(si.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=Zh(si.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=Zh(si.Long);break;default:return null}return jm[t]=n,n}(u);c+=h?h(r,e,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function $h(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function ps(t,n){const e=function XF(t){return $i(t)[qe.LocaleId]}(t);if(yu[e]=yu[e]||{},yu[e][n])return yu[e][n];let i="";switch(n){case"shortDate":i=jh(t,Pn.Short);break;case"mediumDate":i=jh(t,Pn.Medium);break;case"longDate":i=jh(t,Pn.Long);break;case"fullDate":i=jh(t,Pn.Full);break;case"shortTime":i=Hh(t,Pn.Short);break;case"mediumTime":i=Hh(t,Pn.Medium);break;case"longTime":i=Hh(t,Pn.Long);break;case"fullTime":i=Hh(t,Pn.Full);break;case"short":const r=ps(t,"shortTime"),o=ps(t,"shortDate");i=Wh(Gh(t,Pn.Short),[r,o]);break;case"medium":const s=ps(t,"mediumTime"),a=ps(t,"mediumDate");i=Wh(Gh(t,Pn.Medium),[s,a]);break;case"long":const l=ps(t,"longTime"),c=ps(t,"longDate");i=Wh(Gh(t,Pn.Long),[l,c]);break;case"full":const u=ps(t,"fullTime"),h=ps(t,"fullDate");i=Wh(Gh(t,Pn.Full),[u,h])}return i&&(yu[e][n]=i),i}function Wh(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function fo(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function Qn(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function fN(t,n){switch(t){case yt.FullYear:return n.getFullYear();case yt.Month:return n.getMonth();case yt.Date:return n.getDate();case yt.Hours:return n.getHours();case yt.Minutes:return n.getMinutes();case yt.Seconds:return n.getSeconds();case yt.FractionalSeconds:return n.getMilliseconds();case yt.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===yt.Hours)0===a&&-12===e&&(a=12);else if(t===yt.FractionalSeconds)return function hN(t,n){return fo(t,3).substring(0,n)}(a,n);const l=zr(s,mt.MinusSign);return fo(a,n,l,i,r)}}function yn(t,n,e=Gn.Format,i=!1){return function(r,o){return function pN(t,n,e,i,r,o){switch(e){case Nt.Months:return function eN(t,n,e){const i=$i(t),o=Ur([i[qe.MonthsFormat],i[qe.MonthsStandalone]],n);return Ur(o,e)}(n,r,i)[t.getMonth()];case Nt.Days:return function JF(t,n,e){const i=$i(t),o=Ur([i[qe.DaysFormat],i[qe.DaysStandalone]],n);return Ur(o,e)}(n,r,i)[t.getDay()];case Nt.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const c=function rN(t){const n=$i(t);return Xw(n),(n[qe.ExtraData][2]||[]).map(i=>"string"==typeof i?Um(i):[Um(i[0]),Um(i[1])])}(n),u=function oN(t,n,e){const i=$i(t);Xw(i);const o=Ur([i[qe.ExtraData][0],i[qe.ExtraData][1]],n)||[];return Ur(o,e)||[]}(n,r,i),h=c.findIndex(g=>{if(Array.isArray(g)){const[E,L]=g,Z=s>=E.hours&&a>=E.minutes,re=s<L.hours||s===L.hours&&a<L.minutes;if(E.hours<L.hours){if(Z&&re)return!0}else if(Z||re)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(-1!==h)return u[h]}return function QF(t,n,e){const i=$i(t),o=Ur([i[qe.DayPeriodsFormat],i[qe.DayPeriodsStandalone]],n);return Ur(o,e)}(n,r,i)[s<12?0:1];case Nt.Eras:return function tN(t,n){return Ur($i(t)[qe.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function Zh(t){return function(n,e,i){const r=-1*i,o=zr(e,mt.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case si.Short:return(r>=0?"+":"")+fo(s,2,o)+fo(Math.abs(r%60),2,o);case si.ShortGMT:return"GMT"+(r>=0?"+":"")+fo(s,1,o);case si.Long:return"GMT"+(r>=0?"+":"")+fo(s,2,o)+":"+fo(Math.abs(r%60),2,o);case si.Extended:return 0===i?"Z":(r>=0?"+":"")+fo(s,2,o)+":"+fo(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const gN=0,Yh=4;function Qw(t){return $h(t.getFullYear(),t.getMonth(),t.getDate()+(Yh-t.getDay()))}function Vm(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=Qw(e),s=function mN(t){const n=$h(t,gN,1).getDay();return $h(t,0,1+(n<=Yh?Yh:Yh+7)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return fo(r,t,zr(i,mt.MinusSign))}}function qh(t,n=!1){return function(e,i){return fo(Qw(e).getFullYear(),t,zr(i,mt.MinusSign),n)}}const jm={};function Jw(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function eE(t){return t instanceof Date&&!isNaN(t.valueOf())}const Ym=/\s+/,rE=[];let ai=(()=>{class t{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this.initialClasses=rE,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(Ym):rE}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(Ym):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,Boolean(e[i]));this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(Ym).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(J(Vh),J(vu),J(Ln),J(_a))},t.\u0275dir=vt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class NN{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Un=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new NN(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),aE(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{aE(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(J(sr),J(ds),J(Vh))},t.\u0275dir=vt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function aE(t,n){t.context.$implicit=n.item}let fn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new LN,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){lE("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){lE("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(J(sr),J(ds))},t.\u0275dir=vt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class LN{constructor(){this.$implicit=null,this.ngIf=null}}function lE(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${sn(n)}'.`)}class qm{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Ea=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),Cu=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new qm(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(J(sr),J(ds),J(Ea,9))},t.\u0275dir=vt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})(),wu=(()=>{class t{constructor(e,i,r){r._addDefault(new qm(e,i))}}return t.\u0275fac=function(e){return new(e||t)(J(sr),J(ds),J(Ea,9))},t.\u0275dir=vt({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0}),t})(),Ta=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:rr.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(J(Ln),J(vu),J(_a))},t.\u0275dir=vt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),Eu=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:o,ngTemplateOutletInjector:s}=this;this._viewRef=i.createEmbeddedView(r,o,s?{injector:s}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(J(sr))},t.\u0275dir=vt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Mn]}),t})();const qN=new St("DATE_PIPE_DEFAULT_TIMEZONE"),KN=new St("DATE_PIPE_DEFAULT_OPTIONS");let uE=(()=>{class t{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return dN(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw function po(t,n){return new Se(2100,!1)}()}}}return t.\u0275fac=function(e){return new(e||t)(J(hs,16),J(qN,24),J(KN,24))},t.\u0275pipe=Vi({name:"date",type:t,pure:!0,standalone:!0}),t})(),hE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({}),t})();class LR extends YF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class e_ extends LR{static makeCurrent(){!function ZF(t){Bm||(Bm=t)}(new e_)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function BR(){return xu=xu||document.querySelector("base"),xu?xu.getAttribute("href"):null}();return null==e?null:function zR(t){Jh=Jh||document.createElement("a"),Jh.setAttribute("href",t);const n=Jh.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){xu=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function PN(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let Jh,xu=null;const yE=new St("TRANSITION_ID"),VR=[{provide:bw,useFactory:function UR(t,n,e){return()=>{e.get(Nh).donePromise.then(()=>{const i=$l(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[yE,Cr,Do],multi:!0}];let HR=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();const ef=new St("EventManagerPlugins");let tf=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(bt(ef),bt(Gt))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class bE{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=$l().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let CE=(()=>{class t{constructor(){this.usageCount=new Map}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,i){const r=this.usageCount;let o=r.get(e)??0;return o+=i,o>0?r.set(e,o):r.delete(e),o}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),Su=(()=>{class t extends CE{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.forEach(o=>o.remove()),i.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,i){const r=this.doc.createElement("style");r.textContent=i,e.appendChild(r);const o=this.styleRef.get(i);o?o.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return t.\u0275fac=function(e){return new(e||t)(bt(Cr))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();const t_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},n_=/%COMP%/g,TE=new St("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function xE(t,n){return n.flat(100).map(e=>e.replace(n_,t))}function SE(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let nf=(()=>{class t{constructor(e,i,r,o){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=o,this.rendererByCompId=new Map,this.defaultRenderer=new i_(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(e,i);return r instanceof kE?r.applyToHost(e):r instanceof r_&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.eventManager,a=this.sharedStylesHost,l=this.removeStylesOnCompDestory;switch(i.encapsulation){case ro.Emulated:o=new kE(s,a,i,this.appId,l);break;case ro.ShadowDom:return new KR(s,a,e,i);default:o=new r_(s,a,i,l)}o.onDestroy=()=>r.delete(i.id),r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(bt(tf),bt(Su),bt(_u),bt(TE))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class i_{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(t_[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(ME(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(ME(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=t_[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=t_[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(rr.DashCase|rr.Important)?n.style.setProperty(e,i,r&rr.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&rr.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,SE(i)):this.eventManager.addEventListener(n,e,SE(i))}}function ME(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class KR extends i_{constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=xE(r.id,r.styles);for(const s of o){const a=document.createElement("style");a.textContent=s,this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class r_ extends i_{constructor(n,e,i,r,o=i.id){super(n),this.sharedStylesHost=e,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=xE(o,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class kE extends r_{constructor(n,e,i,r,o){const s=r+"-"+i.id;super(n,e,i,o,s),this.contentAttr=function ZR(t){return"_ngcontent-%COMP%".replace(n_,t)}(s),this.hostAttr=function YR(t){return"_nghost-%COMP%".replace(n_,t)}(s)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let XR=(()=>{class t extends bE{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(bt(Cr))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();const IE=["alt","control","meta","shift"],QR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},JR={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let eL=(()=>{class t extends bE{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$l().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),IE.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),s+=c+".")}),s+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(e,i){let r=QR[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),IE.forEach(s=>{s!==r&&(0,JR[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(bt(Cr))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();const AE=[{provide:Ew,useValue:"browser"},{provide:ww,useValue:function tL(){e_.makeCurrent()},multi:!0},{provide:Cr,useFactory:function iL(){return function H2(t){_g=t}(document),document},deps:[]}],rL=Aw(GF,"browser",AE),PE=new St(""),FE=[{provide:Rh,useClass:class jR{addToWindow(n){bn.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},bn.getAllAngularTestabilities=()=>n.getAllTestabilities(),bn.getAllAngularRootElements=()=>n.getAllRootElements(),bn.frameworkStabilizers||(bn.frameworkStabilizers=[]),bn.frameworkStabilizers.push(i=>{const r=bn.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(l){s=s||l,o--,0==o&&i(s)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?$l().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:kw,useClass:Mm,deps:[Gt,km,Rh]},{provide:Mm,useClass:Mm,deps:[Gt,km,Rh]}],NE=[{provide:xg,useValue:"root"},{provide:xl,useFactory:function nL(){return new xl},deps:[]},{provide:ef,useClass:XR,multi:!0,deps:[Cr,Gt,Ew]},{provide:ef,useClass:eL,multi:!0,deps:[Cr]},{provide:nf,useClass:nf,deps:[tf,Su,_u,TE]},{provide:nu,useExisting:nf},{provide:CE,useExisting:Su},{provide:Su,useClass:Su,deps:[Cr]},{provide:tf,useClass:tf,deps:[ef,Gt]},{provide:class uR{},useClass:HR,deps:[]},[]];let RE=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:_u,useValue:e.appId},{provide:yE,useExisting:_u},VR]}}}return t.\u0275fac=function(e){return new(e||t)(bt(PE,12))},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({providers:[...NE,...FE],imports:[hE,$F]}),t})();typeof window<"u"&&window;let zE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:function(e){let i=null;return i=e?new(e||t):bt(UE),i},providedIn:"root"}),t})(),UE=(()=>{class t extends zE{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case _n.NONE:return i;case _n.HTML:return So(i,"HTML")?vr(i):ub(this._doc,String(i)).toString();case _n.STYLE:return So(i,"Style")?vr(i):i;case _n.SCRIPT:if(So(i,"Script"))return vr(i);throw new Error("unsafe value used in a script context");case _n.URL:return So(i,"URL")?vr(i):ah(String(i));case _n.RESOURCE_URL:if(So(i,"ResourceURL"))return vr(i);throw new Error(`unsafe value used in a resource URL context (see ${As})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${As})`)}}bypassSecurityTrustHtml(e){return function K2(t){return new G2(t)}(e)}bypassSecurityTrustStyle(e){return function X2(t){return new $2(t)}(e)}bypassSecurityTrustScript(e){return function Q2(t){return new W2(t)}(e)}bypassSecurityTrustUrl(e){return function J2(t){return new Z2(t)}(e)}bypassSecurityTrustResourceUrl(e){return function eI(t){return new Y2(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(bt(Cr))},t.\u0275prov=Mt({token:t,factory:function(e){let i=null;return i=e?new e:function dL(t){return new UE(t.get(Cr))}(bt(Do)),i},providedIn:"root"}),t})();Y(5386);const{isArray:hL}=Array,{getPrototypeOf:fL,prototype:pL,keys:gL}=Object;const{isArray:vL}=Array;function CL(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function wL(...t){const n=function sa(t){return I(es(t))?t.pop():void 0}(t),{args:e,keys:i}=function mL(t){if(1===t.length){const n=t[0];if(hL(n))return{args:n,keys:null};if(function _L(t){return t&&"object"==typeof t&&fL(t)===pL}(n)){const e=gL(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new xe(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let l=s,c=s;for(let u=0;u<s;u++){let h=!1;eo(e[u]).subscribe(Fe(o,g=>{h||(h=!0,c--),a[u]=g},()=>l--,void 0,()=>{(!l||!h)&&(c||o.next(i?CL(i,a):a),o.complete())}))}});return n?r.pipe(function bL(t){return nt(n=>function yL(t,n){return vL(n)?t(...n):t(n)}(t,n))}(n)):r}let VE=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Ln))},t.\u0275dir=vt({type:t}),t})(),xa=(()=>{class t extends VE{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,features:[hn]}),t})();const Oo=new St("NgValueAccessor"),EL={provide:Oo,useExisting:an(()=>a_),multi:!0};let a_=(()=>{class t extends xa{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&ge("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[En([EL]),hn]}),t})();const TL={provide:Oo,useExisting:an(()=>Ai),multi:!0},SL=new St("CompositionEventMode");let Ai=(()=>{class t extends VE{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function xL(){const t=$l()?$l().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Ln),J(SL,8))},t.\u0275dir=vt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&ge("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[En([TL]),hn]}),t})();const DL=!1;function Ls(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function jE(t){return null!=t&&"number"==typeof t.length}const Pi=new St("NgValidators"),Bs=new St("NgAsyncValidators");function $E(t){return Ls(t.value)?{required:!0}:null}function rf(t){return null}function XE(t){return null!=t}function QE(t){const n=Eh(t)?Ar(t):t;if(DL&&!_1(n)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof t&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new Se(-1101,e)}return n}function JE(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function eT(t,n){return n.map(e=>e(t))}function tT(t){return t.map(n=>function kL(t){return!t.validate}(n)?n:e=>n.validate(e))}function l_(t){return null!=t?function nT(t){if(!t)return null;const n=t.filter(XE);return 0==n.length?null:function(e){return JE(eT(e,n))}}(tT(t)):null}function c_(t){return null!=t?function iT(t){if(!t)return null;const n=t.filter(XE);return 0==n.length?null:function(e){return wL(eT(e,n).map(QE)).pipe(nt(JE))}}(tT(t)):null}function rT(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function u_(t){return t?Array.isArray(t)?t:[t]:[]}function of(t,n){return Array.isArray(t)?t.includes(n):t===n}function aT(t,n){const e=u_(n);return u_(t).forEach(r=>{of(e,r)||e.push(r)}),e}function lT(t,n){return u_(n).filter(e=>!of(t,e))}class cT{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=l_(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=c_(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Zi extends cT{get formDirective(){return null}get path(){return null}}class zs extends cT{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class uT{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Yi=(()=>{class t extends uT{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(J(zs,2))},t.\u0275dir=vt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&xh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[hn]}),t})(),Wl=(()=>{class t extends uT{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(J(Zi,10))},t.\u0275dir=vt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&xh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[hn]}),t})();function dT(t,n){return t?`with name: '${n}'`:`at index: ${n}`}const f_=!1,Du="VALID",af="INVALID",Zl="PENDING",Mu="DISABLED";function p_(t){return(lf(t)?t.validators:t)||null}function g_(t,n){return(lf(n)?n.asyncValidators:t)||null}function lf(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class pT{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===Du}get invalid(){return this.status===af}get pending(){return this.status==Zl}get disabled(){return this.status===Mu}get enabled(){return this.status!==Mu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(aT(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(aT(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(lT(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(lT(n,this._rawAsyncValidators))}hasValidator(n){return of(this._rawValidators,n)}hasAsyncValidator(n){return of(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Zl,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Mu,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Du,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Du||this.status===Zl)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Mu:Du}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Zl,this._hasOwnPendingAsyncValidator=!0;const e=QE(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Ht,this.statusChanges=new Ht}_calculateStatus(){return this._allControlsDisabled()?Mu:this.errors?af:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Zl)?Zl:this._anyControlsHaveStatus(af)?af:Du}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){lf(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function RL(t){return Array.isArray(t)?l_(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function LL(t){return Array.isArray(t)?c_(t):t||null}(this._rawAsyncValidators)}}class m_ extends pT{constructor(n,e,i){super(p_(e),g_(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function fT(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new Se(1002,f_?function NL(t,n){return`Must supply a value for form control ${dT(t,n)}`}(n,r):"")})})(this,!0,n),Object.keys(n).forEach(i=>{(function hT(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new Se(1e3,f_?function PL(t){return`\n    There are no form controls registered with this ${t?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!i[e])throw new Se(1001,f_?function FL(t,n){return`Cannot find form control ${dT(t,n)}`}(n,e):"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const Yl=new St("CallSetDisabledState",{providedIn:"root",factory:()=>cf}),cf="always";function ku(t,n,e=cf){__(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function UL(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&gT(t,n)})}(t,n),function jL(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function VL(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&gT(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function zL(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function hf(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function __(t,n){const e=function oT(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(rT(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function sT(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(rT(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();hf(n._rawValidators,r),hf(n._rawAsyncValidators,r)}function gT(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const ZL={provide:Zi,useExisting:an(()=>Us)},Iu=(()=>Promise.resolve())();let Us=(()=>{class t extends Zi{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Ht,this.form=new m_({},l_(e),c_(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Iu.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),ku(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Iu.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Iu.then(()=>{const i=this._findContainer(e.path),r=new m_({});(function mT(t,n){__(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Iu.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){Iu.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function _T(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(J(Pi,10),J(Bs,10),J(Yl,8))},t.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&ge("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[En([ZL]),hn]}),t})();function vT(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function yT(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const bT=class extends pT{constructor(n=null,e,i){super(p_(e),g_(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),lf(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=yT(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){vT(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){vT(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){yT(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},KL={provide:zs,useExisting:an(()=>Fi)},ET=(()=>Promise.resolve())();let Fi=(()=>{class t extends zs{constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new bT,this._registered=!1,this.update=new Ht,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function b_(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===Ai?e=o:function $L(t){return Object.getPrototypeOf(t.constructor)===xa}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function y_(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ku(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){ET.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&Lm(i);ET.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function uf(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(J(Zi,9),J(Pi,10),J(Bs,10),J(Oo,10),J(Oi,8),J(Yl,8))},t.\u0275dir=vt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[En([KL]),hn,Mn]}),t})(),ql=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const XL={provide:Oo,useExisting:an(()=>Kl),multi:!0};let Kl=(()=>{class t extends xa{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&ge("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([XL]),hn]}),t})();const QL={provide:Oo,useExisting:an(()=>Ou),multi:!0};let TT=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({}),t})(),JL=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:TT}),t})(),Ou=(()=>{class t extends xa{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=Tv(Yl,{optional:!0})??cf}ngOnInit(){this._control=this._injector.get(zs),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(J(_a),J(Ln),J(JL),J(Do))},t.\u0275dir=vt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&ge("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[En([QL]),hn]}),t})();const e4={provide:Oo,useExisting:an(()=>Sa),multi:!0};let Sa=(()=>{class t extends xa{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&ge("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[En([e4]),hn]}),t})();const s4={provide:Oo,useExisting:an(()=>gs),multi:!0};function kT(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let gs=(()=>{class t extends xa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=kT(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function a4(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&ge("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([s4]),hn]}),t})(),Vs=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(kT(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(J(Ln),J(_a),J(gs,9))},t.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const l4={provide:Oo,useExisting:an(()=>T_),multi:!0};function IT(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let T_=(()=>{class t extends xa{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const c=this._getOptionValue(s[a].value);r.push(c)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const c=this._getOptionValue(l.value);r.push(c)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function c4(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&ge("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[En([l4]),hn]}),t})(),js=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(IT(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(IT(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(J(Ln),J(_a),J(T_,9))},t.\u0275dir=vt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function OT(t){return"number"==typeof t?t:parseInt(t,10)}function AT(t){return"number"==typeof t?t:parseFloat(t)}let Da=(()=>{class t{constructor(){this._validator=rf}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):rf,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=vt({type:t,features:[Mn]}),t})();const u4={provide:Pi,useExisting:an(()=>x_),multi:!0};let x_=(()=>{class t extends Da{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>AT(e),this.createValidator=e=>function GE(t){return n=>{if(Ls(n.value)||Ls(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Br("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[En([u4]),hn]}),t})();const d4={provide:Pi,useExisting:an(()=>S_),multi:!0};let S_=(()=>{class t extends Da{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>AT(e),this.createValidator=e=>function HE(t){return n=>{if(Ls(n.value)||Ls(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Br("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[En([d4]),hn]}),t})();const h4={provide:Pi,useExisting:an(()=>pf),multi:!0};let pf=(()=>{class t extends Da{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Lm,this.createValidator=e=>$E}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Br("required",i._enabled?"":null)},inputs:{required:"required"},features:[En([h4]),hn]}),t})();const g4={provide:Pi,useExisting:an(()=>D_),multi:!0};let D_=(()=>{class t extends Da{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>OT(e),this.createValidator=e=>function YE(t){return n=>Ls(n.value)||!jE(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Br("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[En([g4]),hn]}),t})();const m4={provide:Pi,useExisting:an(()=>M_),multi:!0};let M_=(()=>{class t extends Da{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>OT(e),this.createValidator=e=>function qE(t){return n=>jE(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Mi(t)))(i||t)}}(),t.\u0275dir=vt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Br("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[En([m4]),hn]}),t})(),v4=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({imports:[TT]}),t})(),b4=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Yl,useValue:e.callSetDisabledState??cf}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({imports:[v4]}),t})();class RT{}class C4{}const ms="*";function Ao(t,n){return{type:7,name:t,definitions:n,options:{}}}function vi(t,n=null){return{type:4,styles:n,timings:t}}function LT(t,n=null){return{type:2,steps:t,options:n}}function wt(t){return{type:6,styles:t,offset:null}}function BT(t,n,e){return{type:0,name:t,styles:n,options:e}}function go(t){return{type:5,steps:t}}function yi(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function zT(t){Promise.resolve().then(t)}class Au{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){zT(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class UT{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?zT(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const k_="!";function VT(t){return new Se(3e3,!1)}function n5(){return typeof window<"u"&&typeof window.document<"u"}function I_(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Hs(t){switch(t.length){case 0:return new Au;case 1:return t[0];default:return new UT(t)}}function jT(t,n,e,i,r=new Map,o=new Map){const s=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const h=u.get("offset"),g=h==l,E=g&&c||new Map;u.forEach((L,Z)=>{let re=Z,oe=L;if("offset"!==Z)switch(re=n.normalizePropertyName(re,s),oe){case k_:oe=r.get(Z);break;case ms:oe=o.get(Z);break;default:oe=n.normalizeStyleValue(Z,re,oe,s)}E.set(re,oe)}),g||a.push(E),c=E,l=h}),s.length)throw function G4(t){return new Se(3502,!1)}();return a}function O_(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&A_(e,"start",t)));break;case"done":t.onDone(()=>i(e&&A_(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&A_(e,"destroy",t)))}}function A_(t,n,e){const o=P_(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function P_(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function wr(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function HT(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let F_=(t,n)=>!1,GT=(t,n,e)=>[],$T=null;function N_(t){const n=t.parentNode||t.host;return n===$T?null:n}(I_()||typeof Element<"u")&&(n5()?($T=(()=>document.documentElement)(),F_=(t,n)=>{for(;n;){if(n===t)return!0;n=N_(n)}return!1}):F_=(t,n)=>t.contains(n),GT=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let Ma=null,WT=!1;const ZT=F_,YT=GT;let qT=(()=>{class t{validateStyleProperty(e){return function r5(t){Ma||(Ma=function o5(){return typeof document<"u"?document.body:null}()||{},WT=!!Ma.style&&"WebkitAppearance"in Ma.style);let n=!0;return Ma.style&&!function i5(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Ma.style,!n&&WT&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in Ma.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return ZT(e,i)}getParentElement(e){return N_(e)}query(e,i,r){return YT(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],l){return new Au(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),R_=(()=>{class t{}return t.NOOP=new qT,t})();const s5=1e3,L_="ng-enter",gf="ng-leave",mf="ng-trigger",_f=".ng-trigger",XT="ng-animating",B_=".ng-animating";function _s(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:z_(parseFloat(n[1]),n[2])}function z_(t,n){return"s"===n?t*s5:t}function vf(t,n,e){return t.hasOwnProperty("duration")?t:function l5(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(VT()),{duration:0,delay:0,easing:""};r=z_(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=z_(parseFloat(l),a[4]));const c=a[5];c&&(s=c)}else r=t;if(!e){let a=!1,l=n.length;r<0&&(n.push(function w4(){return new Se(3100,!1)}()),a=!0),o<0&&(n.push(function E4(){return new Se(3101,!1)}()),a=!0),a&&n.splice(l,0,VT())}return{duration:r,delay:o,easing:s}}(t,n,e)}function Pu(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function QT(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function Gs(t,n=new Map,e){if(e)for(let[i,r]of e)n.set(i,r);for(let[i,r]of t)n.set(i,r);return n}function ex(t,n,e){return e?n+":"+e+";":""}function tx(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=ex(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=ex(0,h5(e),t.style[e]));t.setAttribute("style",n)}function Po(t,n,e){t.style&&(n.forEach((i,r)=>{const o=V_(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i}),I_()&&tx(t))}function ka(t,n){t.style&&(n.forEach((e,i)=>{const r=V_(i);t.style[r]=""}),I_()&&tx(t))}function Fu(t){return Array.isArray(t)?1==t.length?t[0]:LT(t):t}const U_=new RegExp("{{\\s*(.+?)\\s*}}","g");function nx(t){let n=[];if("string"==typeof t){let e;for(;e=U_.exec(t);)n.push(e[1]);U_.lastIndex=0}return n}function Nu(t,n,e){const i=t.toString(),r=i.replace(U_,(o,s)=>{let a=n[s];return null==a&&(e.push(function x4(t){return new Se(3003,!1)}()),a=""),a.toString()});return r==i?t:r}function yf(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const d5=/-+([a-z0-9])/g;function V_(t){return t.replace(d5,(...n)=>n[1].toUpperCase())}function h5(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Er(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function S4(t){return new Se(3004,!1)}()}}function ix(t,n){return window.getComputedStyle(t)[n]}const wf="*";function v5(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function y5(t,n,e){if(":"==t[0]){const l=function b5(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function U4(t){return new Se(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function z4(t){return new Se(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(rx(r,s));"<"==o[0]&&!(r==wf&&s==wf)&&n.push(rx(s,r))}(i,e,n)):e.push(t),e}const Ef=new Set(["true","1"]),Tf=new Set(["false","0"]);function rx(t,n){const e=Ef.has(t)||Tf.has(t),i=Ef.has(n)||Tf.has(n);return(r,o)=>{let s=t==wf||t==r,a=n==wf||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?Ef.has(t):Tf.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?Ef.has(n):Tf.has(n)),s&&a}}const C5=new RegExp("s*:selfs*,?","g");function j_(t,n,e,i){return new w5(t).build(n,e,i)}class w5{constructor(n){this._driver=n}build(n,e,i){const r=new x5(e);return this._resetContextStyleTimingState(r),Er(this,Fu(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function M4(){return new Se(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,e))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,e);i+=l.queryCount,r+=l.depCount,s.push(l)}else e.errors.push(function k4(){return new Se(3007,!1)}())}),{type:7,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{nx(l).forEach(c=>{s.hasOwnProperty(c)||o.add(c)})})}),o.size&&(yf(o.values()),e.errors.push(function I4(t,n){return new Se(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=Er(this,Fu(n.animation),e);return{type:1,matchers:v5(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Ia(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>Er(this,i,e)),options:Ia(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=Er(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:Ia(n.options)}}visitAnimate(n,e){const i=function D5(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return H_(vf(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=H_(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=vf(e,n);return H_(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:wt({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const c={};i.easing&&(c.easing=i.easing),s=wt(c)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,e);l.isEmptyStep=a,r=l}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===ms?i.push(a):e.errors.push(new Se(3002,!1)):i.push(QT(a));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let l of a.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{const c=e.collectedStyles.get(e.currentQuerySelector),u=c.get(l);let h=!0;u&&(o!=r&&o>=u.startTime&&r<=u.endTime&&(e.errors.push(function A4(t,n,e,i,r){return new Se(3010,!1)}()),h=!1),o=u.startTime),h&&c.set(l,{startTime:o,endTime:r}),e.options&&function u5(t,n,e){const i=n.params||{},r=nx(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function T4(t){return new Se(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function P4(){return new Se(3011,!1)}()),i;let o=0;const s=[];let a=!1,l=!1,c=0;const u=n.steps.map(oe=>{const ce=this._makeStyleAst(oe,e);let ue=null!=ce.offset?ce.offset:function S5(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(ce.styles),be=0;return null!=ue&&(o++,be=ce.offset=ue),l=l||be<0||be>1,a=a||be<c,c=be,s.push(be),ce});l&&e.errors.push(function F4(){return new Se(3012,!1)}()),a&&e.errors.push(function N4(){return new Se(3200,!1)}());const h=n.steps.length;let g=0;o>0&&o<h?e.errors.push(function R4(){return new Se(3202,!1)}()):0==o&&(g=1/(h-1));const E=h-1,L=e.currentTime,Z=e.currentAnimateTimings,re=Z.duration;return u.forEach((oe,ce)=>{const ue=g>0?ce==E?1:g*ce:s[ce],be=ue*re;e.currentTime=L+Z.delay+be,Z.duration=be,this._validateStyleAst(oe,e),oe.offset=ue,i.styles.push(oe)}),i}visitReference(n,e){return{type:8,animation:Er(this,Fu(n.animation),e),options:Ia(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:Ia(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:Ia(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function E5(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(C5,"")),t=t.replace(/@\*/g,_f).replace(/@\w+/g,e=>_f+"-"+e.slice(1)).replace(/:animating/g,B_),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,wr(e.collectedStyles,e.currentQuerySelector,new Map);const a=Er(this,Fu(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:Ia(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function L4(){return new Se(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:vf(n.timings,e.errors,!0);return{type:12,animation:Er(this,Fu(n.animation),e),timings:i,options:null}}}class x5{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Ia(t){return t?(t=Pu(t)).params&&(t.params=function T5(t){return t?Pu(t):null}(t.params)):t={},t}function H_(t,n,e){return{duration:t,delay:n,easing:e}}function G_(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class xf{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const I5=new RegExp(":enter","g"),A5=new RegExp(":leave","g");function $_(t,n,e,i,r,o=new Map,s=new Map,a,l,c=[]){return(new P5).buildKeyframes(t,n,e,i,r,o,s,a,l,c)}class P5{buildKeyframes(n,e,i,r,o,s,a,l,c,u=[]){c=c||new xf;const h=new W_(n,e,c,r,o,u,[]);h.options=l;const g=l.delay?_s(l.delay):0;h.currentTimeline.delayNextStep(g),h.currentTimeline.setStyles([s],null,h.errors,l),Er(this,i,h);const E=h.timelines.filter(L=>L.containsAnimation());if(E.length&&a.size){let L;for(let Z=E.length-1;Z>=0;Z--){const re=E[Z];if(re.element===e){L=re;break}}L&&!L.allowOnlyTimelineStyles()&&L.setStyles([a],null,h.errors,l)}return E.length?E.map(L=>L.buildKeyframes()):[G_(e,[],[],[],0,g,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:_s(Nu(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?_s(i.duration):null,a=null!=i.delay?_s(i.delay):null;return 0!==s&&n.forEach(l=>{const c=e.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Er(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Sf);const s=_s(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>Er(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?_s(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),Er(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return vf(e.params?Nu(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?_s(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Sf);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{e.currentQueryIndex=u;const h=e.createSubContext(n.options,c);o&&h.delayNextStep(o),c===e.element&&(l=h.currentTimeline),Er(this,n.animation,h),h.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,h.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let l=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=e.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;Er(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-h+(r.startTime-i.currentTimeline.startTime)}}const Sf={};class W_{constructor(n,e,i,r,o,s,a,l){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Sf,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Df(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=_s(i.duration)),null!=i.delay&&(r.delay=_s(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Nu(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new W_(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Sf,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new F5(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(I5,"."+this._enterClassName)).replace(A5,"."+this._leaveClassName);let c=this._driver.query(this.element,n,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!o&&0==a.length&&s.push(function B4(t){return new Se(3014,!1)}()),a}}class Df{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Df(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||ms),this._currentKeyframe.set(e,ms);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function N5(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i=i||n.keys();for(let o of i)e.set(o,ms)}else Gs(r,e)}),e}(n,this._globalTimelineStyles);for(let[a,l]of s){const c=Nu(l,o,i);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ms),this._updateStyle(a,c)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Gs(a,new Map,this._backFill);c.forEach((u,h)=>{u===k_?n.add(h):u===ms&&e.add(h)}),i||c.set("offset",l/this.duration),r.push(c)});const o=n.size?yf(n.values()):[],s=e.size?yf(e.values()):[];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return G_(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class F5 extends Df{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,l=Gs(n[0]);l.set("offset",0),o.push(l);const c=Gs(n[0]);c.set("offset",ax(a)),o.push(c);const u=n.length-1;for(let h=1;h<=u;h++){let g=Gs(n[h]);const E=g.get("offset");g.set("offset",ax((e+E*i)/s)),o.push(g)}i=s,e=0,r="",n=o}return G_(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function ax(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class Z_{}const R5=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class L5 extends Z_{normalizePropertyName(n,e){return V_(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(R5.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function D4(t,n){return new Se(3005,!1)}())}return s+o}}function lx(t,n,e,i,r,o,s,a,l,c,u,h,g){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:g}}const Y_={};class cx{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function B5(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,l,c,u){const h=[],g=this.ast.options&&this.ast.options.params||Y_,L=this.buildStyles(i,a&&a.params||Y_,h),Z=l&&l.params||Y_,re=this.buildStyles(r,Z,h),oe=new Set,ce=new Map,ue=new Map,be="void"===r,Ke={params:z5(Z,g),delay:this.ast.options?.delay},ft=u?[]:$_(n,e,this.ast.animation,o,s,L,re,Ke,c,h);let Xe=0;if(ft.forEach(Et=>{Xe=Math.max(Et.duration+Et.delay,Xe)}),h.length)return lx(e,this._triggerName,i,r,be,L,re,[],[],ce,ue,Xe,h);ft.forEach(Et=>{const lt=Et.element,zt=wr(ce,lt,new Set);Et.preStyleProps.forEach(Kr=>zt.add(Kr));const Xi=wr(ue,lt,new Set);Et.postStyleProps.forEach(Kr=>Xi.add(Kr)),lt!==e&&oe.add(lt)});const Bt=yf(oe.values());return lx(e,this._triggerName,i,r,be,L,re,ft,Bt,ce,ue,Xe)}}function z5(t,n){const e=Pu(n);for(const i in t)t.hasOwnProperty(i)&&null!=t[i]&&(e[i]=t[i]);return e}class U5{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=Pu(this.defaultParams);return Object.keys(n).forEach(o=>{const s=n[o];null!==s&&(r[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Nu(s,r,e));const l=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,l,s,e),i.set(a,s)})}),i}}class j5{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new U5(r.style,r.options&&r.options.params||{},i))}),ux(this.states,"true","1"),ux(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new cx(n,r,this.states))}),this.fallbackTransition=function H5(t,n,e){return new cx(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function ux(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const G5=new xf;class $5{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],r=[],o=j_(this._driver,e,i,r);if(i.length)throw function $4(t){return new Se(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=jT(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=$_(this._driver,e,o,L_,gf,new Map,new Map,i,G5,r),s.forEach(u=>{const h=wr(a,u.element,new Map);u.postStyleProps.forEach(g=>h.set(g,null))})):(r.push(function W4(){return new Se(3300,!1)}()),s=[]),r.length)throw function Z4(t){return new Se(3504,!1)}();a.forEach((u,h)=>{u.forEach((g,E)=>{u.set(E,this._driver.computeStyle(h,E,ms))})});const c=Hs(s.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,new Map,h)}));return this._playersById.set(n,c),c.onDestroy(()=>this.destroy(n)),this.players.push(c),c}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Y4(t){return new Se(3301,!1)}();return e}listen(n,e,i,r){const o=P_(e,"","","");return O_(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const dx="ng-animate-queued",q_="ng-animate-disabled",K5=[],hx={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},X5={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Vr="__ng_removed";class K_{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function tB(t){return t??null}(i?n.value:n),i){const o=Pu(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Ru="void",X_=new K_(Ru);class Q5{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,jr(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function q4(t,n){return new Se(3302,!1)}();if(null==i||0==i.length)throw function K4(t){return new Se(3303,!1)}();if(!function nB(t){return"start"==t||"done"==t}(i))throw function X4(t,n){return new Se(3400,!1)}();const o=wr(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=wr(this._engine.statesByElement,n,new Map);return a.has(e)||(jr(n,mf),jr(n,mf+"-"+e),a.set(e,X_)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function Q4(t){return new Se(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new Q_(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(jr(n,mf),jr(n,mf+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e);const c=new K_(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(e,c),l||(l=X_),c.value!==Ru&&l.value===c.value){if(!function oB(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,c.params)){const Z=[],re=o.matchStyles(l.value,l.params,Z),oe=o.matchStyles(c.value,c.params,Z);Z.length?this._engine.reportError(Z):this._engine.afterFlush(()=>{ka(n,re),Po(n,oe)})}return}const g=wr(this._engine.playersByElement,n,[]);g.forEach(Z=>{Z.namespaceId==this.id&&Z.triggerName==e&&Z.queued&&Z.destroy()});let E=o.matchTransition(l.value,c.value,n,c.params),L=!1;if(!E){if(!r)return;E=o.fallbackTransition,L=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:E,fromState:l,toState:c,player:s,isFallbackTransition:L}),L||(jr(n,dx),s.onStart(()=>{Xl(n,dx)})),s.onDone(()=>{let Z=this.players.indexOf(s);Z>=0&&this.players.splice(Z,1);const re=this._engine.playersByElement.get(n);if(re){let oe=re.indexOf(s);oe>=0&&re.splice(oe,1)}}),this.players.push(s),g.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,_f,!0);i.forEach(r=>{if(r[Vr])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((l,c)=>{if(s.set(c,l.value),this._triggers.has(c)){const u=this.trigger(n,c,Ru,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&Hs(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers.get(s).fallbackTransition,c=i.get(s)||X_,u=new K_(Ru),h=new Q_(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[Vr];(!o||o===hx)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){jr(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=P_(o,i.triggerName,i.fromState.value,i.toState.value);l._data=n,O_(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class J5{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new Q5(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const l=r.get(a);if(l){const c=i.indexOf(l);i.splice(c+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(Mf(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!Mf(e))return;const o=e[Vr];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),jr(n,q_)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Xl(n,q_))}removeNode(n,e,i,r){if(Mf(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[Vr]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return Mf(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,_f,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,B_,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Hs(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Vr];if(e&&e.setForRemoval){if(n[Vr]=hx,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(q_)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)jr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Hs(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function J4(t){return new Se(3402,!1)}()}_flushAnimations(n,e){const i=new xf,r=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(tt=>{u.add(tt);const ht=this.driver.query(tt,".ng-animate-queued",!0);for(let _t=0;_t<ht.length;_t++)u.add(ht[_t])});const h=this.bodyNode,g=Array.from(this.statesByElement.keys()),E=gx(g,this.collectedEnterElements),L=new Map;let Z=0;E.forEach((tt,ht)=>{const _t=L_+Z++;L.set(ht,_t),tt.forEach(Qt=>jr(Qt,_t))});const re=[],oe=new Set,ce=new Set;for(let tt=0;tt<this.collectedLeaveElements.length;tt++){const ht=this.collectedLeaveElements[tt],_t=ht[Vr];_t&&_t.setForRemoval&&(re.push(ht),oe.add(ht),_t.hasAnimation?this.driver.query(ht,".ng-star-inserted",!0).forEach(Qt=>oe.add(Qt)):ce.add(ht))}const ue=new Map,be=gx(g,Array.from(oe));be.forEach((tt,ht)=>{const _t=gf+Z++;ue.set(ht,_t),tt.forEach(Qt=>jr(Qt,_t))}),n.push(()=>{E.forEach((tt,ht)=>{const _t=L.get(ht);tt.forEach(Qt=>Xl(Qt,_t))}),be.forEach((tt,ht)=>{const _t=ue.get(ht);tt.forEach(Qt=>Xl(Qt,_t))}),re.forEach(tt=>{this.processLeaveNode(tt)})});const Ke=[],ft=[];for(let tt=this._namespaceList.length-1;tt>=0;tt--)this._namespaceList[tt].drainQueuedTransitions(e).forEach(_t=>{const Qt=_t.player,Fn=_t.element;if(Ke.push(Qt),this.collectedEnterElements.length){const zi=Fn[Vr];if(zi&&zi.setForMove){if(zi.previousTriggersValues&&zi.previousTriggersValues.has(_t.triggerName)){const Qa=zi.previousTriggersValues.get(_t.triggerName),Qr=this.statesByElement.get(_t.element);if(Qr&&Qr.has(_t.triggerName)){const dp=Qr.get(_t.triggerName);dp.value=Qa,Qr.set(_t.triggerName,dp)}}return void Qt.destroy()}}const kr=!h||!this.driver.containsElement(h,Fn),ii=ue.get(Fn),Qi=L.get(Fn),Nn=this._buildInstruction(_t,i,Qi,ii,kr);if(Nn.errors&&Nn.errors.length)return void ft.push(Nn);if(kr)return Qt.onStart(()=>ka(Fn,Nn.fromStyles)),Qt.onDestroy(()=>Po(Fn,Nn.toStyles)),void r.push(Qt);if(_t.isFallbackTransition)return Qt.onStart(()=>ka(Fn,Nn.fromStyles)),Qt.onDestroy(()=>Po(Fn,Nn.toStyles)),void r.push(Qt);const LM=[];Nn.timelines.forEach(zi=>{zi.stretchStartingKeyframe=!0,this.disabledNodes.has(zi.element)||LM.push(zi)}),Nn.timelines=LM,i.append(Fn,Nn.timelines),s.push({instruction:Nn,player:Qt,element:Fn}),Nn.queriedElements.forEach(zi=>wr(a,zi,[]).push(Qt)),Nn.preStyleProps.forEach((zi,Qa)=>{if(zi.size){let Qr=l.get(Qa);Qr||l.set(Qa,Qr=new Set),zi.forEach((dp,_v)=>Qr.add(_v))}}),Nn.postStyleProps.forEach((zi,Qa)=>{let Qr=c.get(Qa);Qr||c.set(Qa,Qr=new Set),zi.forEach((dp,_v)=>Qr.add(_v))})});if(ft.length){const tt=[];ft.forEach(ht=>{tt.push(function e5(t,n){return new Se(3505,!1)}())}),Ke.forEach(ht=>ht.destroy()),this.reportError(tt)}const Xe=new Map,Bt=new Map;s.forEach(tt=>{const ht=tt.element;i.has(ht)&&(Bt.set(ht,ht),this._beforeAnimationBuild(tt.player.namespaceId,tt.instruction,Xe))}),r.forEach(tt=>{const ht=tt.element;this._getPreviousPlayers(ht,!1,tt.namespaceId,tt.triggerName,null).forEach(Qt=>{wr(Xe,ht,[]).push(Qt),Qt.destroy()})});const Et=re.filter(tt=>_x(tt,l,c)),lt=new Map;px(lt,this.driver,ce,c,ms).forEach(tt=>{_x(tt,l,c)&&Et.push(tt)});const Xi=new Map;E.forEach((tt,ht)=>{px(Xi,this.driver,new Set(tt),l,k_)}),Et.forEach(tt=>{const ht=lt.get(tt),_t=Xi.get(tt);lt.set(tt,new Map([...Array.from(ht?.entries()??[]),...Array.from(_t?.entries()??[])]))});const Kr=[],Xr=[],Xo={};s.forEach(tt=>{const{element:ht,player:_t,instruction:Qt}=tt;if(i.has(ht)){if(u.has(ht))return _t.onDestroy(()=>Po(ht,Qt.toStyles)),_t.disabled=!0,_t.overrideTotalTime(Qt.totalTime),void r.push(_t);let Fn=Xo;if(Bt.size>1){let ii=ht;const Qi=[];for(;ii=ii.parentNode;){const Nn=Bt.get(ii);if(Nn){Fn=Nn;break}Qi.push(ii)}Qi.forEach(Nn=>Bt.set(Nn,Fn))}const kr=this._buildAnimation(_t.namespaceId,Qt,Xe,o,Xi,lt);if(_t.setRealPlayer(kr),Fn===Xo)Kr.push(_t);else{const ii=this.playersByElement.get(Fn);ii&&ii.length&&(_t.parentPlayer=Hs(ii)),r.push(_t)}}else ka(ht,Qt.fromStyles),_t.onDestroy(()=>Po(ht,Qt.toStyles)),Xr.push(_t),u.has(ht)&&r.push(_t)}),Xr.forEach(tt=>{const ht=o.get(tt.element);if(ht&&ht.length){const _t=Hs(ht);tt.setRealPlayer(_t)}}),r.forEach(tt=>{tt.parentPlayer?tt.syncPlayerEvents(tt.parentPlayer):tt.destroy()});for(let tt=0;tt<re.length;tt++){const ht=re[tt],_t=ht[Vr];if(Xl(ht,gf),_t&&_t.hasAnimation)continue;let Qt=[];if(a.size){let kr=a.get(ht);kr&&kr.length&&Qt.push(...kr);let ii=this.driver.query(ht,B_,!0);for(let Qi=0;Qi<ii.length;Qi++){let Nn=a.get(ii[Qi]);Nn&&Nn.length&&Qt.push(...Nn)}}const Fn=Qt.filter(kr=>!kr.destroyed);Fn.length?iB(this,ht,Fn):this.processLeaveNode(ht)}return re.length=0,Kr.forEach(tt=>{this.players.push(tt),tt.onDone(()=>{tt.destroy();const ht=this.players.indexOf(tt);this.players.splice(ht,1)}),tt.play()}),Kr}elementContainsData(n,e){let i=!1;const r=e[Vr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const l=!o||o==Ru;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||s.push(c)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const c=l.element,u=c!==o,h=wr(i,c,[]);this._getPreviousPlayers(c,u,s,a,e.toState).forEach(E=>{const L=E.getRealPlayer();L.beforeDestroy&&L.beforeDestroy(),E.destroy(),h.push(E)})}ka(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,l=e.element,c=[],u=new Set,h=new Set,g=e.timelines.map(L=>{const Z=L.element;u.add(Z);const re=Z[Vr];if(re&&re.removedBeforeQueried)return new Au(L.duration,L.delay);const oe=Z!==l,ce=function rB(t){const n=[];return mx(t,n),n}((i.get(Z)||K5).map(Xe=>Xe.getRealPlayer())).filter(Xe=>!!Xe.element&&Xe.element===Z),ue=o.get(Z),be=s.get(Z),Ke=jT(0,this._normalizer,0,L.keyframes,ue,be),ft=this._buildPlayer(L,Ke,ce);if(L.subTimeline&&r&&h.add(Z),oe){const Xe=new Q_(n,a,Z);Xe.setRealPlayer(ft),c.push(Xe)}return ft});c.forEach(L=>{wr(this.playersByQueriedElement,L.element,[]).push(L),L.onDone(()=>function eB(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,L.element,L))}),u.forEach(L=>jr(L,XT));const E=Hs(g);return E.onDestroy(()=>{u.forEach(L=>Xl(L,XT)),Po(l,e.toStyles)}),h.forEach(L=>{wr(r,L,[]).push(E)}),E}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Au(n.duration,n.delay)}}class Q_{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Au,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>O_(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){wr(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Mf(t){return t&&1===t.nodeType}function fx(t,n){const e=t.style.display;return t.style.display=n??"none",e}function px(t,n,e,i,r){const o=[];e.forEach(l=>o.push(fx(l)));const s=[];i.forEach((l,c)=>{const u=new Map;l.forEach(h=>{const g=n.computeStyle(c,h,r);u.set(h,g),(!g||0==g.length)&&(c[Vr]=X5,s.push(c))}),t.set(c,u)});let a=0;return e.forEach(l=>fx(l,o[a++])),s}function gx(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const i=1,r=new Set(n),o=new Map;function s(a){if(!a)return i;let l=o.get(a);if(l)return l;const c=a.parentNode;return l=e.has(c)?c:r.has(c)?i:s(c),o.set(a,l),l}return n.forEach(a=>{const l=s(a);l!==i&&e.get(l).push(a)}),e}function jr(t,n){t.classList?.add(n)}function Xl(t,n){t.classList?.remove(n)}function iB(t,n,e){Hs(e).onDone(()=>t.processLeaveNode(n))}function mx(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof UT?mx(i.players,n):n.push(i)}}function _x(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class kf{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new J5(n,e,i),this._timelineEngine=new $5(n,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],c=[],u=j_(this._driver,o,l,c);if(l.length)throw function H4(t,n){return new Se(3404,!1)}();a=function V5(t,n,e){return new j5(t,n,e)}(r,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=HT(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=HT(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let aB=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Po(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Po(this._element,this._initialStyles),this._endStyles&&(Po(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(ka(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ka(this._element,this._endStyles),this._endStyles=null),Po(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function J_(t){let n=null;return t.forEach((e,i)=>{(function lB(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class vx{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:ix(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class cB{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return ZT(n,e)}getParentElement(n){return N_(n)}query(n,e,i){return YT(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const c=new Map,u=s.filter(E=>E instanceof vx);(function f5(t,n){return 0===t||0===n})(i,r)&&u.forEach(E=>{E.currentSnapshot.forEach((L,Z)=>c.set(Z,L))});let h=function c5(t){return t.length?t[0]instanceof Map?t:t.map(n=>QT(n)):[]}(e).map(E=>Gs(E));h=function p5(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,ix(t,a)))}}return n}(n,h,c);const g=function sB(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=J_(n[0]),n.length>1&&(i=J_(n[n.length-1]))):n instanceof Map&&(e=J_(n)),e||i?new aB(t,e,i):null}(n,h);return new vx(n,h,l,g)}}let uB=(()=>{class t extends RT{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:ro.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?LT(e):e;return yx(this._renderer,null,i,"register",[r]),new dB(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(bt(nu),bt(Cr))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class dB extends C4{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new hB(this._id,n,e||{},this._renderer)}}class hB{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return yx(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function yx(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const bx="@.disabled";let fB=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=s?.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(o);return u||(u=new Cx("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,u)),u}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(s,a,e,u.name,u)};return i.data.animation.forEach(l),new pB(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(bt(nu),bt(kf),bt(Gt))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class Cx{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==bx?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class pB extends Cx{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==bx?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function gB(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function mB(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let _B=(()=>{class t extends kf{constructor(e,i,r,o){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(bt(Cr),bt(R_),bt(Z_),bt(Lh))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();const wx=[{provide:RT,useClass:uB},{provide:Z_,useFactory:function vB(){return new L5}},{provide:kf,useClass:_B},{provide:nu,useFactory:function yB(t,n,e){return new fB(t,n,e)},deps:[nf,kf,Gt]}],e0=[{provide:R_,useFactory:()=>new cB},{provide:Tw,useValue:"BrowserAnimations"},...wx],Ex=[{provide:R_,useClass:qT},{provide:Tw,useValue:"NoopAnimations"},...wx];let bB=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?Ex:e0}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t}),t.\u0275inj=Co({providers:e0,imports:[RE]}),t})();class Fo{static get instance(){return Fo._instance||(Fo._instance=new Fo),Fo._instance}constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306e\uff27ameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}const Tx=Symbol("synchronize-variables"),xx=Symbol("synchronize-attributes");function Sx(t){return n=>{const e=class extends n{constructor(...r){super(...r),this.constructor===e&&function wB(t){Mx(t,Tx,n=>function(){return this.context.syncData[n]},n=>function(i){this.context.syncData[n]=i,this.update()}),Mx(t,xx,n=>function(){return this.context.syncData.attributes[n]},n=>function(i){this.context.syncData.attributes[n]=i,this.update()})}(this)}};return Fo.instance.register(e,t),e}}function Ql(){return(t,n)=>{Dx(t,Tx,n)}}function Dx(t,n,e){t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:new Set}),t[n].add(e)}function Mx(t,n,e,i){const r=new Set;let o=t;for(;o;){const s=o[n];if(null!=s&&o.hasOwnProperty(n))for(const a of s){if(r.has(a))continue;r.add(a);const l=t[a];Object.defineProperty(t,a,{get:e(a),set:i(a),enumerable:!0,configurable:!0}),void 0!==l&&(t[a]=l)}o=Object.getPrototypeOf(o)}}var vs,Lu;!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function u(g){return e[g]}function h(g){return r[g]}t.xml2element=function s(g){let E=new DOMParser,L=null;try{g=function c(g){return g.replace(o,"").trim()}(g),L=E.parseFromString(g,"application/xml"),L.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",L.documentElement),L=null)}catch(Z){console.error(Z)}return L?L.documentElement:null},t.encodeEntityReference=function a(g){return g.replace(n,u)},t.decodeEntityReference=function l(g){return g.replace(i,h)}}(vs||(vs={})),function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(Lu||(Lu={}));const EB=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Tn{static get instance(){return Tn._instance||(Tn._instance=new Tn),Tn._instance}constructor(){console.log("ObjectSerializer ready...")}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():Tn.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i)void 0!==i[s]&&(o+=" "+s+'="'+vs.encodeEntityReference(i[s]+"")+'"');return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=Tn.make2Attributes(n[i],i);for(let a in s)void 0!==s[a]&&(e[a]=s[a])}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=Tn.array2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else if("object"==typeof n){let r=Tn.object2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else void 0!==n&&(i[e]=n);return i}static object2attributes(n,e){let i={};for(let r in n){let a=Tn.make2Attributes(n[r],e+"."+r);for(let l in a)void 0!==a[l]&&(i[l]=a[l])}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let l=Tn.make2Attributes(n[o],e+"."+o);for(let c in l)void 0!==l[c]&&(i[c]=l[c])}return i}parseXml(n){let e=null;if(e="string"==typeof n?vs.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Fo.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();Tn.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=vs.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],l=n,c=s.find(h=>EB.includes(h));null==c?1<s.length&&(({obj:l,key:a}=Tn.attributes2object(s,l,a)),null==a)||("string"!=typeof l[a]&&null!=l[a]&&(o=JSON.parse(o)),l[a]=o):console.log(`skip invalid key (${c})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}let Jl=0;const Bu=new Map,Of=new MessageChannel;function Ni(t){if(4294967296===Jl&&(Jl=0),++Jl in Bu)throw new Error("setZeroTimeout queue overflow.");return Bu.set(Jl,t),Of.port2.postMessage(Jl),Jl}Of.port1.onmessage=function(t){const n=Bu.get(t.data);Bu.delete(t.data),n&&n()},Of.port1.start(),Of.port2.start();class kx{}var t0=Y(1817),Ix=Y(8497),xB=Y(1082),$s=(()=>{return(t=$s||($s={}))[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH",$s;var t})();const SB=xB("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),DB=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class xn{get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:$s.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}parse(n){try{this.peerId=n;let e=DB.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=Ix.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return Ox(this.digestUserId,this.roomId,this.roomName,n)===this.digestPassword&&this.verifyRoomId(n)}verifyRoomId(n){return Ax(this.roomId,this.roomName,n)===this.roomId}verifyPeer(n){let e=xn.parse(n);return this.roomId==e.roomId&&this.roomName==e.roomName&&this.hasPassword==e.hasPassword&&(!this.hasPassword||(this.password.length<1?(console.error("do not know password."),!1):e.verifyPassword(this.password)))}static parse(n){return new xn(n)}static create(...n){return n.length<=1?xn._create.apply(this,n):xn._createRoom.apply(this,n)}static _create(n=""){let e=function MB(t){return null==t?"":Af(t)}(n),i=new xn(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=Af(n,6),s=Ax(e,i,r),a=Ox(o,s,i,r),l=`${o}${s}${Ix.n(i)}-${a}`,c=new xn(l);return c.userId=n,c.password=r,c}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function Ox(t,n,e,i){return null==n||null==i?"":0<i.length?Af(t+n+e+i,7):""}function Ax(t,n,e){if(e.length<1)return t;let i=t.slice(0,2);return i+Af(i+n+e,1)}function Af(t,n=-1){if(null==t)return"";let e=t0(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=SB.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}var Dt=Y(5861);function ec(t){let n=t.length;for(;--n>=0;)t[n]=0}const a0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Pf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),RB=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ux=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ys=new Array(576);ec(ys);const Vu=new Array(60);ec(Vu);const ju=new Array(512);ec(ju);const Hu=new Array(256);ec(Hu);const l0=new Array(29);ec(l0);const Ff=new Array(30);function c0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let Vx,jx,Hx;function u0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}ec(Ff);const Gx=t=>t<256?ju[t]:ju[256+(t>>>7)],Gu=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},lr=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,Gu(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},No=(t,n,e)=>{lr(t,e[2*n],e[2*n+1])},$x=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},Wx=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)r=r+e[o-1]<<1,i[o]=r;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=$x(i[a]++,a))}},Zx=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Yx=t=>{t.bi_valid>8?Gu(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},qx=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},d0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&qx(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!qx(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},Kx=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?No(t,r,n):(s=Hu[r],No(t,s+256+1,n),a=a0[s],0!==a&&(r-=l0[s],lr(t,r,a)),i--,s=Gx(i),No(t,s,e),a=Pf[s],0!==a&&(i-=Ff[s],lr(t,i,a)))}while(o<t.sym_next);No(t,256,n)},h0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,c,l=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=l=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,e[2*c]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=i[2*c+1]);for(n.max_code=l,s=t.heap_len>>1;s>=1;s--)d0(t,e,s);c=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],d0(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*c]=e[2*s]+e[2*a],t.depth[c]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=c,t.heap[1]=c++,d0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,l=n.stat_desc.max_length;let c,u,h,g,E,L,Z=0;for(g=0;g<=15;g++)t.bl_count[g]=0;for(e[2*t.heap[t.heap_max]+1]=0,c=t.heap_max+1;c<573;c++)u=t.heap[c],g=e[2*e[2*u+1]+1]+1,g>l&&(g=l,Z++),e[2*u+1]=g,!(u>i)&&(t.bl_count[g]++,E=0,u>=a&&(E=s[u-a]),L=e[2*u],t.opt_len+=L*(g+E),o&&(t.static_len+=L*(r[2*u+1]+E)));if(0!==Z){do{for(g=l-1;0===t.bl_count[g];)g--;t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[l]--,Z-=2}while(Z>0);for(g=l;0!==g;g--)for(u=t.bl_count[g];0!==u;)h=t.heap[--c],!(h>i)&&(e[2*h+1]!==g&&(t.opt_len+=(g-e[2*h+1])*e[2*h],e[2*h+1]=g),u--)}})(t,n),Wx(e,l,t.bl_count)},Xx=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)&&(a<c?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4))},Qx=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,l=7,c=4;for(0===s&&(l=138,c=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<l&&o===s)){if(a<c)do{No(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(No(t,o,t.bl_tree),a--),No(t,16,t.bl_tree),lr(t,a-3,2)):a<=10?(No(t,17,t.bl_tree),lr(t,a-3,3)):(No(t,18,t.bl_tree),lr(t,a-11,7));a=0,r=o,0===s?(l=138,c=3):o===s?(l=6,c=3):(l=7,c=4)}};let Jx=!1;const eS=(t,n,e,i)=>{lr(t,0+(i?1:0),3),Yx(t),Gu(t,e),Gu(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var JB={_tr_init:t=>{Jx||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(l0[i]=e,t=0;t<1<<a0[i];t++)Hu[e++]=i;for(Hu[e-1]=i,r=0,i=0;i<16;i++)for(Ff[i]=r,t=0;t<1<<Pf[i];t++)ju[r++]=i;for(r>>=7;i<30;i++)for(Ff[i]=r<<7,t=0;t<1<<Pf[i]-7;t++)ju[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)ys[2*t+1]=8,t++,o[8]++;for(;t<=255;)ys[2*t+1]=9,t++,o[9]++;for(;t<=279;)ys[2*t+1]=7,t++,o[7]++;for(;t<=287;)ys[2*t+1]=8,t++,o[8]++;for(Wx(ys,287,o),t=0;t<30;t++)Vu[2*t+1]=5,Vu[2*t]=$x(t,5);Vx=new c0(ys,a0,257,286,15),jx=new c0(Vu,Pf,0,30,15),Hx=new c0(new Array(0),RB,0,19,7)})(),Jx=!0),t.l_desc=new u0(t.dyn_ltree,Vx),t.d_desc=new u0(t.dyn_dtree,jx),t.bl_desc=new u0(t.bl_tree,Hx),t.bi_buf=0,t.bi_valid=0,Zx(t)},_tr_stored_block:eS,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),h0(t,t.l_desc),h0(t,t.d_desc),s=(t=>{let n;for(Xx(t,t.dyn_ltree,t.l_desc.max_code),Xx(t,t.dyn_dtree,t.d_desc.max_code),h0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*Ux[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?eS(t,n,e,i):4===t.strategy||o===r?(lr(t,2+(i?1:0),3),Kx(t,ys,Vu)):(lr(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(lr(t,n-257,5),lr(t,e-1,5),lr(t,i-4,4),r=0;r<i;r++)lr(t,t.bl_tree[2*Ux[r]+1],3);Qx(t,t.dyn_ltree,n-1),Qx(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),Kx(t,t.dyn_ltree,t.dyn_dtree)),Zx(t),i&&Yx(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(Hu[e]+256+1)]++,t.dyn_dtree[2*Gx(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{lr(t,2,3),No(t,256,ys),(t=>{16===t.bi_valid?(Gu(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},$u=(t,n,e,i)=>{let r=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const t6=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var fi=(t,n,e,i)=>{const r=t6,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return-1^t},Aa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Pa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:n6,_tr_stored_block:f0,_tr_flush_block:i6,_tr_tally:Ws,_tr_align:r6}=JB,{Z_NO_FLUSH:Zs,Z_PARTIAL_FLUSH:o6,Z_FULL_FLUSH:s6,Z_FINISH:Hr,Z_BLOCK:tS,Z_OK:bi,Z_STREAM_END:nS,Z_STREAM_ERROR:Ro,Z_DATA_ERROR:a6,Z_BUF_ERROR:p0,Z_DEFAULT_COMPRESSION:l6,Z_FILTERED:c6,Z_HUFFMAN_ONLY:Nf,Z_RLE:u6,Z_FIXED:d6,Z_DEFAULT_STRATEGY:h6,Z_UNKNOWN:f6,Z_DEFLATED:Rf}=Pa,g0=286,v6=30,y6=19,b6=2*g0+1,C6=15,Lo=262,Ra=(t,n)=>(t.msg=Aa[n],n),iS=t=>2*t-(t>4?9:0),qs=t=>{let n=t.length;for(;--n>=0;)t[n]=0},T6=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let Ks=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const Tr=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},xr=(t,n)=>{i6(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,Tr(t.strm)},nn=(t,n)=>{t.pending_buf[t.pending++]=n},Zu=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},C0=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=$u(t.adler,n,r,e):2===t.state.wrap&&(t.adler=fi(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},rS=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-Lo?t.strstart-(t.w_size-Lo):0,c=t.window,u=t.w_mask,h=t.prev,g=t.strstart+258;let E=c[i+s-1],L=c[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,c[r+s]===L&&c[r+s-1]===E&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<g);if(o=258-(g-i),i=g-258,o>s){if(t.match_start=n,s=o,o>=a)break;E=c[i+s-1],L=c[i+s]}}}while((n=h[n&u])>l&&0!=--e);return s<=t.lookahead?s:t.lookahead},oc=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-Lo)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),T6(t),i+=n),0===t.strm.avail_in)break;if(e=C0(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Ks(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Ks(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Lo&&0!==t.strm.avail_in)},oS=(t,n)=>{let i,r,o,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>o&&(i=o),i<e&&(0===i&&n!==Hr||n===Zs||i!==r+t.strm.avail_in)))break;s=n===Hr&&i===r+t.strm.avail_in?1:0,f0(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Tr(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(C0(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===s);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:n!==Zs&&n!==Hr&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(C0(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,r=t.strstart-t.block_start,(r>=e||(r||n===Hr)&&n!==Zs&&0===t.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=n===Hr&&0===t.strm.avail_in&&i===r?1:0,f0(t,t.block_start,i,s),t.block_start+=i,Tr(t.strm)),s?3:1)},w0=(t,n)=>{let e,i;for(;;){if(t.lookahead<Lo){if(oc(t),t.lookahead<Lo&&n===Zs)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Ks(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-Lo&&(t.match_length=rS(t,e)),t.match_length>=3)if(i=Ws(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Ks(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Ks(t,t.ins_h,t.window[t.strstart+1]);else i=Ws(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(xr(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===Hr?(xr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(xr(t,!1),0===t.strm.avail_out)?1:2},sc=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<Lo){if(oc(t),t.lookahead<Lo&&n===Zs)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Ks(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-Lo&&(t.match_length=rS(t,e),t.match_length<=5&&(t.strategy===c6||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Ws(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Ks(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(xr(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Ws(t,0,t.window[t.strstart-1]),i&&xr(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Ws(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===Hr?(xr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(xr(t,!1),0===t.strm.avail_out)?1:2};function Bo(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const Yu=[new Bo(0,0,0,0,oS),new Bo(4,4,8,4,w0),new Bo(4,5,16,8,w0),new Bo(4,6,32,32,w0),new Bo(4,4,16,16,sc),new Bo(8,16,32,32,sc),new Bo(8,16,128,128,sc),new Bo(8,32,128,256,sc),new Bo(32,128,258,1024,sc),new Bo(32,258,258,4096,sc)];function M6(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Rf,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*b6),this.dyn_dtree=new Uint16Array(2*(2*v6+1)),this.bl_tree=new Uint16Array(2*(2*y6+1)),qs(this.dyn_ltree),qs(this.dyn_dtree),qs(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(C6+1),this.heap=new Uint16Array(2*g0+1),qs(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*g0+1),qs(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const qu=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},sS=t=>{if(qu(t))return Ra(t,Ro);t.total_in=t.total_out=0,t.data_type=f6;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,n6(n),bi},aS=t=>{const n=sS(t);return n===bi&&(t=>{t.window_size=2*t.w_size,qs(t.head),t.max_lazy_match=Yu[t.level].max_lazy,t.good_match=Yu[t.level].good_length,t.nice_match=Yu[t.level].nice_length,t.max_chain_length=Yu[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},lS=(t,n,e,i,r,o)=>{if(!t)return Ro;let s=1;if(n===l6&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==Rf||i<8||i>15||n<0||n>9||o<0||o>d6||8===i&&1!==s)return Ra(t,Ro);8===i&&(i=9);const a=new M6;return t.state=a,a.strm=t,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=o,a.method=e,aS(t)};var Ku={deflateInit:(t,n)=>lS(t,n,Rf,15,8,h6),deflateInit2:lS,deflateReset:aS,deflateResetKeep:sS,deflateSetHeader:(t,n)=>qu(t)||2!==t.state.wrap?Ro:(t.state.gzhead=n,bi),deflate:(t,n)=>{if(qu(t)||n>tS||n<0)return t?Ra(t,Ro):Ro;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==Hr)return Ra(t,0===t.avail_out?p0:Ro);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if(Tr(t),0===t.avail_out)return e.last_flush=-1,bi}else if(0===t.avail_in&&iS(n)<=iS(i)&&n!==Hr)return Ra(t,p0);if(666===e.status&&0!==t.avail_in)return Ra(t,p0);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=Rf+(e.w_bits-8<<4)<<8,o=-1;if(o=e.strategy>=Nf||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=o<<6,0!==e.strstart&&(r|=32),r+=31-r%31,Zu(e,r),0!==e.strstart&&(Zu(e,t.adler>>>16),Zu(e,65535&t.adler)),t.adler=1,e.status=113,Tr(t),0!==e.pending)return e.last_flush=-1,bi}if(57===e.status)if(t.adler=0,nn(e,31),nn(e,139),nn(e,8),e.gzhead)nn(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),nn(e,255&e.gzhead.time),nn(e,e.gzhead.time>>8&255),nn(e,e.gzhead.time>>16&255),nn(e,e.gzhead.time>>24&255),nn(e,9===e.level?2:e.strategy>=Nf||e.level<2?4:0),nn(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(nn(e,255&e.gzhead.extra.length),nn(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=fi(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(nn(e,0),nn(e,0),nn(e,0),nn(e,0),nn(e,0),nn(e,9===e.level?2:e.strategy>=Nf||e.level<2?4:0),nn(e,3),e.status=113,Tr(t),0!==e.pending)return e.last_flush=-1,bi;if(69===e.status){if(e.gzhead.extra){let r=e.pending,o=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,Tr(t),0!==e.pending)return e.last_flush=-1,bi;r=0,o-=a}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),Tr(t),0!==e.pending)return e.last_flush=-1,bi;r=0}o=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,nn(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r)),Tr(t),0!==e.pending)return e.last_flush=-1,bi;r=0}o=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,nn(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=fi(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(Tr(t),0!==e.pending))return e.last_flush=-1,bi;nn(e,255&t.adler),nn(e,t.adler>>8&255),t.adler=0}if(e.status=113,Tr(t),0!==e.pending)return e.last_flush=-1,bi}if(0!==t.avail_in||0!==e.lookahead||n!==Zs&&666!==e.status){let r=0===e.level?oS(e,n):e.strategy===Nf?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(oc(t),0===t.lookahead)){if(n===Zs)return 1;break}if(t.match_length=0,e=Ws(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(xr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Hr?(xr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(xr(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===u6?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(oc(t),t.lookahead<=258&&n===Zs)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=Ws(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Ws(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(xr(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Hr?(xr(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(xr(t,!1),0===t.strm.avail_out)?1:2})(e,n):Yu[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),bi;if(2===r&&(n===o6?r6(e):n!==tS&&(f0(e,0,0,!1),n===s6&&(qs(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),Tr(t),0===t.avail_out))return e.last_flush=-1,bi}return n!==Hr?bi:e.wrap<=0?nS:(2===e.wrap?(nn(e,255&t.adler),nn(e,t.adler>>8&255),nn(e,t.adler>>16&255),nn(e,t.adler>>24&255),nn(e,255&t.total_in),nn(e,t.total_in>>8&255),nn(e,t.total_in>>16&255),nn(e,t.total_in>>24&255)):(Zu(e,t.adler>>>16),Zu(e,65535&t.adler)),Tr(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?bi:nS)},deflateEnd:t=>{if(qu(t))return Ro;const n=t.state.status;return t.state=null,113===n?Ra(t,a6):bi},deflateSetDictionary:(t,n)=>{let e=n.length;if(qu(t))return Ro;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Ro;if(1===r&&(t.adler=$u(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(qs(i.head),i.strstart=0,i.block_start=0,i.insert=0);let l=new Uint8Array(i.w_size);l.set(n.subarray(e-i.w_size,e),0),n=l,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,oc(i);i.lookahead>=3;){let l=i.strstart,c=i.lookahead-2;do{i.ins_h=Ks(i,i.ins_h,i.window[l+3-1]),i.prev[l&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=l,l++}while(--c);i.strstart=l,i.lookahead=2,oc(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,bi},deflateInfo:"pako deflate (from Nodeca project)"};const H6=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var Lf={assign:function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)H6(e,i)&&(t[i]=e[i])}}return t},flattenChunks:t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e}};let cS=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cS=!1}const Xu=new Uint8Array(256);for(let t=0;t<256;t++)Xu[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Xu[254]=Xu[254]=1;var Qu={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},buf2string:(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=Xu[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&cS)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},utf8border:(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+Xu[t[e]]>n?e:n}},uS=function K6(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const dS=Object.prototype.toString,{Z_NO_FLUSH:X6,Z_SYNC_FLUSH:Q6,Z_FULL_FLUSH:J6,Z_FINISH:e8,Z_OK:Bf,Z_STREAM_END:t8,Z_DEFAULT_COMPRESSION:n8,Z_DEFAULT_STRATEGY:i8,Z_DEFLATED:r8}=Pa;function Ju(t){this.options=Lf.assign({level:n8,method:r8,chunkSize:16384,windowBits:15,memLevel:8,strategy:i8},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new uS,this.strm.avail_out=0;let e=Ku.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==Bf)throw new Error(Aa[e]);if(n.header&&Ku.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Qu.string2buf(n.dictionary):"[object ArrayBuffer]"===dS.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Ku.deflateSetDictionary(this.strm,i),e!==Bf)throw new Error(Aa[e]);this._dict_set=!0}}function E0(t,n){const e=new Ju(n);if(e.push(t,!0),e.err)throw e.msg||Aa[e.err];return e.result}Ju.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?e8:X6,e.input="string"==typeof t?Qu.string2buf(t):"[object ArrayBuffer]"===dS.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===Q6||o===J6)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Ku.deflate(e,o),r===t8)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Ku.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Bf;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Ju.prototype.onData=function(t){this.chunks.push(t)},Ju.prototype.onEnd=function(t){t===Bf&&(this.result=Lf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var h8={Deflate:Ju,deflate:E0,deflateRaw:function o8(t,n){return(n=n||{}).raw=!0,E0(t,n)},gzip:function s8(t,n){return(n=n||{}).gzip=!0,E0(t,n)},constants:Pa};const zf=16209;var p8=function(n,e){let i,r,o,s,a,l,c,u,h,g,E,L,Z,re,oe,ce,ue,be,Ke,ft,Xe,Bt,Et,lt;const zt=n.state;i=n.next_in,Et=n.input,r=i+(n.avail_in-5),o=n.next_out,lt=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),l=zt.dmax,c=zt.wsize,u=zt.whave,h=zt.wnext,g=zt.window,E=zt.hold,L=zt.bits,Z=zt.lencode,re=zt.distcode,oe=(1<<zt.lenbits)-1,ce=(1<<zt.distbits)-1;e:do{L<15&&(E+=Et[i++]<<L,L+=8,E+=Et[i++]<<L,L+=8),ue=Z[E&oe];t:for(;;){if(be=ue>>>24,E>>>=be,L-=be,be=ue>>>16&255,0===be)lt[o++]=65535&ue;else{if(!(16&be)){if(64&be){if(32&be){zt.mode=16191;break e}n.msg="invalid literal/length code",zt.mode=zf;break e}ue=Z[(65535&ue)+(E&(1<<be)-1)];continue t}for(Ke=65535&ue,be&=15,be&&(L<be&&(E+=Et[i++]<<L,L+=8),Ke+=E&(1<<be)-1,E>>>=be,L-=be),L<15&&(E+=Et[i++]<<L,L+=8,E+=Et[i++]<<L,L+=8),ue=re[E&ce];;){if(be=ue>>>24,E>>>=be,L-=be,be=ue>>>16&255,16&be){if(ft=65535&ue,be&=15,L<be&&(E+=Et[i++]<<L,L+=8,L<be&&(E+=Et[i++]<<L,L+=8)),ft+=E&(1<<be)-1,ft>l){n.msg="invalid distance too far back",zt.mode=zf;break e}if(E>>>=be,L-=be,be=o-s,ft>be){if(be=ft-be,be>u&&zt.sane){n.msg="invalid distance too far back",zt.mode=zf;break e}if(Xe=0,Bt=g,0===h){if(Xe+=c-be,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}}else if(h<be){if(Xe+=c+h-be,be-=h,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);if(Xe=0,h<Ke){be=h,Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}}}else if(Xe+=h-be,be<Ke){Ke-=be;do{lt[o++]=g[Xe++]}while(--be);Xe=o-ft,Bt=lt}for(;Ke>2;)lt[o++]=Bt[Xe++],lt[o++]=Bt[Xe++],lt[o++]=Bt[Xe++],Ke-=3;Ke&&(lt[o++]=Bt[Xe++],Ke>1&&(lt[o++]=Bt[Xe++]))}else{Xe=o-ft;do{lt[o++]=lt[Xe++],lt[o++]=lt[Xe++],lt[o++]=lt[Xe++],Ke-=3}while(Ke>2);Ke&&(lt[o++]=lt[Xe++],Ke>1&&(lt[o++]=lt[Xe++]))}break}if(64&be){n.msg="invalid distance code",zt.mode=zf;break e}ue=re[(65535&ue)+(E&(1<<be)-1)]}}break}}while(i<r&&o<a);Ke=L>>3,i-=Ke,L-=Ke<<3,E&=(1<<L)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),zt.hold=E,zt.bits=L};const g8=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),m8=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),_8=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),v8=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ed=(t,n,e,i,r,o,s,a)=>{const l=a.bits;let ue,be,Ke,ft,Xe,Et,c=0,u=0,h=0,g=0,E=0,L=0,Z=0,re=0,oe=0,ce=0,Bt=null;const lt=new Uint16Array(16),zt=new Uint16Array(16);let Kr,Xr,Xo,Xi=null;for(c=0;c<=15;c++)lt[c]=0;for(u=0;u<i;u++)lt[n[e+u]]++;for(E=l,g=15;g>=1&&0===lt[g];g--);if(E>g&&(E=g),0===g)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(h=1;h<g&&0===lt[h];h++);for(E<h&&(E=h),re=1,c=1;c<=15;c++)if(re<<=1,re-=lt[c],re<0)return-1;if(re>0&&(0===t||1!==g))return-1;for(zt[1]=0,c=1;c<15;c++)zt[c+1]=zt[c]+lt[c];for(u=0;u<i;u++)0!==n[e+u]&&(s[zt[n[e+u]]++]=u);if(0===t?(Bt=Xi=s,Et=20):1===t?(Bt=g8,Xi=m8,Et=257):(Bt=_8,Xi=v8,Et=0),ce=0,u=0,c=h,Xe=o,L=E,Z=0,Ke=-1,oe=1<<E,ft=oe-1,1===t&&oe>852||2===t&&oe>592)return 1;for(;;){Kr=c-Z,s[u]+1<Et?(Xr=0,Xo=s[u]):s[u]>=Et?(Xr=Xi[s[u]-Et],Xo=Bt[s[u]-Et]):(Xr=96,Xo=0),ue=1<<c-Z,be=1<<L,h=be;do{be-=ue,r[Xe+(ce>>Z)+be]=Kr<<24|Xr<<16|Xo|0}while(0!==be);for(ue=1<<c-1;ce&ue;)ue>>=1;if(0!==ue?(ce&=ue-1,ce+=ue):ce=0,u++,0==--lt[c]){if(c===g)break;c=n[e+s[u]]}if(c>E&&(ce&ft)!==Ke){for(0===Z&&(Z=E),Xe+=h,L=c-Z,re=1<<L;L+Z<g&&(re-=lt[L+Z],!(re<=0));)L++,re<<=1;if(oe+=1<<L,1===t&&oe>852||2===t&&oe>592)return 1;Ke=ce&ft,r[Ke]=E<<24|L<<16|Xe-o|0}}return 0!==ce&&(r[Xe+ce]=c-Z<<24|64<<16|0),a.bits=E,0};const{Z_FINISH:vS,Z_BLOCK:b8,Z_TREES:Uf,Z_OK:La,Z_STREAM_END:C8,Z_NEED_DICT:w8,Z_STREAM_ERROR:Gr,Z_DATA_ERROR:yS,Z_MEM_ERROR:bS,Z_BUF_ERROR:E8,Z_DEFLATED:CS}=Pa,Vf=16180,jf=16190,bs=16191,Hf=16199,Gf=16200,Dn=16209,$S=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function D8(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ba=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<Vf||n.mode>16211?1:0},WS=t=>{if(Ba(t))return Gr;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=Vf,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,La},ZS=t=>{if(Ba(t))return Gr;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,WS(t)},YS=(t,n)=>{let e;if(Ba(t))return Gr;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?Gr:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,ZS(t))},qS=(t,n)=>{if(!t)return Gr;const e=new D8;t.state=e,e.strm=t,e.window=null,e.mode=Vf;const i=YS(t,n);return i!==La&&(t.state=null),i};let M0,k0,KS=!0;const k8=t=>{if(KS){M0=new Int32Array(512),k0=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(ed(1,t.lens,0,288,M0,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;ed(2,t.lens,0,32,k0,0,t.work,{bits:5}),KS=!1}t.lencode=M0,t.lenbits=9,t.distcode=k0,t.distbits=5},XS=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Cs={inflateReset:ZS,inflateReset2:YS,inflateResetKeep:WS,inflateInit:t=>qS(t,15),inflateInit2:qS,inflate:(t,n)=>{let e,i,r,o,s,a,l,c,u,h,g,E,L,Z,oe,ce,ue,be,Ke,ft,Xe,Bt,re=0;const Et=new Uint8Array(4);let lt,zt;const Xi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ba(t)||!t.output||!t.input&&0!==t.avail_in)return Gr;e=t.state,e.mode===bs&&(e.mode=16192),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,h=a,g=l,Bt=La;e:for(;;)switch(e.mode){case Vf:if(0===e.wrap){e.mode=16192;break}for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(2&e.wrap&&35615===c){0===e.wbits&&(e.wbits=15),e.check=0,Et[0]=255&c,Et[1]=c>>>8&255,e.check=fi(e.check,Et,2,0),c=0,u=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",e.mode=Dn;break}if((15&c)!==CS){t.msg="unknown compression method",e.mode=Dn;break}if(c>>>=4,u-=4,Xe=8+(15&c),0===e.wbits&&(e.wbits=Xe),Xe>15||Xe>e.wbits){t.msg="invalid window size",e.mode=Dn;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&c?16189:bs,c=0,u=0;break;case 16181:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.flags=c,(255&e.flags)!==CS){t.msg="unknown compression method",e.mode=Dn;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Dn;break}e.head&&(e.head.text=c>>8&1),512&e.flags&&4&e.wrap&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=fi(e.check,Et,2,0)),c=0,u=0,e.mode=16182;case 16182:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.time=c),512&e.flags&&4&e.wrap&&(Et[0]=255&c,Et[1]=c>>>8&255,Et[2]=c>>>16&255,Et[3]=c>>>24&255,e.check=fi(e.check,Et,4,0)),c=0,u=0,e.mode=16183;case 16183:for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.head&&(e.head.xflags=255&c,e.head.os=c>>8),512&e.flags&&4&e.wrap&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=fi(e.check,Et,2,0)),c=0,u=0,e.mode=16184;case 16184:if(1024&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length=c,e.head&&(e.head.extra_len=c),512&e.flags&&4&e.wrap&&(Et[0]=255&c,Et[1]=c>>>8&255,e.check=fi(e.check,Et,2,0)),c=0,u=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(E=e.length,E>a&&(E=a),E&&(e.head&&(Xe=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+E),Xe)),512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,e.length-=E),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;E=0;do{Xe=i[o+E++],e.head&&Xe&&e.length<65536&&(e.head.name+=String.fromCharCode(Xe))}while(Xe&&E<a);if(512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,Xe)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;E=0;do{Xe=i[o+E++],e.head&&Xe&&e.length<65536&&(e.head.comment+=String.fromCharCode(Xe))}while(Xe&&E<a);if(512&e.flags&&4&e.wrap&&(e.check=fi(e.check,i,E,o)),a-=E,o+=E,Xe)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;u<16;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(4&e.wrap&&c!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Dn;break}c=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=bs;break;case 16189:for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}t.adler=e.check=$S(c),c=0,u=0,e.mode=jf;case jf:if(0===e.havedict)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,w8;t.adler=e.check=1,e.mode=bs;case bs:if(n===b8||n===Uf)break e;case 16192:if(e.last){c>>>=7&u,u-=7&u,e.mode=16206;break}for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}switch(e.last=1&c,c>>>=1,u-=1,3&c){case 0:e.mode=16193;break;case 1:if(k8(e),e.mode=Hf,n===Uf){c>>>=2,u-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Dn}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Dn;break}if(e.length=65535&c,c=0,u=0,e.mode=16194,n===Uf)break e;case 16194:e.mode=16195;case 16195:if(E=e.length,E){if(E>a&&(E=a),E>l&&(E=l),0===E)break e;r.set(i.subarray(o,o+E),s),a-=E,o+=E,l-=E,s+=E,e.length-=E;break}e.mode=bs;break;case 16196:for(;u<14;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(e.nlen=257+(31&c),c>>>=5,u-=5,e.ndist=1+(31&c),c>>>=5,u-=5,e.ncode=4+(15&c),c>>>=4,u-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Dn;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;u<3;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.lens[Xi[e.have++]]=7&c,c>>>=3,u-=3}for(;e.have<19;)e.lens[Xi[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,lt={bits:e.lenbits},Bt=ed(0,e.lens,0,19,e.lencode,0,e.work,lt),e.lenbits=lt.bits,Bt){t.msg="invalid code lengths set",e.mode=Dn;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;re=e.lencode[c&(1<<e.lenbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(ue<16)c>>>=oe,u-=oe,e.lens[e.have++]=ue;else{if(16===ue){for(zt=oe+2;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(c>>>=oe,u-=oe,0===e.have){t.msg="invalid bit length repeat",e.mode=Dn;break}Xe=e.lens[e.have-1],E=3+(3&c),c>>>=2,u-=2}else if(17===ue){for(zt=oe+3;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=oe,u-=oe,Xe=0,E=3+(7&c),c>>>=3,u-=3}else{for(zt=oe+7;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=oe,u-=oe,Xe=0,E=11+(127&c),c>>>=7,u-=7}if(e.have+E>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Dn;break}for(;E--;)e.lens[e.have++]=Xe}}if(e.mode===Dn)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Dn;break}if(e.lenbits=9,lt={bits:e.lenbits},Bt=ed(1,e.lens,0,e.nlen,e.lencode,0,e.work,lt),e.lenbits=lt.bits,Bt){t.msg="invalid literal/lengths set",e.mode=Dn;break}if(e.distbits=6,e.distcode=e.distdyn,lt={bits:e.distbits},Bt=ed(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,lt),e.distbits=lt.bits,Bt){t.msg="invalid distances set",e.mode=Dn;break}if(e.mode=Hf,n===Uf)break e;case Hf:e.mode=Gf;case Gf:if(a>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,p8(t,g),s=t.next_out,r=t.output,l=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,c=e.hold,u=e.bits,e.mode===bs&&(e.back=-1);break}for(e.back=0;re=e.lencode[c&(1<<e.lenbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(ce&&!(240&ce)){for(be=oe,Ke=ce,ft=ue;re=e.lencode[ft+((c&(1<<be+Ke)-1)>>be)],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(be+oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=be,u-=be,e.back+=be}if(c>>>=oe,u-=oe,e.back+=oe,e.length=ue,0===ce){e.mode=16205;break}if(32&ce){e.back=-1,e.mode=bs;break}if(64&ce){t.msg="invalid literal/length code",e.mode=Dn;break}e.extra=15&ce,e.mode=16201;case 16201:if(e.extra){for(zt=e.extra;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;re=e.distcode[c&(1<<e.distbits)-1],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(!(240&ce)){for(be=oe,Ke=ce,ft=ue;re=e.distcode[ft+((c&(1<<be+Ke)-1)>>be)],oe=re>>>24,ce=re>>>16&255,ue=65535&re,!(be+oe<=u);){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}c>>>=be,u-=be,e.back+=be}if(c>>>=oe,u-=oe,e.back+=oe,64&ce){t.msg="invalid distance code",e.mode=Dn;break}e.offset=ue,e.extra=15&ce,e.mode=16203;case 16203:if(e.extra){for(zt=e.extra;u<zt;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Dn;break}e.mode=16204;case 16204:if(0===l)break e;if(E=g-l,e.offset>E){if(E=e.offset-E,E>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Dn;break}E>e.wnext?(E-=e.wnext,L=e.wsize-E):L=e.wnext-E,E>e.length&&(E=e.length),Z=e.window}else Z=r,L=s-e.offset,E=e.length;E>l&&(E=l),l-=E,e.length-=E;do{r[s++]=Z[L++]}while(--E);0===e.length&&(e.mode=Gf);break;case 16205:if(0===l)break e;r[s++]=e.length,l--,e.mode=Gf;break;case 16206:if(e.wrap){for(;u<32;){if(0===a)break e;a--,c|=i[o++]<<u,u+=8}if(g-=l,t.total_out+=g,e.total+=g,4&e.wrap&&g&&(t.adler=e.check=e.flags?fi(e.check,r,g,s-g):$u(e.check,r,g,s-g)),g=l,4&e.wrap&&(e.flags?c:$S(c))!==e.check){t.msg="incorrect data check",e.mode=Dn;break}c=0,u=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;u<32;){if(0===a)break e;a--,c+=i[o++]<<u,u+=8}if(4&e.wrap&&c!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Dn;break}c=0,u=0}e.mode=16208;case 16208:Bt=C8;break e;case Dn:Bt=yS;break e;case 16210:return bS;default:return Gr}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,e.hold=c,e.bits=u,(e.wsize||g!==t.avail_out&&e.mode<Dn&&(e.mode<16206||n!==vS))&&XS(t,t.output,t.next_out,g-t.avail_out),h-=t.avail_in,g-=t.avail_out,t.total_in+=h,t.total_out+=g,e.total+=g,4&e.wrap&&g&&(t.adler=e.check=e.flags?fi(e.check,r,g,t.next_out-g):$u(e.check,r,g,t.next_out-g)),t.data_type=e.bits+(e.last?64:0)+(e.mode===bs?128:0)+(e.mode===Hf||16194===e.mode?256:0),(0===h&&0===g||n===vS)&&Bt===La&&(Bt=E8),Bt},inflateEnd:t=>{if(Ba(t))return Gr;let n=t.state;return n.window&&(n.window=null),t.state=null,La},inflateGetHeader:(t,n)=>{if(Ba(t))return Gr;const e=t.state;return 2&e.wrap?(e.head=n,n.done=!1,La):Gr},inflateSetDictionary:(t,n)=>{const e=n.length;let i,r,o;return Ba(t)||(i=t.state,0!==i.wrap&&i.mode!==jf)?Gr:i.mode===jf&&(r=1,r=$u(r,n,e,0),r!==i.check)?yS:(o=XS(t,n,e,e),o?(i.mode=16210,bS):(i.havedict=1,La))},inflateInfo:"pako inflate (from Nodeca project)"},$8=function G8(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const QS=Object.prototype.toString,{Z_NO_FLUSH:W8,Z_FINISH:Z8,Z_OK:td,Z_STREAM_END:I0,Z_NEED_DICT:O0,Z_STREAM_ERROR:Y8,Z_DATA_ERROR:JS,Z_MEM_ERROR:q8}=Pa;function nd(t){this.options=Lf.assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(15&n.windowBits||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new uS,this.strm.avail_out=0;let e=Cs.inflateInit2(this.strm,n.windowBits);if(e!==td)throw new Error(Aa[e]);if(this.header=new $8,Cs.inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Qu.string2buf(n.dictionary):"[object ArrayBuffer]"===QS.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=Cs.inflateSetDictionary(this.strm,n.dictionary),e!==td)))throw new Error(Aa[e])}function A0(t,n){const e=new nd(n);if(e.push(t),e.err)throw e.msg||Aa[e.err];return e.result}nd.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?Z8:W8,e.input="[object ArrayBuffer]"===QS.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Cs.inflate(e,s),o===O0&&r&&(o=Cs.inflateSetDictionary(e,r),o===td?o=Cs.inflate(e,s):o===JS&&(o=O0));e.avail_in>0&&o===I0&&e.state.wrap>0&&0!==t[e.next_in];)Cs.inflateReset(e),o=Cs.inflate(e,s);switch(o){case Y8:case JS:case O0:case q8:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===I0))if("string"===this.options.to){let l=Qu.utf8border(e.output,e.next_out),c=e.next_out-l,u=Qu.buf2string(e.output,l);e.next_out=c,e.avail_out=i-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(u)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==td||0!==a){if(o===I0)return o=Cs.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},nd.prototype.onData=function(t){this.chunks.push(t)},nd.prototype.onEnd=function(t){t===td&&(this.result="string"===this.options.to?this.chunks.join(""):Lf.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var nz={Inflate:nd,inflate:A0,inflateRaw:function K8(t,n){return(n=n||{}).raw=!0,A0(t,n)},ungzip:A0,constants:Pa};const{Deflate:iz}=h8,{Inflate:az}=nz;var eD=iz,tD=az;function P0(){return(P0=(0,Dt.Z)(function*(t,n){const e=new eD({level:2,gzip:!0});try{return yield nD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function F0(){return(F0=(0,Dt.Z)(function*(t,n){const e=new tD;try{return yield nD(e,t,n),e.result}catch(i){console.error(i)}return null})).apply(this,arguments)}function nD(t,n){return N0.apply(this,arguments)}function N0(){return(N0=(0,Dt.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield new Promise(t=>Ni(t)),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t})).apply(this,arguments)}var Sr,t,iD=Y(2391);(t=Sr||(Sr={})).encode=function n(i){try{return iD.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return iD.decode(i)}catch(r){console.error(r,i)}return null};class R0{get hasPassword(){return this.peers.some(n=>n.hasPassword)}constructor(n="",e="",i=[]){this.id="",this.name="",this.peers=[],this.id=n,this.name=e,this.peers=i}filterByPassword(n){return this.peers.filter(e=>e.verifyPassword(n))}static listFrom(n){let e=n.map(o=>xn.parse(o)).sort((o,s)=>o.peerId>s.peerId?1:o.peerId<s.peerId?-1:0),i=new Map;for(let o of e)if(o.isRoom){let s=o.roomId+o.roomName,a=i.get(s)??new R0(o.roomId,o.roomName);a.peers.push(o),i.set(s,a)}return i.size<1?[]:Array.from(i.values()).sort((o,s)=>o.id+o.name<s.id+s.name?-1:o.id+o.name>s.id+s.name?1:0)}}var Cz=Y(9069);class zo{get isActive(){return null!=this.timeoutTimer}constructor(n,e,i=!0){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,i&&this.reset()}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class $f{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new zo(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,8e3)}static doMonitoringAsync(){var n=this;return(0,Dt.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}$f.updateWebRTCStatsTimer=null,$f.monitoringConnections=new Set;var $r=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}($r||($r={})),$r))();class wz{constructor(n){this.peerConnection=n,this.candidateType=$r.UNKNOWN}updateAsync(){var n=this;return(0,Dt.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(g){console.warn(g)}if(null==e)return void(n.candidateType=$r.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],l=[],c=[];e.forEach(g=>{0<=g.type.indexOf("candidate-pair")&&i.push(g),0<=g.type.indexOf("local-candidate")&&r.push(g),0<=g.type.indexOf("remote-candidate")&&o.push(g)}),i.forEach(g=>{"succeeded"===g.state&&(s.push(g.localCandidateId),a.push(g.remoteCandidateId))}),r.forEach(g=>{s.includes(g.id)&&l.push(g)}),o.forEach(g=>{a.includes(g.id)&&c.push(g)});let u=$r.UNKNOWN,h=Object.values($r);l.concat(c).forEach(g=>{let E=h.indexOf(g.candidateType);h.indexOf(u)<E&&(u=h[E])}),n.candidateType=u})()}}class rD extends Cz.EventEmitter{get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){return this.conn._dc?.bufferedAmount??0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}constructor(n,e){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=$r.UNKNOWN,this.peer=xn.parse(e.peerId),this.peer.userId=e.userId,this.peer.password=e.password,n.on("data",i=>this.onData(i)),n.on("open",()=>{this.stats=new wz(this.getPeerConnection()),this.peer.isOpen=!0,this.clearTimeoutTimer(),function Ez(t){t._dc&&t._sendBuffer&&(t._startSendLoop=Tz)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.peer.isOpen=!1,this.clearTimeoutTimer(),this.emit("close")}),n.on("error",i=>{this.clearTimeoutTimer(),this.emit("error",i)}),this.setTimeoutTimer()}close(){this.peer.isOpen=!1,this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=Sr.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=Lu.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(Sr.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){$f.add(this)}stopMonitoring(){$f.remove(this)}updateStatsAsync(){var n=this;return(0,Dt.Z)(function*(){if(null==n.stats)return;n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType;let e=performance.now()-n.timestamp,i=e<=1e4?1:5e3/(e-1e4+5e3),r=i<1?e:n.ping,o=500/(r+500);switch(n.peer.session.health=i,n.peer.session.ping=r,n.peer.session.speed=o*i,n.candidateType){case $r.HOST:n.peer.session.grade=$s.HIGH;break;case $r.SRFLX:case $r.PRFLX:n.peer.session.grade=$s.MIDDLE;break;case $r.RELAY:n.peer.session.grade=$s.LOW;break;default:n.peer.session.grade=$s.UNSPECIFIED}n.peer.session.description=n.candidateType,n.emit("stats",n.stats)})()}sendPing(){let n=Sr.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=Sr.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=Sr.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let c of o.chanks)s.set(c,a),a+=c.byteLength;let l=Sr.decode(s);this.emit("data",l)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function Tz(){this.sendInterval||(this.sendInterval=Ni(oD.bind(this)))}function oD(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch{this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Ni(oD.bind(this))}class xz{constructor(){this.connections=[],this.needsRefreshPeers=!1,this._peers=[],this.needsRefreshPeerIds=!1,this._peerIds=[]}get length(){return this.connections.length}[Symbol.iterator](){let n=this.connections.concat(),e=0;return{next:()=>({value:n[e++],done:n.length+1<=e})}}get peers(){return this.needsRefreshPeers&&(this.needsRefreshPeers=!1,this._peers=this.connections.map(n=>n.peer),this._peers.sort((n,e)=>n.peerId>e.peerId?1:n.peerId<e.peerId?-1:0)),this._peers}get peerIds(){if(this.needsRefreshPeerIds){this.needsRefreshPeerIds=!1;let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);n.sort((e,i)=>e>i?1:e<i?-1:0),this._peerIds=n}return this._peerIds}add(n){let e=this.find(n.remoteId);if(null!=e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting.",e),e!==n){if(!(e.metadata.sortKey<n.metadata.sortKey))return this.remove(e),this.add(n);this.remove(n)}return null}return this.connections.push(n),this.refresh(),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),n}remove(n){n.close();let e=this.connections.indexOf(n);return 0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.refresh()),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length),0<=e?n:null}find(n){return this.connections.find(e=>e.remoteId===n)}refresh(){this.needsRefreshPeers=!0,this.needsRefreshPeerIds=!0}}class Sz{constructor(){this.peer=xn.parse("???"),this.callback=new kx,this.bandwidthUsage=0,this.key="",this.connections=new xz,this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get userIds(){return this.peers.map(n=>n.userId).filter(n=>0<n.length).concat([this.peer.userId])}get peerId(){return this.peer.peerId}get peerIds(){return this.connections.peerIds}get peers(){return this.connections.peers}open(...n){console.log("open",n),this.peer=0===n.length?xn.create(xn.generateId()):1===n.length?xn.create(n[0]):xn.create(n[0],n[1],n[2],n[3]),this.openSkyWay()}close(){this.skyWay&&this.skyWay.destroy(),this.disconnectAll(),this.skyWay=null,this.peer=xn.parse("???")}connect(n){if(!this.shouldConnect(n.peerId))return!1;let e=new rD(this.skyWay.connect(n.peerId,{serialization:"none",metadata:{sortKey:this.peer.digestUserId,token:this.peer.isRoom?"":sD(this.peer.digestUserId+n.userId)}}),n);return this.openDataConnection(e),!0}shouldConnect(n){return this.peer&&this.skyWay&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.connections.find(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):this.peer.verifyPeer(n)?!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. <"+n+"> is not valid."),!1):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.connections.find(n.peerId);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections)this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:Sr.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Ni((0,Dt.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let l=yield function vz(t,n){return P0.apply(this,arguments)}(r.data);l.byteLength<r.data.byteLength&&(r.data=l,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.connections.find(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.skyWay)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.skyWay.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}listAllRooms(){var n=this;return(0,Dt.Z)(function*(){let e=yield n.listAllPeers();return R0.listFrom(e)})()}openSkyWay(){this.skyWay&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peer.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),this.peer.peerId===e?(this.peer.isOpen=!0,console.log("My peer Context",this.peer),this.callback.onOpen&&this.callback.onOpen(this.peer)):console.error("...peer is not me? <"+e+">",this.peer)}),n.on("close",()=>{console.log("Peer close"),this.peer.isOpen&&(this.peer.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peer))}),n.on("connection",e=>{let i=this.peer.verifyPeer(e.remoteId),r=this.peer.isRoom||e.metadata.token===sD(e.metadata.sortKey+this.peer.userId);if(!i||!r)return e.close(),e.on("open",()=>e.close()),void console.log("connection is close. <"+e.remoteId+"> is not valid.");let o=xn.parse(e.remoteId);this.openDataConnection(new rD(e,o))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(xn.parse(r));break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peer&&this.peer.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peer))}this.callback.onError&&this.callback.onError(this.peer,e.type,i,e)}),this.skyWay=n}openDataConnection(n){null!=this.connections.add(n)&&(this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",e=>{this.onData(n,e)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),this.notifyUserList(),this.callback.onConnect&&this.callback.onConnect(n.peer)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{n.peer.session.health<.2&&this.closeDataConnection(n)}))}closeDataConnection(n){let e=this.connections.remove(n);this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),this.notifyUserList(),e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.peer)}onData(n,e){var i=this;if(e.users&&0<e.users.length&&this.onUpdateUserIds(n,e.users),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Ni((0,Dt.Z)(function*(){let a=e.isCompressed?yield function yz(t,n){return F0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.peer,Sr.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i){e.users&&0<e.users.length&&(e.users=this.userIds);for(let r of i){let o=this.connections.find(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}}onUpdateUserIds(n,e){let i=!1;e.forEach(a=>{let l=this.makeFriendPeer(a),c=this.connections.find(l.peerId);c&&c.peer.userId!==a&&(c.peer.userId=a,i=!0)});let r=function Dz(t,n){let e=[],i=[],r=!1,o=!1;for(let s of t.concat(n))r=t.includes(s),o=n.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this.userIds,e),s=r.diff2;if(this.relayingPeerIds.set(n.remoteId,r.diff1.map(a=>this.makeFriendPeer(a).peerId)),s.length)for(let a of s){let l=this.makeFriendPeer(a);!this.maybeUnavailablePeerIds.has(l.peerId)&&this.connect(l)&&console.log("auto connect to unknown Peer <"+l.peerId+">")}i&&this.notifyUserList()}notifyUserList(){if(this.connections.refresh(),this.connections.length<1)return;let n={data:Sr.encode([]),users:this.userIds,ttl:1};this.sendBroadcast(n)}makeFriendPeer(n){return this.peer.isRoom?xn.create(n,this.peer.roomId,this.peer.roomName,this.peer.password):xn.create(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}function sD(t){if(null==t)return"";let n=t0(t),e=Uint32Array.from(n.words).buffer;return btoa(String.fromCharCode(...new Uint8Array(e)))}const aD=xn.parse("???");class Uo{static get instance(){return Uo._instance||(Uo._instance=new Uo),Uo._instance}get isOpen(){return!!this.connection&&this.connection.peer.isOpen}get peerId(){return this.connection?this.connection.peerId:aD.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peer(){return this.connection?this.connection.peer:aD}get peers(){return this.connection?this.connection.peers.concat():[]}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}constructor(){this.callback=new kx,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}open(...n){this.connection&&this.connection.peer&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){this.connection&&this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n.peerId),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Ni(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peer,i)),this.sendInterval=0<this.queue.size?Ni(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}listAllRooms(){return this.connection?this.connection.listAllRooms():Promise.resolve([])}initializeConnection(){let n=new Sz;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Ni(this.sendCallback)),n}}class lc{constructor(n,e,i=Uo.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Uo.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class L0{get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new L0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class za{static get instance(){return za._instance||(za._instance=new za,za._instance.initializeNetworkEvent()),za._instance}constructor(){this.listenerMap=new Map,this.keyMap=new Map,console.log("EventSystem ready...")}register(n){return new L0(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=[];if(null!=n)r=this.getListenersByKey(n);else if(null!=e)r=this.getListenersByEventName(e);else{let o=this.listenerMap.values();for(let s of o)r=r.concat(s)}for(let o of r.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListenersByEventName(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),e=this.getListenersByKey(n.key),e.push(n),this.keyMap.set(n.key,e),n}unregisterListener(n){let e=this.getListenersByEventName(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),e.length<1&&this.listenerMap.delete(n.eventName),e=this.getListenersByKey(n.key),i=e.indexOf(n),0<=i&&e.splice(i,1),e.length<1&&this.keyMap.delete(n.key),n.unregister(),n)}call(...n){"string"==typeof n[0]?this._call(new lc(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();Uo.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof lc?n[0]:new lc(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new lc(n[0],n[1]))}_trigger(n){let e=this.getListenersByEventName(n.eventName).concat(this.getListenersByEventName("*"));for(let i of e)i.trigger(n);return n}getListenersByEventName(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}getListenersByKey(n){return this.keyMap.has(n)?this.keyMap.get(n):[]}initializeNetworkEvent(){let n=Uo.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e.peerId})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e.peerId})},n.onConnect=e=>{this.sendSystemMessage("<"+e.userId+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e.peerId})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e.userId+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e.peerId})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e.userId+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e.peerId,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const fe=za.instance,We=Uo.instance;class Be{static get instance(){return Be._instance||(Be._instance=new Be),Be._instance}constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&fe.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}fe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Ni(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;o.value[1]+n<e||this.garbageMap.delete(o.value[0])}}}class Xs{static get aliasName(){return Fo.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}constructor(n=Lu.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}initialize(){Be.instance.add(this)}destroy(){Be.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Be.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return Tn.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:lD(this.context.syncData)}}toXml(){return Tn.instance.toXml(this)}}function lD(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=lD(t[i]):"function"!==r&&(n[i]=t[i])}return n}const B0=new Map,z0=new Set;let U0=!1;function cD(t,n=We.peerId){B0.set(t.identifier,{object:t,originFrom:n}),t instanceof Ci&&V0(t.parent),uD()}function V0(t){let n=t;for(;n&&(z0.add(n.identifier),n=n.parent,n!==t););uD()}function uD(){U0||(queueMicrotask(Mz),U0=!0)}const Mz=()=>{U0=!1;let t=Array.from(B0.values()),n=Array.from(z0.values());B0.clear(),z0.clear();for(let e of t){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};fe.trigger(new lc(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),fe.trigger(new lc(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of n)fe.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};var j0;const Ua={};let Ci=j0=class extends Xs{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Be.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Be.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Be.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){V0(this);let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){V0(this);let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==Ua[this.identifier])return;let n=Ua[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Ua[this.identifier]&&delete Ua[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return Tn.toAttributes(this.attributes)}parseAttributes(n){Tn.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=vs.encodeEntityReference(this.value+"");for(let e of this.children)n+=Tn.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=Tn.instance.parseXml(e[r]);o instanceof j0&&this.appendChild(o)}else this.value=vs.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Ua||(Ua[this.parentIdentifier]=[]),Ua[this.parentIdentifier].push(this))}};function Wn(t){return n=>Sx(t)(n)}function ot(){return(t,n)=>{t instanceof Ci?function CB(){return(t,n)=>{Dx(t,xx,n)}}()(t,n):Ql()(t,n)}}K([Ql()],Ci.prototype,"value",void 0),K([Ql()],Ci.prototype,"attributes",void 0),K([Ql()],Ci.prototype,"parentIdentifier",void 0),K([Ql()],Ci.prototype,"majorIndex",void 0),K([Ql()],Ci.prototype,"minorIndex",void 0),Ci=j0=K([Sx("node")],Ci);var ws,Va,mo=(()=>(function(t){t[t.None=0]="None",t[t.IgnoreCase=1]="IgnoreCase",t[t.IgnoreWidth=2]="IgnoreWidth"}(mo||(mo={})),mo))();!function(t){function n(r){return r.replace(/[\uff01-\uff5e]/g,o=>String.fromCharCode(o.charCodeAt(0)-65248))}function i(r,o){if(o===mo.None)return r;let s=r;return o&mo.IgnoreCase&&(s=s.toLocaleLowerCase()),o&mo.IgnoreWidth&&(s=n(s)),s}t.toHalfWidth=n,t.equals=function e(r,o,s=mo.None){return r.length===o.length&&(r===o||i(r,s)===i(o,s))},t.normalize=i}(ws||(ws={}));let rt=Va=class extends Ci{get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isNote(){return null!=this.type&&"note"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new Va(r):new Va,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}getElementsByName(n,e=mo.None){let i=[];for(let r of this.children)r instanceof Va&&(ws.equals(r.getAttribute("name"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByName(n,e)));return i}getElementsByType(n,e=mo.None){let i=[];for(let r of this.children)r instanceof Va&&(ws.equals(r.getAttribute("type"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByType(n,e)));return i}getFirstElementByName(n,e=mo.None){for(let i of this.children)if(i instanceof Va){if(ws.equals(i.getAttribute("name"),n,e))return i;let r=i.getFirstElementByName(n,e);if(r)return r}return null}};var H0;K([ot()],rt.prototype,"name",void 0),K([ot()],rt.prototype,"type",void 0),K([ot()],rt.prototype,"currentValue",void 0),rt=Va=K([Wn("data")],rt),function(t){t.resize=function n(e,i,r,o){let s=e.width,a=e.height,l=s/(i=Math.round(i)),c=a/(r=Math.round(r)),u=Math.ceil(l/2),h=Math.ceil(c/2),g=e.getContext("2d"),E=g.getImageData(0,0,s,a),L=g.createImageData(i,r),Z=E.data,re=L.data;for(let oe=0;oe<r;oe++)for(let ce=0;ce<i;ce++){let ue=4*(ce+oe*i),be=0,Ke=0,ft=0,Xe=0,Bt=0,Et=0,lt=0,zt=(oe+.5)*c,Xi=Math.floor(oe*c),Kr=Math.ceil((oe+1)*c);for(let Xr=Xi;Xr<Kr;Xr++){let Xo=Math.abs(zt-(Xr+.5))/h,tt=(ce+.5)*l,ht=Xo*Xo,_t=Math.floor(ce*l),Qt=Math.ceil((ce+1)*l);for(let Fn=_t;Fn<Qt;Fn++){let kr=Math.abs(tt-(Fn+.5))/u,ii=Math.sqrt(ht+kr*kr);if(ii>=1)continue;be=2*ii*ii*ii-3*ii*ii+1;let Qi=4*(Fn+Xr*s);lt+=be*Z[Qi+3],ft+=be,Z[Qi+3]<255&&(be=be*Z[Qi+3]/250),Xe+=be*Z[Qi],Bt+=be*Z[Qi+1],Et+=be*Z[Qi+2],Ke+=be}}re[ue]=Xe/Ke,re[ue+1]=Bt/Ke,re[ue+2]=Et/Ke,re[ue+3]=lt/ft}!0===o?(e.width=i,e.height=r):g.clearRect(0,0,s,a),g.putImageData(L,0,0)}}(H0||(H0={}));var _o,kz=Y(7412);!function(t){function r(){return r=(0,Dt.Z)(function*(l){return l instanceof Blob?function o(l){return s.apply(this,arguments)}(l):a(l)}),r.apply(this,arguments)}function s(){return(s=(0,Dt.Z)(function*(l){return a(yield t.readAsArrayBufferAsync(l))})).apply(this,arguments)}function a(l){let c=kz.create(l);return t0(c).toString()}t.readAsArrayBufferAsync=function n(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsArrayBuffer(l)})},t.readAsTextAsync=function e(l){return new Promise((c,u)=>{let h=new FileReader;h.onload=g=>{c(h.result)},h.onabort=h.onerror=g=>{u(g)},h.readAsText(l)})},t.calcSHA256Async=function i(l){return r.apply(this,arguments)}}(_o||(_o={}));var id,Vn,wi=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(wi||(wi={})),wi))();class gn{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?wi.URL:this.blob===this.thumbnail.blob?wi.THUMBNAIL:wi.COMPLETE:wi.NULL}get isEmpty(){return this.state<=wi.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}static createEmpty(n){let e=new gn;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new gn;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new gn;return e.apply(n),e}}static createAsync(n){return(0,Dt.Z)(function*(){return n instanceof File?yield gn._createAsync(n,n.name):n instanceof Blob?yield gn._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Dt.Z)(function*(){let i=yield _o.readAsArrayBufferAsync(n),r=new gn;r.context.identifier=yield _o.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield gn.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==wi.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==wi.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,l=r.height*s,c=document.createElement("canvas"),u=c.getContext("2d");c.width=r.width,c.height=r.height,u.drawImage(r,0,0),H0.resize(c,a,l,!0),c.toBlob(h=>{let g={type:h.type,blob:h,url:window.URL.createObjectURL(h)};e(g)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}gn.Empty=gn.createEmpty("null");class At{static get instance(){return At._instance||(At._instance=new At),At._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}constructor(){this.imageHash={},console.log("ImageStorage ready...")}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,Dt.Z)(function*(){let i=yield gn.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=gn.create(n);else if(n instanceof gn)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=gn.create(n)}return this._add(e)}_add(n){return wi.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof gn?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),fe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new zo(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)wi.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let Rt=((id=class extends Xs{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier=""}get isMine(){return Vn.myCursor&&Vn.myCursor===this}get image(){return At.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||fe.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{We.peerIds.includes(this.peerId)||(Vn.userIdMap.delete(this.userId),Vn.peerIdMap.delete(this.peerId),Be.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),fe.unregister(this),Vn.userIdMap.delete(this.userId),Vn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(Vn.userIdMap,n,!0)}static findByPeerId(n){return this.find(Vn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&Be.instance.get(r))return Be.instance.get(r);let o=Be.instance.getObjects(Vn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return Vn.myCursor?(console.warn("It is already created."),Vn.myCursor):(Vn.myCursor=new Vn,Vn.myCursor.peerId=We.peerId,Vn.myCursor.initialize(),Vn.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(Vn.userIdMap.set(e,this.identifier),Vn.userIdMap.delete(this.userId)),i!==this.peerId&&(Vn.peerIdMap.set(i,this.identifier),Vn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}}).myCursor=null,id.userIdMap=new Map,id.peerIdMap=new Map,Vn=id);var rn;K([ot()],Rt.prototype,"userId",void 0),K([ot()],Rt.prototype,"peerId",void 0),K([ot()],Rt.prototype,"name",void 0),K([ot()],Rt.prototype,"imageIdentifier",void 0),Rt=Vn=K([Wn("PeerCursor")],Rt),function(t){t.sqrMagnitude=function n(s,a={x:0,y:0,z:0}){return(s.x-a.x)**2+(s.y-a.y)**2+((s.z??0)-(a.z??0))**2},t.clampMin=function e(s,a=0){return s<a?a:s},t.clampMax=function i(s,a=100){return s<a?s:a},t.radians=function r(s){return s*Math.PI/180},t.degrees=function o(s){return 180*s/Math.PI}}(rn||(rn={}));let cr=class extends Ci{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=gn.Empty,this._dataElements={}}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageDataElement.getFirstElementByName("imageIdentifier");if(n&&this._imageFile.identifier!==n.value){let e=At.instance.get(n.value);this._imageFile=e||gn.Empty}return this._imageFile}calcSqrDistance(n){return rn.sqrMagnitude({x:this.location.x,y:this.location.y,z:this.posZ},{x:n.location.x,y:n.location.y,z:n.posZ})}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=rt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(rt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(rt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(rt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(rt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?Be.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);i&&(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?At.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;i&&(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};function G0(t,n=[]){let e=hD(t.aliasName,n),i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function dD(t,n=[]){let e=hD(t.aliasName,n),i=Number.MAX_SAFE_INTEGER,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:e[o].zindex<i&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i-1,!(0<=t.zindex))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function hD(t,n){let e=Be.instance.getObjects(t);return n.forEach(i=>e=e.concat(Be.instance.getObjects(i))),e=e.filter(i=>i.isVisibleOnTable),e}K([ot()],cr.prototype,"location",void 0),K([ot()],cr.prototype,"posZ",void 0),cr=K([Wn("TabletopObject")],cr);var Wf,Es=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(Es||(Es={})),Es))();let ur=Wf=class extends cr{constructor(){super(...arguments),this.state=Es.FRONT,this.rotate=0,this.owner="",this.zindex=0}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isHand||We.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isHand(){return We.peer.userId===this.owner}get isFront(){return this.state===Es.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=Es.FRONT,this.owner=""}faceDown(){this.state=Es.BACK,this.owner=""}toTopmost(){G0(this,["card-stack"])}toBackmost(){dD(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new Wf(o):new Wf,s.createDataElements(),s.commonDataElement.appendChild(rt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(rt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(rt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(rt.create("back",i,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};var Zf;K([ot()],ur.prototype,"state",void 0),K([ot()],ur.prototype,"rotate",void 0),K([ot()],ur.prototype,"owner",void 0),K([ot()],ur.prototype,"zindex",void 0),ur=Wf=K([Wn("card")],ur);let pi=Zf=class extends cr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){G0(this,["card"])}toBackmost(){dD(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Zf(e):new Zf,i.createDataElements(),i.commonDataElement.appendChild(rt.create("name",n,{},"name_"+i.identifier));let r=new Ci("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};K([ot()],pi.prototype,"rotate",void 0),K([ot()],pi.prototype,"zindex",void 0),K([ot()],pi.prototype,"owner",void 0),K([ot()],pi.prototype,"isShowTotal",void 0),pi=Zf=K([Wn("card-stack")],pi);var Ri=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Ri||(Ri={})),Ri))();class Dr{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Ri.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Ri.URL:Ri.COMPLETE:Ri.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}static createEmpty(n){let e=new Dr;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Dr;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Dr;return e.apply(n),e}}static createAsync(n){return(0,Dt.Z)(function*(){return n instanceof File?yield Dr._createAsync(n,n.name):n instanceof Blob?yield Dr._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Dt.Z)(function*(){let i=yield _o.readAsArrayBufferAsync(n),r=new Dr;return r.context.identifier=yield _o.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Ri.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Ri.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var ja,cc=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION"}(cc||(cc={})),cc))();class it{static get audioContext(){return it._audioContext||(it._audioContext=new(window.AudioContext||window.webkitAudioContext)),it._audioContext}static get volume(){return it._volume}static set volume(n){it._volume=n,it.masterGainNode.gain.setTargetAtTime(it._volume,it.audioContext.currentTime,.01)}static get auditionVolume(){return it._auditionVolume}static set auditionVolume(n){it._auditionVolume=n,it.auditionGainNode.gain.setTargetAtTime(it._auditionVolume,it.audioContext.currentTime,.01)}static get masterGainNode(){if(!it._masterGainNode){let n=it.audioContext.createGain();n.gain.setValueAtTime(it._volume,it.audioContext.currentTime),n.connect(it.audioContext.destination),it._masterGainNode=n}return it._masterGainNode}static get auditionGainNode(){if(!it._auditionGainNode){let n=it.audioContext.createGain();n.gain.setValueAtTime(it._auditionVolume,it.audioContext.currentTime),n.connect(it.audioContext.destination),it._auditionGainNode=n}return it._auditionGainNode}static get rootNode(){return it.masterGainNode}static get auditionNode(){return it.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=it.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}constructor(n){this.volumeType=cc.MASTER,this.audio=n}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Ri.URL&&(it.cacheMap.has(n.identifier)?e=it.cacheMap.get(n.identifier).url:it.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===cc.AUDITION?it.auditionNode:it.rootNode}static playBufferAsync(n,e=1){return(0,Dt.Z)(function*(){let i=yield it.createBufferSourceAsync(n);if(!i)return;let r=it.audioContext.createGain();r.gain.setValueAtTime(e,it.audioContext.currentTime),r.connect(it.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,Dt.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Ri.URL)if(it.cacheMap.has(n.identifier))i=it.cacheMap.get(n.identifier).blob;else{let s=yield it.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=it.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,Dt.Z)(function*(i,r){it.audioContext.decodeAudioData(yield _o.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,Dt.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,Dt.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield it.getBlobAsync(n)}catch(i){return console.error(i),e}return it.cacheMap.has(n.identifier)?it.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),it.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){it.audioContext.resume();let n=()=>{it.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}it._volume=.5,it._auditionVolume=.5,it.cacheMap=new Map;class st{static get instance(){return st._instance||(st._instance=new st),st._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}constructor(){this.hash={},console.log("AudioStorage ready...")}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,Dt.Z)(function*(){let i=yield Dr.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Dr.create(n);else if(n instanceof Dr)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Dr.create(n)}return this._add(e)}_add(n){return Ri.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Dr?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),fe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new zo(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of st.instance.audios)Ri.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let Ee=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.selectionStart="",t})(),Re=ja=class extends Xs{onStoreAdded(){super.onStoreAdded(),fe.register(this).on("SOUND_EFFECT",n=>{it.play(st.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=Be.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||!e.isDicebot||(Math.random()<.5?ja.play(Ee.diceRoll1):ja.play(Ee.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),fe.unregister(this)}play(n){ja.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,ja._play(e)}static _play(n){fe.call("SOUND_EFFECT",n)}static playLocal(n){let e="";e="string"==typeof n?n:n.identifier,ja._playLocal(e)}static _playLocal(n){fe.trigger("SOUND_EFFECT",n)}};Re=ja=K([Wn("sound-effect")],Re);let dn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){r||(r=t.defaultParentViewContainerRef);let s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector}),a=s.instance.content.createComponent(e);const l=s.injector.get(t);l.panelComponentRef=s,i&&(i.title&&(l.title=i.title),i.top&&(l.top=i.top),i.left&&(l.left=i.left),i.width&&(l.width=i.width),i.height&&(l.height=i.height)),s.onDestroy(()=>{l.panelComponentRef=null,s=null}),a.onDestroy(()=>{a=null});let c=s.instance,u=a.instance;return(null!=c?.ngOnChanges||null!=u?.ngOnChanges)&&queueMicrotask(()=>{a&&null!=u?.ngOnChanges&&u?.ngOnChanges({}),s&&null!=c?.ngOnChanges&&c?.ngOnChanges({})}),a.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class Iz{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Li=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){return r||(r=t.defaultParentViewContainerRef),new Promise((o,s)=>{const c=new t;c.modalContext=new Iz(re=>{g&&(g.destroy(),o(re),this.count--)},re=>{g&&(g.destroy(),s(re),this.count--)},i);const h=Do.create({providers:[{provide:t,useValue:c}],parent:r.injector});let g=r.createComponent(t.ModalComponentClass,{index:r.length,injector:h}),E=g.instance.content.createComponent(e);g.onDestroy(()=>{g=null,this.count--}),E.onDestroy(()=>{E=null,this.count--}),this.count++;let L=g.instance,Z=E.instance;(null!=L?.ngOnChanges||null!=Z?.ngOnChanges)&&queueMicrotask(()=>{E&&Z?.ngOnChanges({}),g&&L?.ngOnChanges({})})})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),Jn=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(J(zE,16))},t.\u0275pipe=Vi({name:"safe",type:t,pure:!0}),t})();function Oz(t,n){if(1&t){const e=et();O(0,"span",3)(1,"button",4),ge("click",function(){Me(e);const r=H();return ke(r.onSelectedFile(r.empty))}),Q(2,"\u753b\u50cf\u306a\u3057"),F()()}}function Az(t,n){if(1&t){const e=et();O(0,"img",8),ge("click",function(){Me(e);const r=H().$implicit;return ke(H().onSelectedFile(r))}),Zt(1,"safe"),F()}if(2&t){const e=H().$implicit;D("src",Yt(1,2,e.url,"resourceUrl"),Kn)("alt",e.name)}}function Pz(t,n){1&t&&Le(0,"img",9),2&t&&vn("alt",H().$implicit.name)}function Fz(t,n){if(1&t&&(O(0,"span",5),X(1,Az,2,5,"img",6),X(2,Pz,1,1,"img",7),F()),2&t){const e=n.$implicit;k(1),D("ngIf",0<e.url.length),k(1),D("ngIf",e.url.length<=0)}}let Yf=(()=>{class t{get images(){return At.instance.images}get empty(){return gn.Empty}constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){fe.unregister(this)}onSelectedFile(e){fe.call("SELECT_FILE",{fileIdentifier:e.identifier},We.peerId),this.modalService.resolve(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(J(Oi),J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:3,vars:2,consts:[["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],[1,"empty"],[3,"click"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","./assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","./assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(O(0,"div",0),X(1,Oz,3,0,"span",1),X(2,Fz,3,2,"span",2),F()),2&e&&(k(1),D("ngIf",i.isAllowedEmpty),k(1),D("ngForOf",i.images))},dependencies:[Un,fn,Jn],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}"],changeDetection:0}),t})(),dr=class extends Ci{constructor(){super(...arguments),this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return At.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===We.peer.userId||this.originFrom===We.peer.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(We.peer.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!(!this.isSystem||"System-BCDice"!==this.from)}get isSecret(){return-1<this.tags.indexOf("secret")}};K([ot()],dr.prototype,"originFrom",void 0),K([ot()],dr.prototype,"from",void 0),K([ot()],dr.prototype,"to",void 0),K([ot()],dr.prototype,"name",void 0),K([ot()],dr.prototype,"tag",void 0),K([ot()],dr.prototype,"dicebot",void 0),K([ot()],dr.prototype,"imageIdentifier",void 0),dr=K([Wn("chat")],dr);let uc=class extends Ci{constructor(){super(...arguments),this.name="\u30bf\u30d6",this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof dr&&n.isDisplayable&&(this._unreadLength++,fe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new dr;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),fe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof dr&&!e.isDisplayable||(n+=Tn.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}};var Wr;K([ot()],uc.prototype,"name",void 0),uc=K([Wn("chat-tab")],uc);let Ha=Wr=class extends Ci{static get instance(){return Wr._instance||(Wr._instance=new Wr("ChatTabList"),Wr._instance.initialize()),Wr._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof uc)e=n[0];else{let i=n[0];e=new uc(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Wr.instance.children)i.destroy();let e=Wr.instance.toContext();e.syncData=this.toContext().syncData,Wr.instance.apply(e),Wr.instance.update(),super.parseInnerXml.apply(Wr.instance,[n]),this.destroy()}};Ha=Wr=K([Wn("chat-tab-list")],Ha);var dc,Nz=Y(4327),fD=Y(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(dc||(dc={}));class Vo{static get instance(){return Vo._instance||(Vo._instance=new Vo),Vo._instance}constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,Dt.Z)(function*(){if(!n)return;let i=n instanceof FileList?gD(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),fe.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,Dt.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield At.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,Dt.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield st.instance.addAsync(n)}})()}handleText(n){return(0,Dt.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=vs.xml2element(yield _o.readAsTextAsync(n));e&&fe.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,Dt.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new fD;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:dc.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,Dt.Z)(function*(){if(!n)return;let r=n instanceof FileList?gD(n):n,o=new fD;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,Nz.saveAs)(s,e+".zip")})()}}function gD(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}class mD{get length(){return this._length}constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var jo,rd=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(rd||(rd={})),rd))();let Ts=jo=class extends Xs{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=rd.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return jo._instance||(jo._instance=new jo("DataSummarySetting"),jo._instance.initialize()),jo._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=jo.instance.toContext();e.syncData=this.toContext().syncData,jo.instance.apply(e),jo.instance.update(),this.destroy()}};K([ot()],Ts.prototype,"sortTag",void 0),K([ot()],Ts.prototype,"sortOrder",void 0),K([ot()],Ts.prototype,"dataTag",void 0),Ts=jo=K([Wn("summary-setting")],Ts);var qf,Zr=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(Zr||(Zr={})),Zr))();let Ho=qf=class extends cr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement.children.map(n=>n.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get ownerName(){let n=Rt.findByUserId(this.owner);return n?n.name:""}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isMine||We.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isMine(){return We.peer.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case Zr.D2:i=2;break;case Zr.D4:i=4;break;case Zr.D6:i=6;break;case Zr.D8:i=8;break;case Zr.D10_10TIMES:o=s=>s+1+"0";case Zr.D10:i=10;break;case Zr.D12:i=12;break;case Zr.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(rt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=r[0].name,r}static create(n,e,i,r){let o=r?new qf(r):new qf;return o.createDataElements(),o.commonDataElement.appendChild(rt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(rt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};K([ot()],Ho.prototype,"face",void 0),K([ot()],Ho.prototype,"owner",void 0),K([ot()],Ho.prototype,"rotate",void 0),Ho=qf=K([Wn("dice-symbol")],Ho);let od=class extends Ci{constructor(){super(...arguments),this.dicebot="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let o=0,s=!0;for(;s;)o++,s=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,l)=>{l=ws.toHalfWidth(l),console.log(l),s=!0;for(let c of this.paletteVariables)if(c.name==l)return c.value;if(e){let c=e.getFirstElementByName(l,mo.IgnoreWidth);if(c)return c.isNumberResource?c.currentValue+"":c.value+""}return""}),128<o&&(s=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:ws.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var $0;K([ot()],od.prototype,"dicebot",void 0),od=K([Wn("chat-palette")],od);let li=$0=class extends cr{constructor(){super(...arguments),this.rotate=0,this.roll=0}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let n of this.children)if(n instanceof od)return n;return null}static create(n,e,i){let r=new $0;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}createTestGameDataElement(n,e,i){this.createDataElements();let r=rt.create("name",n,{},"name_"+this.identifier),o=rt.create("size",e,{},"size_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let s=rt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),a=rt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=rt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.detailDataElement.appendChild(s),s.appendChild(a),s.appendChild(l);let c=rt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(rt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(rt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c=rt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(rt.create("\u5668\u7528\u5ea6",24,{},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(rt.create("\u654f\u6377\u5ea6",24,{},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(rt.create("\u7b4b\u529b",24,{},"\u7b4b\u529b"+this.identifier)),c.appendChild(rt.create("\u751f\u547d\u529b",24,{},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(rt.create("\u77e5\u529b",24,{},"\u77e5\u529b"+this.identifier)),c.appendChild(rt.create("\u7cbe\u795e\u529b",24,{},"\u7cbe\u795e\u529b"+this.identifier)),c=rt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(rt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(rt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(rt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(rt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(rt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(rt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let g=new od("ChatPalette_"+this.identifier);g.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),g.initialize(),this.appendChild(g)}};var Kf;K([ot()],li.prototype,"rotate",void 0),K([ot()],li.prototype,"roll",void 0),li=$0=K([Wn("character")],li);let Go=Kf=class extends cr{constructor(){super(...arguments),this.isLock=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}static create(n,e,i,r,o){let s=null;return s=o?new Kf(o):new Kf,s.createDataElements(),s.commonDataElement.appendChild(rt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(rt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(rt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(rt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.initialize(),s}};K([ot()],Go.prototype,"isLock",void 0),Go=Kf=K([Wn("table-mask")],Go);var Xf,Qs=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(Qs||(Qs={})),Qs))();let Yr=Xf=class extends cr{constructor(){super(...arguments),this.isLocked=!1,this.mode=Qs.ALL,this.rotate=0}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&Qs.WALL)}get hasFloor(){return!!(this.mode&Qs.FLOOR)}static create(n,e,i,r,o,s,a){let l=null;return l=a?new Xf(a):new Xf,l.createDataElements(),l.commonDataElement.appendChild(rt.create("name",n,{},"name_"+l.identifier)),l.commonDataElement.appendChild(rt.create("width",e,{},"width_"+l.identifier)),l.commonDataElement.appendChild(rt.create("height",r,{},"height_"+l.identifier)),l.commonDataElement.appendChild(rt.create("depth",i,{},"depth_"+l.identifier)),l.imageDataElement.appendChild(rt.create("wall",o,{type:"image"},"wall_"+l.identifier)),l.imageDataElement.appendChild(rt.create("floor",s,{type:"image"},"floor_"+l.identifier)),l.initialize(),l}};K([ot()],Yr.prototype,"isLocked",void 0),K([ot()],Yr.prototype,"mode",void 0),K([ot()],Yr.prototype,"rotate",void 0),Yr=Xf=K([Wn("terrain")],Yr);var xs=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(xs||(xs={})),xs))(),Qf=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(Qf||(Qf={})),Qf))();let ci=class extends Ci{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=Qf.NONE,this.selected=!1,this.gridType=xs.SQUARE,this.gridColor="#000000e6"}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof Yr&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Go&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&fe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var Jf;K([ot()],ci.prototype,"name",void 0),K([ot()],ci.prototype,"width",void 0),K([ot()],ci.prototype,"height",void 0),K([ot()],ci.prototype,"gridSize",void 0),K([ot()],ci.prototype,"imageIdentifier",void 0),K([ot()],ci.prototype,"backgroundImageIdentifier",void 0),K([ot()],ci.prototype,"backgroundFilterType",void 0),K([ot()],ci.prototype,"selected",void 0),K([ot()],ci.prototype,"gridType",void 0),K([ot()],ci.prototype,"gridColor",void 0),ci=K([Wn("game-table")],ci);let $o=Jf=class extends cr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password=""}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}toTopmost(){G0(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Jf(s):new Jf;return a.createDataElements(),a.commonDataElement.appendChild(rt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(rt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(rt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(rt.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(rt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.initialize(),a}};K([ot()],$o.prototype,"rotate",void 0),K([ot()],$o.prototype,"zindex",void 0),K([ot()],$o.prototype,"password",void 0),$o=Jf=K([Wn("text-note")],$o);let W0=class extends Xs{onStoreAdded(){super.onStoreAdded(),Be.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(Be.instance.getObjects(ci)),e=e.concat(Be.instance.getObjects(li)),e=e.concat(Be.instance.getObjects($o)),e=e.concat(Be.instance.getObjects(pi)),e=e.concat(Be.instance.getObjects(ur).filter(i=>null===i.parent)),e=e.concat(Be.instance.getObjects(Ho));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(Be.instance.getObjects(ci)),e=e.concat(Be.instance.getObjects(Go)),e=e.concat(Be.instance.getObjects(Yr)),e=e.concat(Be.instance.getObjects(li)),e=e.concat(Be.instance.getObjects($o)),e=e.concat(Be.instance.getObjects(pi)),e=e.concat(Be.instance.getObjects(ur)),e=e.concat(Be.instance.getObjects(Ho));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)Tn.instance.parseXml(n.children[i])}};W0=K([Wn("room")],W0);var Rz=Y(1203);class Mr{constructor(n){this.ngZone=n}saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return Mr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new W0),o=this.convertToXml(Ha.instance),s=this.convertToXml(Ts.instance);return i.push(new File([r],"data.xml",{type:"text/plain"})),i.push(new File([o],"chat.xml",{type:"text/plain"})),i.push(new File([s],"summary.xml",{type:"text/plain"})),i=i.concat(this.searchImageFiles(r)),i=i.concat(this.searchImageFiles(o)),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="xml_data",i){return Mr.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="xml_data",i){let r=[],o=this.convertToXml(n);return r.push(new File([o],"data.xml",{type:"text/plain"})),r=r.concat(this.searchImageFiles(o)),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return Vo.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+Rz.xml(n.toXml(),2)}searchImageFiles(n){let e=vs.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=At.instance.get(a)}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=At.instance.get(a));let l=o[s].getAttribute("backgroundImageIdentifier");l&&(r[l]=At.instance.get(l))}for(let s in r){let a=r[s];a&&a.state===wi.COMPLETE&&i.push(new File([a.blob],a.identifier+"."+dc.extension(a.blob.type),{type:a.blob.type}))}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}}function Lz(t,n){1&t&&wn(0)}function Bz(t,n){if(1&t){const e=et();O(0,"div",3),X(1,Lz,1,0,"ng-container",8),O(2,"select",9,10),ge("change",function(){Me(e);const r=Pt(3);return ke(H(3).setElementType(r.value))}),O(4,"option",11),Q(5,"\u901a\u5e38"),F(),O(6,"option",12),Q(7,"\u30ea\u30bd\u30fc\u30b9"),F(),O(8,"option",13),Q(9,"\u30ce\u30fc\u30c8"),F()()()}if(2&t){const e=H(3),i=Pt(2);let r;k(1),D("ngTemplateOutlet",i),k(1),D("ngModel",null!==(r=e.gameDataElement.type)&&void 0!==r?r:"")}}function zz(t,n){if(1&t&&(je(0),O(1,"div",14),Q(2),F(),He()),2&t){const e=H(3);k(2),gt(e.name)}}function Uz(t,n){if(1&t){const e=et();je(0),O(1,"div",15),Q(2),F(),O(3,"input",16),ge("ngModelChange",function(r){return Me(e),ke(H(3).name=r)}),F(),He()}if(2&t){const e=H(3);k(2),gt(e.name),k(1),D("ngModel",e.name)}}function Vz(t,n){if(1&t){const e=et();je(0),O(1,"input",17),ge("ngModelChange",function(r){return Me(e),ke(H(3).currentValue=r)}),Zt(2,"safe"),F(),Le(3,"br"),O(4,"input",18),ge("ngModelChange",function(r){return Me(e),ke(H(3).currentValue=r)}),F(),Q(5," / "),O(6,"input",19),ge("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),F(),He()}if(2&t){const e=H(3);k(1),br(Yt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),D("ngModel",e.currentValue),k(3),D("ngModel",e.currentValue),k(2),D("ngModel",e.value)}}function jz(t,n){if(1&t){const e=et();je(0),O(1,"textarea",20),ge("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),F(),He()}if(2&t){const e=H(3);k(1),D("ngModel",e.value)}}function Hz(t,n){if(1&t){const e=et();je(0),O(1,"div",21),Q(2),F(),O(3,"input",22),ge("ngModelChange",function(r){return Me(e),ke(H(3).value=r)}),F(),He()}if(2&t){const e=H(3);k(2),gt(e.value),k(1),D("ngModel",e.value)}}function Gz(t,n){if(1&t&&(je(0),X(1,Bz,10,2,"div",2),O(2,"div",3),X(3,zz,3,1,"ng-container",0),X(4,Uz,4,2,"ng-container",0),F(),O(5,"div",4),je(6,5),X(7,Vz,7,9,"ng-container",6),X(8,jz,2,1,"ng-container",6),X(9,Hz,4,2,"ng-container",7),He(),F(),He()),2&t){const e=H(2);k(1),D("ngIf",e.isEdit),k(2),D("ngIf",e.isTagLocked),k(1),D("ngIf",!e.isTagLocked),k(2),D("ngSwitch",e.gameDataElement.type),k(1),D("ngSwitchCase","numberResource"),k(1),D("ngSwitchCase","note")}}function $z(t,n){1&t&&wn(0)}function Wz(t,n){if(1&t&&(O(0,"div",28),X(1,$z,1,0,"ng-container",8),F()),2&t){H(3);const e=Pt(2);k(1),D("ngTemplateOutlet",e)}}function Zz(t,n){if(1&t&&(je(0),O(1,"div",29),Q(2),F(),He()),2&t){const e=H(3);k(2),gt(e.name)}}function Yz(t,n){if(1&t){const e=et();je(0),O(1,"input",30),ge("ngModelChange",function(r){return Me(e),ke(H(3).name=r)}),F(),He()}if(2&t){const e=H(3);k(1),D("ngModel",e.name)}}function qz(t,n){if(1&t&&Le(0,"div",33),2&t){const e=n.$implicit,i=H(4);D("gameDataElement",e)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function Kz(t,n){if(1&t&&(O(0,"div",31),X(1,qz,1,3,"div",32),F()),2&t){const e=H(3);k(1),D("ngForOf",e.gameDataElement.children)}}function Xz(t,n){if(1&t&&(je(0),X(1,Wz,2,1,"div",23),Le(2,"div",24),O(3,"div",25)(4,"div",26),X(5,Zz,3,1,"ng-container",0),X(6,Yz,2,1,"ng-container",0),F(),X(7,Kz,2,1,"div",27),F(),He()),2&t){const e=H(2);k(1),D("ngIf",e.isEdit),k(4),D("ngIf",e.isTagLocked),k(1),D("ngIf",!e.isTagLocked),k(1),D("ngIf",0<e.gameDataElement.children.length)}}function Qz(t,n){if(1&t&&(je(0),X(1,Gz,10,6,"ng-container",0),X(2,Xz,8,4,"ng-container",0),He()),2&t){const e=H();k(1),D("ngIf",e.gameDataElement.children.length<1),k(1),D("ngIf",0<e.gameDataElement.children.length)}}function Jz(t,n){if(1&t){const e=et();O(0,"button",34),ge("click",function(){return Me(e),ke(H().addElement())}),O(1,"i",35),Q(2,"add_circle"),F()(),O(3,"button",34),ge("click",function(){return Me(e),ke(H().upElement())}),O(4,"i",35),Q(5,"arrow_upward"),F()(),Le(6,"br"),O(7,"button",34),ge("click",function(){return Me(e),ke(H().deleteElement())}),O(8,"i",35),Q(9,"remove_circle_outline"),F()(),O(10,"button",34),ge("click",function(){return Me(e),ke(H().downElement())}),O(11,"i",35),Q(12,"arrow_downward"),F()()}}Mr.queue=new mD("SaveDataServiceQueue"),Mr.\u0275fac=function(n){return new(n||Mr)(bt(Gt))},Mr.\u0275prov=Mt({token:Mr,factory:Mr.\u0275fac,providedIn:"root"});let eU=(()=>{class t{get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement)}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameDataElement?.identifier}`,e=>{this.setValues(this.gameDataElement),this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){fe.unregister(this)}addElement(){this.gameDataElement.appendChild(rt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(J(Oi))},t.\u0275cmp=Wt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},features:[Mn],decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["select",""],["value",""],["value","numberResource"],["value","note"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","max","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModel","ngModelChange"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","none","font-size","0.8em",3,"ngModel","ngModelChange"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Value",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(X(0,Qz,3,2,"ng-container",0),X(1,Jz,13,0,"ng-template",null,1,zn)),2&e&&D("ngIf",i.gameDataElement)},dependencies:[Un,fn,Eu,Ea,Cu,wu,Vs,js,Ai,Kl,Sa,gs,Yi,Fi,t,Jn],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],changeDetection:0}),t})();function tU(t,n){1&t&&wn(0)}function nU(t,n){if(1&t){const e=et();je(0),O(1,"button",0),ge("click",function(){return Me(e),ke(H().openModal("front"))}),Q(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),F(),O(3,"button",0),ge("click",function(){return Me(e),ke(H().openModal("back"))}),Q(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),F(),He()}}function iU(t,n){1&t&&wn(0)}function rU(t,n){if(1&t){const e=et();je(0),O(1,"button",0),ge("click",function(){return Me(e),ke(H().openModal("floor"))}),Q(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),F(),O(3,"button",0),ge("click",function(){return Me(e),ke(H().openModal("wall"))}),Q(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),F(),He()}}function oU(t,n){if(1&t){const e=et();je(0),O(1,"button",4),ge("click",function(){Me(e);const r=H();return ke(r.openModal(r.tabletopObject.face))}),Q(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),F(),He()}if(2&t){const e=H();k(1),D("disabled",!e.tabletopObject.isVisible)}}function sU(t,n){if(1&t){const e=et();je(0),O(1,"button",0),ge("click",function(){return Me(e),ke(H().openModal("imageIdentifier",!0))}),Q(2,"\u753b\u50cf\u5909\u66f4"),F(),He()}}function aU(t,n){if(1&t&&(O(0,"div",10),Q(1),F()),2&t){const e=H();k(1),Hn("",e.progresPercent,"%")}}function lU(t,n){if(1&t){const e=et();O(0,"select",12,13),ge("change",function(){Me(e);const r=Pt(1);return ke(H(2).setLocation(r.value))}),O(2,"option",14),Q(3,"\u30c6\u30fc\u30d6\u30eb"),F(),O(4,"option",15),Q(5,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),F(),O(6,"option",16),Q(7,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),F(),O(8,"option",17),Q(9,"\u5893\u5730"),F()()}if(2&t){const e=H(2);D("ngModel",e.tabletopObject.location.name),k(6),vn("value",e.networkService.peerId)}}function cU(t,n){if(1&t&&(je(0),X(1,lU,10,2,"select",11),He()),2&t){const e=H();k(1),D("ngIf",e.tabletopObject)}}function uU(t,n){if(1&t&&(O(0,"div",20),Le(1,"img",21),Zt(2,"safe"),F()),2&t){const e=H(2);k(1),D("src",Yt(2,2,e.tabletopObject.imageFile.url,"resourceUrl"),Kn)("alt",e.tabletopObject.imageFile.name)}}function dU(t,n){if(1&t&&(je(0),O(1,"div",22)(2,"div",23),Le(3,"div",24),F()(),He()),2&t){const e=H(2);k(3),D("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0)}}function hU(t,n){if(1&t&&(O(0,"div",22)(1,"div",23),Le(2,"div",26),F()()),2&t){const e=n.$implicit,i=H(3);k(2),D("gameDataElement",e)("isEdit",i.isEdit)}}function fU(t,n){if(1&t&&(je(0),X(1,hU,3,2,"div",25),He()),2&t){const e=H(2);k(1),D("ngForOf",e.tabletopObject.detailDataElement.children)}}function pU(t,n){if(1&t){const e=et();je(0),O(1,"div",22)(2,"button",27),ge("click",function(){return Me(e),ke(H(2).addDataElement())}),Q(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),F()(),He()}}function gU(t,n){if(1&t&&(O(0,"div",18),X(1,uU,3,5,"div",19),X(2,dU,4,2,"ng-container",8),X(3,fU,2,1,"ng-container",8),X(4,pU,4,0,"ng-container",8),F()),2&t){const e=H();k(1),D("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)),k(1),D("ngIf",e.tabletopObject.commonDataElement),k(1),D("ngIf",e.tabletopObject.detailDataElement),k(1),D("ngIf",e.isEdit)}}const mU=function(t){return{"is-hidden":t}};let Wo=(()=>{class t{constructor(e,i,r){this.saveDataService=e,this.panelService=i,this.modalService=r,this.tabletopObject=null,this.isEdit=!1,this.networkService=We,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){fe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=rt.create("\u898b\u51fa\u3057","",{}),i=rt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":Re.play(Ee.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,Re.play(Ee.cardPut);break;case"text-note":e.toTopmost(),Re.play(Ee.cardPut);break;case"dice-symbol":Re.play(Ee.dicePut);default:Re.play(Ee.piecePut)}}saveToXML(){var e=this;return(0,Dt.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObject.commonDataElement.getFirstElementByName("name"),r=i?i.value:"";yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"xml_"+r,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){this.tabletopObject.setLocation(e)}openModal(e="",i=!1){this.modalService.open(Yf,{isAllowedEmpty:i}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);o&&(o.value=r)})}}return t.\u0275fac=function(e){return new(e||t)(J(Mr),J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:18,vars:13,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["select",""],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"main-image",3,"src","alt"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(O(0,"button",0),ge("click",function(){return i.toggleEditMode()}),Q(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),F(),je(2,1),X(3,tU,1,0,"ng-container",2),X(4,nU,5,0,"ng-container",2),X(5,iU,1,0,"ng-container",2),X(6,rU,5,0,"ng-container",2),X(7,oU,3,1,"ng-container",2),X(8,sU,3,0,"ng-container",3),He(),O(9,"button",0),ge("click",function(){return i.clone()}),Q(10,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),F(),O(11,"button",4),ge("click",function(){return i.saveToXML()}),O(12,"div",5)(13,"div",6),Q(14,"\u4fdd\u5b58"),F(),X(15,aU,2,1,"div",7),F()(),X(16,cU,2,1,"ng-container",8),X(17,gU,5,4,"div",9)),2&e&&(k(2),D("ngSwitch",i.tabletopObject.aliasName),k(1),D("ngSwitchCase","numberResource"),k(1),D("ngSwitchCase","card"),k(1),D("ngSwitchCase","card-stack"),k(1),D("ngSwitchCase","terrain"),k(1),D("ngSwitchCase","dice-symbol"),k(4),D("disabled",i.isSaveing),k(2),D("ngClass",dt(11,mU,i.isSaveing)),k(2),D("ngIf",i.isSaveing),k(1),D("ngIf","character"===i.tabletopObject.aliasName),k(1),D("ngIf",i.tabletopObject))},dependencies:[ai,Un,fn,Ea,Cu,wu,Vs,js,gs,Yi,Fi,eU,Jn],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px}.main-image[_ngcontent-%COMP%]{width:250px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})(),Z0=(()=>{class t{get summarySetting(){return Ts.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}constructor(){this.tableInventory=new ep(e=>"table"===e.location.name),this.commonInventory=new ep(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new ep(e=>e.location.name===We.peerId),this.graveyardInventory=new ep(e=>"graveyard"===e.location.name),this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=rt.create(this.newLineString),this.initialize()}initialize(){fe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Be.instance.get(e.data.identifier);if(i)if(i instanceof li){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof rt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof Ts&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=li.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){fe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===We.peerId||"graveyard"===e)return!0;for(let i of We.peers)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class ep{get summarySetting(){return Ts.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=rt.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=Be.instance.getObjects(li),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByName(e),a=o.rootDataElement?.getFirstElementByName(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let l=this.convertToSortableValue(s),c=this.convertToSortableValue(a);return l<c?i:l>c?-1*i:0}),n}convertToSortableValue(n){let i=ws.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}let ei=(()=>{class t{get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>{this._isDragging=e,document.body.dispatchEvent(new CustomEvent("draggingstate",{detail:e,bubbles:!0}))})}constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1,this.isTablePickGesture=!1}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i,3),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s,12),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<rn.sqrMagnitude(e,this.startPostion)&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&rn.sqrMagnitude(e,r)<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Zn;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Zn||(Zn={}));const sd=-9999;class Js{get startPointer(){return this.firstPointer}get pointer(){return this.primaryPointer}get magnitude(){return rn.sqrMagnitude(this.firstPointer,this.primaryPointer)}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isPointerMoved(){return this._isPointerMoved}get isDestroyed(){return this._isDestroyed}constructor(...n){this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.startTime=-1e3,this.clearLastPointerTimer=new zo(this.clearLastPointer.bind(this),2e3,!1),this.firstPointer={x:0,y:0,z:0,identifier:sd},this.lastStartPointers=[],this.lastMovePointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:sd},this._isDragging=!1,this._isGrabbing=!1,this._isPointerMoved=!1,this._isDestroyed=!1;let e=n[0],i={capture:!1,passive:!1,always:!1},r=!0;switch(n.length){case 3:i=n[1],r=n[2];break;case 2:"boolean"==typeof n[1]?r=n[1]:i=n[1]}this.target=e,this.option={capture:!0===i.capture,passive:!0===i.passive,always:!0===i.always},r&&this.initialize()}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this.clearLastPointerTimer.clear(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners(),this.onStart=null,this.onMove=null,this.onEnd=null,this.onContextMenu=null}cancel(){this._isDragging=this._isGrabbing=!1,this.clearLastPointerTimer.reset(),this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:sd};this.isSyntheticEvent(n)?this.updateLastPointer(n):(this.updateLastPointer(n),this.primaryPointer=e,this.onPointer(n))}onTouch(n){if(!(n.changedTouches.length<1)){if(this.updateLastPointer(n),"touchstart"===n.type)this.primaryPointer=this.lastStartPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this.onTap&&(this.startTime=performance.now()),this.clearLastPointerTimer.stop(),this.firstPointer=this.primaryPointer,this._isGrabbing=!0,this._isDragging=!1,this._isPointerMoved=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing,this._isPointerMoved=this._isPointerMoved||(n instanceof MouseEvent?3:12)**2<rn.sqrMagnitude(this.firstPointer,this.primaryPointer);break;default:this.onEnd&&this.onEnd(n),this.onTap&&performance.now()-this.startTime<250&&!this._isPointerMoved&&this.onTap(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){let i={x:n.pageX,y:n.pageY,z:0,identifier:sd},r=this.lastMovePointers;"mousemove"!==n.type&&(r=r.concat(this.lastStartPointers));for(let o of r)if(o.identifier!==i.identifier&&rn.sqrMagnitude(i,o)<e**2)return!0;return!1}updateLastPointer(n){let e=[];if(n instanceof MouseEvent)e.push({x:n.pageX,y:n.pageY,z:0,identifier:sd});else{let i=n.touches.length;for(let r=0;r<i;r++){let o=n.touches[r];e.push({x:o.pageX,y:o.pageY,z:0,identifier:o.identifier})}}this.lastMovePointers=e,("mousedown"===n.type||"touchstart"===n.type)&&(this.lastStartPointers=e)}clearLastPointer(){this.clearLastPointerTimer.stop(),this.lastStartPointers=[],this.lastMovePointers=[]}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let _D=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new Ht,this.onmove=new Ht,this.onend=new Ht,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new Js(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():e.stopPropagation()}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<rn.sqrMagnitude(i)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>rn.sqrMagnitude(this.input.pointer,this.startPointer))return;let r=o=>{o.cancelable&&o.preventDefault(),o.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y)),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Zn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Zn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Ln))},t.\u0275dir=vt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})();const vU=["draggablePanel"];function yU(t,n){1&t&&wn(0)}function bU(t,n){1&t&&wn(0)}const vD=function(t){return{card:t}};function CU(t,n){if(1&t&&(je(0),X(1,bU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(12);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,vD,e.tabletopObject))}}function wU(t,n){1&t&&wn(0)}function EU(t,n){if(1&t&&(je(0),X(1,wU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(12);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,vD,e.tabletopObject))}}function TU(t,n){1&t&&wn(0)}const xU=function(t){return{note:t}};function SU(t,n){if(1&t&&(je(0),X(1,TU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(14);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,xU,e.tabletopObject))}}function DU(t,n){1&t&&wn(0)}const yD=function(t){return{character:t}};function MU(t,n){if(1&t&&(je(0),X(1,DU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(16);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,yD,e.tabletopObject))}}function kU(t,n){1&t&&wn(0)}const IU=function(t){return{dice:t}};function OU(t,n){if(1&t&&(je(0),X(1,kU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(18);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,IU,e.tabletopObject))}}function AU(t,n){1&t&&wn(0)}function PU(t,n){if(1&t&&(je(0),X(1,AU,1,0,"ng-container",12),He()),2&t){const e=H(),i=Pt(16);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,yD,e.tabletopObject))}}function FU(t,n){1&t&&wn(0)}function NU(t,n){if(1&t&&(je(0),X(1,FU,1,0,"ng-container",13),He()),2&t){H();const e=Pt(22);k(1),D("ngTemplateOutlet",e)}}const bD=function(t){return{"with-button-marign":t}};function RU(t,n){if(1&t&&(O(0,"div",24)(1,"div",25),Q(2),F()()),2&t){const e=H(2).card,i=H();D("ngClass",dt(2,bD,i.hasImage)),k(2),gt(e.ownerName)}}function LU(t,n){if(1&t){const e=et();O(0,"div",19),Le(1,"img",20),Zt(2,"safe"),O(3,"button",21),ge("click",function(){return Me(e),ke(H(2).chanageImageView(!0))}),O(4,"i",22),Q(5,"zoom_in"),F()(),X(6,RU,3,4,"div",23),F()}if(2&t){const e=H().card,i=H();k(1),D("src",Yt(2,2,i.imageUrl,"resourceUrl"),Kn),k(5),D("ngIf",e.hasOwner&&0<e.ownerName.length)}}function BU(t,n){if(1&t&&(je(0),Q(1),He()),2&t){const e=H(2).card;k(1),gt(e.name)}}function zU(t,n){1&t&&(je(0),Q(1,"\u30ab\u30fc\u30c9"),He())}function UU(t,n){if(1&t&&(O(0,"div",26),X(1,BU,2,1,"ng-container",5),X(2,zU,2,0,"ng-container",5),F()),2&t){const e=H().card,i=H();D("ngClass",dt(3,bD,i.hasImage)),k(1),D("ngIf",null==e.isVisible||e.isVisible),k(1),D("ngIf",null!=e.isVisible&&!e.isVisible)}}function VU(t,n){1&t&&wn(0)}const tp=function(t){return{dataElm:t}};function jU(t,n){if(1&t&&(je(0),X(1,VU,1,0,"ng-container",12),He()),2&t){const e=n.$implicit;H(3);const i=Pt(20);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,tp,e))}}function HU(t,n){if(1&t&&(O(0,"div",27)(1,"div",28),X(2,jU,2,4,"ng-container",29),F()()),2&t){const e=H(2);k(2),D("ngForOf",e.dataElms)}}const vo=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function GU(t,n){if(1&t&&(O(0,"div",14),X(1,LU,7,5,"div",15),X(2,UU,3,5,"div",16),O(3,"div",17),X(4,HU,3,1,"div",18),F()()),2&t){const e=n.card,i=H();D("ngClass",_i(4,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngIf",i.hasImage),k(1),D("ngIf",0<(null==e||null==e.name?null:e.name.length)),k(2),D("ngIf",i.hasDataElms&&e.isVisible)}}function $U(t,n){if(1&t){const e=et();O(0,"div",30)(1,"div",31),Q(2),F(),O(3,"div",32)(4,"div",19)(5,"div",33)(6,"textarea",34),ge("ngModelChange",function(r){return ke(Me(e).note.text=r)}),F()(),O(7,"div",35),Q(8),F()()()()}if(2&t){const e=n.note,i=H();D("ngClass",_i(4,vo,!i.isPointerDragging,i.isPointerDragging)),k(2),gt(e.title),k(4),D("ngModel",e.text),k(2),gt(e.text)}}function WU(t,n){if(1&t&&(O(0,"div",42),Le(1,"img",43),Zt(2,"safe"),F()),2&t){const e=H(2);D("ngClass",_i(5,vo,!e.isPointerDragging,e.isPointerDragging)),k(1),D("src",Yt(2,2,e.imageUrl,"resourceUrl"),Kn)}}function ZU(t,n){1&t&&wn(0)}function YU(t,n){if(1&t&&(je(0),O(1,"div",28),X(2,ZU,1,0,"ng-container",12),F(),He()),2&t){const e=H().$implicit;H(3);const i=Pt(20);k(2),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,tp,e))}}function qU(t,n){if(1&t&&(je(0),X(1,YU,3,4,"ng-container",5),He()),2&t){const e=n.$implicit,i=H(3);k(1),D("ngIf",e&&e.name!==i.newLineString)}}function KU(t,n){if(1&t&&(O(0,"div",27),X(1,qU,2,1,"ng-container",29),F()),2&t){const e=H(2);k(1),D("ngForOf",e.inventoryDataElms)}}function XU(t,n){if(1&t&&(O(0,"div",36),Le(1,"div",37),X(2,WU,3,8,"div",38),O(3,"div",39),Q(4),F(),Le(5,"div",40),O(6,"div",41),X(7,KU,2,1,"div",18),F()()),2&t){const e=n.character,i=H();k(1),D("ngClass",_i(6,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngIf",i.hasImage),k(1),D("ngClass",_i(9,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),gt(e.name),k(2),D("ngClass",_i(12,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngIf",i.hasDataElms)}}function QU(t,n){if(1&t&&(je(0),Q(1),He()),2&t){const e=H().dice;k(1),gt(e.face)}}function JU(t,n){1&t&&(je(0),Q(1,"???"),He())}function eV(t,n){if(1&t&&(O(0,"div",45)(1,"div",25),Q(2),F()()),2&t){const e=H().dice,i=H();D("ngClass",_i(2,vo,!i.isPointerDragging,i.isPointerDragging)),k(2),Hn("",e.ownerName," ")}}const tV=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function nV(t,n){if(1&t&&(O(0,"div",42),Le(1,"img",46),Zt(2,"safe"),F()),2&t){const e=H().dice,i=H();D("ngClass",_i(6,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngClass",_i(9,tV,!e.isVisible,e.isMine))("src",Yt(2,3,i.imageUrl,"resourceUrl"),Kn)}}function iV(t,n){1&t&&wn(0)}function rV(t,n){if(1&t&&(je(0),X(1,iV,1,0,"ng-container",12),He()),2&t){const e=H().$implicit;H(3);const i=Pt(20);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,tp,e))}}function oV(t,n){if(1&t&&(je(0),X(1,rV,2,4,"ng-container",5),He()),2&t){const e=n.$implicit,i=H(3);k(1),D("ngIf",e&&e.name!==i.newLineString)}}function sV(t,n){if(1&t&&(O(0,"div",27)(1,"div",28),X(2,oV,2,1,"ng-container",29),F()()),2&t){const e=H(2);k(2),D("ngForOf",e.dataElms)}}function aV(t,n){if(1&t&&(O(0,"div",36),Le(1,"div",37),O(2,"div",39),Q(3),X(4,QU,2,1,"ng-container",5),X(5,JU,2,0,"ng-container",5),F(),X(6,eV,3,5,"div",44),X(7,nV,3,12,"div",38),Le(8,"div",40),O(9,"div",41),X(10,sV,3,1,"div",18),F()()),2&t){const e=n.dice,i=H();k(1),D("ngClass",_i(9,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngClass",_i(12,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),Hn(" ",e.name,": "),k(1),D("ngIf",e.isVisible),k(1),D("ngIf",!e.isVisible),k(1),D("ngIf",e.hasOwner&&0<e.ownerName.length),k(1),D("ngIf",i.hasImage),k(2),D("ngClass",_i(15,vo,!i.isPointerDragging,i.isPointerDragging)),k(1),D("ngIf",i.hasDataElms&&e.isVisible)}}function lV(t,n){1&t&&wn(0)}function cV(t,n){if(1&t&&(O(0,"div",53),Q(1),F()),2&t){const e=H(2).dataElm;k(1),gt(e.name)}}function uV(t,n){1&t&&wn(0)}function dV(t,n){if(1&t&&(je(0),X(1,uV,1,0,"ng-container",12),He()),2&t){const e=n.$implicit;H(3);const i=Pt(20);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,tp,e))}}function hV(t,n){if(1&t&&(O(0,"div",50),X(1,cV,2,1,"div",51),O(2,"div",52),X(3,dV,2,4,"ng-container",29),F()()),2&t){const e=H().dataElm;k(1),D("ngIf",0<e.name.trim().length),k(2),D("ngForOf",e.children)}}function fV(t,n){if(1&t){const e=et();je(0),O(1,"div",55)(2,"div"),Q(3),F(),O(4,"div",56)(5,"div",33)(6,"textarea",34),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),F()(),O(7,"div",35),Q(8),F()()(),He()}if(2&t){const e=H(2).dataElm;k(3),gt(e.name),k(3),D("ngModel",e.value),k(2),gt(e.value)}}function pV(t,n){if(1&t){const e=et();je(0),O(1,"div",57),Q(2),F(),O(3,"div",58)(4,"div",59)(5,"div",60),Q(6),F(),O(7,"input",61),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),F()(),O(8,"div",62),Q(9),F()(),O(10,"div",63)(11,"input",64),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),Zt(12,"safe"),F()(),He()}if(2&t){const e=H(2).dataElm;k(2),gt(e.name),k(4),gt(e.currentValue),k(1),D("ngModel",e.currentValue),k(2),Hn(" / ",e.value,""),k(2),br(Yt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),D("ngModel",e.currentValue)}}function gV(t,n){if(1&t){const e=et();je(0),O(1,"div",57),Q(2),F(),O(3,"div",58)(4,"div",65),Q(5),F(),O(6,"input",66),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),F()(),He()}if(2&t){const e=H(2).dataElm;k(2),gt(e.name),k(3),gt(e.value),k(1),D("ngModel",e.value)}}function mV(t,n){1&t&&(je(0,2),X(1,fV,9,3,"ng-container",3),X(2,pV,13,11,"ng-container",3),X(3,gV,7,3,"ng-container",4),He(),Le(4,"div",54)),2&t&&(D("ngSwitch",H().dataElm.type),k(1),D("ngSwitchCase","note"),k(1),D("ngSwitchCase","numberResource"))}function _V(t,n){if(1&t&&(X(0,lV,1,0,"ng-container",47),X(1,hV,4,2,"ng-template",null,48,zn),X(3,mV,5,3,"ng-template",null,49,zn)),2&t){const e=n.dataElm,i=Pt(2),r=Pt(4);D("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function vV(t,n){if(1&t){const e=et();O(0,"div",67),ge("click",function(){return Me(e),ke(H().chanageImageView(!1))}),O(1,"div",68)(2,"i",22),Q(3,"close"),F()(),Le(4,"img",69),Zt(5,"safe"),F()}if(2&t){const e=H();D("@fadeInOut","in"),k(4),D("src",Yt(5,2,e.imageUrl,"resourceUrl"),Kn)}}let yV=(()=>{class t{get imageUrl(){return this.tabletopObject&&this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}constructor(e,i,r){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.tabletopObject=null,this.left=0,this.top=0,this.isOpenImageView=!1}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16)}ngOnDestroy(){fe.unregister(this)}onChangeDragging(e){this.changeDetector.markForCheck()}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}}return t.\u0275fac=function(e){return new(e||t)(J(Z0),J(Oi),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&On(vU,7),2&e){let r;In(r=An())&&(i.draggablePanel=r.first)}},hostBindings:function(e,i){1&e&&ge("draggingstate",function(o){return i.onChangeDragging(o)},0,iu)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},features:[Mn],decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"hidden-spacer"],["size","1",1,"input",3,"ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,i){1&e&&(O(0,"div",0,1),je(2,2),X(3,yU,1,0,"ng-container",3),X(4,CU,2,4,"ng-container",3),X(5,EU,2,4,"ng-container",3),X(6,SU,2,4,"ng-container",3),X(7,MU,2,4,"ng-container",3),X(8,OU,2,4,"ng-container",3),X(9,PU,2,4,"ng-container",4),He(),F(),X(10,NU,2,1,"ng-container",5),X(11,GU,5,7,"ng-template",null,6,zn),X(13,$U,9,7,"ng-template",null,7,zn),X(15,XU,8,15,"ng-template",null,8,zn),X(17,aV,11,18,"ng-template",null,9,zn),X(19,_V,5,3,"ng-template",null,10,zn),X(21,vV,6,5,"ng-template",null,11,zn)),2&e&&(D("@fadeInOut","in"),k(2),D("ngSwitch",i.tabletopObject.aliasName),k(1),D("ngSwitchCase","numberResource"),k(1),D("ngSwitchCase","card"),k(1),D("ngSwitchCase","card-stack"),k(1),D("ngSwitchCase","text-note"),k(1),D("ngSwitchCase","character"),k(1),D("ngSwitchCase","dice-symbol"),k(2),D("ngIf",i.isOpenImageView))},dependencies:[ai,Un,fn,Eu,Ea,Cu,wu,Ai,Kl,Sa,Yi,Fi,_D,Jn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#ccc;background-color:#1e1e1ecc;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;max-height:120px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;border-radius:1em;z-index:1}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{width:100%;min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}"],data:{animation:[Ao("fadeInOut",[yi("void => *",[vi("100ms ease-out",go([wt({opacity:0,offset:0}),wt({opacity:1,offset:1})]))]),yi("* => void",[vi("100ms ease-in",go([wt({opacity:1,offset:0}),wt({opacity:0,offset:1})]))])])]},changeDetection:0}),t})();var np=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(np||(np={})),np))();const pn={name:"",enabled:!0,type:np.SEPARATOR};let hr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0}}get isShow(){return!!this.panelComponentRef}open(e,i,r,o){this.close(),o||(o=t.defaultParentViewContainerRef);let a=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const l=a.injector.get(t);l.panelComponentRef=a,i&&(l.actions=i),e&&(l.position.x=e.x,l.position.y=e.y),l.title=r??"",a.onDestroy(()=>{l.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),CD=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o),this.callbackOnPick=o=>this.ngZone.run(()=>this.closeAll())}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointer;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<rn.sqrMagnitude(e,this.pointerDeviceService.pointer)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture)return;let e=hr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(yV,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0),document.addEventListener("pickstart",this.callbackOnPick,!0),document.addEventListener("pickobject",this.callbackOnPick,!0),document.addEventListener("pickregion",this.callbackOnPick,!0)}),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject.identifier}`,o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("UPDATE_SELECTION",o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),document.removeEventListener("pickstart",this.callbackOnPick,!0),document.removeEventListener("pickobject",this.callbackOnPick,!0),document.removeEventListener("pickregion",this.callbackOnPick,!0),this.clearTimer(),this.tooltipComponentRef=null,fe.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef);let r=this.tooltipComponentRef.instance;null!=r?.ngOnChanges&&queueMicrotask(()=>{this.tooltipComponentRef.instance&&r?.ngOnChanges({})})}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(J(Gt),J(sr),J(ei))},t.\u0275dir=vt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();function bV(t,n){if(1&t){const e=et();O(0,"div",2)(1,"div",3)(2,"div",4),Zt(3,"safe"),F(),O(4,"div",4),Zt(5,"safe"),F()(),O(6,"div",5)(7,"button",6),ge("click",function(){const o=Me(e).$implicit;return ke(H().drawCard(o))}),Q(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),F(),O(9,"button",0),ge("click",function(){const o=Me(e).$implicit;return ke(H().showDetail(o))}),O(10,"i",7),Q(11,"settings"),F(),Q(12,"\u7de8\u96c6"),F(),Le(13,"br"),O(14,"button",0),ge("click",function(){const o=Me(e).$implicit;return ke(H().up(o))}),Q(15,"\u2191"),F(),O(16,"button",0),ge("click",function(){const o=Me(e).$implicit;return ke(H().down(o))}),Q(17,"\u2193"),F(),Le(18,"br"),F()()}if(2&t){const e=n.$implicit;k(1),D("appTooltip",e),k(1),un("background-image",Yt(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),k(2),un("background-image",Yt(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let CV=(()=>{class t{constructor(e,i){this.panelService=e,this.changeDetector=i,this.cardStack=null,this.owner=We.peer.userId}ngOnChanges(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck(),this.cardStack.owner!==this.owner&&this.panelService.close()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){fe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),Re.play(Ee.cardDraw)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),Re.play(Ee.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(Oi))},t.\u0275cmp=Wt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},features:[Mn],decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(O(0,"div")(1,"button",0),ge("click",function(){return i.close(!0)}),Q(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),F(),Le(3,"hr"),X(4,bV,19,11,"div",1),F()),2&e&&(k(4),D("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},dependencies:[Un,CD,Jn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();class Y0{constructor(n){this.targetElement=n,this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchMouseInput}),this.isEnable=!0,this.onstart=null,this.oninteract=null,this.initializeHammer()}cancel(){this.isEnable=!1}destroy(){this.hammer.destroy()}initializeHammer(){let n=new Hammer.Tap({event:"tap2",taps:2});this.hammer.add([n]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap2",this.onInteract.bind(this))}onHammer(n){if(!n.isFirst)return;let e=n.srcEvent instanceof MouseEvent&&(0!==n.srcEvent.button||n.srcEvent.ctrlKey||n.srcEvent.shiftKey);this.isEnable=!e,this.isEnable&&this.onstart&&this.onstart(n.srcEvent)}onInteract(n){this.isEnable&&this.oninteract&&this.oninteract(n.srcEvent)}}var Ga;let ea=Ga=class extends Xs{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return Ga._instance||(Ga._instance=new Ga("TableSelecter"),Ga._instance.initialize()),Ga._instance}onStoreAdded(){super.onStoreAdded(),fe.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),fe.unregister(this)}get viewTable(){let n=Be.instance.get(this.viewTableIdentifier);return n||(n=Be.instance.getObjects(ci)[0],n&&(this.viewTableIdentifier.length<1||Be.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,fe.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};K([ot()],ea.prototype,"viewTableIdentifier",void 0),ea=Ga=K([Wn("TableSelecter")],ea);let ip=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Ni(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(bt(Gt))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class ui{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new ui){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,l=r+this.m32,c=o+this.m33,u=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==u&&(u=1e-4),a/=u,l/=u,c/=u;let h=c-o;if(0==h)return e.x=i,e.y=r,e.z=o,e.w=o,e;let g=-o/h;return i+=g*(a-i),r+=g*(l-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return ui.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new ui){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(ui.makePosition(e,ui.MATRIX3D))}static makePerspective(n,e=new ui){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(ui.makePerspective(n,ui.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,l=this.m22,c=this.m23,u=this.m24,h=this.m31,g=this.m32,E=this.m33,L=this.m34,Z=this.m41,re=this.m42,oe=this.m43,ce=this.m44;e[0]=c*L*re-u*E*re+u*g*oe-l*L*oe-c*g*ce+l*E*ce,e[1]=s*E*re-o*L*re-s*g*oe+r*L*oe+o*g*ce-r*E*ce,e[2]=o*u*re-s*c*re+s*l*oe-r*u*oe-o*l*ce+r*c*ce,e[3]=s*c*g-o*u*g-s*l*E+r*u*E+o*l*L-r*c*L;let ue=i*e[0]+a*e[1]+h*e[2]+Z*e[3];return 0==ue?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=u*E*Z-c*L*Z-u*h*oe+a*L*oe+c*h*ce-a*E*ce,e[5]=o*L*Z-s*E*Z+s*h*oe-i*L*oe-o*h*ce+i*E*ce,e[6]=s*c*Z-o*u*Z-s*a*oe+i*u*oe+o*a*ce-i*c*ce,e[7]=o*u*h-s*c*h+s*a*E-i*u*E-o*a*L+i*c*L,e[8]=l*L*Z-u*g*Z+u*h*re-a*L*re-l*h*ce+a*g*ce,e[9]=s*g*Z-r*L*Z-s*h*re+i*L*re+r*h*ce-i*g*ce,e[10]=r*u*Z-s*l*Z+s*a*re-i*u*re-r*a*ce+i*l*ce,e[11]=s*l*h-r*u*h-s*a*g+i*u*g+r*a*L-i*l*L,e[12]=c*g*Z-l*E*Z-c*h*re+a*E*re+l*h*oe-a*g*oe,e[13]=r*E*Z-o*g*Z+o*h*re-i*E*re-r*h*oe+i*g*oe,e[14]=o*l*Z-r*c*Z-o*a*re+i*c*re+r*a*oe-i*l*oe,e[15]=r*c*h-o*l*h+o*a*g-i*c*g-r*a*E+i*l*E,n.setData(e),n.scalar(1/ue),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Zn.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(ui.MATRIX3D.setCSS(n).flatten()):this.append(ui.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new ui){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,l=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,c=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,u=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,h=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,g=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,E=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,L=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Z=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,re=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,oe=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,ce=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,ue=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=l,i.m22=c,i.m23=u,i.m24=h,i.m31=g,i.m32=E,i.m33=L,i.m34=Z,i.m41=re,i.m42=oe,i.m43=ce,i.m44=ue,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}ui.MATRIX3D=new ui;class ad{constructor(n){this.matrix=new ui,this.sceneTransform=new ui,this.inverseSceneTransform=new ui,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Zn.relation(e.paddingTop,i),this.paddingTop=Zn.relation(e.paddingTop,r),this.marginLeft=Zn.relation(e.marginLeft,i),this.marginTop=Zn.relation(e.marginTop,r),this.borderLeft=Zn.relation(e.borderLeft,i),this.borderTop=Zn.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new ad(r),a=ui.multiply(this.sceneTransform,s.inverseSceneTransform),l={x:0,y:0,z:0,w:1};return l.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,l.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,l.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,l.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(l),l}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new ui),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],l=Zn.relation(a[0],i.offsetWidth,.5*i.offsetWidth),c=Zn.relation(a[1],i.offsetHeight,.5*i.offsetHeight),u=Zn.relation(a[2],0,0);e.appendPosition(-l,-c,-u),e.appendCSS(r.transform),e.appendPosition(l,c,u)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Zn.parse(a.perspective)}if(n.parentElement&&s){let l=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),c=Zn.relation(l[0],i.parentElement.offsetWidth),u=Zn.relation(l[1],i.parentElement.offsetHeight);e.appendPosition(-c,-u,0),e.appendPerspective(s),e.appendPosition(c,u,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let $a=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new ad(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new ad(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new ad(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(bt(ei))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class ti{get tabletopObject(){return this._tabletopObject}get layerName(){return this._layerName}get colideLayers(){return this._colideLayers}get transformCssOffset(){return this._transformCssOffset}set option(n){this.unregister(),this.synchronizer.unregister(),this._tabletopObject=n.tabletopObject??null,this._layerName=n.layerName??"",this._colideLayers=n.colideLayers??[],this._transformCssOffset=n.transformCssOffset??"",this._layerName.length<1&&this._tabletopObject&&(this._layerName=this._tabletopObject.aliasName),this.register(),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(n){this._posX=n,this.setUpdateBatching()}get posY(){return this._posY}set posY(n){this._posY=n,this.setUpdateBatching()}get posZ(){return this._posZ}set posZ(n){this._posZ=n,this.setUpdateBatching()}get magnitude(){return this.input.magnitude}get isPointerMoved(){return this.input.isPointerMoved}get state(){return this.selectionService.state(this.tabletopObject)}set state(n){this.selectionService.add(this.tabletopObject,n)}get isGridSnap(){return ea.instance.gridSnap}constructor(n,e,i,r,o,s){this.ngZone=n,this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._layerName="",this._colideLayers=[],this._transformCssOffset="",this.isDisable=!1,this.onstart=new Ht,this.ondragstart=new Ht,this.ondrag=new Ht,this.ondragend=new Ht,this.onend=new Ht,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=-1,this.width=-1,this.ratio=1,this.isUpdateBatching=!1,this.collidableElements=[],this.input=new Js(this.nativeElement,!1),this.synchronizer=new Zo(this,this.selectionService,this.pointerDeviceService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,n=>{n.isSendFromSelf&&(this.input.isGrabbing||this.state!==kt.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.state=kt.NONE,this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.isDisable&&this.state!==kt.NONE&&(this.state=kt.NONE),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.unregister(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.findCollidableElements()}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1)}dispose(){fe.unregister(this),this.batchService.remove(this)}onInputStart(n){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||n instanceof MouseEvent&&(0!==n.button||n.ctrlKey||n.shiftKey))return void this.cancel();this.onstart.emit(n),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(!0),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let e={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},i=this.coordinateService.convertToGlobal(e,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=i.x-this.input.pointer.x,this.pointerOffset2d.y=i.y-this.input.pointer.y,this.pointerOffset2d.z=i.z-this.input.pointer.z,this.pointerStart3d.x=e.x,this.pointerStart3d.y=e.y,this.pointerStart3d.z=e.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.synchronizer.prepareMove()}onInputMove(n){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();n.cancelable&&n.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let e={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};e.x=Math.min(window.innerWidth-.1,Math.max(e.x,.1)),e.y=Math.min(window.innerHeight-.1,Math.max(e.y,.1));let i=document.elementFromPoint(e.x,e.y);if(null==i)return;let r=this.coordinateService.calcTabletopLocalCoordinate(e,i);if(r.x-=this.width/2,r.y-=this.height/2,this.posX===r.x&&this.posY===r.y&&this.posZ===r.z)return;this.input.isDragging||this.ondragstart.emit(n),this.ondrag.emit(n);let s=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;s<this.ratio&&(this.ratio+=.1*(s-this.ratio));let a={x:r.x-this.posX,y:r.y-this.posY,z:r.z-this.posZ};this.posX=r.x,this.posY=r.y,this.posZ=r.z,this.synchronizer.updateMove(a)}onInputEnd(n){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(n);let e_x=this.posX,e_y=this.posY,e_z=this.posZ;this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.synchronizer.finishMove({x:this.posX-e_x,y:this.posY-e_y,z:this.posZ-e_z}),this.cancel(),this.onend.emit(n)}onContextMenu(n){if(this.isDisable)return this.cancel();n.cancelable&&n.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let e=this.input.isGrabbing&&n.isTrusted;if(this.cancel(),e){n.stopPropagation();let i=new MouseEvent(n.type,n);this.ngZone.run(()=>this.nativeElement.dispatchEvent(i))}}callSelectedEvent(){this.tabletopObject&&fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(n=25){this.posX=this.calcSnapNum(this.posX,n),this.posY=this.calcSnapNum(this.posY,n)}calcSnapNum(n,e){return e<=0?n:(n=n<0?n-e/2:n+e/2)-n%e}setPosition(n){this._posX=n.location.x,this._posY=n.location.y,this._posZ=n.posZ,this.updateTransformCss()}setUpdateBatching(){!this.isUpdateBatching&&this.tabletopObject&&(this.isUpdateBatching=!0,this.batchService.add(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.isUpdateBatching=!1})),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(n){let e=n.children;for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&"none"!==getComputedStyle(r).pointerEvents&&this.collidableElements.push(r)}if(this.collidableElements.length<1)for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&this.findNestedCollidableElements(r)}}setPointerEvents(n){let e=n?"auto":"none";this.collidableElements.forEach(i=>i.style.pointerEvents=e)}setAnimatedTransition(n){this.nativeElement.style.transition=n?"transform 132ms linear":""}shouldTransition(n){return n.location.x!==this.posX||n.location.y!==this.posY||n.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let n=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=n}setCollidableLayer(n){let e=n;for(let i of ti.layerMap.keys())e=this.colideLayers.includes(i)?!this.input.isGrabbing||n:!n,ti.layerMap.get(i).forEach(r=>{r===this||r.input?.isGrabbing||r.setPointerEvents(e)})}register(){let n=ti.layerMap.get(this.layerName)??new Set;n.add(this),ti.layerMap.set(this.layerName,n)}unregister(){let n=ti.layerMap.get(this.layerName);n&&(n.delete(this),n.size<1&&ti.layerMap.delete(this.layerName))}}ti.layerMap=new Map,ti.\u0275fac=function(n){return new(n||ti)(J(Gt),J(Ln),J(ip),J(ei),J($a),J(Yo))},ti.\u0275dir=vt({type:ti,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"},features:[Mn]});class Zo{get selectedMovables(){let n=new Set;for(let e of this.selection.objects)Zo.objectMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e,i){this.movable=n,this.selection=e,this.pointerDevice=i,this.callbackOnPickStart=this.onPickStart.bind(this),this.callbackOnPickObject=this.onPickObject.bind(this),this.callbackOnPickRegion=this.onPickRegion.bind(this),this._isDestroyed=!1}initialize(){this.register(),this.addEventListeners()}destroy(){this.unregister(),this._isDestroyed=!0,this.removeEventListeners(),this.movable=null}onPickStart(n){null==this.movable.tabletopObject||this.movable.isDisable||(this.movable.state=n.detail.isMagnetic?kt.MAGNETIC:kt.SELECTED,this.prepareMove())}onPickObject(n){this.selection.excludeElement!==this.movable.nativeElement&&(this.pointerDevice.isDragging||this.movable.isDisable||(null==this.selection.excludeElement?(this.toggleState(),this.selection.excludeElement=this.movable.nativeElement):this.movable.state=kt.SELECTED))}onPickRegion(n){if(this.pointerDevice.isDragging||this.movable.isDisable)return;let e=n.detail.x,i=n.detail.y,r=n.detail.width,o=n.detail.height,s=this.movable.nativeElement.getBoundingClientRect();s.x<=e+r&&e<=s.x+s.width&&s.y<=i+o&&i<=s.y+s.height&&(this.movable.state=kt.SELECTED)}toggleState(){this.movable.state=this.movable.state===kt.SELECTED?kt.NONE:kt.SELECTED}prepareMove(){if(this.shouldSynchronize())for(let n of this.selectedMovables)n!==this.movable&&(n.isDisable?n.state=kt.NONE:(n.state=kt.SELECTED,n.setPointerEvents(!1),n.setAnimatedTransition(!1)))}updateMove(n){if(this.shouldSynchronize()){if(this.movable.state===kt.MAGNETIC){let e=ti.layerMap.get(this.movable.layerName);if(e)for(let i of e)i!==this.movable&&!i.isDisable&&i.state===kt.NONE&&(i.width<0&&(i.width=i.nativeElement.clientWidth),i.height<0&&(i.height=i.nativeElement.clientHeight),this.isProximity(i)&&(i.state=kt.MAGNETIC,i.setPointerEvents(!1),i.setAnimatedTransition(!1)))}for(let e of this.selectedMovables)e!==this.movable&&(e.posX+=n.x,e.posY+=n.y,e.posZ+=n.z,e.state===kt.MAGNETIC&&(e.posX=.02*(this.movable.posX+(this.movable.width-e.width)/2)+.98*e.posX,e.posY=.02*(this.movable.posY+(this.movable.height-e.height)/2)+.98*e.posY,e.posZ=.02*this.movable.posZ+.98*e.posZ),e.posZ<0&&(e.posZ=0))}else this.movable.isPointerMoved&&this.selection.clear()}finishMove(n){if(!this.shouldSynchronize())return void this.selection.clear();for(let a of this.selectedMovables)a!==this.movable&&(a.posX+=n.x,a.posY+=n.y,a.posZ+=n.z);let e=Array.from(this.selectedMovables).sort((a,l)=>{let c=a.tabletopObject.zindex,u=l.tabletopObject.zindex;return null==c||null==u?0:c-u}).filter(a=>a.state===kt.MAGNETIC&&a!==this.movable),i=360/e.length,r=360*Math.random(),o=Math.min(Math.max((this.movable.width+this.movable.height)/2,50),75),s_x=this.movable.posX+this.movable.width/2,s_y=this.movable.posY+this.movable.height/2;for(let a of e){if(a===this.movable)continue;r+=i;let l=rn.radians(r);a.posX=s_x+o*Math.sin(l)-a.width/2,a.posY=s_y+o*Math.cos(l)-a.height/2}this.movable.state===kt.MAGNETIC&&this.selection.size<=1?this.selection.clear():this.refreshState()}shouldSynchronize(){return this.movable.state!==kt.NONE}refreshState(){for(let n of this.selectedMovables)n.state=kt.SELECTED,n!==this.movable&&(n.setPointerEvents(!0),n.setAnimatedTransition(!0),n.width=n.height=-1)}isProximity(n,e=this.movable){let i=Math.max(.95*((n.width+e.width)/4+(n.height+e.height)/4),25)**2;return rn.sqrMagnitude({x:n.posX+n.width/2,y:n.posY+n.height/2,z:n.posZ},{x:e.posX+e.width/2,y:e.posY+e.height/2,z:e.posZ})<i}addEventListeners(){this.movable.nativeElement.addEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.addEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.addEventListener("pickregion",this.callbackOnPickRegion)}removeEventListeners(){this.movable.nativeElement.removeEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.removeEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.removeEventListener("pickregion",this.callbackOnPickRegion)}register(){let n=Zo.objectMap.get(this.movable.tabletopObject)??new Set;n.add(this.movable),Zo.objectMap.set(this.movable.tabletopObject,n)}unregister(){let n=Zo.objectMap.get(this.movable.tabletopObject);n&&(n.delete(this.movable),n.size<1&&Zo.objectMap.delete(this.movable.tabletopObject))}static congregate(n,e){let i=e.sort((a,l)=>{let c=a.zindex,u=l.zindex;return null==c||null==u?0:c-u}),r=360/i.length,o=360*Math.random(),s=Math.min(Math.max(9*i.length,5),75);for(let a of i){let l=Zo.objectMap.get(a);if(null!=l)for(let c of l){c.setAnimatedTransition(!0),c.stopTransition(),c.width<0&&(c.width=c.nativeElement.clientWidth),c.height<0&&(c.height=c.nativeElement.clientHeight),o+=r;let u=rn.radians(o);c.posX=n.x+s*Math.sin(u)-c.width/2,c.posY=n.y+s*Math.cos(u)-c.height/2,c.posZ=n.z}}}}Zo.objectMap=new Map;var kt=(()=>(function(t){t[t.NONE=0]="NONE",t[t.SELECTED=1]="SELECTED",t[t.MAGNETIC=2]="MAGNETIC"}(kt||(kt={})),kt))();let Yo=(()=>{class t{get size(){return this.selectionMap.size}get objects(){return Array.from(this.selectionMap.keys())}constructor(){this.selectionMap=new Map,this.previus=new Set,this.excludeElement=null,this.isUdpateCssBatching=!1}state(e){return this.selectionMap.get(e)??kt.NONE}add(e,i=kt.SELECTED){if(i===kt.NONE)return this.remove(e);let r=this.objects;this.selectionMap.set(e,i),this.updateHighlight(r)}remove(e){if(!this.selectionMap.has(e))return;let i=this.objects;this.selectionMap.delete(e),this.updateHighlight(i)}clear(){let e=this.objects;this.selectionMap.clear(),this.updateHighlight(e)}congregate(e){Zo.congregate(e,this.objects)}updateHighlight(e=[]){e.forEach(i=>this.previus.add(i)),!this.isUdpateCssBatching&&(queueMicrotask(()=>{this.isUdpateCssBatching=!1,this.selectionMap.forEach((r,o)=>this.previus.add(o));let i=Array.from(this.previus);this.previus.clear(),0<i.length&&fe.trigger("UPDATE_SELECTION",{changed:i});for(let r of i)fe.trigger(`UPDATE_SELECTION/identifier/${r.identifier}`,{changed:i})}),this.isUdpateCssBatching=!0)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const wV=gn.create("./assets/images/skeleton.png");let hc=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof gn?e:At.instance.get(e);return i&&!i.isEmpty?i:wV}getEmptyOr(e){let i=e instanceof gn?e:At.instance.get(e);return i&&!i.isEmpty?i:gn.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class ta{get selectedRotables(){let n=new Set;for(let e of this.selection.objects)ta.rotablesMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e){this.rotable=n,this.selection=e,this._isDestroyed=!1}initialize(){this.register()}destroy(){this.unregister(),this._isDestroyed=!0,this.rotable=null}prepareRotate(){if(1<this.selection.size&&this.rotable.state!==kt.NONE)for(let n of this.selectedRotables)n!==this.rotable&&(n.isDisable||n.setAnimatedTransition(!1));else this.selection.clear()}updateRotate(){if(!(this.selection.size<=1||this.rotable.state===kt.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.rotate=this.rotable.rotate)}finishRotate(){if(!(this.selection.size<=1||this.rotable.state===kt.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.setAnimatedTransition(!0),n.rotate=this.rotable.rotate)}register(){let n=ta.rotablesMap.get(this.rotable.tabletopObject)??new Set;n.add(this.rotable),ta.rotablesMap.set(this.rotable.tabletopObject,n)}unregister(){let n=ta.rotablesMap.get(this.rotable.tabletopObject);n&&(n.delete(this.rotable),n.size<1&&ta.rotablesMap.delete(this.rotable.tabletopObject))}}ta.rotablesMap=new Map;let fc=(()=>{class t{get tabletopObject(){return this._tabletopObject}get targetPropertyName(){return this._targetPropertyName}get targetProperty(){return this.tabletopObject[this.targetPropertyName]}set targetProperty(e){this.targetPropertyName in this.tabletopObject&&(this.tabletopObject[this.targetPropertyName]=e)}get transformCssOffset(){return this._transformCssOffset}get grabbingSelecter(){return this._grabbingSelecter}set option(e){this.synchronizer.unregister(),this._tabletopObject=e.tabletopObject,this._targetPropertyName=e.targetPropertyName??"",this._grabbingSelecter=e.grabbingSelecter??".rotate-grab",this._transformCssOffset=e.transformCssOffset??"",this._targetPropertyName.length<1&&this._tabletopObject&&(this._targetPropertyName="rotate"),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateBatching()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}get state(){return this.selectionService.state(this.tabletopObject)}constructor(e,i,r,o,s){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.selectionService=s,this._targetPropertyName="",this._transformCssOffset="",this._grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Ht,this.ondragstart=new Ht,this.ondrag=new Ht,this.ondragend=new Ht,this.onend=new Ht,this.cssRotate=0,this._rotate=0,this.rotateOffset=0,this.isUpdateBatching=!1,this.grabbingElement=null,this.input=new Js(this.nativeElement,!1),this.synchronizer=new ta(this,this.selectionService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{e.isSendFromSelf&&(this.input.isGrabbing||this.state!==kt.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(this.targetProperty),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)}ngOnDestroy(){this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.setAnimatedTransition(!0)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0)}dispose(){fe.unregister(this),this.batchService.remove(this)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||e instanceof MouseEvent&&(0!==e.button||e.ctrlKey||e.shiftKey))return void this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.synchronizer.prepareRotate()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r,this.synchronizer.updateRotate()}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.synchronizer.finishRotate(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){let l=Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2),c=(rn.degrees(l)-i+720)%360;return c<180?c:c-360}radianFromMatrix(e,i,r,o,s,a){let l=0;if(0!==e||0!==i){let c=Math.sqrt(e*e+i*i);l=i>0?Math.acos(e/c):-Math.acos(e/c)}else if(0!==r||0!==o){let c=Math.sqrt(r*r+o*o);l=.5*Math.PI-(o>0?Math.acos(-r/c):-Math.acos(r/c))}return l}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateBatching(){this.isUpdateBatching||(this.isUpdateBatching=!0,this.batchService.add(()=>{this.targetProperty=this.rotate,this.isUpdateBatching=!1})),this.updateTransformCss()}setRotate(e){e&&this.targetPropertyName in e&&(this._rotate=e[this.targetPropertyName]),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return this.targetProperty!==this.rotate}stopTransition(e=this.rotate){let i=window.getComputedStyle(this.nativeElement).transform;if(Math.abs(e-this.cssRotate)<180)return;let r=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/gi.exec(i);if(!r)return;let o=this.radianFromMatrix(Number(r[1]),Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]),Number(r[6])),s=rn.degrees(o),a_x=Math.cos(o),a_y=Math.sin(o),l=rn.radians(e),c_x=Math.cos(l),u=a_x*Math.sin(l)-c_x*a_y,h=Math.abs(e-s);180<h&&(h=360-h);let g=e+(0<u?-h:h);if(g===s)return;let E=this.nativeElement.style.transition;this.nativeElement.style.transition="",this.cssRotate=g,this.nativeElement.style.transform=`${this.transformCssOffset} rotateZ(${g.toFixed(4)}deg)`,this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform,this.nativeElement.style.transition=E}updateTransformCss(){this.cssRotate=this.rotate;let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(J(Ln),J(ip),J(ei),J($a),J(Yo))},t.\u0275dir=vt({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend"},features:[Mn]}),t})();const q0=function(t){return{transform:t}};function EV(t,n){if(1&t&&(Le(0,"img",7),Zt(1,"safe")),2&t){const e=H();D("ngStyle",dt(5,q0,"rotateZ("+e.topCard.rotate+"deg)"))("src",Yt(1,2,e.imageFile.url,"resourceUrl"),Kn)}}function TV(t,n){1&t&&(je(0),O(1,"div",8)(2,"i",9),Q(3,"autorenew"),F()(),O(4,"div",10)(5,"i",9),Q(6,"autorenew"),F()(),O(7,"div",11)(8,"i",9),Q(9,"autorenew"),F()(),O(10,"div",12)(11,"i",9),Q(12,"autorenew"),F()(),He())}function xV(t,n){if(1&t&&(O(0,"div",13)(1,"span"),Q(2),F()()),2&t){const e=H();D("ngStyle",dt(2,q0,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),Hn("",e.cards.length,"\u679a")}}function SV(t,n){if(1&t&&(O(0,"div",14)(1,"span"),Q(2),F()()),2&t){const e=H();D("ngStyle",dt(2,q0,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),Hn("",e.ownerName," \u304c\u78ba\u8a8d\u4e2d")}}const DV=function(t){return{"is-magnetic":t}};function MV(t,n){if(1&t&&Le(0,"div",15),2&t){const e=H();D("ngClass",dt(1,DV,e.isMagnetic))}}const kV=function(t){return{"is-empty":t}};let IV=(()=>{class t{get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?rn.clampMin(e.size):2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get selectionState(){return this.selectionService.state(this.cardStack)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){fe.unregister(this),fe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.cardStack&&i&&i.userId===this.cardStack.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new Y0(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),fe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof ur||e.detail instanceof pi))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof ur){let i=e.detail;this.cardStack.calcSqrDistance(i)<2500&&this.cardStack.putOnTop(i)}else if(e.detail instanceof pi){let i=e.detail;this.cardStack.calcSqrDistance(i)<625&&this.concatStack(i)}}onDoubleClick(){this.ngZone.run(()=>{null!=this.drawCard()&&Re.play(Ee.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.cardStack.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu(oa)),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let l=pi.create(this.cardStack.name);l.location.x=this.cardStack.location.x+50-100*Math.random(),l.location.y=this.cardStack.location.y+50-100*Math.random(),l.posZ=this.cardStack.posZ,l.location.name=this.cardStack.location.name,l.rotate=this.rotate,l.toTopmost(),i.push(l)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=pi.create(e.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.cardStack.topCard?.size??2,r={x:this.cardStack.location.x+i*this.gridSize/2,y:this.cardStack.location.y+i*this.gridSize/2,z:this.cardStack.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),this.isSelected){let o=()=>this.selectionService.objects.filter(s=>s.aliasName===this.cardStack.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5c71\u672d",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceUpAll()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceDownAll()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.uprightAll()),Re.play(Ee.cardDraw)}},pn,{name:"\u3059\u3079\u3066\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{Re.play(Ee.cardShuffle),o().forEach(s=>{s.shuffle(),fe.call("SHUFFLE_CARD_STACK",{identifier:s.identifier})})}}]})}return e.push(pn),e}makeContextMenu(e){let i=[];return e&&(i.push({name:"\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&Re.play(Ee.cardDraw)}}),i.push(pn),i.push({name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),Re.play(Ee.cardDraw)}}),i.push({name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),Re.play(Ee.cardDraw)}}),i.push(pn),i.push({name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),Re.play(Ee.cardDraw)}}),i.push({name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),Re.play(Ee.cardDraw)}}),i.push({name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),Re.play(Ee.cardDraw)}}),i.push(pn)),i.push({name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),Re.play(Ee.cardShuffle),fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})}}),i.push({name:"\u30ab\u30fc\u30c9\u4e00\u89a7",action:()=>{this.showStackList(this.cardStack)}}),i.push(pn),e&&(i.push(this.isShowTotal?{name:"\u679a\u6570\u3092\u975e\u8868\u793a\u306b\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u679a\u6570\u3092\u8868\u793a\u3059\u308b",action:()=>{this.cardStack.isShowTotal=!0}}),i.push({name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)}}),i.push(pn),i.push({name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(We.peerIds.length+1),Re.play(Ee.cardDraw)}}),i.push({name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),Re.play(Ee.cardShuffle)}}),i.push(pn),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.toTopmost(),Re.play(Ee.cardPut)}}),i.push({name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),Re.play(Ee.sweep)}})),i}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=We.peer.userId,this.panelService.open(CV,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hr),J(dn),J(Ln),J(Oi),J(Yo),J(hc),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&ge("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},features:[Mn],decls:8,vars:13,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"ngStyle","src",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),O(2,"div"),ge("@shuffle.start",function(o){return i.animationShuffleStarted(o)})("@shuffle.done",function(o){return i.animationShuffleDone(o)}),X(3,EV,2,7,"img",2),F(),X(4,TV,13,0,"ng-container",3),X(5,xV,3,4,"div",4),X(6,SV,3,4,"div",5),X(7,MV,1,3,"div",6),F()()),2&e&&(un("width",i.size*i.gridSize,"px"),D("ngClass",dt(11,kV,i.isEmpty))("movable.option",i.movableOption),k(1),D("rotable.option",i.rotableOption),k(1),D("@shuffle",i.animeState),k(1),D("ngIf",i.topCard&&i.imageFile),k(1),D("ngIf",!i.isIconHidden),k(1),D("ngIf",i.isShowTotal),k(1),D("ngIf",i.hasOwner),k(1),D("ngIf",i.isSelected))},dependencies:[ai,fn,Ta,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99;inset:-5px}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("shuffle",[yi("* => active",[vi("800ms ease",go([wt({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),wt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])])]},changeDetection:0}),t})(),K0=(()=>{class t{get tableSelecter(){return ea.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Be.instance.getObjects(Rt)}constructor(e){this.coordinateService=e,this._emptyTable=new ci(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Wa(()=>Be.instance.getObjects(li).filter(i=>i.isVisibleOnTable)),this.cardCache=new Wa(()=>Be.instance.getObjects(ur).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Wa(()=>Be.instance.getObjects(pi).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Wa(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.terrainCache=new Wa(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Wa(()=>Be.instance.getObjects($o)),this.diceSymbolCache=new Wa(()=>Be.instance.getObjects(Ho)),this.initialize()}initialize(){this.refreshCacheAll(),fe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Go.aliasName),void this.refreshCache(Yr.aliasName);let i=Be.instance.get(e.data.identifier);i&&i instanceof cr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=Tn.instance.parseXml(e.data.xmlElement);if(r instanceof cr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),Re.play(Ee.piecePut)}else r instanceof uc&&Ha.instance.addChatTab(r)})}findCache(e){switch(e){case li.aliasName:return this.characterCache;case ur.aliasName:return this.cardCache;case pi.aliasName:return this.cardStackCache;case Go.aliasName:return this.tableMaskCache;case Yr.aliasName:return this.terrainCache;case $o.aliasName:return this.textNoteCache;case Ho.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case Go.aliasName:e instanceof Go&&(e.isLock=!1);case Yr.aliasName:if(e instanceof Yr&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(bt($a))},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class Wa{get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}refresh(){this.needsRefresh=!0}}function OV(t,n){if(1&t&&(Le(0,"img",7),Zt(1,"safe")),2&t){const e=H();D("src",Yt(1,1,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Kn)}}const AV=function(t){return{transform:t}};function PV(t,n){if(1&t&&(O(0,"div",8)(1,"span"),Q(2),F()()),2&t){const e=H();D("ngStyle",dt(2,AV,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),k(2),gt(e.ownerName)}}function FV(t,n){1&t&&(Le(0,"img",9),Zt(1,"safe")),2&t&&D("src",Yt(1,1,H().frontImage.url,"resourceUrl"),Kn)}function NV(t,n){1&t&&(je(0),O(1,"div",10)(2,"i",11),Q(3,"autorenew"),F()(),O(4,"div",12)(5,"i",11),Q(6,"autorenew"),F()(),O(7,"div",13)(8,"i",11),Q(9,"autorenew"),F()(),O(10,"div",14)(11,"i",11),Q(12,"autorenew"),F()(),Le(13,"div",15),He())}const RV=function(t){return{"is-magnetic":t}};function LV(t,n){if(1&t&&Le(0,"div",16),2&t){const e=H();D("ngClass",dt(1,RV,e.isMagnetic))}}let BV=(()=>{class t{get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return rn.clampMin(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get selectionState(){return this.selectionService.state(this.card)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.selectionService=l,this.imageService=c,this.pointerDeviceService=u,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.card&&i&&i.userId===this.card.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new Y0(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),fe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof ur||e.detail instanceof pi)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof pi)){let i=e.detail;this.card.calcSqrDistance(i)<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card))}}onDoubleClick(){this.ownerIsOnline&&!this.isHand||this.ngZone.run(()=>{this.state=this.isVisible&&!this.isHand?Es.BACK:Es.FRONT,this.owner="",Re.play(Ee.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.card.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu(oa)),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=pi.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>this.card.calcSqrDistance(r)<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.card.location.x+this.card.size*this.gridSize/2,y:this.card.location.y+this.card.size*this.gridSize/2,z:this.card.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.card.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ab\u30fc\u30c9",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceUp()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceDown()),Re.play(Ee.cardDraw)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>{o.faceDown(),o.owner=We.peer.userId}),Re.play(Ee.cardDraw)}}]})}return e.push(pn),e}makeContextMenu(e){let i=[];return i.push(!this.isVisible||this.isHand?{name:"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),Re.play(Ee.cardDraw)}}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),Re.play(Ee.cardDraw)}}),i.push(this.isHand?{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),Re.play(Ee.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{Re.play(Ee.cardDraw),this.card.faceDown(),this.owner=We.peer.userId}}),i.push(pn),i.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),Re.play(Ee.cardPut)}}),i.push(pn),e&&(i.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),Re.play(Ee.cardPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),Re.play(Ee.sweep)}})),i}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hr),J(dn),J(Ln),J(Oi),J(K0),J(Yo),J(hc),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&ge("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},features:[Mn],decls:7,vars:9,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),X(2,OV,2,4,"img",2),X(3,PV,3,4,"div",3),X(4,FV,2,4,"img",4),X(5,NV,14,0,"ng-container",5),X(6,LV,1,3,"div",6),F()()),2&e&&(un("width",i.size*i.gridSize,"px"),D("movable.option",i.movableOption),k(1),D("rotable.option",i.rotableOption),k(1),D("ngIf",i.imageFile),k(1),D("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),k(1),D("ngIf",i.isHand&&i.frontImage),k(1),D("ngIf",!i.isIconHidden),k(1),D("ngIf",i.isSelected))},dependencies:[ai,fn,Ta,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:3px;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();function zV(t,n){1&t&&(je(0),O(1,"div",12)(2,"div",13)(3,"div",14),Q(4,"autorenew"),F(),O(5,"div",15),Q(6,"autorenew"),F()()(),He())}const UV=function(t){return{"is-magnetic":t}};function VV(t,n){if(1&t&&Le(0,"div",16),2&t){const e=H();D("ngClass",dt(1,UV,e.isMagnetic))}}function jV(t,n){if(1&t&&(O(0,"span"),Q(1),F()),2&t){const e=H(3);k(1),gt(e.face)}}function HV(t,n){1&t&&(O(0,"span"),Q(1,"???"),F())}const wD=function(t){return{transform:t}};function GV(t,n){if(1&t&&(O(0,"div",19)(1,"div"),Q(2),X(3,jV,2,1,"span",3),X(4,HV,2,0,"span",3),F()()),2&t){const e=H().$implicit,i=H();D("ngStyle",dt(4,wD,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),Hn("",i.name,":"),k(1),D("ngIf",i.isVisible),k(1),D("ngIf",!i.isVisible)}}function $V(t,n){if(1&t&&(O(0,"div",20)(1,"div"),Q(2),F()()),2&t){const e=H().$implicit,i=H();D("ngStyle",dt(2,wD,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),gt(i.ownerName)}}function WV(t,n){if(1&t&&(je(0),X(1,GV,5,6,"div",17),X(2,$V,3,4,"div",18),He()),2&t){const e=H();k(1),D("ngIf",0<e.name.length),k(1),D("ngIf",e.hasOwner&&0<e.ownerName.length)}}const ZV=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function YV(t,n){if(1&t&&(Le(0,"img",21),Zt(1,"safe")),2&t){const e=H();D("src",Yt(1,2,e.imageFile.url,"resourceUrl"),Kn)("ngClass",_i(5,ZV,!e.isVisible,e.isMine))}}const qV=function(t){return{"is-gray-border":t}},KV=function(){return["0","180deg"]};let XV=(()=>{class t{get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return rn.clampMin(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get isVisible(){return this.diceSymbol.isVisible}get selectionState(){return this.selectionService.state(this.diceSymbol)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}constructor(e,i,r,o,s,a,l,c){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=c,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null}ngOnChanges(){fe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on(`UPDATE_GAME_OBJECT/aliasName/${Rt.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);this.diceSymbol&&i&&i.userId===this.diceSymbol.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Rt.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new Y0(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.ngZone.run(()=>this.startIconHiddenTimer())}onDoubleClick(){this.isVisible&&this.ngZone.run(()=>this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.diceSymbol.location.x+this.diceSymbol.size*this.gridSize/2,y:this.diceSymbol.location.y+this.diceSymbol.size*this.gridSize/2,z:this.diceSymbol.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.diceSymbol.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30c0\u30a4\u30b9",action:null,subActions:[{name:"\u3059\u3079\u3066\u632f\u308b",action:()=>{let o=!1;r().forEach(s=>{s.isVisible&&(o=!0,fe.call("ROLL_DICE_SYMBOL",{identifier:s.identifier}),s.diceRoll())}),o&&Re.play(Ee.diceRoll1)}},{name:"\u3059\u3079\u3066\u516c\u958b",action:()=>{r().forEach(o=>o.owner=""),Re.play(Ee.unlock)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{r().forEach(o=>o.owner=We.peer.userId),Re.play(Ee.lock)}}]})}return e.push(pn),e}makeContextMenu(){let e=[];if(this.isVisible&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()}}),e.length&&e.push(pn),(this.isMine||this.hasOwner)&&e.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",Re.play(Ee.unlock)}}),this.isMine||e.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=We.peer.userId,Re.play(Ee.lock)}}),this.isVisible){let i=[];this.faces.forEach(r=>{i.push({name:`${r}`,action:()=>{this.face=r,Re.play(Ee.dicePut)}})}),e.push({name:"\u30c0\u30a4\u30b9\u76ee\u3092\u8a2d\u5b9a",action:null,subActions:i})}return e.push(pn),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.diceSymbol.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),Re.play(Ee.dicePut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),Re.play(Ee.sweep)}}),e}onMove(){this.contextMenuService.close(),Re.play(Ee.dicePick)}onMoved(){Re.play(Ee.dicePut)}diceRoll(){return fe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),Re.play(Ee.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-300,top:i.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(dn),J(hr),J(Ln),J(Oi),J(Yo),J(hc),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&ge("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},features:[Mn],decls:13,vars:20,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[4,"ngFor","ngForOf"],["class","image chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"owner-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"image","chrome-smooth-image-trick",3,"src","ngClass"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1)(2,"div",2),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),X(3,zV,7,0,"ng-container",3),Le(4,"div",4),X(5,VV,1,3,"div",5),Le(6,"div",6),O(7,"div",1),ge("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),O(8,"div",7)(9,"div",8)(10,"div",9),X(11,WV,3,2,"ng-container",10),X(12,YV,2,8,"img",11),F()()()()()()()),2&e&&(un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),D("movable.option",i.movableOption),k(1),D("@bounceInOut","in"),k(1),D("rotable.option",i.rotableOption),k(1),D("ngIf",!i.isIconHidden),k(1),D("ngClass",dt(17,qV,i.hasOwner)),k(1),D("ngIf",i.isSelected),k(2),D("@diceRoll",i.animeState),k(2),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),k(2),D("ngForOf",Ca(19,KV)),k(1),D("ngIf",0<i.imageFile.url.length))},dependencies:[ai,Un,fn,Ta,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("diceRoll",[yi("* => active",[vi("800ms ease",go([wt({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),wt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))])]),Ao("bounceInOut",[yi("void => *",[vi("600ms ease",go([wt({transform:"scale3d(0, 0, 0)",offset:0}),wt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),yi("* => void",[vi(100,wt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();var X0,ld;let rp,QV=function JV(){let t=new mD("DiceBotQueue");return t.add((0,Dt.Z)(function*(){rp=new((yield Y.e(2460).then(Y.bind(Y,383))).default),qo.diceBotInfos=rp.listAvailableGameSystems().sort((n,e)=>n.sortKey<e.sortKey?-1:n.sortKey>e.sortKey?1:0)})),t}(),qo=((X0=class extends Xs{onStoreAdded(){var n=this;super.onStoreAdded(),fe.register(this).on("SEND_MESSAGE",function(){var e=(0,Dt.Z)(function*(i){let r=Be.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem)return;let o=ws.toHalfWidth(r.text).trim(),s=r.tag;try{let a=/^((\d+)?\s+)?(.*)?/gi.exec(o),l=null!=a[2]?Number(a[2]):1,c=null!=a[3]?a[3]:o;if(!c||l<1)return;l>1&&(c=`x${l} ${c}`);let u=yield ld.diceRollAsync(c,s);if(!u.result)return;n.sendResultMessage(u,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),fe.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result,o=n.isSecret;if(r.length<1)return;let s={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:"system dicebot"+(o?" secret":""),name:`${i} : ${e.name}${o?" (Secret)":""}`,text:r};null!=e.to&&0<e.to.length&&(s.to=e.to,e.to.indexOf(e.from)<0&&(s.to+=" "+e.from));let a=Be.instance.get(e.tabIdentifier);a&&a.addMessage(s)}static diceRollAsync(n,e){return(0,Dt.Z)(function*(){const i={id:e,result:"",isSecret:!1};try{const r=yield ld.loadGameSystemAsync(e);if(!r?.COMMAND_PATTERN.test(n))return i;const o=r.eval(n);if(o)return console.log("diceRoll!!!",o.text),console.log("isSecret!!!",o.secret),{id:r.ID,result:o.text.replace(/\n?(#\d+)\n/gi,"$1 "),isSecret:o.secret}}catch(r){console.error(r)}return i})()}static getHelpMessage(n){return(0,Dt.Z)(function*(){try{return(yield ld.loadGameSystemAsync(n)).HELP_MESSAGE}catch(e){console.error(e)}return""})()}static loadGameSystemAsync(n){var e=this;return(0,Dt.Z)(function*(){return yield QV.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return rp.getGameSystemClass(i)}catch{return rp.dynamicLoad(i)}})})()}}).diceBotInfos=[],ld=X0);qo=ld=K([Wn("dice-bot")],qo);let Za=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return Ha.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,c=new Date(o.utc_datetime).getTime();this.timeOffset=c+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+c),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s){let a={from:We.peer.userId,to:this.findId(s),name:this.makeMessageName(o,s),imageIdentifier:this.findImageIdentifier(o),timestamp:this.calcTimeStamp(e),tag:r,text:i};return e.addMessage(a)}findId(e){let i=Be.instance.get(e);return i instanceof li?i.identifier:i instanceof Rt?i.userId:null}findObjectName(e){let i=Be.instance.get(e);return i instanceof li||i instanceof Rt?i.name:e}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" > "+this.findObjectName(i)}findImageIdentifier(e){let i=Be.instance.get(e);return i instanceof li?i.imageFile?i.imageFile.identifier:"":i instanceof Rt?i.imageIdentifier:e}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})(),ED=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Wt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[Mn],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(O(0,"div",0),Q(1),F()),2&e&&(D("@bounce",i.animeState),k(1),gt(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Ao("bounce",[BT("active",wt({transform:""})),yi("* => active",[vi("600ms ease",go([wt({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),wt({transform:"scale3d(2, 2, 2)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})(),Q0=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["text-view"]],inputs:{text:"text",title:"title"},decls:3,vars:1,consts:[[1,"text"]],template:function(e,i){1&e&&(O(0,"span")(1,"pre",0),Q(2),F()()),2&e&&(k(2),gt(i.text))},styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})();const tj=["textArea"];function nj(t,n){1&t&&(Le(0,"img",15),Zt(1,"safe")),2&t&&D("src",Yt(1,1,H().imageFile.url,"resourceUrl"),Kn)}function ij(t,n){if(1&t&&(O(0,"option",16),Q(1),F()),2&t){const e=H();vn("value",null==e.myPeer?null:e.myPeer.identifier),k(1),Hn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function rj(t,n){if(1&t&&(O(0,"option",16),Q(1),F()),2&t){const e=n.$implicit;vn("value",e.identifier),k(1),Hn("",e.name," ")}}function oj(t,n){1&t&&(je(0),Q(1,"\uff08\u3042\u306a\u305f\uff09"),He())}function sj(t,n){if(1&t&&(O(0,"option",16),Q(1),X(2,oj,2,0,"ng-container",9),F()),2&t){const e=n.$implicit,i=H();vn("value",e.identifier),k(1),Hn("",e.name," "),k(1),D("ngIf",e===i.myPeer)}}function aj(t,n){if(1&t&&(O(0,"option",16),Q(1),F()),2&t){const e=n.$implicit;vn("value",e.id),k(1),gt("DiceBot"===e.name?"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057":e.name)}}const TD=function(){return{standalone:!0}};function lj(t,n){if(1&t){const e=et();je(0),O(1,"select",17,18),ge("change",function(){Me(e);const r=Pt(2);return ke(H().loadDiceBot(r.value))})("ngModelChange",function(r){return Me(e),ke(H().gameType=r)}),X(3,aj,2,2,"option",6),F(),He()}if(2&t){const e=H();k(1),D("ngModel",e.gameType)("ngModelOptions",Ca(3,TD)),k(2),D("ngForOf",e.diceBotInfos)}}function cj(t,n){1&t&&(je(0),O(1,"select",19)(2,"option",8),Q(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d..."),F()(),He())}function uj(t,n){1&t&&(O(0,"span"),Q(1,", "),F())}function dj(t,n){if(1&t&&(O(0,"span",21),Q(1),X(2,uj,2,0,"span",9),F()),2&t){const e=n.$implicit,i=n.index,r=H(2);k(1),gt(e),k(1),D("ngIf",r.writingPeerNames.length!==i+1)}}function hj(t,n){if(1&t&&(je(0),X(1,dj,3,2,"span",20),O(2,"span"),Q(3," \u304c\u5165\u529b\u4e2d..."),F(),He()),2&t){const e=H();k(1),D("ngForOf",e.writingPeerNames)}}const fj=function(t){return{"direct-message":t}};let xD=(()=>{class t{get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get imageFile(){let e=Be.instance.get(this.sendFrom),i=null;return e instanceof li?i=e.imageFile:e instanceof Rt&&(i=e.image),i||gn.Empty}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Be.instance.getObjects(li).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return qo.diceBotInfos}get myPeer(){return Rt.myCursor}get otherPeers(){return Be.instance.getObjects(Rt)}constructor(e,i,r,o,s){this.ngZone=e,this.chatMessageService=i,this.batchService=r,this.panelService=o,this.pointerDeviceService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Ht,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Ht,this._sendTo="",this.sendToChange=new Ht,this._text="",this.textChange=new Ht,this.chat=new Ht,this.gameHelp="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNames=[]}ngOnInit(){fe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Be.instance.get(e.data.messageIdentifier),r=Be.instance.getObjects(Rt).find(s=>s.userId===i.from),o=r?r.peerId:"?";this.writingPeers.has(o)&&(this.writingPeers.get(o).stop(),this.writingPeers.delete(o),this.updateWritingPeerNames())}).on(`UPDATE_GAME_OBJECT/aliasName/${li.aliasName}`,e=>{if(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom)return;let i=Be.instance.get(e.data.identifier);i&&!this.allowsChat(i)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let i=Be.instance.get(this.sendTo);i instanceof Rt&&i.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new zo(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNames(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNames(),this.batchService.requireChangeDetection())})}ngOnDestroy(){fe.unregister(this),this.batchService.remove(this)}updateWritingPeerNames(){this.writingPeerNames=Array.from(this.writingPeers.keys()).map(e=>{let i=Rt.findByPeerId(e);return i?i.name:""})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let i=Be.instance.get(this.sendTo);if(i instanceof Rt){let r=xn.parse(i.peerId);r&&(e=r.peerId)}}fe.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){e&&e.preventDefault(),!this.text.length||e&&13!==e.keyCode||(this.sendFrom.length||(this.sendFrom=this.myPeer.identifier),this.chat.emit({text:this.text,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight())}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),qo.getHelpMessage(e).then(i=>{console.log("onChangeGameType done\n"+i)})}showDicebotHelp(){qo.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let a of qo.diceBotInfos)a.id===this.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8<"+a.name+"\uff1e");i+="\u306e\u8aac\u660e";let r=this.pointerDeviceService.pointers[0],s=this.panelService.open(Q0,{left:r.x,top:r.y,width:600,height:500});s.title=i,s.text="\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u30002R6[>3]>=5 \uff1a2D6\u306e\u30c0\u30a4\u30b9\u76ee\u304c3\u3088\u308a\u5927\u304d\u3044\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3066\u30015\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000c(10-4*3/2+2)\uff1ac(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u7aef\u6570\u51e6\u7406\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u4f9d\u5b58\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2C\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3001\u5207\u308a\u6368\u3066\u306f /2F\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66A\uff1a\u6607\u9806\u3001D66D\uff1a\u964d\u9806\n\n\u8a73\u7d30\u306f\u4e0b\u8a18URL\u306e\u30b3\u30de\u30f3\u30c9\u30ac\u30a4\u30c9\u3092\u53c2\u7167\nhttps://docs.bcdice.org/\n===================================\n"+this.gameHelp})}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const i of We.peers)if(i.isOpen&&e.location.name===i.peerId)return!1;return!0}}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Za),J(ip),J(dn),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&On(tj,7),2&e){let r;In(r=An())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:25,vars:16,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox"],["class","image",3,"src",4,"ngIf"],[1,"table-cell"],[2,"width","12em",3,"ngModel","ngModelChange"],[3,"value",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[2,"width","10em",3,"ngModel","ngModelChange"],["value",""],[4,"ngIf"],[3,"disabled","click"],["placeholder","Enter\u3067\u9001\u4fe1  Shift+Enter\u3067\u6539\u884c",1,"chat-input",3,"ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[1,"image",3,"src"],[3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","change","ngModelChange"],["select",""],["disabled","",2,"width","12em"],["style","font-weight: bold;",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,i){1&e&&(O(0,"div",0)(1,"div",1),X(2,nj,2,4,"img",2),F(),O(3,"div",3)(4,"div")(5,"select",4),ge("ngModelChange",function(o){return i.sendFrom=o}),X(6,ij,2,2,"option",5),X(7,rj,2,2,"option",6),F(),Q(8," \uff1e "),O(9,"select",7),ge("ngModelChange",function(o){return i.sendTo=o}),O(10,"option",8),Q(11,"\u5168\u54e1"),F(),X(12,sj,3,3,"option",6),F(),X(13,lj,4,4,"ng-container",9),X(14,cj,4,0,"ng-container",9),O(15,"button",10),ge("click",function(){return i.showDicebotHelp()}),Q(16,"?"),F()(),O(17,"div")(18,"form")(19,"textarea",11,12),ge("ngModelChange",function(o){return i.text=o})("input",function(){return i.onInput()})("keydown.enter",function(o){return i.sendChat(o)}),F(),O(21,"button",13),ge("click",function(){return i.sendChat(null)}),Q(22,"SEND"),F()()(),O(23,"div",14),X(24,hj,4,1,"ng-container",9),F()()()),2&e&&(D("ngClass",dt(13,fj,i.isDirect)),k(2),D("ngIf",0<i.imageFile.url.length),k(3),D("ngModel",i.sendFrom),k(1),D("ngIf",!i.onlyCharacters),k(1),D("ngForOf",i.gameCharacters),k(2),D("ngModel",i.sendTo),k(3),D("ngForOf",i.otherPeers),k(1),D("ngIf",0<i.diceBotInfos.length),k(1),D("ngIf",i.diceBotInfos.length<1),k(1),D("disabled",i.diceBotInfos.length<1),k(4),D("ngModel",i.text)("ngModelOptions",Ca(15,TD)),k(5),D("ngIf",0<i.writingPeerNames.length))},dependencies:[ai,Un,fn,ql,Vs,js,Ai,gs,Yi,Wl,Fi,Us,Jn],styles:["[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.chat-input[_ngcontent-%COMP%]{font-family:inherit;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);resize:none;overflow:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}"]}),t})();const pj=["chatInput"],gj=["chatPlette"];function mj(t,n){1&t&&Le(0,"badge",12),2&t&&D("count",H().$implicit.unreadLength)}function _j(t,n){if(1&t){const e=et();O(0,"label")(1,"input",10),ge("ngModelChange",function(r){return Me(e),ke(H().chatTabidentifier=r)}),F(),O(2,"div"),Q(3),X(4,mj,1,1,"badge",11),F()()}if(2&t){const e=n.$implicit,i=H();k(1),vn("value",e.identifier),D("ngModel",i.chatTabidentifier),k(2),gt(e.name),k(1),D("ngIf",e.hasUnread)}}function vj(t,n){1&t&&(O(0,"div",13)(1,"i",14),Q(2,"info_outline"),F(),Q(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),F())}function yj(t,n){if(1&t&&(O(0,"option",19),Q(1),F()),2&t){const e=n.$implicit;vn("value",e),k(1),gt(e)}}function bj(t,n){if(1&t&&(je(0),X(1,yj,2,2,"option",18),He()),2&t){const e=H(2);k(1),D("ngForOf",e.palette.getPalette())}}function Cj(t,n){if(1&t){const e=et();O(0,"div",15)(1,"select",16,17),ge("input",function(){Me(e);const r=Pt(2);return ke(H().selectPalette(r.value))})("click",function(){Me(e);const r=Pt(2);return ke(H().clickPalette(r.value))}),X(3,bj,2,1,"ng-container",9),F()()}if(2&t){const e=H();k(3),D("ngIf",e.palette)}}function wj(t,n){if(1&t){const e=et();O(0,"div",15)(1,"textarea",20),ge("ngModelChange",function(r){return Me(e),ke(H().editPalette=r)}),F()()}if(2&t){const e=H();k(1),D("ngModel",e.editPalette)}}function Ej(t,n){1&t&&(O(0,"span"),Q(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),F())}function Tj(t,n){1&t&&(O(0,"span"),Q(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),F())}let SD=(()=>{class t{get palette(){return this.character.chatPalette}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return qo.diceBotInfos}get chatTab(){return Be.instance.get(this.chatTabidentifier)}get myPeer(){return Rt.myCursor}get otherPeers(){return Be.instance.getObjects(Rt)}constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.doubleClickTimer=null}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){fe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Be.instance.get(e);if(i instanceof li){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){this.doubleClickTimer&&this.text===e?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.text=e,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo)}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}}return t.\u0275fac=function(e){return new(e||t)(J(Za),J(dn))},t.\u0275cmp=Wt({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(On(pj,7),On(gj,5)),2&e){let r;In(r=An())&&(i.chatInputComponent=r.first),In(r=An())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(O(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),X(4,_j,5,4,"label",3),F()(),O(5,"chat-input",4,5),ge("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)}),F(),X(7,vj,4,0,"div",6),F(),X(8,Cj,4,1,"div",7),X(9,wj,2,1,"div",7),O(10,"div",1)(11,"button",8),ge("click",function(){return i.toggleEditMode()}),X(12,Ej,2,0,"span",9),X(13,Tj,2,0,"span",9),F()()()),2&e&&(k(4),D("ngForOf",i.chatMessageService.chatTabs),k(1),D("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),k(2),D("ngIf",i.isEdit),k(1),D("ngIf",!i.isEdit),k(1),D("ngIf",i.isEdit),k(3),D("ngIf",!i.isEdit),k(1),D("ngIf",i.isEdit))},dependencies:[Un,fn,ql,Vs,js,Ai,Ou,Yi,Wl,Fi,Us,ED,xD],styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]}),t})();const xj=function(t){return{"is-magnetic":t}};function Sj(t,n){if(1&t&&Le(0,"div",18),2&t){const e=H();D("ngClass",dt(1,xj,e.isMagnetic))}}const J0=function(t){return{transform:t}};function Dj(t,n){if(1&t&&(O(0,"div",20)(1,"div",21),Q(2),F()()),2&t){const e=n.$implicit,i=H(2);D("ngStyle",dt(2,J0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+e+")")),k(2),gt(i.name)}}const Mj=function(){return["0","180deg"]};function kj(t,n){1&t&&(je(0),X(1,Dj,3,4,"div",19),He()),2&t&&(k(1),D("ngForOf",Ca(1,Mj)))}function Ij(t,n){1&t&&(Le(0,"img",22),Zt(1,"safe")),2&t&&D("src",Yt(1,1,H().imageFile.url,"resourceUrl"),Kn)}let Oj=(()=>{class t{get name(){return this.gameCharacter.name}get size(){return rn.clampMin(this.gameCharacter.size)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get selectionState(){return this.selectionService.state(this.gameCharacter)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}constructor(e,i,r,o,s){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.selectionService=o,this.pointerDeviceService=s,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.rollOption={}}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.gameCharacter},this.rollOption={tabletopObject:this.gameCharacter,targetPropertyName:"roll"}}ngOnDestroy(){fe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.piecePick)}onMoved(){Re.play(Ee.piecePut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.gameCharacter.location.x+this.gameCharacter.size*this.gridSize/2,y:this.gameCharacter.location.y+this.gameCharacter.size*this.gridSize/2,z:this.gameCharacter.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameCharacter.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:[{name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("common"),this.selectionService.remove(o)}),Re.play(Ee.piecePut)}},{name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation(We.peerId),this.selectionService.remove(o)}),Re.play(Ee.piecePut)}},{name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("graveyard"),this.selectionService.remove(o)}),Re.play(Ee.sweep)}}]})}return e.push(pn),e}makeContextMenu(){let e=[];return e.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}}),e.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}}),e.push(pn),e.push({name:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("common"),Re.play(Ee.piecePut)}}),e.push({name:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation(We.peerId),Re.play(Ee.piecePut)}}),e.push({name:"\u5893\u5834\u306b\u79fb\u52d5",action:()=>{this.gameCharacter.setLocation("graveyard"),Re.play(Ee.sweep)}}),e.push(pn),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.gameCharacter.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),Re.play(Ee.piecePut)}}),e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(SD,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}}return t.\u0275fac=function(e){return new(e||t)(J(hr),J(dn),J(Oi),J(Yo),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["game-character"]],hostBindings:function(e,i){1&e&&ge("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},features:[Mn],decls:23,vars:21,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"pedestal-inner"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],[4,"ngIf"],["class","image chrome-smooth-image-trick",3,"src",4,"ngIf"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngFor","ngForOf"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"has-length-limit"],[1,"image","chrome-smooth-image-trick",3,"src"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1)(2,"div",2),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),O(3,"div",3)(4,"div",4)(5,"div",5),Q(6,"autorenew"),F(),O(7,"div",6),Q(8,"autorenew"),F()()(),Le(9,"div",7),X(10,Sj,1,3,"div",8),Le(11,"div",9),O(12,"div",10)(13,"div",11),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),O(14,"div",12),X(15,kj,2,2,"ng-container",13),X(16,Ij,2,4,"img",14),O(17,"div",15)(18,"i",16),Q(19,"autorenew"),F()(),O(20,"div",17)(21,"i",16),Q(22,"autorenew"),F()()()()()()()()),2&e&&(un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),D("movable.option",i.movableOption),k(1),D("@bounceInOut","in"),k(1),D("rotable.option",i.rotableOption),k(8),D("ngIf",i.isSelected),k(3),un("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),D("rotable.option",i.rollOption),k(2),D("ngIf",0<i.name.length),k(1),D("ngIf",0<i.imageFile.url.length),k(1),D("ngStyle",dt(17,J0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px)")),k(3),D("ngStyle",dt(19,J0,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")))},dependencies:[ai,Un,fn,Ta,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:25px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:-30px}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Ao("bounceInOut",[yi("void => *",[vi("600ms ease",go([wt({transform:"scale3d(0, 0, 0)",offset:0}),wt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),wt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),wt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),wt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),yi("* => void",[vi(100,wt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})(),ev=(()=>{class t{constructor(){}createGameCharacter(e){let i=li.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Go.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=At.instance.get(i);r||(r=At.instance.add(i));let o=this.getViewTable();if(!o)return;let s=Yr.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=$o.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=Ho.create(i,r,1),a=null;return s.faces.forEach(l=>{let c=`./assets/images/dice/${o}/${o}[${l}].png`;a=At.instance.get(c),a||(a=At.instance.add(c)),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createTrump(e){let i=pi.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";At.instance.get(r)||At.instance.add(r);let o=["c","d","h","s"],s=[];for(let a of o)for(let l=1;l<=13;l++)s.push(a+("00"+l).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let l="./assets/images/trump/"+a+".gif";At.instance.get(l)||At.instance.add(l);let c=ur.create(We.peer.userId,l,r);i.putOnBottom(c)}return i}makeDefaultTable(){let e=new ci("gameTable"),i=null,r=gn.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/field.jpg",i=At.instance.add(r),e.imageIdentifier=i.identifier,r=gn.createEmpty("testBackgroundImage_image").toContext(),r.url="./assets/images/background.jpg",i=At.instance.add(r),e.backgroundImageIdentifier=i.identifier,e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.width=26,e.height=28,e.initialize(),ea.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){}makeDefaultContextMenuActions(e){return[this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),Re.play(Ee.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),Re.play(Ee.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),Re.play(Ee.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),Re.play(Ee.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),Re.play(Ee.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"D6",diceName:"D6",type:Zr.D6,imagePathPrefix:"6_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),Re.play(Ee.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return ea.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Aj(t,n){1&t&&Le(0,"div")}function Pj(t,n){1&t&&Le(0,"div",6),2&t&&un("background-color","rgba(10, 10, 10,"+H().opacity+")")}function Fj(t,n){if(1&t&&(O(0,"div",7),Le(1,"img",8),Zt(2,"safe"),F()),2&t){const e=H();k(1),un("opacity",e.opacity),D("src",Yt(2,3,e.imageFile.url,"resourceUrl"),Kn)}}function Nj(t,n){1&t&&(O(0,"div",9)(1,"i",10),Q(2,"lock"),F()())}const Rj=function(t){return{"is-magnetic":t}};function Lj(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H();D("ngClass",dt(1,Rj,e.isMagnetic))}}const Bj=function(t){return{"is-grab":t}};let zj=(()=>{class t{get name(){return this.gameTableMask.name}get width(){return rn.clampMin(this.gameTableMask.width)}get height(){return rn.clampMin(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get selectionState(){return this.selectionService.state(this.gameTableMask)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.selectionService=l,this.pointerDeviceService=c,this.coordinateService=u,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&fe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameTableMask.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30de\u30c3\u30d7\u30de\u30b9\u30af",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLock=!0),Re.play(Ee.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,o.parent&&o.parent.appendChild(s)}),Re.play(Ee.cardPut)}}]})}return e.push(pn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLock?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLock=!1,Re.play(Ee.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLock=!0,Re.play(Ee.lock)}}),i.push(pn),i.push({name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameTableMask.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(r),Re.play(Ee.cardPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),Re.play(Ee.sweep)}}),i.push(pn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-200,top:i.y-150,width:400,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(ev),J(hr),J(Ln),J(dn),J(Oi),J(Yo),J(ei),J($a))},t.\u0275cmp=Wt({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&ge("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[Mn],decls:8,vars:14,consts:[["appMovable","",1,"component","is-3d",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[4,"ngIf","ngIfThen","ngIfElse"],["blackMask",""],["imageMask",""],["class","lock-icon is-center",4,"ngIf"],["class","selected-highlight border",3,"ngClass",4,"ngIf"],[1,"border","is-fit-full"],[1,"border","is-fit-full","chrome-smooth-image-trick"],[1,"image","is-fit-full","chrome-smooth-image-trick",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"selected-highlight","border",3,"ngClass"]],template:function(e,i){if(1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,Aj,1,0,"div",1),X(2,Pj,1,2,"ng-template",null,2,zn),X(4,Fj,3,6,"ng-template",null,3,zn),X(6,Nj,3,0,"div",4),X(7,Lj,1,3,"div",5),F()),2&e){const r=Pt(3),o=Pt(5);un("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),D("ngClass",dt(12,Bj,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),k(1),D("ngIf",i.imageFile.url.length<1)("ngIfThen",r)("ngIfElse",o),k(5),D("ngIf",i.isLock),k(1),D("ngIf",i.isSelected)}},dependencies:[ai,fn,ti,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],changeDetection:0}),t})();function Uj(t,n){if(1&t&&(O(0,"option",8),Q(1),F()),2&t){const e=n.$implicit;vn("value",e.identifier),k(1),gt(e.name)}}function Vj(t,n){if(1&t){const e=et();O(0,"div")(1,"button",29),ge("click",function(){return Me(e),ke(H(2).openBgImageModal())}),Q(2,"\u753b\u50cf\u3092\u8ffd\u52a0"),F()()}if(2&t){const e=H(2);k(1),D("disabled",!e.isEditable)}}function jj(t,n){if(1&t){const e=et();O(0,"div",2),ge("click",function(){return Me(e),ke(H(2).openBgImageModal())}),Le(1,"img",30),Zt(2,"safe"),F()}if(2&t){const e=H(2);k(1),D("src",Yt(2,1,e.tableBackgroundImage.url,"resourceUrl"),Kn)}}function Hj(t,n){if(1&t){const e=et();O(0,"div")(1,"button",29),ge("click",function(){return Me(e),ke(H(2).openDistanceViewImageModal())}),Q(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),F()()}if(2&t){const e=H(2);k(1),D("disabled",!e.isEditable)}}function Gj(t,n){if(1&t){const e=et();O(0,"div",2),ge("click",function(){return Me(e),ke(H(2).openDistanceViewImageModal())}),Le(1,"img",30),Zt(2,"safe"),F()}if(2&t){const e=H(2);k(1),D("src",Yt(2,1,e.tableDistanceviewImage.url,"resourceUrl"),Kn)}}function $j(t,n){if(1&t&&(O(0,"div",36),Q(1),F()),2&t){const e=H(3);k(1),Hn("",e.progresPercent,"%")}}const Wj=function(t){return{"is-hidden":t}};function Zj(t,n){if(1&t){const e=et();je(0),O(1,"button",31),ge("click",function(){return Me(e),ke(H(2).save())}),O(2,"div",32)(3,"div",33),Q(4,"\u4fdd\u5b58"),F(),X(5,$j,2,1,"div",34),F()(),O(6,"button",35),ge("click",function(){return Me(e),ke(H(2).delete())}),Q(7,"\u524a\u9664"),F(),He()}if(2&t){const e=H(2);k(1),D("disabled",e.isSaveing),k(2),D("ngClass",dt(4,Wj,e.isSaveing)),k(2),D("ngIf",e.isSaveing),k(1),D("disabled",e.getGameTables().length<=1)}}function Yj(t,n){if(1&t){const e=et();je(0),O(1,"button",2),ge("click",function(){return Me(e),ke(H(2).restore())}),Q(2,"\u5143\u306b\u623b\u3059"),F(),He()}}function qj(t,n){if(1&t){const e=et();je(0),O(1,"div",9)(2,"div"),Q(3," \u753b\u50cf "),X(4,Vj,3,1,"div",7),X(5,jj,3,4,"div",10),F(),O(6,"div"),Q(7," \u80cc\u666f "),X(8,Hj,3,1,"div",7),X(9,Gj,3,4,"div",10),F()(),O(10,"div"),Q(11,"Name : "),O(12,"input",11),ge("ngModelChange",function(r){return Me(e),ke(H().tableName=r)}),F()(),O(13,"div")(14,"input",12),ge("ngModelChange",function(r){return Me(e),ke(H().tableWidth=r)}),F(),Q(15," Width : "),O(16,"input",13),ge("ngModelChange",function(r){return Me(e),ke(H().tableWidth=r)}),F()(),O(17,"div")(18,"input",14),ge("ngModelChange",function(r){return Me(e),ke(H().tableHeight=r)}),F(),Q(19," Height : "),O(20,"input",13),ge("ngModelChange",function(r){return Me(e),ke(H().tableHeight=r)}),F()(),O(21,"div"),Q(22," \u30b0\u30ea\u30c3\u30c9: "),O(23,"select",15),ge("ngModelChange",function(r){return Me(e),ke(H().tableGridType=r)}),O(24,"option",16),Q(25,"\u306a\u3057"),F(),O(26,"option",17),Q(27,"\u30b9\u30af\u30a8\u30a2"),F(),O(28,"option",18),Q(29,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),F(),O(30,"option",19),Q(31,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),F()(),Q(32," \u8272: "),O(33,"select",20),ge("ngModelChange",function(r){return Me(e),ke(H().tableGridColor=r)}),O(34,"option",21),Q(35,"\u9ed2"),F(),O(36,"option",22),Q(37,"\u767d"),F()()(),O(38,"div"),Q(39," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),O(40,"select",23),ge("ngModelChange",function(r){return Me(e),ke(H().tableDistanceviewFilter=r)}),O(41,"option",24),Q(42,"\u306a\u3057"),F(),O(43,"option",25),Q(44,"\u30db\u30ef\u30a4\u30c8"),F(),O(45,"option",26),Q(46,"\u30d6\u30e9\u30c3\u30af"),F()()(),Le(47,"hr"),O(48,"div")(49,"label"),Q(50,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),O(51,"input",27),ge("ngModelChange",function(r){return Me(e),ke(H().tableGridShow=r)}),F()(),O(52,"label"),Q(53,"\u30b9\u30ca\u30c3\u30d7: "),O(54,"input",28),ge("ngModelChange",function(r){return Me(e),ke(H().tableGridSnap=r)}),F()(),X(55,Zj,8,6,"ng-container",7),X(56,Yj,3,0,"ng-container",7),F(),He()}if(2&t){const e=H();k(4),D("ngIf",!e.tableBackgroundImage.url),k(1),D("ngIf",e.tableBackgroundImage.url),k(3),D("ngIf",!e.tableDistanceviewImage.url),k(1),D("ngIf",e.tableDistanceviewImage.url),k(3),D("ngModel",e.tableName)("disabled",!e.isEditable),k(2),vn("min",e.minSize),vn("max",e.maxSize),D("ngModel",e.tableWidth)("disabled",!e.isEditable),k(2),vn("min",e.minSize),vn("max",e.maxSize),D("ngModel",e.tableWidth)("disabled",!e.isEditable),k(2),vn("min",e.minSize),vn("max",e.maxSize),D("ngModel",e.tableHeight)("disabled",!e.isEditable),k(2),vn("min",e.minSize),vn("max",e.maxSize),D("ngModel",e.tableHeight)("disabled",!e.isEditable),k(3),D("ngModel",e.tableGridType)("disabled",!e.isEditable),k(10),D("ngModel",e.tableGridColor)("disabled",!e.isEditable),k(7),D("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),k(11),D("ngModel",e.tableGridShow),k(3),D("ngModel",e.tableGridSnap),k(1),D("ngIf",!e.isDeleted),k(1),D("ngIf",e.isDeleted)}}function Kj(t,n){1&t&&(je(0),O(1,"div",37),Q(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),F(),He())}let DD=(()=>{class t{get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,fe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return ea.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Be.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.saveDataService=i,this.imageService=r,this.panelService=o,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),this.selectedTable=this.tableSelecter.viewTable,fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Be.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngOnDestroy(){fe.unregister(this)}selectGameTable(e){fe.call("SELECT_GAME_TABLE",{identifier:e},We.peerId),this.selectedTable=Be.instance.get(e),this.selectedTableXml=""}getGameTables(){return Be.instance.getObjects(ci)}createGameTable(){let e=new ci;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,Dt.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Tn.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(Yf).then(e=>{!this.selectedTable||!e||(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(Yf,{isAllowedEmpty:!0}).then(e=>{!this.selectedTable||!e||(this.selectedTable.backgroundImageIdentifier=e)})}}return t.\u0275fac=function(e){return new(e||t)(J(Li),J(Mr),J(hc),J(dn))},t.\u0275cmp=Wt({type:t,selectors:[["game-table-setting"]],decls:11,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],["select",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[1,"images-select"],[3,"click",4,"ngIf"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"height","120px",3,"disabled","click"],["height","120",3,"src"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();O(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),ge("click",function(){return i.createGameTable()}),Q(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),F()(),O(5,"select",3,4),ge("change",function(){Me(r);const s=Pt(6);return ke(i.selectGameTable(s.value))}),X(7,Uj,2,2,"option",5),F()(),O(8,"div",6),X(9,qj,57,32,"ng-container",7),F()(),X(10,Kj,3,0,"ng-container",7)}2&e&&(k(5),D("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),k(2),D("ngForOf",i.getGameTables()),k(2),D("ngIf",i.selectedTable),k(1),D("ngIf",i.isEmpty))},dependencies:[ai,Un,fn,Vs,js,Ai,Kl,Sa,a_,gs,Yi,S_,x_,Fi,Jn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();class Xj{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=xs.SQUARE,o="#000000e6"){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let s=this.canvasElement.getContext("2d");if(r<0)return;let a=this.generateCalcGridPositionFunc(r);this.makeBrush(s,i,o);for(let l=0;l<=e;l++)for(let c=0;c<=n;c++){let{gx:u,gy:h}=a(c,l,i);this.strokeSquare(s,u,h,i),s.fillText((c+1).toString()+"-"+(l+1).toString(),u+i/2,h+i/2)}}generateCalcGridPositionFunc(n){switch(n){case xs.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case xs.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===xs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,c=i+r/2;n.beginPath();for(let u=0;u<6;u++){s+=60;let h=rn.radians(s),g=Math.cos(h)*a+l,E=Math.sin(h)*a+c;n.lineTo(g,E)}n.closePath(),n.stroke()}}var Ya=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(Ya||(Ya={})),Ya))(),qr=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(qr||(qr={})),qr))();class Qj{get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}initialize(){this.input=new Js(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,c=0,h=0,g=Ya.DRAG;2===this.buttonCode?(g=Ya.ROTATE,h=-r/5,c=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,c,0,h,g,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Ya.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,l=this.getKeyName(n);switch(l){case qr.ArrowLeft:n.shiftKey?a=-2:e=10;break;case qr.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case qr.ArrowRight:n.shiftKey?a=2:e=-10;break;case qr.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=qr[l]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Ya.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return qr.ArrowLeft;case 38:return qr.ArrowUp;case 39:return qr.ArrowRight;case 40:return qr.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}class Jj{get isActive(){return this.pointerDevice.isTablePickGesture}set isActive(n){this.pointerDevice.isTablePickGesture=n}constructor(n,e,i,r,o,s){this.targetElement=n,this.gameObjectsElement=e,this.pointerDevice=o,this.selection=s,this.pickCursorScale=1,this.input=null,this.activateTimer=null,this.keydownTimer=null,this.tappedTimer=null,this.tappedPointer={x:0,y:0,z:0},this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.callbackOnKeydown=a=>this.onKeydown(a),this.onstart=null,this.onend=null,this.oncancelifneeded=null,this.onpick=null,this.pickCursor=new eH(i),this.pickArea=new tH(r),this.initialize()}initialize(){this.input=new Js(this.targetElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onTap=this.onInputTap.bind(this)}cancel(){this.input.cancel(),this.clearActivateTimer(),this.pickCursor.deactive(),this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isActive=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.clearKeyDownTimer(),this.clearTappedTimer()}destroy(){this.cancel(),this.input.destroy(),this.clearKeyDownTimer(),this.clearTappedTimer()}onInputStart(n){if(this.target=null,this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.clearActivateTimer(),this.pickCursor.update(this.input.pointer),!(n instanceof MouseEvent&&0===n.button||n.touches))return this.cancel();this.isStrokeMode=n instanceof MouseEvent&&0===n.button&&n.ctrlKey;let i=n instanceof MouseEvent&&0===n.button&&n.shiftKey;this.isStrokeMode||i?this.startQuickCursor(n):this.startLongPressCursor(n)}onInputMove(n){let e=1<n.touches?.length,i=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||i<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,null==this.keydownTimer&&((e||null!=this.target&&this.isObjectDragging&&this.isPointerMoved&&!this.isMagneticMode||null!=this.activateTimer&&this.isPointerMoved)&&this.cancel(),this.isActive&&(null==this.oncancelifneeded||!this.oncancelifneeded())&&(this.pickCursor.update(this.input.pointer),this.pickCursor.scale(0),this.isPickObjectMode&&n instanceof MouseEvent&&n.ctrlKey?this.pickObject(n):this.isPointerMoved&&this.isPickRegionMode&&this.pickRegion(n),this.onpick&&this.onpick()))}onInputEnd(n){let e=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||e<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,this.onend&&this.onend(),this.cancel()}onInputTap(n){this.setTappedTimer(),this.tappedPointer=this.input.pointer}onKeydown(n){if(!this.isActive||this.input.isGrabbing)switch(n.key){case"Control":this.isStrokeMode=!0;case"Shift":this.clearActivateTimer(),this.clearKeyDownTimer(),this.target=null,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.isActive=!0,this.pickCursor.update(this.input.pointer),this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(.6),requestAnimationFrame(()=>this.pickCursor.scale(0)),this.pointerDevice.isDragging=!1,this.pickStart()}}startQuickCursor(n){this.isActive=!0,this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(1),requestAnimationFrame(()=>this.pickCursor.scale(.6)),this.isMagneticMode=!1,this.isPickObjectMode=this.isStrokeMode,this.isPickRegionMode=!this.isStrokeMode,this.pointerDevice.isDragging=!1,this.pickStart(),this.isPickObjectMode&&(this.selection.excludeElement=null,this.pickObject(n))}startLongPressCursor(n){let e=n.target;e.contains(this.gameObjectsElement)||(this.target=e),this.isMagneticMode=null!=this.target&&this.pointerDevice.isDragging&&null!=this.tappedTimer&&rn.sqrMagnitude(this.tappedPointer,this.input.pointer)<625,this.isPickObjectMode=null!=this.target&&this.pointerDevice.isDragging&&!this.isMagneticMode,this.isPickRegionMode=null==this.target||!this.isPickObjectMode&&!this.isMagneticMode,!this.isPickObjectMode&&(this.setActivateTimer(),this.setKeyDownTimer(),this.pickCursorScale=n.touches?4.5:1,this.pickCursor.active(),this.pickCursor.scale(this.pickCursorScale),this.isMagneticMode&&this.pickCursor.color(cd.MAGNETIC,cd.MAGNETIC_FILL))}pickStart(){let n=new CustomEvent("pickstart",{detail:{isMagnetic:this.isMagneticMode,isPickRegion:this.isPickRegionMode,isPickObject:this.isPickObjectMode},bubbles:!0});this.target?this.target.dispatchEvent(n):document.dispatchEvent(n),this.onstart&&this.onstart()}pickObject(n){let e=n.target;if(e.contains(this.gameObjectsElement))this.selection.excludeElement=document.body;else{this.isKeepSelection=!0;let i=new CustomEvent("pickobject",{detail:{srcEvent:n,first:this.input.startPointer,last:this.input.pointer},bubbles:!0});e.dispatchEvent(i)}}pickRegion(n){let e=this.input.startPointer,i=this.input.pointer,r=Math.min(e.x,i.x),o=Math.min(e.y,i.y),s=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);this.pickArea.update(r,o,s,a),this.selection.clear();let l=new CustomEvent("pickregion",{detail:{srcEvent:n,x:r,y:o,width:s,height:a},bubbles:!0});document.dispatchEvent(l)}setActivateTimer(){this.clearActivateTimer(),this.activateTimer=setTimeout(()=>{this.activateTimer=null,this.pickCursor.scale(.6*this.pickCursorScale),this.isActive=!0,this.isKeepSelection=this.isPickObjectMode||this.isMagneticMode,this.pickStart()},850)}clearActivateTimer(){this.isActive=!1,null!=this.activateTimer&&(clearTimeout(this.activateTimer),this.activateTimer=null),this.pickArea.deactive()}setKeyDownTimer(){this.clearKeyDownTimer(),this.keydownTimer=setTimeout(()=>{this.keydownTimer=null},66),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}clearKeyDownTimer(){null!=this.keydownTimer&&(clearTimeout(this.keydownTimer),this.keydownTimer=null),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}setTappedTimer(){this.clearTappedTimer(),this.tappedTimer=setTimeout(()=>{this.tappedTimer=null},300)}clearTappedTimer(){null!=this.tappedTimer&&(clearTimeout(this.tappedTimer),this.tappedTimer=null)}}var cd=(()=>(function(t){t.SELECTED="hsl(200, 100%, 50%)",t.MAGNETIC="hsl(45, 100%, 50%)",t.SELECTED_FILL="hsla(200, 100%, 95%, .7)",t.MAGNETIC_FILL="hsla(45, 100%, 95%, .7)"}(cd||(cd={})),cd))();class eH{constructor(n){this.targetElement=n,this.width=0,this.height=0,this.circleElement=this.targetElement.querySelector("circle"),this.active();let e=this.targetElement.getBoundingClientRect();this.width=e.width,this.height=e.height,this.deactive()}active(){this.deactive(),this.targetElement.style.display="block"}deactive(){this.targetElement.style.display=null,this.targetElement.style.stroke=null,this.targetElement.style.scale=null,this.circleElement.style.animation=null,this.circleElement.style.fill=null}scale(n){this.targetElement.style.scale=n+""}color(n,e){this.targetElement.style.stroke=n,this.circleElement.style.fill=e}disableAnimation(){this.circleElement.style.animation="none"}update(n){this.targetElement.style.left=n.x-this.width/2+"px",this.targetElement.style.top=n.y-this.height/2+"px"}}class tH{constructor(n){this.targetElement=n}update(n,e,i,r){this.targetElement.style.left=n+"px",this.targetElement.style.top=e+"px",this.targetElement.style.width=i+"px",this.targetElement.style.height=r+"px",this.targetElement.style.display="block"}deactive(){this.targetElement.style.width="0px",this.targetElement.style.height="0px",this.targetElement.style.display=null}}var na=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(na||(na={})),na))();class nH{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",l=>{let c=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:l.center.x,clientY:l.center.y});this.ngZone.run(()=>l.srcEvent.target.dispatchEvent(c))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<rn.sqrMagnitude(this.tappedPanCenter,n.center)&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer)this.ontransform&&this.ontransform(this.deltaHammerDeltaX,this.deltaHammerDeltaY,0,0,0,0,na.PAN,n.srcEvent);else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,na.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,na.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,na.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,na.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}const iH=["root"],rH=["gameTable"],oH=["gameObjects"],sH=["gridCanvas"],aH=["pickArea"],lH=["pickCursor"];function cH(t,n){1&t&&Le(0,"terrain",23),2&t&&D("terrain",n.$implicit)}function uH(t,n){1&t&&Le(0,"game-table-mask",24),2&t&&D("gameTableMask",n.$implicit)}const dH=function(t){return{"z-index":t}};function hH(t,n){if(1&t&&Le(0,"text-note",25),2&t){const e=n.$implicit;D("textNote",e)("appTooltip",e)("ngStyle",dt(3,dH,e.zindex))}}const MD=function(t,n){return{"z-index":t,transform:n}};function fH(t,n){if(1&t&&Le(0,"card-stack",26),2&t){const e=n.$implicit;D("cardStack",e)("appTooltip",e)("ngStyle",_i(3,MD,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function pH(t,n){if(1&t&&Le(0,"card",27),2&t){const e=n.$implicit;D("card",e)("appTooltip",e)("ngStyle",_i(3,MD,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function gH(t,n){if(1&t&&Le(0,"dice-symbol",28),2&t){const e=n.$implicit;D("diceSymbol",e)("appTooltip",e)}}function mH(t,n){if(1&t&&Le(0,"game-character",29),2&t){const e=n.$implicit;D("gameCharacter",e)("appTooltip",e)}}function _H(t,n){1&t&&Le(0,"peer-cursor",30),2&t&&D("cursor",n.$implicit)}const vH=function(t,n){return[t,n]},yH=function(t){return{"is-grabbing":t}};let kD=(()=>{class t{get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}constructor(e,i,r,o,s,a,l,c,u){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=l,this.selectionService=c,this.modalService=u,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null,this.pickGesture=null}ngOnInit(){fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture(),this.initializeTablePickGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){fe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy(),this.pickGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new nH(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new Qj(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}initializeTablePickGesture(){this.pickGesture=new Jj(this.rootElementRef.nativeElement,this.gameObjects.nativeElement,this.pickCursor.nativeElement,this.pickArea.nativeElement,this.pointerDeviceService,this.selectionService),this.pickGesture.onstart=this.onTablePickStart.bind(this),this.pickGesture.onend=this.onTablePickEnd.bind(this),this.pickGesture.oncancelifneeded=this.onTablePickCancelIfNeeded.bind(this),this.pickGesture.onpick=this.onTablePick.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,l,c){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),c.cancelable&&c.preventDefault();let u=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=u,i*=u,r,o,s,a),this.isTableTransformed=!0}onTablePickStart(){this.isTableTransformMode=!1,Re.playLocal(Ee.selectionStart),this.pickGesture.isMagneticMode||(this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+"")}onTablePickEnd(){this.pickGesture.isKeepSelection||requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.contextMenuService.isShow||this.selectionService.clear()})})}onTablePickCancelIfNeeded(){return this.isTableTransformMode}onTablePick(){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close())}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];0<this.selectionService.size&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>{this.selectionService.congregate(r)},enabled:0<this.selectionService.size}),o.push(pn)),Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(pn),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(DD)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a){this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r,this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=xs.SQUARE,s="#000000e6"){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new Xj(this.gridCanvas.nativeElement).render(e,i,r,o,s),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hr),J(ei),J($a),J(hc),J(K0),J(ev),J(Yo),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(On(iH,7),On(rH,7),On(oH,7),On(sH,7),On(aH,7),On(lH,7)),2&e){let r;In(r=An())&&(i.rootElementRef=r.first),In(r=An())&&(i.gameTable=r.first),In(r=An())&&(i.gameObjects=r.first),In(r=An())&&(i.gridCanvas=r.first),In(r=An())&&(i.pickArea=r.first),In(r=An())&&(i.pickCursor=r.first)}},hostBindings:function(e,i){1&e&&ge("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,iu)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,iu)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,iu)},decls:25,vars:33,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none"],["gridCanvas",""],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pick-area"],["pickArea",""],[1,"pick-cursor"],["pickCursor",""],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 100 100"],["cx","50","cy","50","r","15"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(O(0,"div",0),Zt(1,"safe"),F(),O(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Zt(8,"safe"),Le(9,"canvas",7,8),X(11,cH,1,1,"terrain",9),X(12,uH,1,1,"game-table-mask",10),X(13,hH,1,5,"text-note",11),X(14,fH,1,6,"card-stack",12),X(15,pH,1,6,"card",13),X(16,gH,1,2,"dice-symbol",14),X(17,mH,1,2,"game-character",15),X(18,_H,1,1,"peer-cursor",16),F()()(),Le(19,"div",17,18),O(21,"div",19,20),function ey(){It.lFrame.currentNamespace=Bv}(),O(23,"svg",21),Le(24,"circle",22),F()()),2&e&&(un("background-image",Yt(1,22,"url("+i.backgroundImage.url+")","style")),D("ngClass",_i(28,vH,i.backgroundFilterType?"is-filter":"",i.backgroundFilterType)),k(2),D("ngClass",dt(31,yH,i.isPointerDragging)),k(4),un("background-image",Yt(8,25,"url("+i.tableImage.url+")","style")),k(5),D("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),k(1),D("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:none;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.3s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.pick-area[_ngcontent-%COMP%]{position:absolute;display:none;background-color:#00a8ff1a;border:1px solid hsl(200,100%,50%);pointer-events:none}.pick-cursor[_ngcontent-%COMP%]{position:absolute;display:none;scale:1;transition:scale .2s ease-out;stroke:#0af;pointer-events:none}.pick-cursor[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(-90deg)}.pick-cursor[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:#e5f6ffb3;stroke:inherit;stroke-width:4;animation-name:_ngcontent-%COMP%_circle-animation,_ngcontent-%COMP%_circle-fill;animation-timing-function:linear,ease-out;animation-duration:.85s,.85s}@keyframes _ngcontent-%COMP%_circle-animation{0%{stroke-dasharray:0 94.3}55%{stroke-dasharray:0 94.3}99.9%,to{stroke-dasharray:94.3 94.3}}@keyframes _ngcontent-%COMP%_circle-fill{0%{opacity:0}45%{opacity:0}99.9%,to{opacity:1}}']}),t})();const bH=["cursor"],CH=["opacity"];function wH(t,n){if(1&t&&(O(0,"div",6)(1,"div",7),Zt(2,"safe"),O(3,"div",8)(4,"span",9),Q(5),F()()()()),2&t){const e=n.$implicit,i=H(2);D("ngClass",e),k(1),un("background-image",Yt(2,4,"url("+i.iconUrl+")","style")),k(4),gt(i.name)}}const EH=function(){return["is-front","is-back"]};function TH(t,n){1&t&&(je(0),O(1,"div",1,2)(3,"div",3,4),X(5,wH,6,7,"div",5),F()(),He()),2&t&&(k(5),D("ngForOf",Ca(1,EH)))}let xH=(()=>{class t{get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get delayMs(){let e=16.6*(We.peerIds.length+1);return e<100?100:e}constructor(e,i,r){this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Rt.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}ngOnInit(){this.isMine||fe.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut()},this)})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),fe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(e){let i=e.touches?e.changedTouches[0].pageX:e.pageX,r=e.touches?e.changedTouches[0].pageY:e.pageY;i===this._x&&r===this._y||(this._x=i,this._y=r,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,i,r){if(!document.getElementById("app-table-layer").contains(r))return;let o={x:e,y:i,z:0};o=this.coordinateService.calcTabletopLocalCoordinate(o,r),fe.call("CURSOR_MOVE",[o.x,o.y,o.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new zo(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,i,r){this.cursorElement.style.transform=`translateX(${e.toFixed(4)}px) translateY(${i.toFixed(4)}px) translateZ(${r.toFixed(4)}px)`}}return t.\u0275fac=function(e){return new(e||t)(J(ip),J($a),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(On(bH,5),On(CH,5)),2&e){let r;In(r=An())&&(i.cursorElementRef=r.first),In(r=An())&&(i.opacityElementRef=r.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-front",3,"ngClass",4,"ngFor","ngForOf"],[1,"peer-cursor","is-front",3,"ngClass"],[1,"icon"],[1,"name","is-center"],[2,"white-space","nowrap"]],template:function(e,i){1&e&&X(0,TH,6,2,"ng-container",0),2&e&&D("ngIf",!i.isMine)},dependencies:[ai,Un,fn,Jn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;background-color:#f0dabde6;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),t})();function SH(t,n){1&t&&(je(0),Le(1,"div",3),O(2,"div",4)(3,"i",5),Q(4,"autorenew"),F()(),O(5,"div",6)(6,"i",5),Q(7,"autorenew"),F()(),O(8,"div",7)(9,"i",5),Q(10,"autorenew"),F()(),O(11,"div",8)(12,"i",5),Q(13,"autorenew"),F()(),He())}const ud=function(t){return{"is-magnetic":t}};function DH(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(2);D("ngClass",dt(1,ud,e.isMagnetic))}}const dd=function(t){return{"blinking-animation":t}},MH=function(t){return{transform:t}};function kH(t,n){if(1&t&&(je(0),O(1,"div",9),Zt(2,"safe"),X(3,DH,1,3,"div",10),F(),He()),2&t){const e=H();k(1),un("background-image",Yt(2,5,"url("+e.floorImage.url+")","style")),D("ngClass",dt(8,dd,!e.isLocked))("ngStyle",dt(10,MH,"translateZ("+e.height*e.gridSize+"px)")),k(2),D("ngIf",e.isSelected)}}function IH(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);D("ngClass",dt(1,ud,e.isMagnetic))}}function OH(t,n){if(1&t&&(O(0,"div",16),Zt(1,"safe"),X(2,IH,1,3,"div",10),F()),2&t){const e=H(2);un("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),D("ngClass",dt(11,dd,!e.isLocked)),k(2),D("ngIf",e.isSelected)}}function AH(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);D("ngClass",dt(1,ud,e.isMagnetic))}}function PH(t,n){if(1&t&&(O(0,"div",17),Zt(1,"safe"),X(2,AH,1,3,"div",10),F()),2&t){const e=H(2);un("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),D("ngClass",dt(11,dd,!e.isLocked)),k(2),D("ngIf",e.isSelected)}}function FH(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);D("ngClass",dt(1,ud,e.isMagnetic))}}function NH(t,n){if(1&t&&(O(0,"div",18),Zt(1,"safe"),X(2,FH,1,3,"div",10),F()),2&t){const e=H(2);un("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),D("ngClass",dt(11,dd,!e.isLocked)),k(2),D("ngIf",e.isSelected)}}function RH(t,n){if(1&t&&Le(0,"div",11),2&t){const e=H(3);D("ngClass",dt(1,ud,e.isMagnetic))}}function LH(t,n){if(1&t&&(O(0,"div",19),Zt(1,"safe"),X(2,RH,1,3,"div",10),F()),2&t){const e=H(2);un("background-image",Yt(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),D("ngClass",dt(11,dd,!e.isLocked)),k(2),D("ngIf",e.isSelected)}}function BH(t,n){if(1&t&&(je(0),X(1,OH,3,13,"div",12),X(2,PH,3,13,"div",13),X(3,NH,3,13,"div",14),X(4,LH,3,13,"div",15),He()),2&t){const e=H();k(1),D("ngIf",e.isVisibleWallTopBottom),k(1),D("ngIf",e.isVisibleWallTopBottom),k(1),D("ngIf",e.isVisibleWallLeftRight),k(1),D("ngIf",e.isVisibleWallLeftRight)}}const zH=function(t){return{"is-grab":t}};let UH=(()=>{class t{get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return rn.clampMin(this.terrain.height)}get width(){return rn.clampMin(this.terrain.width)}get depth(){return rn.clampMin(this.terrain.depth)}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get selectionState(){return this.selectionService.state(this.terrain)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}constructor(e,i,r,o,s,a,l,c,u,h){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=l,this.selectionService=c,this.pointerDeviceService=u,this.coordinateService=h,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.input=null}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&fe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),Re.play(Ee.blockPick)}onMoved(){Re.play(Ee.blockPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.terrain.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5730\u5f62",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLocked=!0),Re.play(Ee.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,o.parent&&o.parent.appendChild(s)}),Re.play(Ee.blockPut)}}]})}return e.push(pn),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate(),i=[];return i.push(this.isLocked?{name:"\u56fa\u5b9a\u89e3\u9664",action:()=>{this.isLocked=!1,Re.play(Ee.unlock)}}:{name:"\u56fa\u5b9a\u3059\u308b",action:()=>{this.isLocked=!0,Re.play(Ee.lock)}}),i.push(pn),i.push(this.hasWall?{name:"\u58c1\u3092\u975e\u8868\u793a",action:()=>{this.mode=Qs.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}:{name:"\u58c1\u3092\u8868\u793a",action:()=>{this.mode=Qs.ALL}}),i.push(pn),i.push({name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}}),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.terrain.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(r),Re.play(Ee.blockPut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),Re.play(Ee.sweep)}}),i.push(pn),i.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}),i}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-250,top:i.y-150,width:500,height:300}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hc),J(ev),J(hr),J(Ln),J(dn),J(Oi),J(Yo),J(ei),J($a))},t.\u0275cmp=Wt({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&ge("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},features:[Mn],decls:5,vars:14,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"],[1,"texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],["class","texture of-wall-top chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-bottom chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-left chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],["class","texture of-wall-right chrome-smooth-image-trick",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"texture","of-wall-top","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-bottom","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-left","chrome-smooth-image-trick",3,"ngClass"],[1,"texture","of-wall-right","chrome-smooth-image-trick",3,"ngClass"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),X(2,SH,14,0,"ng-container",2),X(3,kH,4,12,"ng-container",2),X(4,BH,5,4,"ng-container",2),F()()),2&e&&(un("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),D("movable.option",i.movableOption)("movable.disable",i.isLocked),k(1),D("ngClass",dt(12,zH,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),k(1),D("ngIf",!i.isLocked),k(1),D("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),k(1),D("ngIf",i.hasWall&&0<(null==i.wallImage?null:i.wallImage.url.length)))},dependencies:[ai,fn,Ta,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.selected-highlight[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.pedestal-grab[_ngcontent-%COMP%]{position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s linear infinite alternate}@keyframes _ngcontent-%COMP%_blink{0%{opacity:.9}to{opacity:.5}}"],changeDetection:0}),t})();const VH=["textArea"];function jH(t,n){if(1&t&&(O(0,"div",12),Q(1),F()),2&t){const e=H();k(1),gt(e.title)}}const ID=function(t){return{"is-magnetic":t}};function HH(t,n){if(1&t&&Le(0,"div",13),2&t){const e=H();D("ngClass",dt(1,ID,e.isMagnetic))}}function GH(t,n){if(1&t&&Le(0,"div",13),2&t){const e=H();D("ngClass",dt(1,ID,e.isMagnetic))}}const $H=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"is-outline-text":e}};let WH=(()=>{class t{get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return rn.clampMin(this.textNote.height)}get width(){return rn.clampMin(this.textNote.width)}get isActive(){return document.activeElement===this.textAreaElementRef.nativeElement}get selectionState(){return this.selectionService.state(this.textNote)}get isSelected(){return this.selectionState!==kt.NONE}get isMagnetic(){return this.selectionState===kt.MAGNETIC}constructor(e,i,r,o,s,a){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.changeDetector=o,this.selectionService=s,this.pointerDeviceService=a,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=l=>this.onMouseUp(l),this.gridSize=50,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={}}ngOnChanges(){fe.unregister(this),fe.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngOnDestroy(){fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isActive){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void fe.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(this.removeMouseEventListeners(),this.isActive||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.title)}onMove(){this.contextMenuService.close(),Re.play(Ee.cardPick)}onMoved(){Re.play(Ee.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.textNote.location.x,y:this.textNote.location.y,z:this.textNote.posZ};return e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),e.push(pn),e}makeContextMenu(){let e=[];return e.push({name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}}),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.textNote.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),Re.play(Ee.cardPut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),Re.play(Ee.sweep)}}),e}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(Wo,{title:r,left:i.x-350,top:i.y-200,width:700,height:400}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(hr),J(dn),J(Oi),J(Yo),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&On(VH,7),2&e){let r;In(r=An())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&ge("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},features:[Mn],decls:18,vars:34,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[1,"upright-transform","is-front","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"upright-transform","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],[1,"title","is-black-background","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"]],template:function(e,i){1&e&&(O(0,"div",0),ge("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),O(1,"div",1),ge("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),O(2,"div",2)(3,"div",3)(4,"i",4),Q(5,"autorenew"),F()(),O(6,"div",5)(7,"i",4),Q(8,"autorenew"),F()(),O(9,"div",6),Zt(10,"safe"),X(11,jH,2,1,"div",7),O(12,"textarea",8,9),ge("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),F(),X(14,HH,1,3,"div",10),F(),O(15,"div",11),Zt(16,"safe"),X(17,GH,1,3,"div",10),F()()()()),2&e&&(D("movable.option",i.movableOption)("movable.disable",i.isActive),k(1),D("rotable.option",i.rotableOption),k(1),un("width",i.width*i.gridSize,"px"),k(7),un("background-image",Yt(10,24,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),k(2),D("ngIf",i.title.length),k(1),un("font-size",i.fontSize+9,"px"),D("ngClass",Oh(30,$H,!i.isActive,i.isActive,!i.isActive))("ngModel",i.text),k(2),D("ngIf",i.isSelected),k(1),un("background-image",Yt(16,27,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),k(2),D("ngIf",i.isSelected))},dependencies:[ai,fn,Ai,Yi,Fi,ti,fc,Jn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;box-sizing:border-box;height:100%;width:100%;top:0;left:0;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}"],changeDetection:0}),t})();function OD(t){return typeof t>"u"||null===t}var di={isNothing:OD,isObject:function ZH(t){return"object"==typeof t&&null!==t},toArray:function YH(t){return Array.isArray(t)?t:OD(t)?[]:[t]},repeat:function KH(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},isNegativeZero:function XH(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function qH(t,n){var e,i,r,o;if(n)for(e=0,i=(o=Object.keys(n)).length;e<i;e+=1)t[r=o[e]]=n[r];return t}};function AD(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function hd(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=AD(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(hd.prototype=Object.create(Error.prototype)).constructor=hd,hd.prototype.toString=function(n){return this.name+": "+AD(this,n)};var Ki=hd;function tv(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function nv(t,n){return di.repeat(" ",n-t.length)+t}var o9=function r9(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var l,c,a="",u=Math.min(t.line+n.linesAfter,r.length).toString().length,h=n.maxLength-(n.indent+u+3);for(l=1;l<=n.linesBefore&&!(s-l<0);l++)c=tv(t.buffer,i[s-l],r[s-l],t.position-(i[s]-i[s-l]),h),a=di.repeat(" ",n.indent)+nv((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=tv(t.buffer,i[s],r[s],t.position,h),a+=di.repeat(" ",n.indent)+nv((t.line+1).toString(),u)+" | "+c.str+"\n",a+=di.repeat("-",n.indent+u+3+c.pos)+"^\n",l=1;l<=n.linesAfter&&!(s+l>=r.length);l++)c=tv(t.buffer,i[s+l],r[s+l],t.position-(i[s]-i[s+l]),h),a+=di.repeat(" ",n.indent)+nv((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")},s9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],a9=["scalar","sequence","mapping"],Ei=function c9(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===s9.indexOf(e))throw new Ki('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function l9(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===a9.indexOf(this.kind))throw new Ki('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function PD(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function iv(t){return this.extend(t)}iv.prototype.extend=function(n){var e=[],i=[];if(n instanceof Ei)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Ki("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof Ei))throw new Ki("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new Ki("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new Ki("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Ei))throw new Ki("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(iv.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=PD(r,"implicit"),r.compiledExplicit=PD(r,"explicit"),r.compiledTypeMap=function u9(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var FD=iv,ND=new Ei("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),RD=new Ei("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),LD=new Ei("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),BD=new FD({explicit:[ND,RD,LD]}),zD=new Ei("tag:yaml.org,2002:null",{kind:"scalar",resolve:function d9(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function h9(){return null},predicate:function f9(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),UD=new Ei("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function p9(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function g9(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function m9(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function _9(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function v9(t){return 48<=t&&t<=55}function y9(t){return 48<=t&&t<=57}var VD=new Ei("tag:yaml.org,2002:int",{kind:"scalar",resolve:function b9(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!_9(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!v9(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!y9(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function C9(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function w9(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!di.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),E9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),S9=/^[-+]?[0-9]+e/,jD=new Ei("tag:yaml.org,2002:float",{kind:"scalar",resolve:function T9(t){return!(null===t||!E9.test(t)||"_"===t[t.length-1])},construct:function x9(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function M9(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||di.isNegativeZero(t))},represent:function D9(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(di.isNegativeZero(t))return"-0.0";return e=t.toString(10),S9.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),GD=BD.extend({implicit:[zD,UD,VD,jD]}),$D=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),WD=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),ZD=new Ei("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function k9(t){return null!==t&&(null!==$D.exec(t)||null!==WD.exec(t))},construct:function I9(t){var n,e,i,r,o,s,a,g,l=0,c=null;if(null===(n=$D.exec(t))&&(n=WD.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(c=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(c=-c)),g=new Date(Date.UTC(e,i,r,o,s,a,l)),c&&g.setTime(g.getTime()-c),g},instanceOf:Date,represent:function O9(t){return t.toISOString()}}),YD=new Ei("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function A9(t){return"<<"===t||null===t}}),rv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",qD=new Ei("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function P9(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=rv;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function F9(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=rv,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function R9(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function N9(t){var i,r,n="",e=0,o=t.length,s=rv;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),L9=Object.prototype.hasOwnProperty,B9=Object.prototype.toString,KD=new Ei("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function z9(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==B9.call(r=a[e]))return!1;for(o in r)if(L9.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function U9(t){return null!==t?t:[]}}),V9=Object.prototype.toString,XD=new Ei("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function j9(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==V9.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function H9(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),G9=Object.prototype.hasOwnProperty,QD=new Ei("tag:yaml.org,2002:set",{kind:"mapping",resolve:function $9(t){if(null===t)return!0;var n,e=t;for(n in e)if(G9.call(e,n)&&null!==e[n])return!1;return!0},construct:function W9(t){return null!==t?t:{}}}),ov=GD.extend({implicit:[ZD,YD],explicit:[qD,KD,XD,QD]}),ia=Object.prototype.hasOwnProperty,op=1,JD=2,eM=3,sp=4,sv=1,Z9=2,tM=3,Y9=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,q9=/[\x85\u2028\u2029]/,K9=/[,\[\]\{\}]/,nM=/^(?:!|!!|![a-z\-]+!)$/i,iM=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function rM(t){return Object.prototype.toString.call(t)}function Ko(t){return 10===t||13===t}function qa(t){return 9===t||32===t}function fr(t){return 9===t||32===t||10===t||13===t}function pc(t){return 44===t||91===t||93===t||123===t||125===t}function X9(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function Q9(t){return 120===t?2:117===t?4:85===t?8:0}function J9(t){return 48<=t&&t<=57?t-48:-1}function oM(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function e7(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var sM=new Array(256),aM=new Array(256),gc=0;gc<256;gc++)sM[gc]=oM(gc)?1:0,aM[gc]=oM(gc);function t7(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||ov,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function lM(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=o9(e),new Ki(n,e)}function at(t,n){throw lM(t,n)}function ap(t,n){t.onWarning&&t.onWarning.call(null,lM(t,n))}var cM={YAML:function(n,e,i){var r,o,s;null!==n.version&&at(n,"duplication of %YAML directive"),1!==i.length&&at(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&at(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&at(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&ap(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&at(n,"TAG directive accepts exactly two arguments"),o=i[1],nM.test(r=i[0])||at(n,"ill-formed tag handle (first argument) of the TAG directive"),ia.call(n.tagMap,r)&&at(n,'there is a previously declared suffix for "'+r+'" tag handle'),iM.test(o)||at(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{at(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function ra(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||at(t,"expected valid JSON character");else Y9.test(a)&&at(t,"the stream contains non-printable characters");t.result+=a}}function uM(t,n,e,i){var r,o,s,a;for(di.isObject(e)||at(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)ia.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function mc(t,n,e,i,r,o,s,a,l){var c,u;if(Array.isArray(r))for(c=0,u=(r=Array.prototype.slice.call(r)).length;c<u;c+=1)Array.isArray(r[c])&&at(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===rM(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===rM(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(c=0,u=o.length;c<u;c+=1)uM(t,n,o[c],e);else uM(t,n,o,e);else!t.json&&!ia.call(e,r)&&ia.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,at(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function av(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):at(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function ni(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;qa(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Ko(r))break;for(av(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&ap(t,"deficient indentation"),i}function lp(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!fr(e)))}function lv(t,n){1===n?t.result+=" ":n>1&&(t.result+=di.repeat("\n",n-1))}function dM(t,n){var e,l,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);0!==l&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,at(t,"tab characters must not be used in indentation")),45===l&&fr(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,ni(t,!0,-1)&&t.lineIndent<=n)o.push(null),l=t.input.charCodeAt(t.position);else if(e=t.line,_c(t,n,eM,!1,!0),o.push(t.result),ni(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==l)at(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function l7(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&at(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):at(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!fr(s);)33===s&&(i?at(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),nM.test(r)||at(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),K9.test(o)&&at(t,"tag suffix cannot contain flow indicator characters")}o&&!iM.test(o)&&at(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{at(t,"tag name is malformed: "+o)}return e?t.tag=o:ia.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:at(t,'undeclared tag handle "'+r+'"'),!0}function c7(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&at(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!fr(e)&&!pc(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&at(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function _c(t,n,e,i,r){var o,s,a,h,g,E,L,Z,re,l=1,c=!1,u=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=sp===e||eM===e,i&&ni(t,!0,-1)&&(c=!0,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)),1===l)for(;l7(t)||c7(t);)ni(t,!0,-1)?(c=!0,a=o,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=c||r),(1===l||sp===e)&&(Z=op===e||JD===e?n:n+1,re=t.position-t.lineStart,1===l?a&&(dM(t,re)||function a7(t,n,e){var i,r,o,s,a,l,ce,c=t.tag,u=t.anchor,h={},g=Object.create(null),E=null,L=null,Z=null,re=!1,oe=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=h),ce=t.input.charCodeAt(t.position);0!==ce;){if(!re&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,at(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==ce&&58!==ce||!fr(i)){if(s=t.line,a=t.lineStart,l=t.position,!_c(t,e,JD,!1,!0))break;if(t.line===o){for(ce=t.input.charCodeAt(t.position);qa(ce);)ce=t.input.charCodeAt(++t.position);if(58===ce)fr(ce=t.input.charCodeAt(++t.position))||at(t,"a whitespace character is expected after the key-value separator within a block mapping"),re&&(mc(t,h,g,E,L,null,s,a,l),E=L=Z=null),oe=!0,re=!1,r=!1,E=t.tag,L=t.result;else{if(!oe)return t.tag=c,t.anchor=u,!0;at(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!oe)return t.tag=c,t.anchor=u,!0;at(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===ce?(re&&(mc(t,h,g,E,L,null,s,a,l),E=L=Z=null),oe=!0,re=!0,r=!0):re?(re=!1,r=!0):at(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,ce=i;if((t.line===o||t.lineIndent>n)&&(re&&(s=t.line,a=t.lineStart,l=t.position),_c(t,n,sp,!0,r)&&(re?L=t.result:Z=t.result),re||(mc(t,h,g,E,L,Z,s,a,l),E=L=Z=null),ni(t,!0,-1),ce=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==ce)at(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return re&&mc(t,h,g,E,L,null,s,a,l),oe&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=h),oe}(t,re,Z))||function o7(t,n){var i,r,o,a,u,h,g,E,Z,re,oe,ce,e=!0,s=t.tag,l=t.anchor,L=Object.create(null);if(91===(ce=t.input.charCodeAt(t.position)))u=93,E=!1,a=[];else{if(123!==ce)return!1;u=125,E=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),ce=t.input.charCodeAt(++t.position);0!==ce;){if(ni(t,!0,n),(ce=t.input.charCodeAt(t.position))===u)return t.position++,t.tag=s,t.anchor=l,t.kind=E?"mapping":"sequence",t.result=a,!0;e?44===ce&&at(t,"expected the node content, but found ','"):at(t,"missed comma between flow collection entries"),oe=null,h=g=!1,63===ce&&fr(t.input.charCodeAt(t.position+1))&&(h=g=!0,t.position++,ni(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,_c(t,n,op,!1,!0),re=t.tag,Z=t.result,ni(t,!0,n),ce=t.input.charCodeAt(t.position),(g||t.line===i)&&58===ce&&(h=!0,ce=t.input.charCodeAt(++t.position),ni(t,!0,n),_c(t,n,op,!1,!0),oe=t.result),E?mc(t,a,L,re,Z,oe,i,r,o):a.push(h?mc(t,null,L,re,Z,oe,i,r,o):Z),ni(t,!0,n),44===(ce=t.input.charCodeAt(t.position))?(e=!0,ce=t.input.charCodeAt(++t.position)):e=!1}at(t,"unexpected end of the stream within a flow collection")}(t,Z)?u=!0:(s&&function s7(t,n){var e,i,u,h,r=sv,o=!1,s=!1,a=n,l=0,c=!1;if(124===(h=t.input.charCodeAt(t.position)))i=!1;else{if(62!==h)return!1;i=!0}for(t.kind="scalar",t.result="";0!==h;)if(43===(h=t.input.charCodeAt(++t.position))||45===h)sv===r?r=43===h?tM:Z9:at(t,"repeat of a chomping mode identifier");else{if(!((u=J9(h))>=0))break;0===u?at(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?at(t,"repeat of an indentation width identifier"):(a=n+u-1,s=!0)}if(qa(h)){do{h=t.input.charCodeAt(++t.position)}while(qa(h));if(35===h)do{h=t.input.charCodeAt(++t.position)}while(!Ko(h)&&0!==h)}for(;0!==h;){for(av(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===h;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Ko(h))l++;else{if(t.lineIndent<a){r===tM?t.result+=di.repeat("\n",o?1+l:l):r===sv&&o&&(t.result+="\n");break}for(i?qa(h)?(c=!0,t.result+=di.repeat("\n",o?1+l:l)):c?(c=!1,t.result+=di.repeat("\n",l+1)):0===l?o&&(t.result+=" "):t.result+=di.repeat("\n",l):t.result+=di.repeat("\n",o?1+l:l),o=!0,s=!0,l=0,e=t.position;!Ko(h)&&0!==h;)h=t.input.charCodeAt(++t.position);ra(t,e,t.position,!1)}}return!0}(t,Z)||function i7(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(ra(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Ko(e)?(ra(t,i,r,!0),lv(t,ni(t,!1,n)),i=r=t.position):t.position===t.lineStart&&lp(t)?at(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);at(t,"unexpected end of the stream within a single quoted scalar")}(t,Z)||function r7(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return ra(t,e,t.position,!0),t.position++,!0;if(92===a){if(ra(t,e,t.position,!0),Ko(a=t.input.charCodeAt(++t.position)))ni(t,!1,n);else if(a<256&&sM[a])t.result+=aM[a],t.position++;else if((s=Q9(a))>0){for(r=s,o=0;r>0;r--)(s=X9(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:at(t,"expected hexadecimal character");t.result+=e7(o),t.position++}else at(t,"unknown escape sequence");e=i=t.position}else Ko(a)?(ra(t,e,i,!0),lv(t,ni(t,!1,n)),e=i=t.position):t.position===t.lineStart&&lp(t)?at(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}at(t,"unexpected end of the stream within a double quoted scalar")}(t,Z)?u=!0:function u7(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!fr(i)&&!pc(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&at(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),ia.call(t.anchorMap,e)||at(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],ni(t,!0,-1),!0}(t)?(u=!0,(null!==t.tag||null!==t.anchor)&&at(t,"alias node should not have any properties")):function n7(t,n,e){var r,o,s,a,l,c,u,E,h=t.kind,g=t.result;if(fr(E=t.input.charCodeAt(t.position))||pc(E)||35===E||38===E||42===E||33===E||124===E||62===E||39===E||34===E||37===E||64===E||96===E||(63===E||45===E)&&(fr(r=t.input.charCodeAt(t.position+1))||e&&pc(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==E;){if(58===E){if(fr(r=t.input.charCodeAt(t.position+1))||e&&pc(r))break}else if(35===E){if(fr(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&lp(t)||e&&pc(E))break;if(Ko(E)){if(l=t.line,c=t.lineStart,u=t.lineIndent,ni(t,!1,-1),t.lineIndent>=n){a=!0,E=t.input.charCodeAt(t.position);continue}t.position=s,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(ra(t,o,s,!1),lv(t,t.line-l),o=s=t.position,a=!1),qa(E)||(s=t.position+1),E=t.input.charCodeAt(++t.position)}return ra(t,o,s,!1),!!t.result||(t.kind=h,t.result=g,!1)}(t,Z,op===e)&&(u=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===l&&(u=a&&dM(t,re))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&at(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,g=t.implicitTypes.length;h<g;h+=1)if((L=t.implicitTypes[h]).resolve(t.result)){t.result=L.construct(t.result),t.tag=L.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(ia.call(t.typeMap[t.kind||"fallback"],t.tag))L=t.typeMap[t.kind||"fallback"][t.tag];else for(L=null,h=0,g=(E=t.typeMap.multi[t.kind||"fallback"]).length;h<g;h+=1)if(t.tag.slice(0,E[h].tag.length)===E[h].tag){L=E[h];break}L||at(t,"unknown tag !<"+t.tag+">"),null!==t.result&&L.kind!==t.kind&&at(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+L.kind+'", not "'+t.kind+'"'),L.resolve(t.result,t.tag)?(t.result=L.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):at(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||u}function d7(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(ni(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!fr(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&at(t,"directive name must not be less than one character in length");0!==s;){for(;qa(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Ko(s));break}if(Ko(s))break;for(e=t.position;0!==s&&!fr(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&av(t),ia.call(cM,i)?cM[i](t,i,r):ap(t,'unknown document directive "'+i+'"')}ni(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,ni(t,!0,-1)):o&&at(t,"directives end mark is expected"),_c(t,t.lineIndent-1,sp,!1,!0),ni(t,!0,-1),t.checkLineBreaks&&q9.test(t.input.slice(n,t.position))&&ap(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&lp(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,ni(t,!0,-1)):t.position<t.length-1&&at(t,"end of the stream or a document separator is expected")}function hM(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new t7(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,at(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)d7(e);return e.documents}var fM_load=function f7(t,n){var e=hM(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Ki("expected a single document in the stream, but found more")}};function pv(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var PM=fM_load;pv("safeLoad","load"),pv("safeLoadAll","loadAll"),pv("safeDump","dump");const FM=Object.getOwnPropertyNames(Object.prototype),dG=Object.getOwnPropertyNames(Array.prototype);let gv=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,Dt.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=PM(i);t.applyConfig(r)}catch(i){console.warn(i)}fe.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,Dt.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?FM.concat(dG):FM).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Mt({token:t,factory:t.\u0275fac}),t})();class Ka{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Ka(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Ka(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&fe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){fe.unregister(this),this.sendChankTimer&&function TB(t){Bu.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Sr.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),fe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Ni(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);fe.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Ni(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Ni(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,fe.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),fe.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=Sr.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new zo(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class yc{static get instance(){return yc._instance||(yc._instance=new yc),yc._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),fe.register(this).on("CONNECT_PEER",-1,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),st.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=st.instance.get(o.identifier);null===s&&(s=Dr.createEmpty(o.identifier),st.instance.add(s)),s.state<Ri.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<st.instance.getCatalog().length&&st.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=st.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=st.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(We.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void fe.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),st.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=st.instance.get(e);this.receiveTaskMap.has(e)||i&&Ri.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),fe.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){fe.unregister(this)}startSendTask(n,e){var i=this;return(0,Dt.Z)(function*(){let r=Ka.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),fe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Ri.URL?o.url=n.url:(o.blob=yield _o.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),st.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=st.instance.get(n),i=Ka.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&fe.trigger("UPDATE_AUDIO_RESOURE",[o]),st.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),fe.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:We.peerId,candidatePeers:We.peerIds},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class bc{static get instance(){return bc._instance||(bc._instance=new bc),bc._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}initialize(){var n=this;fe.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),At.instance.synchronize())}).on("XML_LOADED",e=>{!function hG(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!At.instance.get(r)&&0<dc.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!At.instance.get(r)&&0<dc.type(r).length&&n.push(r)}for(let i of n)At.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=At.instance.get(o.identifier);null===s&&(s=gn.createEmpty(o.identifier),At.instance.add(s)),s.state<wi.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<At.instance.getCatalog().length&&At.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,Dt.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=At.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(We.peerId);-1<a&&s.splice(a,1);for(let l of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+l+" -> "+i.data.identifiers),void fe.call(i,l);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),At.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=At.instance.get(i);this.receiveTaskMap.has(i)||r&&wi.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),fe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){fe.unregister(this)}startSendTask(n,e){var i=this;return(0,Dt.Z)(function*(){let r=1===n.length?n[0].identifier:Lu.generateUuid(),o=Ka.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),fe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield _o.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield _o.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),At.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Ka.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&fe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),At.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),fe.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:We.peerId,candidatePeers:We.peerIds},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=At.instance.get(s.identifier),l={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===wi.URL?l.url=a.url:s.state===wi.NULL?(l.thumbnail.blob=a.thumbnail.blob,l.thumbnail.type=a.thumbnail.type):(l.blob=a.blob,l.type=a.blob.type);let c=l.blob?l.blob.size:l.thumbnail.blob?l.thumbnail.blob.size:100;if(i.push(l),r+=c,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Yn{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Yn.tasksMap.size<1&&fe.register(Yn.key).on("DISCONNECT_PEER",r=>{Yn.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Yn.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Yn.onUpdate(r.data.identifier)});let i=new Yn(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Yn.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Yn.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;fe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Yn.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Yn.tasksMap.size<1&&fe.unregister(Yn.key)}static onUpdate(n){if(!Yn.tasksMap.has(n))return;let e=Yn.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Yn.tasksMap.size<1&&fe.unregister(Yn.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Yn.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Yn.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new zo(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Yn.key={},Yn.tasksMap=new Map;class Cc{static get instance(){return Cc._instance||(Cc._instance=new Cc),Cc._instance}constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),fe.register(this).on("CONNECT_PEER",2,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)Be.instance.isDeleted(i.identifier)?fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(Be.instance.isDeleted(n.data))fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=Be.instance.get(n.data);e&&fe.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=Be.instance.get(e.identifier);i?(n.isSendFromSelf||(i=this.updateObject(i,e)),cD(i,n.sendFrom)):Be.instance.isDeleted(e.identifier)?fe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):(i=this.createObject(e),cD(i,n.sendFrom))}).on("DELETE_GAME_OBJECT",1e3,n=>{Be.instance.delete(n.data.identifier,!1)})}destroy(){fe.unregister(this)}updateObject(n,e){return e.majorVersion+e.minorVersion>n.version&&n.apply(e),n}createObject(n){let e=Fo.instance.create(n.aliasName,n.identifier);if(e)return Be.instance.add(e,!1),e.apply(n),e;console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=Be.instance.getCatalog(),i=setInterval(()=>{fe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=Yn.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=Be.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=We.peers;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}let Xa=class extends Xs{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new it}get audio(){return st.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=st.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){fe.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){fe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};function fG(t,n){if(1&t&&(O(0,"option",8),Q(1),F()),2&t){const e=n.$implicit;vn("value",e.identifier),k(1),gt(e.name)}}function pG(t,n){if(1&t&&(O(0,"div",15),Q(1),F()),2&t){const e=H(3);k(1),Hn("",e.progresPercent,"%")}}K([ot()],Xa.prototype,"audioIdentifier",void 0),K([ot()],Xa.prototype,"startTime",void 0),K([ot()],Xa.prototype,"isLoop",void 0),K([ot()],Xa.prototype,"isPlaying",void 0),Xa=K([Wn("jukebox")],Xa);const gG=function(t){return{"is-hidden":t}};function mG(t,n){if(1&t){const e=et();je(0),O(1,"button",2),ge("click",function(){return Me(e),ke(H(2).upTabIndex())}),Q(2,"\u2191"),F(),O(3,"button",2),ge("click",function(){return Me(e),ke(H(2).downTabIndex())}),Q(4,"\u2193"),F(),O(5,"button",10),ge("click",function(){return Me(e),ke(H(2).save())}),O(6,"div",11)(7,"div",12),Q(8,"\u4fdd\u5b58"),F(),X(9,pG,2,1,"div",13),F()(),O(10,"button",14),ge("click",function(){return Me(e),ke(H(2).delete())}),Q(11,"\u524a\u9664"),F(),He()}if(2&t){const e=H(2);k(5),D("disabled",e.isSaveing),k(2),D("ngClass",dt(4,gG,e.isSaveing)),k(2),D("ngIf",e.isSaveing),k(1),Br("disabled",e.chatTabs.length<=1?"":null)}}function _G(t,n){if(1&t){const e=et();je(0),O(1,"button",2),ge("click",function(){return Me(e),ke(H(2).restore())}),Q(2,"\u5143\u306b\u623b\u3059"),F(),He()}}function vG(t,n){if(1&t){const e=et();je(0),O(1,"div"),Q(2,"\u30bf\u30d6\u540d : "),O(3,"input",9),ge("ngModelChange",function(r){return Me(e),ke(H().tabName=r)}),F()(),Le(4,"hr"),O(5,"div"),X(6,mG,12,6,"ng-container",7),X(7,_G,3,0,"ng-container",7),F(),He()}if(2&t){const e=H();k(3),D("ngModel",e.tabName),Br("disabled",e.isEditable?null:""),k(3),D("ngIf",!e.isDeleted),k(1),D("ngIf",e.isDeleted)}}function yG(t,n){1&t&&(je(0),O(1,"div",16),Q(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),F(),He())}let bG=(()=>{class t{get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Be.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Be.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){fe.unregister(this)}onChangeSelectTab(e){this.selectedTab=Be.instance.get(e),this.selectedTabXml=""}create(){Ha.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,Dt.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Tn.instance.parseXml(this.selectedTabXml);Ha.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}}return t.\u0275fac=function(e){return new(e||t)(J(Li),J(dn),J(Za),J(Mr))},t.\u0275cmp=Wt({type:t,selectors:[["app-chat-tab-setting"]],decls:11,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],["select",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModel","ngModelChange"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();O(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),ge("click",function(){return i.create()}),Q(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),F()(),O(5,"select",3,4),ge("change",function(){Me(r);const s=Pt(6);return ke(i.onChangeSelectTab(s.value))}),X(7,fG,2,2,"option",5),F()(),O(8,"div",6),X(9,vG,8,4,"ng-container",7),F()(),X(10,yG,3,0,"ng-container",7)}2&e&&(k(5),D("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),k(2),D("ngForOf",i.chatTabs),k(2),D("ngIf",!i.isEmpty&&i.selectedTab),k(1),D("ngIf",i.isEmpty))},dependencies:[ai,Un,fn,Vs,js,Ai,gs,Yi,Fi],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();function CG(t,n){if(1&t&&(Le(0,"img",13),Zt(1,"safe")),2&t){const e=H();D("src",Yt(1,1,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Kn)}}function wG(t,n){1&t&&wn(0)}function EG(t,n){if(1&t){const e=et();O(0,"button",15),ge("click",function(){return Me(e),ke(H(2).discloseMessage())}),Q(1,"\u7d50\u679c\u3092\u516c\u958b"),F()}}function TG(t,n){if(1&t&&(O(0,"span"),Q(1),F(),X(2,EG,2,0,"button",14)),2&t){const e=H();k(1),gt(e.chatMessage.text),k(1),D("ngIf",e.chatMessage.isSecret)}}function xG(t,n){1&t&&(O(0,"span"),Q(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),F())}const SG=function(t,n,e){return{"direct-message":t,"system-message":n,"dicebot-message":e}};let DG=(()=>{class t{constructor(e){this.chatMessageService=e,this.imageFile=gn.Empty,this.animeState="inactive"}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}}return t.\u0275fac=function(e){return new(e||t)(J(Za))},t.\u0275cmp=Wt({type:t,selectors:[["chat-message"]],inputs:{chatMessage:"chatMessage"},decls:19,vars:16,consts:[[1,"container"],[1,"message",3,"ngClass"],[1,"image"],[3,"src",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from"],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],["visible",""],["secret",""],[3,"src"],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,i){if(1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),X(3,CG,2,4,"img",3),F(),O(4,"div",4)(5,"div",5)(6,"span",6),Q(7),F(),O(8,"span",7),Q(9),F(),O(10,"span",8),Q(11),Zt(12,"date"),F()(),O(13,"div",9),X(14,wG,1,0,"ng-container",10),F()()()(),X(15,TG,3,2,"ng-template",null,11,zn),X(17,xG,2,0,"ng-template",null,12,zn)),2&e){const r=Pt(16),o=Pt(18);k(1),D("ngClass",Oh(12,SG,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot))("@flyInOut",i.animeState),k(2),D("ngIf",0<(null==i.imageFile||null==i.imageFile.url?null:i.imageFile.url.length)),k(4),gt(i.chatMessage.name),k(2),gt(i.chatMessage.from),k(2),gt(Yt(12,9,i.chatMessage.timestamp,"y/M/d H:mm")),k(3),D("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)("ngIfThen",r)("ngIfElse",o)}},dependencies:[ai,fn,uE,Jn],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}"],data:{animation:[Ao("flyInOut",[yi("* => active",[vi("200ms ease-out",go([wt({transform:"translateX(100px)",opacity:"0",offset:0}),wt({transform:"translateX(0)",opacity:"1",offset:1})]))]),yi("void => *",[vi("200ms ease-out",go([wt({opacity:"0",offset:0}),wt({opacity:"1",offset:1})]))])])]}}),t})();const MG=["logContainer"],kG=["messageContainer"];function IG(t,n){1&t&&Le(0,"chat-message",7),2&t&&D("chatMessage",H().$implicit)}function OG(t,n){if(1&t&&(je(0),X(1,IG,1,1,"chat-message",6),He()),2&t){const e=n.$implicit;k(1),D("ngIf",e.isDisplayable)}}function AG(t,n){if(1&t&&(je(0),X(1,OG,2,1,"ng-container",5),He()),2&t){const e=H();k(1),D("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function PG(t,n){1&t&&Le(0,"chat-message",7),2&t&&D("chatMessage",n.$implicit)}function FG(t,n){if(1&t&&(je(0),X(1,PG,1,1,"chat-message",8),He()),2&t){const e=H();k(1),D("ngForOf",e.sampleMessages)}}const mv=window.navigator.userAgent.toLowerCase(),NM=mv.indexOf("iphone")>-1||mv.indexOf("ipad")>-1||mv.indexOf("macintosh")>-1&&"ontouchend"in document;let NG=(()=>{class t{get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){let e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.sampleMessages=[this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"),this.makeSampleMessage("System","???","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System","???","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb > \u30d7\u30ec\u30a4\u30e4\u30fc","\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb","\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002")],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Ht}ngOnInit(){fe.register(this).on("MESSAGE_ADDED",e=>{let i=Be.instance.get(e.data.messageIdentifier);!i||!this.chatTab.contains(i)||this.topTimestamp<=i.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on(`UPDATE_GAME_OBJECT/aliasName/${dr.aliasName}`,e=>{let i=Be.instance.get(e.data.identifier);i&&this.topTimestamp<=i.timestamp&&i.timestamp<=this.botomTimestamp&&this.chatTab.contains(i)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new zo(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new zo(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){fe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Ni(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,l=null,c=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),l=s.getBoundingClientRect(),c=a.top-l.top-this.scrollSpeed,(!r||!o)&&.25<c**2&&(this.panelService.scrollablePanel.scrollTop-=c);let u=this.logContainerRef.nativeElement.getBoundingClientRect(),h=this.messageContainerRef.nativeElement.getBoundingClientRect(),g=h.top-u.top,E=g+h.height,L=this.getScrollPosition();return r=L.top<g,o=E<L.bottom&&L.bottom<L.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Ni(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,l=this.getScrollPosition();this.scrollSpeed=l.top-this.preScrollTop,this.preScrollTop=l.top;let c=l.top<r,u=o<l.bottom&&l.bottom<l.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!c&&!u)return;let h=l.top-(!e&&c?100:1200),g=l.bottom+(!e&&u?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,h,g,l,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Ni(()=>{let L=this.getScrollPosition();this.scrollSpeed=L.top-this.preScrollTop,this.preScrollTop=L.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let l=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/l)+1:r>e&&(NM||(this.topIndex+=Math.floor((r-e)/l))),i>o?NM||(this.bottomIndex-=Math.floor((i-o)/l)):i<o&&(this.bottomIndex+=Math.floor((o-i)/l)+1)}this.adjustIndex()}makeSampleMessage(e,i,r,o){let s=new dr;return s.from=e,s.to=i,s.name=r,s.value=o,s}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Oi),J(dn))},t.\u0275cmp=Wt({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(On(MG,7),On(kG,7)),2&e){let r;In(r=An())&&(i.logContainerRef=r.first),In(r=An())&&(i.messageContainerRef=r.first)}},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[Mn],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(O(0,"div",0,1)(2,"div",2,3),X(4,AG,2,2,"ng-container",4),X(5,FG,2,1,"ng-container",4),F()()),2&e&&(un("min-height",i.minScrollHeight,"px"),k(2),un("margin-bottom",i.bottomSpace,"px"),k(2),D("ngIf",0<i.chatMessages.length),k(1),D("ngIf",i.chatMessages.length<=0))},dependencies:[Un,fn,DG],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})();function RG(t,n){if(1&t){const e=et();O(0,"chat-tab",10),ge("onAddMessage",function(){return Me(e),ke(H().scrollToBottom())}),F()}2&t&&D("chatTab",H().chatTab)}function LG(t,n){1&t&&(O(0,"div"),Q(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),F())}function BG(t,n){1&t&&Le(0,"badge",13),2&t&&D("count",H().$implicit.unreadLength)}function zG(t,n){if(1&t){const e=et();O(0,"label")(1,"input",11),ge("ngModelChange",function(r){return Me(e),ke(H().chatTabidentifier=r)}),F(),O(2,"div"),Q(3),X(4,BG,1,1,"badge",12),F()()}if(2&t){const e=n.$implicit,i=H();k(1),vn("value",e.identifier),D("ngModel",i.chatTabidentifier),k(2),gt(e.name),k(1),D("ngIf",e.hasUnread)}}let UG=(()=>{class t{get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return Be.instance.get(this.chatTabidentifier)}constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}ngOnInit(){this.sendFrom=Rt.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",fe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Be.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){fe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(bG,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo)}trackByChatTab(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(J(Za),J(dn),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","onAddMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(O(0,"div",0)(1,"div",1),X(2,RG,1,1,"chat-tab",2),X(3,LG,2,0,"div",3),F(),O(4,"div",4)(5,"form")(6,"div",5),X(7,zG,5,4,"label",6),O(8,"button",7),ge("click",function(){return i.showTabSetting()}),O(9,"i",8),Q(10,"settings"),F(),Q(11,"\u30bf\u30d6\u8a2d\u5b9a"),F()()(),O(12,"chat-input",9),ge("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)}),F()()()),2&e&&(k(2),D("ngIf",i.chatTab),k(1),D("ngIf",!i.chatTab),k(4),D("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),k(5),D("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},dependencies:[Un,fn,ql,Ai,Ou,Yi,Wl,Fi,Us,ED,NG,xD],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),t})();const VG=["root"];function jG(t,n){if(1&t&&(O(0,"div",6),Q(1),F()),2&t){const e=H();k(1),gt(e.title)}}function HG(t,n){1&t&&wn(0)}const GG=function(t){return{action:t}};function $G(t,n){if(1&t&&(je(0),X(1,HG,1,0,"ng-container",7),He()),2&t){const e=n.$implicit;H();const i=Pt(8),r=Pt(6);k(1),D("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",dt(2,GG,e))}}function WG(t,n){1&t&&(O(0,"div",12)(1,"i",13),Q(2,"arrow_forward_ios"),F()())}function ZG(t,n){if(1&t&&Le(0,"context-menu",14),2&t){const e=H().action,i=H();D("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function YG(t,n){if(1&t){const e=et();O(0,"li",8),ge("click",function(){const o=Me(e).action;return ke(H().doAction(o))})("mouseenter",function(){const o=Me(e).action;return ke(H().showSubMenu(o))}),O(1,"div",9),Q(2),F(),X(3,WG,3,0,"div",10),X(4,ZG,1,3,"context-menu",11),F()}if(2&t){const e=n.action,i=H();k(2),gt(e.name),k(1),D("ngIf",e.subActions),k(1),D("ngIf",i.subMenu&&i.parentMenu===e)}}function qG(t,n){1&t&&(O(0,"li"),Le(1,"hr",15),F())}const KG=function(t,n,e){return{"submenu-panel":t,"is-max-limit":n,"pointer-events-none":e}};let XG=(()=>{class t{get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(J(Ln),J(hr),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&On(VG,7),2&e){let r;In(r=An())&&(i.rootElementRef=r.first)}},hostBindings:function(e,i){1&e&&ge("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",isSubmenu:"isSubmenu"},decls:9,vars:7,consts:[[1,"component",3,"ngClass","mouseleave"],["root",""],["class","title",4,"ngIf"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"hasHighlight",3,"click","mouseenter"],[1,"menu-title"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(O(0,"div",0,1),ge("mouseleave",function(){return i.hideSubMenu()}),X(2,jG,2,1,"div",2),O(3,"ul"),X(4,$G,2,4,"ng-container",3),F()(),X(5,YG,5,3,"ng-template",null,4,zn),X(7,qG,2,0,"ng-template",null,5,zn)),2&e&&(D("ngClass",Oh(3,KG,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),k(2),D("ngIf",0<i.title.length),k(2),D("ngForOf",i.actions))},dependencies:[ai,Un,fn,Eu,t],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}"]}),t})();function QG(t,n){if(1&t){const e=et();O(0,"img",9),ge("click",function(){Me(e);const r=H().$implicit;return ke(H().onSelectedFile(r))}),Zt(1,"safe"),F()}if(2&t){const e=H().$implicit;D("src",Yt(1,2,e.url,"resourceUrl"),Kn)("alt",e.name)}}function JG(t,n){1&t&&Le(0,"img",10),2&t&&vn("alt",H().$implicit.name)}function e$(t,n){if(1&t&&(O(0,"span",6),X(1,QG,2,5,"img",7),X(2,JG,1,1,"img",8),F()),2&t){const e=n.$implicit;k(1),D("ngIf",0<e.url.length),k(1),D("ngIf",e.url.length<=0)}}let t$=(()=>{class t{constructor(e,i){this.changeDetector=e,this.panelService=i,this.fileStorageService=At.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){fe.unregister(this)}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Vo.instance.load(r),i.value=""}onSelectedFile(e){console.log("onSelectedFile",e),fe.call("SELECT_FILE",{fileIdentifier:e.identifier},We.peerId)}}return t.\u0275fac=function(e){return new(e||t)(J(Oi),J(dn))},t.\u0275cmp=Wt({type:t,selectors:[["file-storage"]],decls:15,vars:1,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],["id","file-list"],["class","image",4,"ngFor","ngForOf"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(O(0,"label")(1,"div",0)(2,"div")(3,"i",1),Q(4,"add_photo_alternate"),F()(),O(5,"div"),Q(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),F(),O(7,"div",2),Q(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),F(),O(9,"input",3),ge("change",function(o){return i.handleFileSelect(o)}),F(),O(10,"div",2),Le(11,"br"),Q(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),F()()(),O(13,"div",4),X(14,e$,3,2,"span",5),F()),2&e&&(k(14),D("ngForOf",i.fileStorageService.images))},dependencies:[Un,fn,Jn],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}'],changeDetection:0}),t})();function n$(t,n){1&t&&wn(0)}function i$(t,n){1&t&&wn(0)}function r$(t,n){if(1&t&&(O(0,"div"),Q(1),F()),2&t){const e=H();k(1),Hn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function o$(t,n){1&t&&wn(0)}const s$=function(t){return{box:!0,selected:t}},a$=function(t){return{gameObject:t}};function l$(t,n){if(1&t){const e=et();O(0,"div",9),ge("contextmenu",function(r){const s=Me(e).$implicit;return ke(H().onContextMenu(r,s))})("click",function(){const o=Me(e).$implicit;return ke(H().selectGameObject(o))}),X(1,o$,1,0,"ng-container",10),F()}if(2&t){const e=n.$implicit,i=H(),r=Pt(11);D("ngClass",dt(3,s$,i.selectedIdentifier===e.identifier)),k(1),D("ngTemplateOutlet",r)("ngTemplateOutletContext",dt(5,a$,e))}}function c$(t,n){if(1&t){const e=et();O(0,"div",11)(1,"button",12),ge("click",function(){return Me(e),ke(H().cleanInventory())}),Q(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),F()()}if(2&t){const e=H();k(1),Br("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function u$(t,n){if(1&t){const e=et();O(0,"label")(1,"input",16),ge("ngModelChange",function(r){return Me(e),ke(H(2).selectTab=r)}),F(),O(2,"div"),Q(3),F()()}if(2&t){const e=n.$implicit,i=H(2);k(1),vn("value",e),D("ngModel",i.selectTab),k(2),zl("",i.getTabTitle(e)," (",i.getInventory(e).length,")")}}function d$(t,n){if(1&t&&(O(0,"form",13)(1,"div",14),X(2,u$,4,4,"label",15),F()()),2&t){const e=H();k(2),D("ngForOf",e.inventoryTypes)}}function h$(t,n){if(1&t){const e=et();je(0),O(1,"div")(2,"div",17),Q(3,"\u4e26\u3073\u9806"),F(),O(4,"input",18),ge("ngModelChange",function(r){return Me(e),ke(H(2).sortTag=r)}),F(),O(5,"select",19),ge("ngModelChange",function(r){return Me(e),ke(H(2).sortOrder=r)}),O(6,"option",20),Q(7,"\u6607\u9806"),F(),O(8,"option",21),Q(9,"\u964d\u9806"),F()()(),O(10,"div",22),Q(11,"\u8868\u793a\u9805\u76ee"),F(),O(12,"input",23),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataTag=r)}),F(),O(13,"div",11)(14,"button",24),ge("click",function(){return Me(e),ke(H(2).toggleEdit())}),O(15,"i",25),Q(16,"settings"),F(),Q(17,"\u5b8c\u4e86"),F()(),He()}if(2&t){const e=H(2);k(4),D("ngModel",e.sortTag),k(1),D("ngModel",e.sortOrder),k(7),D("ngModel",e.dataTag)}}function f$(t,n){if(1&t&&(je(0),Q(1),He()),2&t){const e=H(3);k(1),zl("",e.sortTag," (",e.sortOrderName,")")}}function p$(t,n){1&t&&(je(0),Q(1,"-"),He())}function g$(t,n){if(1&t){const e=et();je(0),O(1,"table",26)(2,"tr")(3,"th",27),Q(4,"\u4e26\u3073\u9806:"),F(),O(5,"td",27),X(6,f$,2,2,"ng-container",2),X(7,p$,2,0,"ng-container",2),F(),O(8,"td")(9,"button",24),ge("click",function(){return Me(e),ke(H(2).toggleEdit())}),O(10,"i",25),Q(11,"settings"),F(),Q(12,"\u8a2d\u5b9a"),F()()()(),He()}if(2&t){const e=H(2);k(6),D("ngIf",0<e.sortTag.length),k(1),D("ngIf",e.sortTag.length<1)}}function m$(t,n){if(1&t&&(X(0,h$,18,3,"ng-container",2),X(1,g$,13,2,"ng-container",2)),2&t){const e=H();D("ngIf",e.isEdit),k(1),D("ngIf",!e.isEdit)}}function _$(t,n){if(1&t){const e=et();O(0,"button",35),ge("click",function(r){Me(e);const o=H().gameObject;return ke(H().onContextMenu(r,o))}),O(1,"i",36),Q(2,"settings"),F()()}}function v$(t,n){1&t&&(Le(0,"img",37),Zt(1,"safe")),2&t&&D("src",Yt(1,1,H().gameObject.imageFile.url,"resourceUrl"),Kn)}function y$(t,n){1&t&&wn(0)}const b$=function(t){return{dataElm:t}};function C$(t,n){if(1&t&&(je(0),X(1,y$,1,0,"ng-container",10),He()),2&t){const e=n.$implicit;H(3);const i=Pt(13);k(1),D("ngTemplateOutlet",i)("ngTemplateOutletContext",dt(2,b$,e))}}function w$(t,n){if(1&t&&(O(0,"div"),X(1,C$,2,4,"ng-container",38),F()),2&t){const e=H().gameObject,i=H();k(1),D("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function E$(t,n){if(1&t&&(O(0,"div",28)(1,"div",29),Q(2),X(3,_$,3,0,"button",30),F(),O(4,"div",31)(5,"div",32),X(6,v$,2,4,"img",33),F(),O(7,"div",34),X(8,w$,2,2,"div",2),F()()()),2&t){const e=n.gameObject,i=H();k(2),Hn("",e.name," "),k(1),D("ngIf",i.selectedIdentifier===e.identifier),k(3),D("ngIf",e.imageFile.url),k(2),D("ngIf",e.rootDataElement)}}function T$(t,n){1&t&&(je(0),Le(1,"br"),He())}function x$(t,n){if(1&t){const e=et();je(0),O(1,"div",44)(2,"div",45),Q(3),F(),O(4,"input",46),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),F()(),O(5,"div",44)(6,"input",47),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.currentValue=r)}),Zt(7,"safe"),F()(),He()}if(2&t){const e=H(2).dataElm;k(3),gt(e.name),k(1),D("ngModel",e.currentValue),k(2),br(Yt(7,6,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),vn("max",e.value),D("ngModel",e.currentValue)}}function S$(t,n){if(1&t){const e=et();je(0),O(1,"div",48),Q(2),F(),O(3,"div",49)(4,"div",50)(5,"div",51)(6,"div",52),Q(7),F(),O(8,"input",53),ge("ngModelChange",function(r){return Me(e),ke(H(2).dataElm.value=r)}),F()()()(),He()}if(2&t){const e=H(2).dataElm;k(2),gt(e.name),k(5),gt(e.value),k(1),D("ngModel",e.value)}}function D$(t,n){if(1&t&&(O(0,"div",40),je(1,41),X(2,x$,8,9,"ng-container",42),X(3,S$,9,3,"ng-container",43),He(),F()),2&t){const e=H().dataElm;k(1),D("ngSwitch",e.attributes.type),k(1),D("ngSwitchCase","numberResource")}}function M$(t,n){if(1&t&&(X(0,T$,2,0,"ng-container",2),X(1,D$,4,2,"div",39)),2&t){const e=n.dataElm,i=H();D("ngIf",(null==e?null:e.name)===i.newLineString),k(1),D("ngIf",e&&e.name!==i.newLineString)}}let k$=(()=>{class t{get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get sortOrderName(){return this.sortOrder===rd.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}constructor(e,i,r,o,s){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),fe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Be.instance.get(e.data.identifier)instanceof cr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",We.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=We.peerId)}),this.inventoryTypes=["table","common",We.peerId,"graveyard"]}ngOnDestroy(){fe.unregister(this)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case We.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case We.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],o=[];o.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),"graveyard"!==i.location.name&&o.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)}}),o.push(pn);let s=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5"},{name:"common",alias:"\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:We.peerId,alias:"\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5"},{name:"graveyard",alias:"\u5893\u5834\u306b\u79fb\u52d5"}];for(let a of s)i.location.name!==a.name&&o.push({name:a.alias,action:()=>{i.setLocation(a.name),Re.play(Ee.piecePut)}});"graveyard"===i.location.name&&o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(i),Re.play(Ee.sweep)}}),o.push(pn),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),Re.play(Ee.piecePut)}}),this.contextMenuService.open(r,o,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${i.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const r of i)this.deleteGameObject(r);Re.play(Ee.sweep)}}cloneGameObject(e){e.clone()}showDetail(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Wo,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(SD,{left:i.x-250,top:i.y-175,width:615,height:350}).character=e}selectGameObject(e){fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}trackByGameObject(e,i){return i?i.identifier:e}}return t.\u0275fac=function(e){return new(e||t)(J(Oi),J(dn),J(Z0),J(hr),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],[1,"inventory-object"],[1,"object-name"],["style","font-size: 0.8em; padding: 2px 5px;",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[3,"src",4,"ngIf"],[1,"table-cell"],[2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em"],[3,"src"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModel","ngModelChange"],["type","range","min","0",3,"max","ngModel","ngModelChange"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(O(0,"div",0),X(1,n$,1,0,"ng-container",1),X(2,i$,1,0,"ng-container",1),X(3,r$,2,1,"div",2),X(4,l$,2,7,"div",3),X(5,c$,3,1,"div",4),F(),X(6,d$,3,1,"ng-template",null,5,zn),X(8,m$,2,2,"ng-template",null,6,zn),X(10,E$,9,4,"ng-template",null,7,zn),X(12,M$,2,2,"ng-template",null,8,zn)),2&e){const r=Pt(7),o=Pt(9);k(1),D("ngTemplateOutlet",r),k(1),D("ngTemplateOutlet",o),k(1),D("ngIf",i.getGameObjects(i.selectTab).length<1),k(1),D("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),k(1),D("ngIf","graveyard"===i.selectTab)}},dependencies:[ai,Un,fn,Eu,Ea,Cu,wu,ql,Vs,js,Ai,Kl,Sa,gs,Ou,Yi,Wl,Fi,Us,Jn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio]+div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked+div{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}"],changeDetection:0}),t})();function I$(t,n){if(1&t){const e=et();O(0,"button",10),ge("click",function(){Me(e);const r=H().$implicit;return ke(H().play(r))}),Q(1,"\u8a66\u8074/\u518d\u751f"),F()}2&t&&D("disabled",!H().$implicit.isReady)}function O$(t,n){if(1&t){const e=et();O(0,"button",10),ge("click",function(){return Me(e),ke(H(2).stop())}),Q(1,"\u8a66\u8074/\u505c\u6b62"),F()}2&t&&D("disabled",!H().$implicit.isReady)}function A$(t,n){if(1&t){const e=et();O(0,"button",10),ge("click",function(){Me(e);const r=H().$implicit;return ke(H().playBGM(r))}),Q(1,"BGM/\u518d\u751f"),F()}2&t&&D("disabled",!H().$implicit.isReady)}function P$(t,n){if(1&t){const e=et();O(0,"button",10),ge("click",function(){Me(e);const r=H().$implicit;return ke(H().stopBGM(r))}),Q(1,"BGM/\u505c\u6b62"),F()}2&t&&D("disabled",!H().$implicit.isReady)}function F$(t,n){1&t&&(O(0,"span"),Q(1,"\u3010\u8a66\u8074\u4e2d\u3011"),F())}function N$(t,n){1&t&&(O(0,"span"),Q(1,"\u3010BGM\u3011"),F())}function R$(t,n){if(1&t&&(O(0,"div",8),X(1,I$,2,1,"button",9),X(2,O$,2,1,"button",9),X(3,A$,2,1,"button",9),X(4,P$,2,1,"button",9),X(5,F$,2,0,"span",2),X(6,N$,2,0,"span",2),O(7,"span"),Q(8),F()()),2&t){const e=n.$implicit,i=H();k(1),D("ngIf",e!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),k(1),D("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),k(1),D("ngIf",e!==(null==i.jukebox?null:i.jukebox.audio)),k(1),D("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),k(1),D("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),k(1),D("ngIf",e===(null==i.jukebox?null:i.jukebox.audio)),k(2),gt(e.name)}}function L$(t,n){1&t&&(O(0,"div"),Q(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),F())}let B$=(()=>{class t{get volume(){return it.volume}set volume(e){it.volume=e}get auditionVolume(){return it.auditionVolume}set auditionVolume(e){it.auditionVolume=e}get audios(){return st.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Be.instance.get("Jukebox")}constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new it,this.lazyUpdateTimer=null}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=cc.AUDITION,fe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){fe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Vo.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(J(Li),J(dn),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["app-jukebox"]],decls:29,vars:4,consts:[["type","range","min","0","max","1","step","0.01",3,"ngModel","ngModelChange"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,i){1&e&&(O(0,"div"),Q(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),O(2,"input",0),ge("ngModelChange",function(o){return i.auditionVolume=o}),F()(),O(3,"div"),Q(4,"BGM\u97f3\u91cf\uff1a"),O(5,"input",0),ge("ngModelChange",function(o){return i.volume=o}),F()(),Le(6,"hr"),O(7,"div"),X(8,R$,9,7,"div",1),X(9,L$,2,0,"div",2),F(),O(10,"label")(11,"div",3)(12,"div")(13,"i",4),Q(14,"playlist_add"),F()(),O(15,"div"),Q(16,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),F(),O(17,"div",5),Q(18,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),F(),O(19,"input",6),ge("change",function(o){return i.handleFileSelect(o)}),F(),O(20,"div",5),Le(21,"br"),Q(22,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),F()()(),O(23,"div",7),Q(24,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),F(),O(25,"div",7),Q(26,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),F(),O(27,"div",7),Q(28,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),F()),2&e&&(k(2),D("ngModel",i.auditionVolume),k(3),D("ngModel",i.volume),k(3),D("ngForOf",i.audios),k(1),D("ngIf",i.audios.length<1))},dependencies:[Un,fn,Ai,Sa,Yi,Fi],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}']}),t})();const z$=["content"],U$=["*"];let V$=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&On(z$,7,sr),2&e){let r;In(r=An())&&(i.content=r.first)}},ngContentSelectors:U$,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(Xg(),O(0,"div",0)(1,"div",1),ge("click",function(o){return i.clickBackground(o)}),F(),O(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),ge("click",function(){return i.resolve()}),O(6,"i",6),Q(7,"close"),F()()(),Q(8),F(),O(9,"div",7),Qg(10),Le(11,"div",null,8),F()()()),2&e&&(k(1),D("@bgInOut","in"),k(1),D("@flyInOut","in"),k(6),Hn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Ao("flyInOut",[yi("void => *",[vi("100ms ease-out",go([wt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),wt({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),yi("* => void",[vi(100,wt({transform:"scale(0, 0)"}))])]),Ao("bgInOut",[BT("in",wt({"background-color":"rgba(30, 30, 30, 0.4)"})),yi("void => *",[wt({"background-color":"rgba(30, 30, 30, 0.0)"}),vi(200)]),yi("* => void",[vi(200,wt({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();const j$=["passwordInput"],H$=function(){return{standalone:!0}};let G$=(()=>{class t{get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeers=[],this.title="",this.targetPeers=i.option.peers??[],this.title=i.option.title?i.option.title:""}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9 \uff1c${this.title}\uff1e`),fe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){fe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeers.find(e=>e.verifyPassword(this.password))&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&On(j$,7),2&e){let r;In(r=An())&&(i.passwordInputElementRef=r.first)}},decls:12,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["input","","passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){if(1&e){const r=et();O(0,"form",null,0)(2,"div"),Q(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),O(4,"input",1,2),ge("ngModelChange",function(s){return i.password=s})("input",function(){Me(r);const s=Pt(5);return ke(i.onInputChange(s.value))}),F()(),O(7,"button",3),ge("click",function(){return i.submit()}),Q(8,"\u5165\u5ba4"),F()(),O(9,"div")(10,"span",4),Q(11),F()()}2&e&&(k(4),D("ngModel",i.password)("ngModelOptions",Ca(3,H$)),k(7),gt(i.help))},dependencies:[ql,Ai,Yi,Wl,Fi,Us],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function $$(t,n){if(1&t&&(O(0,"div")(1,"div",9),Q(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),F(),O(3,"div",9),Q(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),F(),O(5,"div",9),Q(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),F()()),2&t){H();const e=Pt(5);k(1),D("hidden",!e.errors.required),k(2),D("hidden",!e.errors.minlength),k(2),D("hidden",!e.errors.maxlength)}}function W$(t,n){if(1&t&&(O(0,"div")(1,"div",9),Q(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),F()()),2&t){H();const e=Pt(10);k(1),D("hidden",!e.errors.maxlength)}}function Z$(t,n){1&t&&(O(0,"div"),Q(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),F())}function Y$(t,n){if(1&t){const e=et();O(0,"div")(1,"div"),Q(2,"\u30eb\u30fc\u30e0\u540d : "),O(3,"input",3,4),ge("input",function(){Me(e);const r=Pt(4),o=H();return ke(o.calcPeerId(r.value,o.password))})("ngModelChange",function(r){return Me(e),ke(H().roomName=r)}),F()(),O(6,"div"),Q(7,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),O(8,"input",5,6),ge("input",function(){Me(e);const r=Pt(4),o=H();return ke(o.calcPeerId(o.roomName,r.value))})("ngModelChange",function(r){return Me(e),ke(H().password=r)}),F()(),Le(11,"hr"),X(12,$$,7,3,"div",7),X(13,W$,3,1,"div",7),X(14,Z$,2,0,"div",7),O(15,"div")(16,"button",8),ge("click",function(){return Me(e),ke(H().createRoom())}),Q(17,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),F()()()}if(2&t){const e=Pt(5),i=Pt(10),r=H();k(3),D("ngModel",r.roomName),k(5),D("ngModel",r.password),k(4),D("ngIf",e.errors&&(e.dirty||e.touched)),k(1),D("ngIf",i.errors&&(i.dirty||i.touched)),k(1),D("ngIf",!r.validateLength),k(2),D("disabled",!e.valid||!i.valid||!r.validateLength)}}function q$(t,n){1&t&&(O(0,"span",1),Q(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Le(2,"br"),Q(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Le(4,"br"),Q(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),F())}let K$=(()=>{class t{get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),fe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){fe.unregister(this)}calcPeerId(e,i){let o=xn.create(We.peer.userId,xn.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){We.open(We.peer.userId,xn.generateId("***"),this.roomName,this.password),Rt.myCursor.peerId=We.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["input","","roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["input","","passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(X(0,Y$,18,6,"div",0),O(1,"div")(2,"span",1),Q(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),F()(),X(4,q$,6,0,"ng-template",null,2,zn)),2&e){const r=Pt(5);D("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[fn,Ai,Yi,pf,D_,M_,Fi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function X$(t,n){1&t&&(O(0,"td")(1,"i",11),Q(2,"lock"),F()())}function Q$(t,n){1&t&&(O(0,"td"),Q(1,"-"),F())}function J$(t,n){if(1&t){const e=et();O(0,"button",12),ge("click",function(){Me(e);const r=H().$implicit;return ke(H(3).connect(r))}),Q(1,"\u63a5\u7d9a"),F()}if(2&t){const e=H().$implicit,i=H(3);D("disabled",e.id===i.currentRoom)}}function eW(t,n){if(1&t&&(je(0),O(1,"tr")(2,"td",9),Q(3),F(),O(4,"td",7),Q(5),F(),X(6,X$,3,0,"td",4),X(7,Q$,2,0,"td",4),O(8,"td"),Q(9),F(),O(10,"td"),X(11,J$,2,1,"button",10),F()(),He()),2&t){const e=n.$implicit;k(3),gt(e.id),k(2),gt(e.name),k(1),D("ngIf",e.hasPassword),k(1),D("ngIf",!e.hasPassword),k(2),Hn("",e.peers.length,"\u4eba"),k(2),D("ngIf",0<e.id.length)}}function tW(t,n){if(1&t&&(je(0),O(1,"table",6)(2,"tr")(3,"th"),Q(4,"\u30eb\u30fc\u30e0ID"),F(),O(5,"th",7),Q(6,"\u30eb\u30fc\u30e0\u540d"),F(),O(7,"th"),Q(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),F(),O(9,"th"),Q(10,"\u53c2\u52a0\u8005"),F(),Le(11,"th"),F(),X(12,eW,12,6,"ng-container",8),F(),He()),2&t){const e=H(2);k(12),D("ngForOf",e.rooms)}}function nW(t,n){if(1&t&&(O(0,"span",13),Q(1),F()),2&t){const e=H(2);k(1),gt(e.help)}}function iW(t,n){if(1&t){const e=et();O(0,"div")(1,"button",2),ge("click",function(){return Me(e),ke(H().reload())}),Q(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),F(),O(3,"button",3),ge("click",function(){return Me(e),ke(H().showRoomSetting())}),Q(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),F(),Le(5,"hr"),X(6,tW,13,1,"ng-container",4),X(7,nW,2,1,"span",5),F()}if(2&t){const e=H();k(1),D("disabled",e.isReloading),k(5),D("ngIf",e.rooms.length),k(1),D("ngIf",e.rooms.length<1)}}function rW(t,n){1&t&&(O(0,"span",13),Q(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Le(2,"br"),Q(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),F())}let oW=(()=>{class t{get currentRoom(){return We.peer.roomId}get peerId(){return We.peerId}get isConnected(){return 0<We.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),fe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",We.peer.roomName.length&&(this.modalService.title=this.panelService.title="\uff1c"+We.peer.roomName+"/"+We.peer.roomId+"\uff1e")}ngOnDestroy(){fe.unregister(this)}reload(){var e=this;return(0,Dt.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=yield We.listAllRooms(),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,Dt.Z)(function*(){let r="";e.hasPassword&&(r=yield i.modalService.open(G$,{peers:e.peers,title:`${e.name}/${e.id}`}),null==r&&(r=""));let o=e.filterByPassword(r);if(o.length<1)return;We.open(We.peer.userId,e.id,e.name,r),Rt.myCursor.peerId=We.peerId;let a=[];fe.register(a).on("OPEN_NETWORK",l=>{console.log("LobbyComponent OPEN_PEER",l.data.peerId),fe.unregister(a),Be.instance.clearDeleteHistory();for(let c of o)We.connect(c);fe.register(a).on("CONNECT_PEER",c=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",c.data.peerId),a.push(c.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+o.length),o.length<=a.length&&(i.resetNetwork(),fe.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",c=>{console.warn("\u63a5\u7d9a\u5931\u6557",c.data.peerId),a.push(c.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+o.length),o.length<=a.length&&(i.resetNetwork(),fe.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){We.peers.length<1&&(We.open(),Rt.myCursor.peerId=We.peerId)}closeIfConnected(){0<We.peers.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,Dt.Z)(function*(){yield e.modalService.open(K$,{width:700,height:400,left:0,top:400}),e.modalService.resolve(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(Li))},t.\u0275cmp=Wt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(X(0,iW,8,3,"div",0),X(1,rW,4,0,"ng-template",null,1,zn)),2&e){const r=Pt(2);D("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[Un,fn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();function sW(t,n){if(1&t){const e=et();O(0,"div",8),ge("click",function(){return Me(e),ke(H(2).changeIcon())}),Zt(1,"safe"),F()}2&t&&un("background-image",Yt(1,2,"url("+H(2).myPeer.image.url+")","style"))}function aW(t,n){if(1&t){const e=et();O(0,"div")(1,"button",5),ge("click",function(){return Me(e),ke(H().changeIcon())}),Q(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),F(),X(3,sW,2,5,"div",6),O(4,"span"),Q(5,"\u3042\u306a\u305f\u306e\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a "),O(6,"input",7),ge("ngModelChange",function(r){return Me(e),ke(H().myPeer.name=r)}),F()()()}if(2&t){const e=H();k(3),D("ngIf",e.myPeer.image),k(3),D("ngModel",e.myPeer.name)}}function lW(t,n){if(1&t&&(O(0,"span",9),Q(1),F()),2&t){const e=H();k(1),gt(e.networkService.peer.userId)}}function cW(t,n){1&t&&(O(0,"span",9),Q(1,"???"),F())}function uW(t,n){if(1&t&&(O(0,"span",9),Q(1),F()),2&t){const e=H(2);k(1),zl("",e.networkService.peer.roomName,"/",e.networkService.peer.roomId,"")}}function dW(t,n){if(1&t&&(O(0,"span",9),Q(1),F()),2&t){const e=H(3);k(1),gt(e.isPasswordVisible?e.networkService.peer.password:"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf")}}function hW(t,n){if(1&t){const e=et();O(0,"span"),X(1,dW,2,1,"span",1),O(2,"button",10),ge("click",function(){return Me(e),ke(H(2).togglePasswordVisibility())}),O(3,"span",11),Q(4),F()()()}if(2&t){const e=H(2);k(1),D("ngIf",e.networkService.isOpen),k(3),gt(e.isPasswordVisible?"visibility":"visibility_off")}}function fW(t,n){if(1&t&&(je(0),Le(1,"hr"),O(2,"div")(3,"span"),Q(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),X(5,uW,2,2,"span",1),F()(),O(6,"div")(7,"span"),Q(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),X(9,hW,5,2,"span",0),F()(),He()),2&t){const e=H();k(5),D("ngIf",e.networkService.isOpen),k(4),D("ngIf",e.networkService.peer.hasPassword)}}function pW(t,n){1&t&&(O(0,"span"),Q(1,"[\u63a5\u7d9a\u4e2d]"),F())}function gW(t,n){if(1&t&&(O(0,"div")(1,"div"),X(2,pW,2,0,"span",0),O(3,"span"),Q(4),F()()()),2&t){const e=n.$implicit,i=H();k(2),D("ngIf",!e.isOpen),k(2),zl("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(e.peerId)," [",i.findPeerName(e.peerId),"]")}}function mW(t,n){if(1&t){const e=et();je(0),O(1,"input",12),ge("ngModelChange",function(r){return Me(e),ke(H().targetUserId=r)}),F(),O(2,"button",13),ge("click",function(){return Me(e),ke(H().connectPeer())}),Q(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),F(),Le(4,"br"),He()}if(2&t){const e=H();k(1),D("ngModel",e.targetUserId),k(1),D("disabled",!e.networkService.isOpen)}}function _W(t,n){if(1&t){const e=et();O(0,"button",13),ge("click",function(){return Me(e),ke(H().showLobby())}),Q(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),F()}2&t&&D("disabled",!H().networkService.isOpen)}function vW(t,n){1&t&&(O(0,"div",4),Q(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),F())}function yW(t,n){1&t&&(O(0,"div",4),Q(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),F())}function bW(t,n){if(1&t&&(je(0),X(1,vW,2,0,"div",14),X(2,yW,2,0,"div",14),He()),2&t){const e=H();k(1),D("ngIf",e.networkService.peers.length<1),k(1),D("ngIf",e.networkService.peers.length<1)}}function CW(t,n){1&t&&(je(0),O(1,"div",4),Q(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),F(),He())}let wW=(()=>{class t{get myPeer(){return Rt.myCursor}constructor(e,i,r,o){this.ngZone=e,this.modalService=i,this.panelService=r,this.appConfigService=o,this.targetUserId="",this.networkService=We,this.gameRoomService=Be.instance,this.help="",this.isPasswordVisible=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u63a5\u7d9a\u60c5\u5831")}ngAfterViewInit(){fe.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})})}ngOnDestroy(){fe.unregister(this)}changeIcon(){this.modalService.open(Yf).then(e=>{!this.myPeer||!e||(this.myPeer.imageIdentifier=e)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=xn.create(e);i.isRoom||(Be.instance.clearDeleteHistory(),We.connect(i))}showLobby(){this.modalService.open(oW,{width:700,height:400,left:0,top:400})}togglePasswordVisibility(){this.isPasswordVisible=!this.isPasswordVisible}findUserId(e){const i=Rt.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Rt.findByPeerId(e);return i?i.name:""}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Li),J(dn),J(gv))},t.\u0275cmp=Wt({type:t,selectors:[["peer-menu"]],decls:17,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",3,"ngModel","ngModelChange"],[1,"image","cover",3,"click"],[2,"font-weight","bold"],[2,"padding","2px","margin-left","1.0em","font-size","1.0em",3,"click"],[1,"material-icons",2,"font-size","1.0em","vertical-align","text-bottom"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","ngModelChange"],[3,"disabled","click"],["style","font-size: 12px;",4,"ngIf"]],template:function(e,i){1&e&&(X(0,aW,7,2,"div",0),O(1,"div")(2,"span"),Q(3,"\u3042\u306a\u305f\u306eID\uff1a"),X(4,lW,2,1,"span",1),X(5,cW,2,0,"span",1),F()(),X(6,fW,10,2,"ng-container",0),Le(7,"hr"),X(8,gW,5,3,"div",2),O(9,"div"),X(10,mW,5,2,"ng-container",0),X(11,_W,2,1,"button",3),F(),O(12,"div")(13,"span",4),Q(14),F()(),X(15,bW,3,2,"ng-container",0),X(16,CW,3,0,"ng-container",0)),2&e&&(D("ngIf",i.myPeer),k(4),D("ngIf",i.networkService.isOpen),k(1),D("ngIf",!i.networkService.isOpen),k(1),D("ngIf",i.networkService.peer.isRoom),k(2),D("ngForOf",i.networkService.peers),k(2),D("ngIf",!i.networkService.peer.isRoom),k(1),D("ngIf",i.networkService.peers.length<1),k(3),gt(i.help),k(1),D("ngIf",!i.networkService.peer.isRoom),k(1),D("ngIf",i.networkService.peer.isRoom))},dependencies:[Un,fn,Ai,Yi,Fi,Jn],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}"]}),t})();var on=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(on||(on={})),on))();class EW{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new Js(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case on.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case on.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case on.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`,n.cursor="ew-resize";break;case on.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`,n.cursor="ns-resize";break;case on.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2";break;case on.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case on.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nwse-resize",n.zIndex="2";break;case on.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.cursor="nesw-resize",n.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let TW=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Ht,this.onmove=new Ht,this.onend=new Ht,this.handleMap=new Map,this.handleTypes=[on.N,on.E,on.W,on.S,on.NE,on.NW,on.SE,on.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new EW(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case on.N:case on.S:r.width=0;break;case on.E:case on.W:r.height=0}switch(i.type){case on.SW:r.left=r.width,r.width*=-1;break;case on.NE:r.top=r.height,r.height*=-1;break;case on.E:case on.S:case on.SE:break;case on.N:case on.W:case on.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Zn.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Zn.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Zn.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Zn.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(J(Gt),J(Ln))},t.\u0275dir=vt({type:t,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const xW=["draggablePanel"],SW=["scrollablePanel"],DW=["content"];function MW(t,n){if(1&t){const e=et();O(0,"div",7)(1,"button",8),ge("click",function(){return Me(e),ke(H().toggleFullScreen())}),O(2,"i",9),Q(3,"fullscreen"),F()(),O(4,"button",8),ge("click",function(){return Me(e),ke(H().close())}),O(5,"i",9),Q(6,"close"),F()()()}}const kW=function(t){return{"pointer-events-none":t}},IW=["*"];let RM=(()=>{class t{set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleFullScreen(){let e=this.draggablePanel.nativeElement;this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(J(dn),J(ei))},t.\u0275cmp=Wt({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(On(xW,7),On(SW,7),On(DW,7,sr)),2&e){let r;In(r=An())&&(i.draggablePanel=r.first),In(r=An())&&(i.scrollablePanel=r.first),In(r=An())&&(i.content=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",showTitleButtons:"showTitleButtons"},features:[En([dn])],ngContentSelectors:IW,decls:10,vars:16,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["class","title-button",4,"ngIf"],[1,"scrollable-panel"],["scrollablePanel",""],["content",""],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(e,i){1&e&&(Xg(),O(0,"div",0,1)(2,"div",2),X(3,MW,7,0,"div",3),Q(4),F(),O(5,"div",4,5),Qg(7),Le(8,"div",null,6),F()()),2&e&&(un("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),D("@flyInOut","in")("ngClass",dt(14,kW,i.isPointerDragging))("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),k(3),D("ngIf",i.showTitleButtons),k(1),Hn(" ",i.panelService.title," "))},dependencies:[ai,fn,_D,TW],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[Ao("flyInOut",[yi("void => *",[vi("100ms ease-out",go([wt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),wt({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),yi("* => void",[vi(100,wt({transform:"scale(0, 0)"}))])])]}}),t})(),OW=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};fe.register(this).on("*",i=>{this.needRepeat||We.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){fe.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(J(Ln))},t.\u0275cmp=Wt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(O(0,"div",0),Le(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),O(10,"div",10),Q(11,"sync"),F()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const AW=["modalLayer"];function PW(t,n){if(1&t&&(O(0,"li",8)(1,"a")(2,"div")(3,"i",9),Q(4,"sd_storage"),F()(),O(5,"div"),Q(6),F()()()),2&t){const e=H();k(6),Hn("",e.progresPercent,"%")}}let FW=(()=>{class t{constructor(e,i,r,o,s,a,l){var c=this;this.modalService=e,this.panelService=i,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=a,this.ngZone=l,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(()=>{Vo.instance.initialize(),bc.instance.initialize(),yc.instance.initialize(),Cc.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),new qo("DiceBot").initialize(),qo.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Xa("Jukebox").initialize(),new Re("SoundEffect").initialize();let E=gn.createEmpty("none_icon").toContext();E.url="./assets/images/ic_account_circle_black_24dp_2x.png";let L=At.instance.add(E);it.resumeAudioContext(),Ee.dicePick=st.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.dicePut=st.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.diceRoll1=st.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Ee.diceRoll2=st.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Ee.cardDraw=st.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Ee.cardPick=st.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.cardPut=st.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.cardShuffle=st.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Ee.piecePick=st.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ee.piecePut=st.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ee.blockPick=st.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ee.blockPut=st.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ee.lock=st.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ee.unlock=st.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ee.sweep=st.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Ee.selectionStart=st.instance.add("./assets/sounds/soundeffect-lab/decision50.mp3").identifier,st.instance.get(Ee.dicePick).isHidden=!0,st.instance.get(Ee.dicePut).isHidden=!0,st.instance.get(Ee.diceRoll1).isHidden=!0,st.instance.get(Ee.diceRoll2).isHidden=!0,st.instance.get(Ee.cardDraw).isHidden=!0,st.instance.get(Ee.cardPick).isHidden=!0,st.instance.get(Ee.cardPut).isHidden=!0,st.instance.get(Ee.cardShuffle).isHidden=!0,st.instance.get(Ee.piecePick).isHidden=!0,st.instance.get(Ee.piecePut).isHidden=!0,st.instance.get(Ee.blockPick).isHidden=!0,st.instance.get(Ee.blockPut).isHidden=!0,st.instance.get(Ee.lock).isHidden=!0,st.instance.get(Ee.unlock).isHidden=!0,st.instance.get(Ee.sweep).isHidden=!0,st.instance.get(Ee.selectionStart).isHidden=!0,Rt.createMyCursor(),Rt.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc",Rt.myCursor.imageIdentifier=L.identifier,fe.register(this).on("UPDATE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DELETE_GAME_OBJECT",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("UPDATE_SELECTION",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",Z=>{Z.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",Z=>{console.log("LOAD_CONFIG !!!"),We.setApiKey(Z.data.webrtc.key),We.open()}).on("FILE_LOADED",Z=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",Z=>{console.log("OPEN_NETWORK",Z.data.peerId),Rt.myCursor.peerId=We.peer.peerId,Rt.myCursor.userId=We.peer.userId}).on("NETWORK_ERROR",Z=>{console.log("NETWORK_ERROR",Z.data.peerId);let re=Z.data.errorType,oe=Z.data.errorMessage;this.ngZone.run((0,Dt.Z)(function*(){["peer-unavailable"].includes(re)||(yield c.modalService.open(Q0,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:oe}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(re)&&(yield c.modalService.open(Q0,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),We.open()))}))}).on("CONNECT_PEER",Z=>{Z.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(Z.isSendFromSelf)}).on("DISCONNECT_PEER",Z=>{this.lazyNgZoneUpdate(Z.isSendFromSelf)}),function NW(){let t=window.navigator.userAgent.toLowerCase();if(t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("macintosh")>-1&&"ontouchend"in document){let e=document.createElement("style");e.innerHTML="\n      .chrome-smooth-image-trick {\n        transform-style: flat;\n      }\n      ",document.body.appendChild(e)}}()}ngAfterViewInit(){dn.defaultParentViewContainerRef=Li.defaultParentViewContainerRef=hr.defaultParentViewContainerRef=this.modalLayerViewContainerRef}ngOnDestroy(){fe.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":i=wW;break;case"ChatWindowComponent":i=UG,r.width=700;break;case"GameTableSettingComponent":i=DD,r={width:630,height:400,left:100};break;case"FileStorageComponent":oa&&(i=t$);break;case"GameCharacterSheetComponent":i=Wo;break;case"JukeboxComponent":i=B$;break;case"GameObjectInventoryComponent":i=k$}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,Dt.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=0<We.peer.roomName.length?We.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Vo.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}}return t.\u0275fac=function(e){return new(e||t)(J(Li),J(dn),J(ei),J(Za),J(gv),J(Mr),J(Gt))},t.\u0275cmp=Wt({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&On(AW,7,sr),2&e){let r;In(r=An())&&(i.modalLayerViewContainerRef=r.first)}},decls:23,vars:7,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","showTitleButtons"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],["style","pointer-events: none;",4,"ngIf"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(O(0,"div",0),Le(1,"game-table"),F(),O(2,"ui-panel",1)(3,"nav")(4,"ul")(5,"li",2),ge("click",function(){return i.open("PeerMenuComponent")}),O(6,"a",3)(7,"div")(8,"i",4),Q(9,"people"),F()(),O(10,"div"),Q(11,"\u63a5\u7d9a"),F()()(),O(12,"li",2),ge("click",function(){return i.open("FileStorageComponent")}),O(13,"a",3)(14,"div")(15,"i",4),Q(16,"photo_library"),F()(),O(17,"div"),Q(18,"\u30ab\u30fc\u30c9\u3092\u8ffd\u52a0\u3059\u308b(\u7ba1\u7406\u8005\u306e\u307f)"),F()()(),X(19,PW,7,1,"li",5),F()()(),Le(20,"div",null,6)(22,"network-indicator",7)),2&e&&(k(2),D("top",0)("left",0)("width",150)("height",150)("title","\u30e1\u30cb\u30e5\u30fc")("showTitleButtons",!1),k(17),D("ngIf",i.isSaveing))},dependencies:[fn,kD,RM,OW],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer;white-space:nowrap}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_vibration .2s infinite}@keyframes _ngcontent-%COMP%_vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}"]}),t})();dn.UIPanelComponentClass=RM,hr.ContextMenuComponentClass=XG,Li.ModalComponentClass=V$;let RW=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=rs({type:t,bootstrap:[FW]}),t.\u0275inj=Co({providers:[gv,Za,hr,Li,Z0,dn,ei,K0],imports:[RE,bB,hE,b4]}),t})();(function Sv(t,n,e){const i=t.\u0275cmp;i.directiveDefs=Fd(n,!1),i.pipeDefs=Fd(e,!0)})(kD,[ai,Un,Ta,BV,IV,Oj,zj,UH,xH,WH,XV,CD],[Jn]),rL().bootstrapModule(RW).catch(t=>console.error(t));var oa=!1;document.addEventListener("keydown",t=>{t.ctrlKey&&t.ctrlKey&&t.altKey&&(oa=!oa),!oa&&t.preventDefault()})},1082:Ye=>{"use strict";Ye.exports=function N(Y){if(Y.length>=255)throw new TypeError("Alphabet too long");for(var I=new Uint8Array(256),A=0;A<I.length;A++)I[A]=255;for(var x=0;x<Y.length;x++){var f=Y.charAt(x),p=f.charCodeAt(0);if(255!==I[p])throw new TypeError(f+" is ambiguous");I[p]=x}var b=Y.length,T=Y.charAt(0),S=Math.log(b)/Math.log(256),m=Math.log(256)/Math.log(b);function _(M){if("string"!=typeof M)throw new TypeError("Expected String");if(0===M.length)return new Uint8Array;for(var w=0,R=0,W=0;M[w]===T;)R++,w++;for(var ne=(M.length-w)*S+1>>>0,B=new Uint8Array(ne);M[w];){var V=I[M.charCodeAt(w)];if(255===V)return;for(var z=0,te=ne-1;(0!==V||z<W)&&-1!==te;te--,z++)B[te]=(V+=b*B[te]>>>0)%256>>>0,V=V/256>>>0;if(0!==V)throw new Error("Non-zero carry");W=z,w++}for(var ee=ne-W;ee!==ne&&0===B[ee];)ee++;for(var q=new Uint8Array(R+(ne-ee)),Ce=R;ee!==ne;)q[Ce++]=B[ee++];return q}return{encode:function d(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===M.length)return"";for(var w=0,R=0,W=0,ne=M.length;W!==ne&&0===M[W];)W++,w++;for(var B=(ne-W)*m+1>>>0,V=new Uint8Array(B);W!==ne;){for(var z=M[W],te=0,ee=B-1;(0!==z||te<R)&&-1!==ee;ee--,te++)V[ee]=(z+=256*V[ee]>>>0)%b>>>0,z=z/b>>>0;if(0!==z)throw new Error("Non-zero carry");R=te,W++}for(var q=B-R;q!==B&&0===V[q];)q++;for(var Ce=T.repeat(w);q<B;++q)Ce+=Y.charAt(V[q]);return Ce},decodeUnsafe:_,decode:function v(M){var w=_(M);if(w)return w;throw new Error("Non-base"+b+" character")}}}},7585:function(Ye,N,Y){var I;Ye.exports=(I=I||function(A,x){var f;if(typeof window<"u"&&window.crypto&&(f=window.crypto),typeof self<"u"&&self.crypto&&(f=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(f=globalThis.crypto),!f&&typeof window<"u"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof global<"u"&&global.crypto&&(f=global.crypto),!f)try{f=Y(2480)}catch{}var p=function(){if(f){if("function"==typeof f.getRandomValues)try{return f.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof f.randomBytes)try{return f.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},b=Object.create||function(){function B(){}return function(V){var z;return B.prototype=V,z=new B,B.prototype=null,z}}(),T={},S=T.lib={},m=S.Base={extend:function(B){var V=b(this);return B&&V.mixIn(B),(!V.hasOwnProperty("init")||this.init===V.init)&&(V.init=function(){V.$super.init.apply(this,arguments)}),V.init.prototype=V,V.$super=this,V},create:function(){var B=this.extend();return B.init.apply(B,arguments),B},init:function(){},mixIn:function(B){for(var V in B)B.hasOwnProperty(V)&&(this[V]=B[V]);B.hasOwnProperty("toString")&&(this.toString=B.toString)},clone:function(){return this.init.prototype.extend(this)}},d=S.WordArray=m.extend({init:function(B,V){B=this.words=B||[],this.sigBytes=null!=V?V:4*B.length},toString:function(B){return(B||v).stringify(this)},concat:function(B){var V=this.words,z=B.words,te=this.sigBytes,ee=B.sigBytes;if(this.clamp(),te%4)for(var q=0;q<ee;q++)V[te+q>>>2]|=(z[q>>>2]>>>24-q%4*8&255)<<24-(te+q)%4*8;else for(var $=0;$<ee;$+=4)V[te+$>>>2]=z[$>>>2];return this.sigBytes+=ee,this},clamp:function(){var B=this.words,V=this.sigBytes;B[V>>>2]&=4294967295<<32-V%4*8,B.length=A.ceil(V/4)},clone:function(){var B=m.clone.call(this);return B.words=this.words.slice(0),B},random:function(B){for(var V=[],z=0;z<B;z+=4)V.push(p());return new d.init(V,B)}}),_=T.enc={},v=_.Hex={stringify:function(B){for(var V=B.words,z=B.sigBytes,te=[],ee=0;ee<z;ee++){var q=V[ee>>>2]>>>24-ee%4*8&255;te.push((q>>>4).toString(16)),te.push((15&q).toString(16))}return te.join("")},parse:function(B){for(var V=B.length,z=[],te=0;te<V;te+=2)z[te>>>3]|=parseInt(B.substr(te,2),16)<<24-te%8*4;return new d.init(z,V/2)}},M=_.Latin1={stringify:function(B){for(var V=B.words,z=B.sigBytes,te=[],ee=0;ee<z;ee++)te.push(String.fromCharCode(V[ee>>>2]>>>24-ee%4*8&255));return te.join("")},parse:function(B){for(var V=B.length,z=[],te=0;te<V;te++)z[te>>>2]|=(255&B.charCodeAt(te))<<24-te%4*8;return new d.init(z,V)}},w=_.Utf8={stringify:function(B){try{return decodeURIComponent(escape(M.stringify(B)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(B){return M.parse(unescape(encodeURIComponent(B)))}},R=S.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(B){"string"==typeof B&&(B=w.parse(B)),this._data.concat(B),this._nDataBytes+=B.sigBytes},_process:function(B){var V,z=this._data,te=z.words,ee=z.sigBytes,q=this.blockSize,$=ee/(4*q),ae=($=B?A.ceil($):A.max((0|$)-this._minBufferSize,0))*q,C=A.min(4*ae,ee);if(ae){for(var pe=0;pe<ae;pe+=q)this._doProcessBlock(te,pe);V=te.splice(0,ae),z.sigBytes-=C}return new d.init(V,C)},clone:function(){var B=m.clone.call(this);return B._data=this._data.clone(),B},_minBufferSize:0}),ne=(S.Hasher=R.extend({cfg:m.extend(),init:function(B){this.cfg=this.cfg.extend(B),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(B){return this._append(B),this._process(),this},finalize:function(B){return B&&this._append(B),this._doFinalize()},blockSize:16,_createHelper:function(B){return function(V,z){return new B.init(z).finalize(V)}},_createHmacHelper:function(B){return function(V,z){return new ne.HMAC.init(B,z).finalize(V)}}}),T.algo={});return T}(Math),I)},7412:function(Ye,N,Y){var I;Ye.exports=(I=Y(7585),function(){if("function"==typeof ArrayBuffer){var f=I.lib.WordArray,p=f.init,b=f.init=function(T){if(T instanceof ArrayBuffer&&(T=new Uint8Array(T)),(T instanceof Int8Array||typeof Uint8ClampedArray<"u"&&T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array)&&(T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength)),T instanceof Uint8Array){for(var S=T.byteLength,m=[],d=0;d<S;d++)m[d>>>2]|=T[d]<<24-d%4*8;p.call(this,m,S)}else p.apply(this,arguments)};b.prototype=f}}(),I.lib.WordArray)},1817:function(Ye,N,Y){var I;Ye.exports=(I=Y(7585),function(A){var x=I,f=x.lib,p=f.WordArray,b=f.Hasher,T=x.algo,S=[],m=[];!function(){function v(W){for(var ne=A.sqrt(W),B=2;B<=ne;B++)if(!(W%B))return!1;return!0}function M(W){return 4294967296*(W-(0|W))|0}for(var w=2,R=0;R<64;)v(w)&&(R<8&&(S[R]=M(A.pow(w,.5))),m[R]=M(A.pow(w,1/3)),R++),w++}();var d=[],_=T.SHA256=b.extend({_doReset:function(){this._hash=new p.init(S.slice(0))},_doProcessBlock:function(v,M){for(var w=this._hash.words,R=w[0],W=w[1],ne=w[2],B=w[3],V=w[4],z=w[5],te=w[6],ee=w[7],q=0;q<64;q++){if(q<16)d[q]=0|v[M+q];else{var Ce=d[q-15],ae=d[q-2];d[q]=((Ce<<25|Ce>>>7)^(Ce<<14|Ce>>>18)^Ce>>>3)+d[q-7]+((ae<<15|ae>>>17)^(ae<<13|ae>>>19)^ae>>>10)+d[q-16]}var ze=R&W^R&ne^W&ne,ve=ee+((V<<26|V>>>6)^(V<<21|V>>>11)^(V<<7|V>>>25))+(V&z^~V&te)+m[q]+d[q];ee=te,te=z,z=V,V=B+ve|0,B=ne,ne=W,W=R,R=ve+(((R<<30|R>>>2)^(R<<19|R>>>13)^(R<<10|R>>>22))+ze)|0}w[0]=w[0]+R|0,w[1]=w[1]+W|0,w[2]=w[2]+ne|0,w[3]=w[3]+B|0,w[4]=w[4]+V|0,w[5]=w[5]+z|0,w[6]=w[6]+te|0,w[7]=w[7]+ee|0},_doFinalize:function(){var v=this._data,M=v.words,w=8*this._nDataBytes,R=8*v.sigBytes;return M[R>>>5]|=128<<24-R%32,M[14+(R+64>>>9<<4)]=A.floor(w/4294967296),M[15+(R+64>>>9<<4)]=w,v.sigBytes=4*M.length,this._process(),this._hash},clone:function(){var v=b.clone.call(this);return v._hash=this._hash.clone(),v}});x.SHA256=b._createHelper(_),x.HmacSHA256=b._createHmacHelper(_)}(Math),I.SHA256)},6654:Ye=>{!function(Y){Ye.exports=Y;var I="listeners",A={on:function f(m,d){return S(this,m).push(d),this},once:function p(m,d){var _=this;return v.originalListener=d,S(_,m).push(v),_;function v(){b.call(_,m,v),d.apply(this,arguments)}},off:b,emit:function T(m,d){var _=this,v=S(_,m,!0);if(!v)return!1;var M=arguments.length;if(1===M)v.forEach(function R(B){B.call(_)});else if(2===M)v.forEach(function W(B){B.call(_,d)});else{var w=Array.prototype.slice.call(arguments,1);v.forEach(function ne(B){B.apply(_,w)})}return!!v.length}};function x(m){for(var d in A)m[d]=A[d];return m}function b(m,d){var v,_=this;if(arguments.length){if(d){if(v=S(_,m,!0)){if(!(v=v.filter(function M(w){return w!==d&&w.originalListener!==d})).length)return b.call(_,m);_[I][m]=v}}else if((v=_[I])&&(delete v[m],!Object.keys(v).length))return b.call(_)}else delete _[I];return _}function S(m,d,_){if(!_||m[I]){var v=m[I]||(m[I]={});return v[d]||(v[d]=[])}}x(Y.prototype),Y.mixin=x}(function N(){if(!(this instanceof N))return new N})},9069:Ye=>{"use strict";var I,N="object"==typeof Reflect?Reflect:null,Y=N&&"function"==typeof N.apply?N.apply:function(z,te,ee){return Function.prototype.apply.call(z,te,ee)};I=N&&"function"==typeof N.ownKeys?N.ownKeys:Object.getOwnPropertySymbols?function(z){return Object.getOwnPropertyNames(z).concat(Object.getOwnPropertySymbols(z))}:function(z){return Object.getOwnPropertyNames(z)};var x=Number.isNaN||function(z){return z!=z};function f(){f.init.call(this)}Ye.exports=f,Ye.exports.once=function W(V,z){return new Promise(function(te,ee){function q($){V.removeListener(z,Ce),ee($)}function Ce(){"function"==typeof V.removeListener&&V.removeListener("error",q),te([].slice.call(arguments))}B(V,z,Ce,{once:!0}),"error"!==z&&function ne(V,z,te){"function"==typeof V.on&&B(V,"error",z,te)}(V,q,{once:!0})})},f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var p=10;function b(V){if("function"!=typeof V)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof V)}function T(V){return void 0===V._maxListeners?f.defaultMaxListeners:V._maxListeners}function S(V,z,te,ee){var q,Ce,$;if(b(te),void 0===(Ce=V._events)?(Ce=V._events=Object.create(null),V._eventsCount=0):(void 0!==Ce.newListener&&(V.emit("newListener",z,te.listener?te.listener:te),Ce=V._events),$=Ce[z]),void 0===$)$=Ce[z]=te,++V._eventsCount;else if("function"==typeof $?$=Ce[z]=ee?[te,$]:[$,te]:ee?$.unshift(te):$.push(te),(q=T(V))>0&&$.length>q&&!$.warned){$.warned=!0;var ae=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(z)+" listeners added. Use emitter.setMaxListeners() to increase limit");ae.name="MaxListenersExceededWarning",ae.emitter=V,ae.type=z,ae.count=$.length,function A(V){console&&console.warn&&console.warn(V)}(ae)}return V}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(V,z,te){var ee={fired:!1,wrapFn:void 0,target:V,type:z,listener:te},q=m.bind(ee);return q.listener=te,ee.wrapFn=q,q}function _(V,z,te){var ee=V._events;if(void 0===ee)return[];var q=ee[z];return void 0===q?[]:"function"==typeof q?te?[q.listener||q]:[q]:te?function R(V){for(var z=new Array(V.length),te=0;te<z.length;++te)z[te]=V[te].listener||V[te];return z}(q):M(q,q.length)}function v(V){var z=this._events;if(void 0!==z){var te=z[V];if("function"==typeof te)return 1;if(void 0!==te)return te.length}return 0}function M(V,z){for(var te=new Array(z),ee=0;ee<z;++ee)te[ee]=V[ee];return te}function B(V,z,te,ee){if("function"==typeof V.on)ee.once?V.once(z,te):V.on(z,te);else{if("function"!=typeof V.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof V);V.addEventListener(z,function q(Ce){ee.once&&V.removeEventListener(z,q),te(Ce)})}}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(V){if("number"!=typeof V||V<0||x(V))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+V+".");p=V}}),f.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(z){if("number"!=typeof z||z<0||x(z))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+z+".");return this._maxListeners=z,this},f.prototype.getMaxListeners=function(){return T(this)},f.prototype.emit=function(z){for(var te=[],ee=1;ee<arguments.length;ee++)te.push(arguments[ee]);var q="error"===z,Ce=this._events;if(void 0!==Ce)q=q&&void 0===Ce.error;else if(!q)return!1;if(q){var $;if(te.length>0&&($=te[0]),$ instanceof Error)throw $;var ae=new Error("Unhandled error."+($?" ("+$.message+")":""));throw ae.context=$,ae}var C=Ce[z];if(void 0===C)return!1;if("function"==typeof C)Y(C,this,te);else{var pe=C.length,ze=M(C,pe);for(ee=0;ee<pe;++ee)Y(ze[ee],this,te)}return!0},f.prototype.on=f.prototype.addListener=function(z,te){return S(this,z,te,!1)},f.prototype.prependListener=function(z,te){return S(this,z,te,!0)},f.prototype.once=function(z,te){return b(te),this.on(z,d(this,z,te)),this},f.prototype.prependOnceListener=function(z,te){return b(te),this.prependListener(z,d(this,z,te)),this},f.prototype.off=f.prototype.removeListener=function(z,te){var ee,q,Ce,$,ae;if(b(te),void 0===(q=this._events))return this;if(void 0===(ee=q[z]))return this;if(ee===te||ee.listener===te)0==--this._eventsCount?this._events=Object.create(null):(delete q[z],q.removeListener&&this.emit("removeListener",z,ee.listener||te));else if("function"!=typeof ee){for(Ce=-1,$=ee.length-1;$>=0;$--)if(ee[$]===te||ee[$].listener===te){ae=ee[$].listener,Ce=$;break}if(Ce<0)return this;0===Ce?ee.shift():function w(V,z){for(;z+1<V.length;z++)V[z]=V[z+1];V.pop()}(ee,Ce),1===ee.length&&(q[z]=ee[0]),void 0!==q.removeListener&&this.emit("removeListener",z,ae||te)}return this},f.prototype.removeAllListeners=function(z){var te,ee,q;if(void 0===(ee=this._events))return this;if(void 0===ee.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==ee[z]&&(0==--this._eventsCount?this._events=Object.create(null):delete ee[z]),this;if(0===arguments.length){var $,Ce=Object.keys(ee);for(q=0;q<Ce.length;++q)"removeListener"!==($=Ce[q])&&this.removeAllListeners($);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(te=ee[z]))this.removeListener(z,te);else if(void 0!==te)for(q=te.length-1;q>=0;q--)this.removeListener(z,te[q]);return this},f.prototype.listeners=function(z){return _(this,z,!0)},f.prototype.rawListeners=function(z){return _(this,z,!1)},f.listenerCount=function(V,z){return"function"==typeof V.listenerCount?V.listenerCount(z):v.call(V,z)},f.prototype.listenerCount=v,f.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]}},4327:function(Ye,N){var Y,A;void 0!==(A="function"==typeof(Y=function(){"use strict";function f(d,_,v){var M=new XMLHttpRequest;M.open("GET",d),M.responseType="blob",M.onload=function(){m(M.response,_,v)},M.onerror=function(){console.error("could not download file")},M.send()}function p(d){var _=new XMLHttpRequest;_.open("HEAD",d,!1);try{_.send()}catch{}return 200<=_.status&&299>=_.status}function b(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var _=document.createEvent("MouseEvents");_.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(_)}}var T="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,S=T.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=T.saveAs||("object"!=typeof window||window!==T?function(){}:"download"in HTMLAnchorElement.prototype&&!S?function(d,_,v){var M=T.URL||T.webkitURL,w=document.createElement("a");w.download=_=_||d.name||"download",w.rel="noopener","string"==typeof d?(w.href=d,w.origin===location.origin?b(w):p(w.href)?f(d,_,v):b(w,w.target="_blank")):(w.href=M.createObjectURL(d),setTimeout(function(){M.revokeObjectURL(w.href)},4e4),setTimeout(function(){b(w)},0))}:"msSaveOrOpenBlob"in navigator?function(d,_,v){if(_=_||d.name||"download","string"!=typeof d)navigator.msSaveOrOpenBlob(function x(d,_){return typeof _>"u"?_={autoBom:!1}:"object"!=typeof _&&(console.warn("Deprecated: Expected third argument to be a object"),_={autoBom:!_}),_.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\ufeff",d],{type:d.type}):d}(d,v),_);else if(p(d))f(d,_,v);else{var M=document.createElement("a");M.href=d,M.target="_blank",setTimeout(function(){b(M)})}}:function(d,_,v,M){if((M=M||open("","_blank"))&&(M.document.title=M.document.body.innerText="downloading..."),"string"==typeof d)return f(d,_,v);var w="application/octet-stream"===d.type,R=/constructor/i.test(T.HTMLElement)||T.safari,W=/CriOS\/[\d]+/.test(navigator.userAgent);if((W||w&&R||S)&&typeof FileReader<"u"){var ne=new FileReader;ne.onloadend=function(){var z=ne.result;z=W?z:z.replace(/^data:[^;]*;/,"data:attachment/file;"),M?M.location.href=z:location=z,M=null},ne.readAsDataURL(d)}else{var B=T.URL||T.webkitURL,V=B.createObjectURL(d);M?M.location=V:location.href=V,M=null,setTimeout(function(){B.revokeObjectURL(V)},4e4)}});T.saveAs=m.saveAs=m,Ye.exports=m})?Y.apply(N,[]):Y)&&(Ye.exports=A)},5386:(Ye,N,Y)=>{var I;!function(A,x,f,p){"use strict";var W,b=["","webkit","Moz","MS","ms","o"],T=x.createElement("div"),S="function",m=Math.round,d=Math.abs,_=Date.now;function v(P,j,ie){return setTimeout(z(P,ie),j)}function M(P,j,ie){return!!Array.isArray(P)&&(w(P,ie[j],ie),!0)}function w(P,j,ie){var ye;if(P)if(P.forEach)P.forEach(j,ie);else if(P.length!==p)for(ye=0;ye<P.length;)j.call(ie,P[ye],ye,P),ye++;else for(ye in P)P.hasOwnProperty(ye)&&j.call(ie,P[ye],ye,P)}function R(P,j,ie){var ye="DEPRECATED METHOD: "+j+"\n"+ie+" AT \n";return function(){var Oe=new Error("get-stack-trace"),$e=Oe&&Oe.stack?Oe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",jt=A.console&&(A.console.warn||A.console.log);return jt&&jt.call(A.console,ye,$e),P.apply(this,arguments)}}W="function"!=typeof Object.assign?function(j){if(j===p||null===j)throw new TypeError("Cannot convert undefined or null to object");for(var ie=Object(j),ye=1;ye<arguments.length;ye++){var Oe=arguments[ye];if(Oe!==p&&null!==Oe)for(var $e in Oe)Oe.hasOwnProperty($e)&&(ie[$e]=Oe[$e])}return ie}:Object.assign;var ne=R(function(j,ie,ye){for(var Oe=Object.keys(ie),$e=0;$e<Oe.length;)(!ye||ye&&j[Oe[$e]]===p)&&(j[Oe[$e]]=ie[Oe[$e]]),$e++;return j},"extend","Use `assign`."),B=R(function(j,ie){return ne(j,ie,!0)},"merge","Use `assign`.");function V(P,j,ie){var Oe,ye=j.prototype;(Oe=P.prototype=Object.create(ye)).constructor=P,Oe._super=ye,ie&&W(Oe,ie)}function z(P,j){return function(){return P.apply(j,arguments)}}function te(P,j){return typeof P==S?P.apply(j&&j[0]||p,j):P}function ee(P,j){return P===p?j:P}function q(P,j,ie){w(C(j),function(ye){P.addEventListener(ye,ie,!1)})}function Ce(P,j,ie){w(C(j),function(ye){P.removeEventListener(ye,ie,!1)})}function $(P,j){for(;P;){if(P==j)return!0;P=P.parentNode}return!1}function ae(P,j){return P.indexOf(j)>-1}function C(P){return P.trim().split(/\s+/g)}function pe(P,j,ie){if(P.indexOf&&!ie)return P.indexOf(j);for(var ye=0;ye<P.length;){if(ie&&P[ye][ie]==j||!ie&&P[ye]===j)return ye;ye++}return-1}function ze(P){return Array.prototype.slice.call(P,0)}function le(P,j,ie){for(var ye=[],Oe=[],$e=0;$e<P.length;){var jt=j?P[$e][j]:P[$e];pe(Oe,jt)<0&&ye.push(P[$e]),Oe[$e]=jt,$e++}return ie&&(ye=j?ye.sort(function(hi,Sn){return hi[j]>Sn[j]}):ye.sort()),ye}function Ae(P,j){for(var ie,ye,Oe=j[0].toUpperCase()+j.slice(1),$e=0;$e<b.length;){if((ye=(ie=b[$e])?ie+Oe:j)in P)return ye;$e++}return p}var ve=1;function he(P){var j=P.ownerDocument||P;return j.defaultView||j.parentWindow||A}var Je="ontouchstart"in A,Ge=Ae(A,"PointerEvent")!==p,Ue=Je&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),qt="touch",Ie="mouse",pt=25,nt=1,Kt=2,Ct=4,y=8,_e=1,K=2,G=4,U=8,se=16,we=K|G,Te=U|se,de=we|Te,Ne=["x","y"],Ze=["clientX","clientY"];function Pe(P,j){var ie=this;this.manager=P,this.callback=j,this.element=P.element,this.target=P.options.inputTarget,this.domHandler=function(ye){te(P.options.enable,[P])&&ie.handler(ye)},this.init()}function en(P,j,ie){var ye=ie.pointers.length,Oe=ie.changedPointers.length,$e=j&nt&&ye-Oe==0,jt=j&(Ct|y)&&ye-Oe==0;ie.isFirst=!!$e,ie.isFinal=!!jt,$e&&(P.session={}),ie.eventType=j,function Vt(P,j){var ie=P.session,ye=j.pointers,Oe=ye.length;ie.firstInput||(ie.firstInput=Ji(j)),Oe>1&&!ie.firstMultiple?ie.firstMultiple=Ji(j):1===Oe&&(ie.firstMultiple=!1);var $e=ie.firstInput,jt=ie.firstMultiple,qn=jt?jt.center:$e.center,hi=j.center=Ti(ye);j.timeStamp=_(),j.deltaTime=j.timeStamp-$e.timeStamp,j.angle=er(qn,hi),j.distance=yo(qn,hi),function Ui(P,j){var ie=j.center,ye=P.offsetDelta||{},Oe=P.prevDelta||{},$e=P.prevInput||{};(j.eventType===nt||$e.eventType===Ct)&&(Oe=P.prevDelta={x:$e.deltaX||0,y:$e.deltaY||0},ye=P.offsetDelta={x:ie.x,y:ie.y}),j.deltaX=Oe.x+(ie.x-ye.x),j.deltaY=Oe.y+(ie.y-ye.y)}(ie,j),j.offsetDirection=Ms(j.deltaX,j.deltaY);var Sn=mn(j.deltaTime,j.deltaX,j.deltaY);j.overallVelocityX=Sn.x,j.overallVelocityY=Sn.y,j.overallVelocity=d(Sn.x)>d(Sn.y)?Sn.x:Sn.y,j.scale=jt?function _d(P,j){return yo(j[0],j[1],Ze)/yo(P[0],P[1],Ze)}(jt.pointers,ye):1,j.rotation=jt?function Ja(P,j){return er(j[1],j[0],Ze)+er(P[1],P[0],Ze)}(jt.pointers,ye):0,j.maxPointers=ie.prevInput?j.pointers.length>ie.prevInput.maxPointers?j.pointers.length:ie.prevInput.maxPointers:j.pointers.length,function Ds(P,j){var Oe,$e,jt,qn,ie=P.lastInterval||j,ye=j.timeStamp-ie.timeStamp;if(j.eventType!=y&&(ye>pt||ie.velocity===p)){var hi=j.deltaX-ie.deltaX,Sn=j.deltaY-ie.deltaY,io=mn(ye,hi,Sn);$e=io.x,jt=io.y,Oe=d(io.x)>d(io.y)?io.x:io.y,qn=Ms(hi,Sn),P.lastInterval=j}else Oe=ie.velocity,$e=ie.velocityX,jt=ie.velocityY,qn=ie.direction;j.velocity=Oe,j.velocityX=$e,j.velocityY=jt,j.direction=qn}(ie,j);var io=P.element;$(j.srcEvent.target,io)&&(io=j.srcEvent.target),j.target=io}(P,ie),P.emit("hammer.input",ie),P.recognize(ie),P.session.prevInput=ie}function Ji(P){for(var j=[],ie=0;ie<P.pointers.length;)j[ie]={clientX:m(P.pointers[ie].clientX),clientY:m(P.pointers[ie].clientY)},ie++;return{timeStamp:_(),pointers:j,center:Ti(j),deltaX:P.deltaX,deltaY:P.deltaY}}function Ti(P){var j=P.length;if(1===j)return{x:m(P[0].clientX),y:m(P[0].clientY)};for(var ie=0,ye=0,Oe=0;Oe<j;)ie+=P[Oe].clientX,ye+=P[Oe].clientY,Oe++;return{x:m(ie/j),y:m(ye/j)}}function mn(P,j,ie){return{x:j/P||0,y:ie/P||0}}function Ms(P,j){return P===j?_e:d(P)>=d(j)?P<0?K:G:j<0?U:se}function yo(P,j,ie){ie||(ie=Ne);var ye=j[ie[0]]-P[ie[0]],Oe=j[ie[1]]-P[ie[1]];return Math.sqrt(ye*ye+Oe*Oe)}function er(P,j,ie){return ie||(ie=Ne),180*Math.atan2(j[ie[1]]-P[ie[1]],j[ie[0]]-P[ie[0]])/Math.PI}Pe.prototype={handler:function(){},init:function(){this.evEl&&q(this.element,this.evEl,this.domHandler),this.evTarget&&q(this.target,this.evTarget,this.domHandler),this.evWin&&q(he(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ce(this.element,this.evEl,this.domHandler),this.evTarget&&Ce(this.target,this.evTarget,this.domHandler),this.evWin&&Ce(he(this.element),this.evWin,this.domHandler)}};var vd={mousedown:nt,mousemove:Kt,mouseup:Ct},yd="mousedown",wc="mousemove mouseup";function Jr(){this.evEl=yd,this.evWin=wc,this.pressed=!1,Pe.apply(this,arguments)}V(Jr,Pe,{handler:function(j){var ie=vd[j.type];ie&nt&&0===j.button&&(this.pressed=!0),ie&Kt&&1!==j.which&&(ie=Ct),this.pressed&&(ie&Ct&&(this.pressed=!1),this.callback(this.manager,ie,{pointers:[j],changedPointers:[j],pointerType:Ie,srcEvent:j}))}});var Qo={pointerdown:nt,pointermove:Kt,pointerup:Ct,pointercancel:y,pointerout:y},bd={2:qt,3:"pen",4:Ie,5:"kinect"},Ec="pointerdown",Tc="pointermove pointerup pointercancel";function el(){this.evEl=Ec,this.evWin=Tc,Pe.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A.MSPointerEvent&&!A.PointerEvent&&(Ec="MSPointerDown",Tc="MSPointerMove MSPointerUp MSPointerCancel"),V(el,Pe,{handler:function(j){var ie=this.store,ye=!1,Oe=j.type.toLowerCase().replace("ms",""),$e=Qo[Oe],jt=bd[j.pointerType]||j.pointerType,qn=jt==qt,hi=pe(ie,j.pointerId,"pointerId");$e&nt&&(0===j.button||qn)?hi<0&&(ie.push(j),hi=ie.length-1):$e&(Ct|y)&&(ye=!0),!(hi<0)&&(ie[hi]=j,this.callback(this.manager,$e,{pointers:ie,changedPointers:[j],pointerType:jt,srcEvent:j}),ye&&ie.splice(hi,1))}});var hp={touchstart:nt,touchmove:Kt,touchend:Ct,touchcancel:y},Cd="touchstart",wd="touchstart touchmove touchend touchcancel";function xc(){this.evTarget=Cd,this.evWin=wd,this.started=!1,Pe.apply(this,arguments)}function Ed(P,j){var ie=ze(P.touches),ye=ze(P.changedTouches);return j&(Ct|y)&&(ie=le(ie.concat(ye),"identifier",!0)),[ie,ye]}V(xc,Pe,{handler:function(j){var ie=hp[j.type];if(ie===nt&&(this.started=!0),this.started){var ye=Ed.call(this,j,ie);ie&(Ct|y)&&ye[0].length-ye[1].length==0&&(this.started=!1),this.callback(this.manager,ie,{pointers:ye[0],changedPointers:ye[1],pointerType:qt,srcEvent:j})}}});var eo={touchstart:nt,touchmove:Kt,touchend:Ct,touchcancel:y},fp="touchstart touchmove touchend touchcancel";function tl(){this.evTarget=fp,this.targetIds={},Pe.apply(this,arguments)}function pp(P,j){var ie=ze(P.touches),ye=this.targetIds;if(j&(nt|Kt)&&1===ie.length)return ye[ie[0].identifier]=!0,[ie,ie];var Oe,$e,jt=ze(P.changedTouches),qn=[],hi=this.target;if($e=ie.filter(function(Sn){return $(Sn.target,hi)}),j===nt)for(Oe=0;Oe<$e.length;)ye[$e[Oe].identifier]=!0,Oe++;for(Oe=0;Oe<jt.length;)ye[jt[Oe].identifier]&&qn.push(jt[Oe]),j&(Ct|y)&&delete ye[jt[Oe].identifier],Oe++;return qn.length?[le($e.concat(qn),"identifier",!0),qn]:void 0}V(tl,Pe,{handler:function(j){var ie=eo[j.type],ye=pp.call(this,j,ie);ye&&this.callback(this.manager,ie,{pointers:ye[0],changedPointers:ye[1],pointerType:qt,srcEvent:j})}});var gp=2500,Sc=25;function Dc(){Pe.apply(this,arguments);var P=z(this.handler,this);this.touch=new tl(this.manager,P),this.mouse=new Jr(this.manager,P),this.primaryTouch=null,this.lastTouches=[]}function mp(P,j){P&nt?(this.primaryTouch=j.changedPointers[0].identifier,to.call(this,j)):P&(Ct|y)&&to.call(this,j)}function to(P){var j=P.changedPointers[0];if(j.identifier===this.primaryTouch){var ie={x:j.clientX,y:j.clientY};this.lastTouches.push(ie);var ye=this.lastTouches;setTimeout(function(){var $e=ye.indexOf(ie);$e>-1&&ye.splice($e,1)},gp)}}function _p(P){for(var j=P.srcEvent.clientX,ie=P.srcEvent.clientY,ye=0;ye<this.lastTouches.length;ye++){var Oe=this.lastTouches[ye],$e=Math.abs(j-Oe.x),jt=Math.abs(ie-Oe.y);if($e<=Sc&&jt<=Sc)return!0}return!1}V(Dc,Pe,{handler:function(j,ie,ye){var $e=ye.pointerType==Ie;if(!($e&&ye.sourceCapabilities&&ye.sourceCapabilities.firesTouchEvents)){if(ye.pointerType==qt)mp.call(this,ie,ye);else if($e&&_p.call(this,ye))return;this.callback(j,ie,ye)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Mc=Ae(T.style,"touchAction"),Td=Mc!==p,kc="compute",Ic="manipulation",Jo="none",es="pan-x",sa="pan-y",nl=function Sd(){if(!Td)return!1;var P={},j=A.CSS&&A.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ie){P[ie]=!j||A.CSS.supports("touch-action",ie)}),P}();function Oc(P,j){this.manager=P,this.set(j)}Oc.prototype={set:function(P){P==kc&&(P=this.compute()),Td&&this.manager.element.style&&nl[P]&&(this.manager.element.style[Mc]=P),this.actions=P.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var P=[];return w(this.manager.recognizers,function(j){te(j.options.enable,[j])&&(P=P.concat(j.getTouchAction()))}),function xd(P){if(ae(P,Jo))return Jo;var j=ae(P,es),ie=ae(P,sa);return j&&ie?Jo:j||ie?j?es:sa:ae(P,Ic)?Ic:"auto"}(P.join(" "))},preventDefaults:function(P){var j=P.srcEvent,ie=P.offsetDirection;if(!this.manager.session.prevented){var ye=this.actions,Oe=ae(ye,Jo)&&!nl[Jo],$e=ae(ye,sa)&&!nl[sa],jt=ae(ye,es)&&!nl[es];if(Oe&&1===P.pointers.length&&P.distance<2&&P.deltaTime<250)return;return jt&&$e||!(Oe||$e&&ie&we||jt&&ie&Te)?void 0:this.preventSrc(j)}j.preventDefault()},preventSrc:function(P){this.manager.session.prevented=!0,P.preventDefault()}};var il=1,tr=2,ks=4,bo=8,Ir=bo,aa=16;function Ar(P){this.options=W({},this.defaults,P||{}),this.id=function xe(){return ve++}(),this.manager=null,this.options.enable=ee(this.options.enable,!0),this.state=il,this.simultaneous={},this.requireFail=[]}function Dd(P){return P&aa?"cancel":P&bo?"end":P&ks?"move":P&tr?"start":""}function Md(P){return P==se?"down":P==U?"up":P==K?"left":P==G?"right":""}function Is(P,j){var ie=j.manager;return ie?ie.get(P):P}function Ut(){Ar.apply(this,arguments)}function Os(){Ut.apply(this,arguments),this.pX=null,this.pY=null}function sn(){Ut.apply(this,arguments)}function la(){Ar.apply(this,arguments),this._timer=null,this._input=null}function Ac(){Ut.apply(this,arguments)}function an(){Ut.apply(this,arguments)}function ut(){Ar.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function no(P,j){return(j=j||{}).recognizers=ee(j.recognizers,no.defaults.preset),new As(P,j)}function As(P,j){this.options=W({},no.defaults,j||{}),this.options.inputTarget=this.options.inputTarget||P,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=P,this.input=function ct(P){return new(P.options.inputClass||(Ge?el:Ue?tl:Je?Dc:Jr))(P,en)}(this),this.touchAction=new Oc(this,this.options.touchAction),Se(this,!0),w(this.options.recognizers,function(ie){var ye=this.add(new ie[0](ie[1]));ie[2]&&ye.recognizeWith(ie[2]),ie[3]&&ye.requireFailure(ie[3])},this)}function Se(P,j){var ye,ie=P.element;ie.style&&(w(P.options.cssProps,function(Oe,$e){ye=Ae(ie.style,$e),j?(P.oldCssProps[ye]=ie.style[ye],ie.style[ye]=Oe):ie.style[ye]=P.oldCssProps[ye]||""}),j||(P.oldCssProps={}))}Ar.prototype={defaults:{},set:function(P){return W(this.options,P),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(P){if(M(P,"recognizeWith",this))return this;var j=this.simultaneous;return j[(P=Is(P,this)).id]||(j[P.id]=P,P.recognizeWith(this)),this},dropRecognizeWith:function(P){return M(P,"dropRecognizeWith",this)||(P=Is(P,this),delete this.simultaneous[P.id]),this},requireFailure:function(P){if(M(P,"requireFailure",this))return this;var j=this.requireFail;return-1===pe(j,P=Is(P,this))&&(j.push(P),P.requireFailure(this)),this},dropRequireFailure:function(P){if(M(P,"dropRequireFailure",this))return this;P=Is(P,this);var j=pe(this.requireFail,P);return j>-1&&this.requireFail.splice(j,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(P){return!!this.simultaneous[P.id]},emit:function(P){var j=this,ie=this.state;function ye(Oe){j.manager.emit(Oe,P)}ie<bo&&ye(j.options.event+Dd(ie)),ye(j.options.event),P.additionalEvent&&ye(P.additionalEvent),ie>=bo&&ye(j.options.event+Dd(ie))},tryEmit:function(P){if(this.canEmit())return this.emit(P);this.state=32},canEmit:function(){for(var P=0;P<this.requireFail.length;){if(!(this.requireFail[P].state&(32|il)))return!1;P++}return!0},recognize:function(P){var j=W({},P);if(!te(this.options.enable,[this,j]))return this.reset(),void(this.state=32);this.state&(Ir|aa|32)&&(this.state=il),this.state=this.process(j),this.state&(tr|ks|bo|aa)&&this.tryEmit(j)},process:function(P){},getTouchAction:function(){},reset:function(){}},V(Ut,Ar,{defaults:{pointers:1},attrTest:function(P){var j=this.options.pointers;return 0===j||P.pointers.length===j},process:function(P){var j=this.state,ie=P.eventType,ye=j&(tr|ks),Oe=this.attrTest(P);return ye&&(ie&y||!Oe)?j|aa:ye||Oe?ie&Ct?j|bo:j&tr?j|ks:tr:32}}),V(Os,Ut,{defaults:{event:"pan",threshold:10,pointers:1,direction:de},getTouchAction:function(){var P=this.options.direction,j=[];return P&we&&j.push(sa),P&Te&&j.push(es),j},directionTest:function(P){var j=this.options,ie=!0,ye=P.distance,Oe=P.direction,$e=P.deltaX,jt=P.deltaY;return Oe&j.direction||(j.direction&we?(Oe=0===$e?_e:$e<0?K:G,ie=$e!=this.pX,ye=Math.abs(P.deltaX)):(Oe=0===jt?_e:jt<0?U:se,ie=jt!=this.pY,ye=Math.abs(P.deltaY))),P.direction=Oe,ie&&ye>j.threshold&&Oe&j.direction},attrTest:function(P){return Ut.prototype.attrTest.call(this,P)&&(this.state&tr||!(this.state&tr)&&this.directionTest(P))},emit:function(P){this.pX=P.deltaX,this.pY=P.deltaY;var j=Md(P.direction);j&&(P.additionalEvent=this.options.event+j),this._super.emit.call(this,P)}}),V(sn,Ut,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Jo]},attrTest:function(P){return this._super.attrTest.call(this,P)&&(Math.abs(P.scale-1)>this.options.threshold||this.state&tr)},emit:function(P){1!==P.scale&&(P.additionalEvent=this.options.event+(P.scale<1?"in":"out")),this._super.emit.call(this,P)}}),V(la,Ar,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(P){var j=this.options,ie=P.pointers.length===j.pointers,ye=P.distance<j.threshold,Oe=P.deltaTime>j.time;if(this._input=P,!ye||!ie||P.eventType&(Ct|y)&&!Oe)this.reset();else if(P.eventType&nt)this.reset(),this._timer=v(function(){this.state=Ir,this.tryEmit()},j.time,this);else if(P.eventType&Ct)return Ir;return 32},reset:function(){clearTimeout(this._timer)},emit:function(P){this.state===Ir&&(P&&P.eventType&Ct?this.manager.emit(this.options.event+"up",P):(this._input.timeStamp=_(),this.manager.emit(this.options.event,this._input)))}}),V(Ac,Ut,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Jo]},attrTest:function(P){return this._super.attrTest.call(this,P)&&(Math.abs(P.rotation)>this.options.threshold||this.state&tr)}}),V(an,Ut,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:we|Te,pointers:1},getTouchAction:function(){return Os.prototype.getTouchAction.call(this)},attrTest:function(P){var ie,j=this.options.direction;return j&(we|Te)?ie=P.overallVelocity:j&we?ie=P.overallVelocityX:j&Te&&(ie=P.overallVelocityY),this._super.attrTest.call(this,P)&&j&P.offsetDirection&&P.distance>this.options.threshold&&P.maxPointers==this.options.pointers&&d(ie)>this.options.velocity&&P.eventType&Ct},emit:function(P){var j=Md(P.offsetDirection);j&&this.manager.emit(this.options.event+j,P),this.manager.emit(this.options.event,P)}}),V(ut,Ar,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ic]},process:function(P){var j=this.options,ie=P.pointers.length===j.pointers,ye=P.distance<j.threshold,Oe=P.deltaTime<j.time;if(this.reset(),P.eventType&nt&&0===this.count)return this.failTimeout();if(ye&&Oe&&ie){if(P.eventType!=Ct)return this.failTimeout();var $e=!this.pTime||P.timeStamp-this.pTime<j.interval,jt=!this.pCenter||yo(this.pCenter,P.center)<j.posThreshold;if(this.pTime=P.timeStamp,this.pCenter=P.center,jt&&$e?this.count+=1:this.count=1,this._input=P,0==this.count%j.taps)return this.hasRequireFailures()?(this._timer=v(function(){this.state=Ir,this.tryEmit()},j.interval,this),tr):Ir}return 32},failTimeout:function(){return this._timer=v(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ir&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),no.VERSION="2.0.7",no.defaults={domEvents:!1,touchAction:kc,enable:!0,inputTarget:null,inputClass:null,preset:[[Ac,{enable:!1}],[sn,{enable:!1},["rotate"]],[an,{direction:we}],[Os,{direction:we},["swipe"]],[ut],[ut,{event:"doubletap",taps:2},["tap"]],[la]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},As.prototype={set:function(P){return W(this.options,P),P.touchAction&&this.touchAction.update(),P.inputTarget&&(this.input.destroy(),this.input.target=P.inputTarget,this.input.init()),this},stop:function(P){this.session.stopped=P?2:1},recognize:function(P){var j=this.session;if(!j.stopped){this.touchAction.preventDefaults(P);var ie,ye=this.recognizers,Oe=j.curRecognizer;(!Oe||Oe&&Oe.state&Ir)&&(Oe=j.curRecognizer=null);for(var $e=0;$e<ye.length;)ie=ye[$e],2===j.stopped||Oe&&ie!=Oe&&!ie.canRecognizeWith(Oe)?ie.reset():ie.recognize(P),!Oe&&ie.state&(tr|ks|bo)&&(Oe=j.curRecognizer=ie),$e++}},get:function(P){if(P instanceof Ar)return P;for(var j=this.recognizers,ie=0;ie<j.length;ie++)if(j[ie].options.event==P)return j[ie];return null},add:function(P){if(M(P,"add",this))return this;var j=this.get(P.options.event);return j&&this.remove(j),this.recognizers.push(P),P.manager=this,this.touchAction.update(),P},remove:function(P){if(M(P,"remove",this))return this;if(P=this.get(P)){var j=this.recognizers,ie=pe(j,P);-1!==ie&&(j.splice(ie,1),this.touchAction.update())}return this},on:function(P,j){if(P!==p&&j!==p){var ie=this.handlers;return w(C(P),function(ye){ie[ye]=ie[ye]||[],ie[ye].push(j)}),this}},off:function(P,j){if(P!==p){var ie=this.handlers;return w(C(P),function(ye){j?ie[ye]&&ie[ye].splice(pe(ie[ye],j),1):delete ie[ye]}),this}},emit:function(P,j){this.options.domEvents&&function rl(P,j){var ie=x.createEvent("Event");ie.initEvent(P,!0,!0),ie.gesture=j,j.target.dispatchEvent(ie)}(P,j);var ie=this.handlers[P]&&this.handlers[P].slice();if(ie&&ie.length){j.type=P,j.preventDefault=function(){j.srcEvent.preventDefault()};for(var ye=0;ye<ie.length;)ie[ye](j),ye++}},destroy:function(){this.element&&Se(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},W(no,{INPUT_START:nt,INPUT_MOVE:Kt,INPUT_END:Ct,INPUT_CANCEL:y,STATE_POSSIBLE:il,STATE_BEGAN:tr,STATE_CHANGED:ks,STATE_ENDED:bo,STATE_RECOGNIZED:Ir,STATE_CANCELLED:aa,STATE_FAILED:32,DIRECTION_NONE:_e,DIRECTION_LEFT:K,DIRECTION_RIGHT:G,DIRECTION_UP:U,DIRECTION_DOWN:se,DIRECTION_HORIZONTAL:we,DIRECTION_VERTICAL:Te,DIRECTION_ALL:de,Manager:As,Input:Pe,TouchAction:Oc,TouchInput:tl,MouseInput:Jr,PointerEventInput:el,TouchMouseInput:Dc,SingleTouchInput:xc,Recognizer:Ar,AttrRecognizer:Ut,Tap:ut,Pan:Os,Swipe:an,Pinch:sn,Rotate:Ac,Press:la,on:q,off:Ce,each:w,merge:B,extend:ne,assign:W,inherit:V,bindFn:z,prefixed:Ae}),(typeof A<"u"?A:typeof self<"u"?self:{}).Hammer=no,(I=function(){return no}.call(N,Y,N,Ye))!==p&&(Ye.exports=I)}(window,document)},8461:(Ye,N)=>{N.read=function(Y,I,A,x,f){var p,b,T=8*f-x-1,S=(1<<T)-1,m=S>>1,d=-7,_=A?f-1:0,v=A?-1:1,M=Y[I+_];for(_+=v,p=M&(1<<-d)-1,M>>=-d,d+=T;d>0;p=256*p+Y[I+_],_+=v,d-=8);for(b=p&(1<<-d)-1,p>>=-d,d+=x;d>0;b=256*b+Y[I+_],_+=v,d-=8);if(0===p)p=1-m;else{if(p===S)return b?NaN:1/0*(M?-1:1);b+=Math.pow(2,x),p-=m}return(M?-1:1)*b*Math.pow(2,p-x)},N.write=function(Y,I,A,x,f,p){var b,T,S,m=8*p-f-1,d=(1<<m)-1,_=d>>1,v=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,M=x?0:p-1,w=x?1:-1,R=I<0||0===I&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(T=isNaN(I)?1:0,b=d):(b=Math.floor(Math.log(I)/Math.LN2),I*(S=Math.pow(2,-b))<1&&(b--,S*=2),(I+=b+_>=1?v/S:v*Math.pow(2,1-_))*S>=2&&(b++,S/=2),b+_>=d?(T=0,b=d):b+_>=1?(T=(I*S-1)*Math.pow(2,f),b+=_):(T=I*Math.pow(2,_-1)*Math.pow(2,f),b=0));f>=8;Y[A+M]=255&T,M+=w,T/=256,f-=8);for(b=b<<f|T,m+=f;m>0;Y[A+M]=255&b,M+=w,b/=256,m-=8);Y[A+M-w]|=128*R}},6256:function(Ye,N){!function(f){var M,p="undefined",b=p!==typeof Buffer&&Buffer,T=p!==typeof Uint8Array&&Uint8Array,S=p!==typeof ArrayBuffer&&ArrayBuffer,m=[0,0,0,0,0,0,0,0],d=Array.isArray||function $(ae){return!!ae&&"[object Array]"==Object.prototype.toString.call(ae)},_=4294967296,v=16777216;function w(ae,C,pe){var ze=C?0:4,le=C?4:0,Ae=C?0:3,ve=C?1:2,xe=C?2:1,he=C?3:0,me=C?te:q,Je=C?ee:Ce,Ge=Ve.prototype,Ue="is"+ae,qt="_"+Ue;return Ge.buffer=void 0,Ge.offset=0,Ge[qt]=!0,Ge.toNumber=nt,Ge.toString=function Kt(_e){var K=this.buffer,G=this.offset,U=y(K,G+ze),se=y(K,G+le),we="",Te=!pe&&2147483648&U;for(Te&&(U=~U,se=_-se),_e=_e||10;;){var de=U%_e*_+se;if(U=Math.floor(U/_e),se=Math.floor(de/_e),we=(de%_e).toString(_e)+we,!U&&!se)break}return Te&&(we="-"+we),we},Ge.toJSON=nt,Ge.toArray=R,b&&(Ge.toBuffer=W),T&&(Ge.toArrayBuffer=ne),Ve[Ue]=function Ie(_e){return!(!_e||!_e[qt])},f[ae]=Ve,Ve;function Ve(_e,K,G,U){return this instanceof Ve?function Fe(_e,K,G,U,se){T&&S&&(K instanceof S&&(K=new T(K)),U instanceof S&&(U=new T(U))),K||G||U||M?(B(K,G)||(se=G,U=K,G=0,K=new(M||Array)(8)),_e.buffer=K,_e.offset=G|=0,p!==typeof U&&("string"==typeof U?function pt(_e,K,G,U){var se=0,we=G.length,Te=0,de=0;"-"===G[0]&&se++;for(var Ne=se;se<we;){var Ze=parseInt(G[se++],U);if(!(Ze>=0))break;de=de*U+Ze,Te=Te*U+Math.floor(de/_),de%=_}Ne&&(Te=~Te,de?de=_-de:Te++),Ct(_e,K+ze,Te),Ct(_e,K+le,de)}(K,G,U,se||10):B(U,se)?V(K,G,U,se):"number"==typeof se?(Ct(K,G+ze,U),Ct(K,G+le,se)):U>0?me(K,G,U):U<0?Je(K,G,U):V(K,G,m,0))):_e.buffer=z(m,0)}(this,_e,K,G,U):new Ve(_e,K,G,U)}function nt(){var _e=this.buffer,K=this.offset,G=y(_e,K+ze),U=y(_e,K+le);return pe||(G|=0),G?G*_+U:U}function Ct(_e,K,G){_e[K+he]=255&G,_e[K+xe]=255&(G>>=8),_e[K+ve]=255&(G>>=8),_e[K+Ae]=255&(G>>=8)}function y(_e,K){return _e[K+Ae]*v+(_e[K+ve]<<16)+(_e[K+xe]<<8)+_e[K+he]}}function R(ae){var C=this.buffer,pe=this.offset;return M=null,!1!==ae&&0===pe&&8===C.length&&d(C)?C:z(C,pe)}function W(ae){var C=this.buffer,pe=this.offset;if(M=b,!1!==ae&&0===pe&&8===C.length&&Buffer.isBuffer(C))return C;var ze=new b(8);return V(ze,0,C,pe),ze}function ne(ae){var C=this.buffer,pe=this.offset,ze=C.buffer;if(M=T,!1!==ae&&0===pe&&ze instanceof S&&8===ze.byteLength)return ze;var le=new T(8);return V(le,0,C,pe),le.buffer}function B(ae,C){var pe=ae&&ae.length;return C|=0,pe&&C+8<=pe&&"string"!=typeof ae[C]}function V(ae,C,pe,ze){C|=0,ze|=0;for(var le=0;le<8;le++)ae[C++]=255&pe[ze++]}function z(ae,C){return Array.prototype.slice.call(ae,C,C+8)}function te(ae,C,pe){for(var ze=C+8;ze>C;)ae[--ze]=255&pe,pe/=256}function ee(ae,C,pe){var ze=C+8;for(pe++;ze>C;)ae[--ze]=255&-pe^255,pe/=256}function q(ae,C,pe){for(var ze=C+8;C<ze;)ae[C++]=255&pe,pe/=256}function Ce(ae,C,pe){var ze=C+8;for(pe++;C<ze;)ae[C++]=255&-pe^255,pe/=256}w("Uint64BE",!0,!0),w("Int64BE",!0,!1),w("Uint64LE",!1,!0),w("Int64LE",!1,!1)}("string"!=typeof N.nodeName?N:this||{})},6425:Ye=>{var N={}.toString;Ye.exports=Array.isArray||function(Y){return"[object Array]"==N.call(Y)}},5650:Ye=>{Ye.exports=function N(Y,I,A){function x(b,T){if(!I[b]){if(!Y[b]){if(f)return f(b,!0);var m=new Error("Cannot find module '"+b+"'");throw m.code="MODULE_NOT_FOUND",m}var d=I[b]={exports:{}};Y[b][0].call(d.exports,function(_){return x(Y[b][1][_]||_)},d,d.exports,N,Y,I,A)}return I[b].exports}for(var f=void 0,p=0;p<A.length;p++)x(A[p]);return x}({1:[function(N,Y,I){"use strict";var A=N("./utils"),x=N("./support"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";I.encode=function(p){for(var b,T,S,d,_,v,M=[],w=0,R=p.length,W=R,ne="string"!==A.getTypeOf(p);w<p.length;)W=R-w,S=ne?(b=p[w++],T=w<R?p[w++]:0,w<R?p[w++]:0):(b=p.charCodeAt(w++),T=w<R?p.charCodeAt(w++):0,w<R?p.charCodeAt(w++):0),d=(3&b)<<4|T>>4,_=1<W?(15&T)<<2|S>>6:64,v=2<W?63&S:64,M.push(f.charAt(b>>2)+f.charAt(d)+f.charAt(_)+f.charAt(v));return M.join("")},I.decode=function(p){var b,T,S,m,d,_,v=0,M=0,w="data:";if(p.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var R,W=3*(p=p.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(p.charAt(p.length-1)===f.charAt(64)&&W--,p.charAt(p.length-2)===f.charAt(64)&&W--,W%1!=0)throw new Error("Invalid base64 input, bad content length.");for(R=x.uint8array?new Uint8Array(0|W):new Array(0|W);v<p.length;)b=f.indexOf(p.charAt(v++))<<2|(m=f.indexOf(p.charAt(v++)))>>4,T=(15&m)<<4|(d=f.indexOf(p.charAt(v++)))>>2,S=(3&d)<<6|(_=f.indexOf(p.charAt(v++))),R[M++]=b,64!==d&&(R[M++]=T),64!==_&&(R[M++]=S);return R}},{"./support":30,"./utils":32}],2:[function(N,Y,I){"use strict";var A=N("./external"),x=N("./stream/DataWorker"),f=N("./stream/Crc32Probe"),p=N("./stream/DataLengthProbe");function b(T,S,m,d,_){this.compressedSize=T,this.uncompressedSize=S,this.crc32=m,this.compression=d,this.compressedContent=_}b.prototype={getContentWorker:function(){var T=new x(A.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new p("data_length")),S=this;return T.on("end",function(){if(this.streamInfo.data_length!==S.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),T},getCompressedWorker:function(){return new x(A.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},b.createWorkerFrom=function(T,S,m){return T.pipe(new f).pipe(new p("uncompressedSize")).pipe(S.compressWorker(m)).pipe(new p("compressedSize")).withStreamInfo("compression",S)},Y.exports=b},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(N,Y,I){"use strict";var A=N("./stream/GenericWorker");I.STORE={magic:"\0\0",compressWorker:function(){return new A("STORE compression")},uncompressWorker:function(){return new A("STORE decompression")}},I.DEFLATE=N("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(N,Y,I){"use strict";var A=N("./utils"),x=function(){for(var f,p=[],b=0;b<256;b++){f=b;for(var T=0;T<8;T++)f=1&f?3988292384^f>>>1:f>>>1;p[b]=f}return p}();Y.exports=function(f,p){return void 0!==f&&f.length?"string"!==A.getTypeOf(f)?function(b,T,S,m){var d=x,_=0+S;b^=-1;for(var v=0;v<_;v++)b=b>>>8^d[255&(b^T[v])];return-1^b}(0|p,f,f.length):function(b,T,S,m){var d=x,_=0+S;b^=-1;for(var v=0;v<_;v++)b=b>>>8^d[255&(b^T.charCodeAt(v))];return-1^b}(0|p,f,f.length):0}},{"./utils":32}],5:[function(N,Y,I){"use strict";I.base64=!1,I.binary=!1,I.dir=!1,I.createFolders=!0,I.date=null,I.compression=null,I.compressionOptions=null,I.comment=null,I.unixPermissions=null,I.dosPermissions=null},{}],6:[function(N,Y,I){"use strict";var A;A=typeof Promise<"u"?Promise:N("lie"),Y.exports={Promise:A}},{lie:37}],7:[function(N,Y,I){"use strict";var A=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=N("pako"),f=N("./utils"),p=N("./stream/GenericWorker"),b=A?"uint8array":"array";function T(S,m){p.call(this,"FlateWorker/"+S),this._pako=null,this._pakoAction=S,this._pakoOptions=m,this.meta={}}I.magic="\b\0",f.inherits(T,p),T.prototype.processChunk=function(S){this.meta=S.meta,null===this._pako&&this._createPako(),this._pako.push(f.transformTo(b,S.data),!1)},T.prototype.flush=function(){p.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},T.prototype.cleanUp=function(){p.prototype.cleanUp.call(this),this._pako=null},T.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var S=this;this._pako.onData=function(m){S.push({data:m,meta:S.meta})}},I.compressWorker=function(S){return new T("Deflate",S)},I.uncompressWorker=function(){return new T("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(N,Y,I){"use strict";function A(d,_){var v,M="";for(v=0;v<_;v++)M+=String.fromCharCode(255&d),d>>>=8;return M}function x(d,_,v,M,w,R){var W,ne,B=d.file,V=d.compression,z=R!==b.utf8encode,te=f.transformTo("string",R(B.name)),ee=f.transformTo("string",b.utf8encode(B.name)),q=B.comment,Ce=f.transformTo("string",R(q)),$=f.transformTo("string",b.utf8encode(q)),ae=ee.length!==B.name.length,C=$.length!==q.length,pe="",ze="",le="",Ae=B.dir,ve=B.date,xe={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(xe.crc32=d.crc32,xe.compressedSize=d.compressedSize,xe.uncompressedSize=d.uncompressedSize);var he=0;_&&(he|=8),z||!ae&&!C||(he|=2048);var Ue,Ve,me=0,Je=0;Ae&&(me|=16),"UNIX"===w?(Je=798,me|=(Ve=Ue=B.unixPermissions,Ue||(Ve=Ae?16893:33204),(65535&Ve)<<16)):(Je=20,me|=function(Ue){return 63&(Ue||0)}(B.dosPermissions)),W=ve.getUTCHours(),W<<=6,W|=ve.getUTCMinutes(),W<<=5,W|=ve.getUTCSeconds()/2,ne=ve.getUTCFullYear()-1980,ne<<=4,ne|=ve.getUTCMonth()+1,ne<<=5,ne|=ve.getUTCDate(),ae&&(ze=A(1,1)+A(T(te),4)+ee,pe+="up"+A(ze.length,2)+ze),C&&(le=A(1,1)+A(T(Ce),4)+$,pe+="uc"+A(le.length,2)+le);var Ge="";return Ge+="\n\0",Ge+=A(he,2),Ge+=V.magic,Ge+=A(W,2),Ge+=A(ne,2),Ge+=A(xe.crc32,4),Ge+=A(xe.compressedSize,4),Ge+=A(xe.uncompressedSize,4),Ge+=A(te.length,2),Ge+=A(pe.length,2),{fileRecord:S.LOCAL_FILE_HEADER+Ge+te+pe,dirRecord:S.CENTRAL_FILE_HEADER+A(Je,2)+Ge+A(Ce.length,2)+"\0\0\0\0"+A(me,4)+A(M,4)+te+pe+Ce}}var f=N("../utils"),p=N("../stream/GenericWorker"),b=N("../utf8"),T=N("../crc32"),S=N("../signature");function m(d,_,v,M){p.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=M,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}f.inherits(m,p),m.prototype.push=function(d){var _=d.meta.percent||0,v=this.entriesCount,M=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,p.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-M-1))/v:100}}))},m.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var _=this.streamFiles&&!d.file.dir;if(_){var v=x(d,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(d){this.accumulate=!1;var M,_=this.streamFiles&&!d.file.dir,v=x(d,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:(M=d,S.DATA_DESCRIPTOR+A(M.crc32,4)+A(M.compressedSize,4)+A(M.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var d=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var w,R,W,V,M=(w=this.dirRecords.length,R=this.bytesWritten-d,W=d,V=f.transformTo("string",(0,this.encodeFileName)(this.zipComment)),S.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(w,2)+A(w,2)+A(R,4)+A(W,4)+A(V.length,2)+V);this.push({data:M,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(d){this._sources.push(d);var _=this;return d.on("data",function(v){_.processChunk(v)}),d.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),d.on("error",function(v){_.error(v)}),this},m.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(d){var _=this._sources;if(!p.prototype.error.call(this,d))return!1;for(var v=0;v<_.length;v++)try{_[v].error(d)}catch{}return!0},m.prototype.lock=function(){p.prototype.lock.call(this);for(var d=this._sources,_=0;_<d.length;_++)d[_].lock()},Y.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(N,Y,I){"use strict";var A=N("../compressions"),x=N("./ZipFileWorker");I.generateWorker=function(f,p,b){var T=new x(p.streamFiles,b,p.platform,p.encodeFileName),S=0;try{f.forEach(function(m,d){S++;var _=function(R,W){var ne=R||W,B=A[ne];if(!B)throw new Error(ne+" is not a valid compression method !");return B}(d.options.compression,p.compression),M=d.dir,w=d.date;d._compressWorker(_,d.options.compressionOptions||p.compressionOptions||{}).withStreamInfo("file",{name:m,dir:M,date:w,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(T)}),T.entriesCount=S}catch(m){T.error(m)}return T}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(N,Y,I){"use strict";function A(){if(!(this instanceof A))return new A;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new A;for(var f in this)"function"!=typeof this[f]&&(x[f]=this[f]);return x}}(A.prototype=N("./object")).loadAsync=N("./load"),A.support=N("./support"),A.defaults=N("./defaults"),A.version="3.10.1",A.loadAsync=function(x,f){return(new A).loadAsync(x,f)},A.external=N("./external"),Y.exports=A},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(N,Y,I){"use strict";var A=N("./utils"),x=N("./external"),f=N("./utf8"),p=N("./zipEntries"),b=N("./stream/Crc32Probe"),T=N("./nodejsUtils");function S(m){return new x.Promise(function(d,_){var v=m.decompressed.getContentWorker().pipe(new b);v.on("error",function(M){_(M)}).on("end",function(){v.streamInfo.crc32!==m.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}Y.exports=function(m,d){var _=this;return d=A.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:f.utf8decode}),T.isNode&&T.isStream(m)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):A.prepareContent("the loaded zip file",m,!0,d.optimizedBinaryString,d.base64).then(function(v){var M=new p(d);return M.load(v),M}).then(function(v){var M=[x.Promise.resolve(v)],w=v.files;if(d.checkCRC32)for(var R=0;R<w.length;R++)M.push(S(w[R]));return x.Promise.all(M)}).then(function(v){for(var M=v.shift(),w=M.files,R=0;R<w.length;R++){var W=w[R],ne=W.fileNameStr,B=A.resolve(W.fileNameStr);_.file(B,W.decompressed,{binary:!0,optimizedBinaryString:!0,date:W.date,dir:W.dir,comment:W.fileCommentStr.length?W.fileCommentStr:null,unixPermissions:W.unixPermissions,dosPermissions:W.dosPermissions,createFolders:d.createFolders}),W.dir||(_.file(B).unsafeOriginalName=ne)}return M.zipComment.length&&(_.comment=M.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(N,Y,I){"use strict";var A=N("../utils"),x=N("../stream/GenericWorker");function f(p,b){x.call(this,"Nodejs stream input adapter for "+p),this._upstreamEnded=!1,this._bindStream(b)}A.inherits(f,x),f.prototype._bindStream=function(p){var b=this;(this._stream=p).pause(),p.on("data",function(T){b.push({data:T,meta:{percent:0}})}).on("error",function(T){b.isPaused?this.generatedError=T:b.error(T)}).on("end",function(){b.isPaused?b._upstreamEnded=!0:b.end()})},f.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},f.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Y.exports=f},{"../stream/GenericWorker":28,"../utils":32}],13:[function(N,Y,I){"use strict";var A=N("readable-stream").Readable;function x(f,p,b){A.call(this,p),this._helper=f;var T=this;f.on("data",function(S,m){T.push(S)||T._helper.pause(),b&&b(m)}).on("error",function(S){T.emit("error",S)}).on("end",function(){T.push(null)})}N("../utils").inherits(x,A),x.prototype._read=function(){this._helper.resume()},Y.exports=x},{"../utils":32,"readable-stream":16}],14:[function(N,Y,I){"use strict";Y.exports={isNode:typeof Buffer<"u",newBufferFrom:function(A,x){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(A,x);if("number"==typeof A)throw new Error('The "data" argument must not be a number');return new Buffer(A,x)},allocBuffer:function(A){if(Buffer.alloc)return Buffer.alloc(A);var x=new Buffer(A);return x.fill(0),x},isBuffer:function(A){return Buffer.isBuffer(A)},isStream:function(A){return A&&"function"==typeof A.on&&"function"==typeof A.pause&&"function"==typeof A.resume}}},{}],15:[function(N,Y,I){"use strict";function A(B,V,z){var te,ee=f.getTypeOf(V),q=f.extend(z||{},T);q.date=q.date||new Date,null!==q.compression&&(q.compression=q.compression.toUpperCase()),"string"==typeof q.unixPermissions&&(q.unixPermissions=parseInt(q.unixPermissions,8)),q.unixPermissions&&16384&q.unixPermissions&&(q.dir=!0),q.dosPermissions&&16&q.dosPermissions&&(q.dir=!0),q.dir&&(B=w(B)),q.createFolders&&(te=M(B))&&R.call(this,te,!0),z&&void 0!==z.binary||(q.binary=!("string"===ee&&!1===q.binary&&!1===q.base64)),(V instanceof S&&0===V.uncompressedSize||q.dir||!V||0===V.length)&&(q.base64=!1,q.binary=!0,V="",q.compression="STORE",ee="string");var $;$=V instanceof S||V instanceof p?V:_.isNode&&_.isStream(V)?new v(B,V):f.prepareContent(B,V,q.binary,q.optimizedBinaryString,q.base64);var ae=new m(B,$,q);this.files[B]=ae}var x=N("./utf8"),f=N("./utils"),p=N("./stream/GenericWorker"),b=N("./stream/StreamHelper"),T=N("./defaults"),S=N("./compressedObject"),m=N("./zipObject"),d=N("./generate"),_=N("./nodejsUtils"),v=N("./nodejs/NodejsStreamInputAdapter"),M=function(B){"/"===B.slice(-1)&&(B=B.substring(0,B.length-1));var V=B.lastIndexOf("/");return 0<V?B.substring(0,V):""},w=function(B){return"/"!==B.slice(-1)&&(B+="/"),B},R=function(B,V){return V=void 0!==V?V:T.createFolders,B=w(B),this.files[B]||A.call(this,B,null,{dir:!0,createFolders:V}),this.files[B]};function W(B){return"[object RegExp]"===Object.prototype.toString.call(B)}var ne={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(B){var V,z,te;for(V in this.files)te=this.files[V],(z=V.slice(this.root.length,V.length))&&V.slice(0,this.root.length)===this.root&&B(z,te)},filter:function(B){var V=[];return this.forEach(function(z,te){B(z,te)&&V.push(te)}),V},file:function(B,V,z){if(1!==arguments.length)return A.call(this,B=this.root+B,V,z),this;if(W(B)){var te=B;return this.filter(function(q,Ce){return!Ce.dir&&te.test(q)})}var ee=this.files[this.root+B];return ee&&!ee.dir?ee:null},folder:function(B){if(!B)return this;if(W(B))return this.filter(function(ee,q){return q.dir&&B.test(ee)});var z=R.call(this,this.root+B),te=this.clone();return te.root=z.name,te},remove:function(B){var V=this.files[B=this.root+B];if(V||("/"!==B.slice(-1)&&(B+="/"),V=this.files[B]),V&&!V.dir)delete this.files[B];else for(var z=this.filter(function(ee,q){return q.name.slice(0,B.length)===B}),te=0;te<z.length;te++)delete this.files[z[te].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(B){var V,z={};try{if((z=f.extend(B||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),"binarystring"===z.type&&(z.type="string"),!z.type)throw new Error("No output type specified.");f.checkSupport(z.type),"darwin"!==z.platform&&"freebsd"!==z.platform&&"linux"!==z.platform&&"sunos"!==z.platform||(z.platform="UNIX"),"win32"===z.platform&&(z.platform="DOS"),V=d.generateWorker(this,z,z.comment||this.comment||"")}catch(ee){(V=new p("error")).error(ee)}return new b(V,z.type||"string",z.mimeType)},generateAsync:function(B,V){return this.generateInternalStream(B).accumulate(V)},generateNodeStream:function(B,V){return(B=B||{}).type||(B.type="nodebuffer"),this.generateInternalStream(B).toNodejsStream(V)}};Y.exports=ne},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(N,Y,I){"use strict";Y.exports=N("stream")},{stream:void 0}],17:[function(N,Y,I){"use strict";var A=N("./DataReader");function x(f){A.call(this,f);for(var p=0;p<this.data.length;p++)f[p]=255&f[p]}N("../utils").inherits(x,A),x.prototype.byteAt=function(f){return this.data[this.zero+f]},x.prototype.lastIndexOfSignature=function(f){for(var p=f.charCodeAt(0),b=f.charCodeAt(1),T=f.charCodeAt(2),S=f.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===p&&this.data[m+1]===b&&this.data[m+2]===T&&this.data[m+3]===S)return m-this.zero;return-1},x.prototype.readAndCheckSignature=function(f){var p=f.charCodeAt(0),b=f.charCodeAt(1),T=f.charCodeAt(2),S=f.charCodeAt(3),m=this.readData(4);return p===m[0]&&b===m[1]&&T===m[2]&&S===m[3]},x.prototype.readData=function(f){if(this.checkOffset(f),0===f)return[];var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=x},{"../utils":32,"./DataReader":18}],18:[function(N,Y,I){"use strict";var A=N("../utils");function x(f){this.data=f,this.length=f.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(f){this.checkIndex(this.index+f)},checkIndex:function(f){if(this.length<this.zero+f||f<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+f+"). Corrupted zip ?")},setIndex:function(f){this.checkIndex(f),this.index=f},skip:function(f){this.setIndex(this.index+f)},byteAt:function(){},readInt:function(f){var p,b=0;for(this.checkOffset(f),p=this.index+f-1;p>=this.index;p--)b=(b<<8)+this.byteAt(p);return this.index+=f,b},readString:function(f){return A.transformTo("string",this.readData(f))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var f=this.readInt(4);return new Date(Date.UTC(1980+(f>>25&127),(f>>21&15)-1,f>>16&31,f>>11&31,f>>5&63,(31&f)<<1))}},Y.exports=x},{"../utils":32}],19:[function(N,Y,I){"use strict";var A=N("./Uint8ArrayReader");function x(f){A.call(this,f)}N("../utils").inherits(x,A),x.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(N,Y,I){"use strict";var A=N("./DataReader");function x(f){A.call(this,f)}N("../utils").inherits(x,A),x.prototype.byteAt=function(f){return this.data.charCodeAt(this.zero+f)},x.prototype.lastIndexOfSignature=function(f){return this.data.lastIndexOf(f)-this.zero},x.prototype.readAndCheckSignature=function(f){return f===this.readData(4)},x.prototype.readData=function(f){this.checkOffset(f);var p=this.data.slice(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=x},{"../utils":32,"./DataReader":18}],21:[function(N,Y,I){"use strict";var A=N("./ArrayReader");function x(f){A.call(this,f)}N("../utils").inherits(x,A),x.prototype.readData=function(f){if(this.checkOffset(f),0===f)return new Uint8Array(0);var p=this.data.subarray(this.zero+this.index,this.zero+this.index+f);return this.index+=f,p},Y.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(N,Y,I){"use strict";var A=N("../utils"),x=N("../support"),f=N("./ArrayReader"),p=N("./StringReader"),b=N("./NodeBufferReader"),T=N("./Uint8ArrayReader");Y.exports=function(S){var m=A.getTypeOf(S);return A.checkSupport(m),"string"!==m||x.uint8array?"nodebuffer"===m?new b(S):x.uint8array?new T(A.transformTo("uint8array",S)):new f(A.transformTo("array",S)):new p(S)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(N,Y,I){"use strict";I.LOCAL_FILE_HEADER="PK\x03\x04",I.CENTRAL_FILE_HEADER="PK\x01\x02",I.CENTRAL_DIRECTORY_END="PK\x05\x06",I.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",I.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",I.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(N,Y,I){"use strict";var A=N("./GenericWorker"),x=N("../utils");function f(p){A.call(this,"ConvertWorker to "+p),this.destType=p}x.inherits(f,A),f.prototype.processChunk=function(p){this.push({data:x.transformTo(this.destType,p.data),meta:p.meta})},Y.exports=f},{"../utils":32,"./GenericWorker":28}],25:[function(N,Y,I){"use strict";var A=N("./GenericWorker"),x=N("../crc32");function f(){A.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}N("../utils").inherits(f,A),f.prototype.processChunk=function(p){this.streamInfo.crc32=x(p.data,this.streamInfo.crc32||0),this.push(p)},Y.exports=f},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(N,Y,I){"use strict";var A=N("../utils"),x=N("./GenericWorker");function f(p){x.call(this,"DataLengthProbe for "+p),this.propName=p,this.withStreamInfo(p,0)}A.inherits(f,x),f.prototype.processChunk=function(p){p&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+p.data.length),x.prototype.processChunk.call(this,p)},Y.exports=f},{"../utils":32,"./GenericWorker":28}],27:[function(N,Y,I){"use strict";var A=N("../utils"),x=N("./GenericWorker");function f(p){x.call(this,"DataWorker");var b=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,p.then(function(T){b.dataIsReady=!0,b.data=T,b.max=T&&T.length||0,b.type=A.getTypeOf(T),b.isPaused||b._tickAndRepeat()},function(T){b.error(T)})}A.inherits(f,x),f.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},f.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,A.delay(this._tickAndRepeat,[],this)),!0)},f.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(A.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},f.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var p=null,b=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":p=this.data.substring(this.index,b);break;case"uint8array":p=this.data.subarray(this.index,b);break;case"array":case"nodebuffer":p=this.data.slice(this.index,b)}return this.index=b,this.push({data:p,meta:{percent:this.max?this.index/this.max*100:0}})},Y.exports=f},{"../utils":32,"./GenericWorker":28}],28:[function(N,Y,I){"use strict";function A(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}A.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,f){return this._listeners[x].push(f),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,f){if(this._listeners[x])for(var p=0;p<this._listeners[x].length;p++)this._listeners[x][p].call(this,f)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var f=this;return x.on("data",function(p){f.processChunk(p)}),x.on("end",function(){f.end()}),x.on("error",function(p){f.error(p)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,f){return this.extraStreamInfo[x]=f,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},Y.exports=A},{}],29:[function(N,Y,I){"use strict";var A=N("../utils"),x=N("./ConvertWorker"),f=N("./GenericWorker"),p=N("../base64"),b=N("../support"),T=N("../external"),S=null;if(b.nodestream)try{S=N("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(_,v,M){var w=v;switch(v){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=v,this._mimeType=M,A.checkSupport(w),this._worker=_.pipe(new x(w)),_.lock()}catch(R){this._worker=new f("error"),this._worker.error(R)}}d.prototype={accumulate:function(_){return function m(_,v){return new T.Promise(function(M,w){var R=[],W=_._internalType,ne=_._outputType,B=_._mimeType;_.on("data",function(V,z){R.push(V),v&&v(z)}).on("error",function(V){R=[],w(V)}).on("end",function(){try{var V=function(z,te,ee){switch(z){case"blob":return A.newBlob(A.transformTo("arraybuffer",te),ee);case"base64":return p.encode(te);default:return A.transformTo(z,te)}}(ne,function(z,te){var ee,q=0,Ce=null,$=0;for(ee=0;ee<te.length;ee++)$+=te[ee].length;switch(z){case"string":return te.join("");case"array":return Array.prototype.concat.apply([],te);case"uint8array":for(Ce=new Uint8Array($),ee=0;ee<te.length;ee++)Ce.set(te[ee],q),q+=te[ee].length;return Ce;case"nodebuffer":return Buffer.concat(te);default:throw new Error("concat : unsupported type '"+z+"'")}}(W,R),B);M(V)}catch(z){w(z)}R=[]}).resume()})}(this,_)},on:function(_,v){var M=this;return this._worker.on(_,"data"===_?function(w){v.call(M,w.data,w.meta)}:function(){A.delay(v,arguments,M)}),this},resume:function(){return A.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(A.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new S(this,{objectMode:"nodebuffer"!==this._outputType},_)}},Y.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(N,Y,I){"use strict";if(I.base64=!0,I.array=!0,I.string=!0,I.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",I.nodebuffer=typeof Buffer<"u",I.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")I.blob=!1;else{var A=new ArrayBuffer(0);try{I.blob=0===new Blob([A],{type:"application/zip"}).size}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(A),I.blob=0===x.getBlob("application/zip").size}catch{I.blob=!1}}}try{I.nodestream=!!N("readable-stream").Readable}catch{I.nodestream=!1}},{"readable-stream":16}],31:[function(N,Y,I){"use strict";for(var A=N("./utils"),x=N("./support"),f=N("./nodejsUtils"),p=N("./stream/GenericWorker"),b=new Array(256),T=0;T<256;T++)b[T]=252<=T?6:248<=T?5:240<=T?4:224<=T?3:192<=T?2:1;function S(){p.call(this,"utf-8 decode"),this.leftOver=null}function m(){p.call(this,"utf-8 encode")}b[254]=b[254]=1,I.utf8encode=function(d){return x.nodebuffer?f.newBufferFrom(d,"utf-8"):function(_){var v,M,w,R,W,ne=_.length,B=0;for(R=0;R<ne;R++)55296==(64512&(M=_.charCodeAt(R)))&&R+1<ne&&56320==(64512&(w=_.charCodeAt(R+1)))&&(M=65536+(M-55296<<10)+(w-56320),R++),B+=M<128?1:M<2048?2:M<65536?3:4;for(v=x.uint8array?new Uint8Array(B):new Array(B),R=W=0;W<B;R++)55296==(64512&(M=_.charCodeAt(R)))&&R+1<ne&&56320==(64512&(w=_.charCodeAt(R+1)))&&(M=65536+(M-55296<<10)+(w-56320),R++),M<128?v[W++]=M:(M<2048?v[W++]=192|M>>>6:(M<65536?v[W++]=224|M>>>12:(v[W++]=240|M>>>18,v[W++]=128|M>>>12&63),v[W++]=128|M>>>6&63),v[W++]=128|63&M);return v}(d)},I.utf8decode=function(d){return x.nodebuffer?A.transformTo("nodebuffer",d).toString("utf-8"):function(_){var v,M,w,R,W=_.length,ne=new Array(2*W);for(v=M=0;v<W;)if((w=_[v++])<128)ne[M++]=w;else if(4<(R=b[w]))ne[M++]=65533,v+=R-1;else{for(w&=2===R?31:3===R?15:7;1<R&&v<W;)w=w<<6|63&_[v++],R--;1<R?ne[M++]=65533:w<65536?ne[M++]=w:(ne[M++]=55296|(w-=65536)>>10&1023,ne[M++]=56320|1023&w)}return ne.length!==M&&(ne.subarray?ne=ne.subarray(0,M):ne.length=M),A.applyFromCharCode(ne)}(d=A.transformTo(x.uint8array?"uint8array":"array",d))},A.inherits(S,p),S.prototype.processChunk=function(d){var _=A.transformTo(x.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var M=function(R,W){var ne;for((W=W||R.length)>R.length&&(W=R.length),ne=W-1;0<=ne&&128==(192&R[ne]);)ne--;return ne<0||0===ne?W:ne+b[R[ne]]>W?ne:W}(_),w=_;M!==_.length&&(x.uint8array?(w=_.subarray(0,M),this.leftOver=_.subarray(M,_.length)):(w=_.slice(0,M),this.leftOver=_.slice(M,_.length))),this.push({data:I.utf8decode(w),meta:d.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:I.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},I.Utf8DecodeWorker=S,A.inherits(m,p),m.prototype.processChunk=function(d){this.push({data:I.utf8encode(d.data),meta:d.meta})},I.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(N,Y,I){"use strict";var A=N("./support"),x=N("./base64"),f=N("./nodejsUtils"),p=N("./external");function b(v){return v}function T(v,M){for(var w=0;w<v.length;++w)M[w]=255&v.charCodeAt(w);return M}N("setimmediate"),I.newBlob=function(v,M){I.checkSupport("blob");try{return new Blob([v],{type:M})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(v),w.getBlob(M)}catch{throw new Error("Bug : can't construct the Blob.")}}};var S={stringifyByChunk:function(v,M,w){var R=[],W=0,ne=v.length;if(ne<=w)return String.fromCharCode.apply(null,v);for(;W<ne;)R.push(String.fromCharCode.apply(null,"array"===M||"nodebuffer"===M?v.slice(W,Math.min(W+w,ne)):v.subarray(W,Math.min(W+w,ne)))),W+=w;return R.join("")},stringifyByChar:function(v){for(var M="",w=0;w<v.length;w++)M+=String.fromCharCode(v[w]);return M},applyCanBeUsed:{uint8array:function(){try{return A.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return A.nodebuffer&&1===String.fromCharCode.apply(null,f.allocBuffer(1)).length}catch{return!1}}()}};function m(v){var M=65536,w=I.getTypeOf(v),R=!0;if("uint8array"===w?R=S.applyCanBeUsed.uint8array:"nodebuffer"===w&&(R=S.applyCanBeUsed.nodebuffer),R)for(;1<M;)try{return S.stringifyByChunk(v,w,M)}catch{M=Math.floor(M/2)}return S.stringifyByChar(v)}function d(v,M){for(var w=0;w<v.length;w++)M[w]=v[w];return M}I.applyFromCharCode=m;var _={};_.string={string:b,array:function(v){return T(v,new Array(v.length))},arraybuffer:function(v){return _.string.uint8array(v).buffer},uint8array:function(v){return T(v,new Uint8Array(v.length))},nodebuffer:function(v){return T(v,f.allocBuffer(v.length))}},_.array={string:m,array:b,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(v)}},_.arraybuffer={string:function(v){return m(new Uint8Array(v))},array:function(v){return d(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:b,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(new Uint8Array(v))}},_.uint8array={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:b,nodebuffer:function(v){return f.newBufferFrom(v)}},_.nodebuffer={string:m,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return _.nodebuffer.uint8array(v).buffer},uint8array:function(v){return d(v,new Uint8Array(v.length))},nodebuffer:b},I.transformTo=function(v,M){if(M=M||"",!v)return M;I.checkSupport(v);var w=I.getTypeOf(M);return _[w][v](M)},I.resolve=function(v){for(var M=v.split("/"),w=[],R=0;R<M.length;R++){var W=M[R];"."===W||""===W&&0!==R&&R!==M.length-1||(".."===W?w.pop():w.push(W))}return w.join("/")},I.getTypeOf=function(v){return"string"==typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?"array":A.nodebuffer&&f.isBuffer(v)?"nodebuffer":A.uint8array&&v instanceof Uint8Array?"uint8array":A.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},I.checkSupport=function(v){if(!A[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},I.MAX_VALUE_16BITS=65535,I.MAX_VALUE_32BITS=-1,I.pretty=function(v){var M,w,R="";for(w=0;w<(v||"").length;w++)R+="\\x"+((M=v.charCodeAt(w))<16?"0":"")+M.toString(16).toUpperCase();return R},I.delay=function(v,M,w){setImmediate(function(){v.apply(w||null,M||[])})},I.inherits=function(v,M){function w(){}w.prototype=M.prototype,v.prototype=new w},I.extend=function(){var v,M,w={};for(v=0;v<arguments.length;v++)for(M in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],M)&&void 0===w[M]&&(w[M]=arguments[v][M]);return w},I.prepareContent=function(v,M,w,R,W){return p.Promise.resolve(M).then(function(ne){return A.blob&&(ne instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ne)))&&typeof FileReader<"u"?new p.Promise(function(B,V){var z=new FileReader;z.onload=function(te){B(te.target.result)},z.onerror=function(te){V(te.target.error)},z.readAsArrayBuffer(ne)}):ne}).then(function(ne){var V,B=I.getTypeOf(ne);return B?("arraybuffer"===B?ne=I.transformTo("uint8array",ne):"string"===B&&(W?ne=x.decode(ne):w&&!0!==R&&(ne=T(V=ne,A.uint8array?new Uint8Array(V.length):new Array(V.length)))),ne):p.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(N,Y,I){"use strict";var A=N("./reader/readerFor"),x=N("./utils"),f=N("./signature"),p=N("./zipEntry"),b=N("./support");function T(S){this.files=[],this.loadOptions=S}T.prototype={checkSignature:function(S){if(!this.reader.readAndCheckSignature(S)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(m)+", expected "+x.pretty(S)+")")}},isSignature:function(S,m){var d=this.reader.index;this.reader.setIndex(S);var _=this.reader.readString(4)===m;return this.reader.setIndex(d),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var S=this.reader.readData(this.zipCommentLength),d=x.transformTo(b.uint8array?"uint8array":"array",S);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var S,m,d,_=this.zip64EndOfCentralSize-44;0<_;)S=this.reader.readInt(2),m=this.reader.readInt(4),d=this.reader.readData(m),this.zip64ExtensibleData[S]={id:S,length:m,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var S,m;for(S=0;S<this.files.length;S++)this.reader.setIndex((m=this.files[S]).localHeaderOffset),this.checkSignature(f.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var S;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(f.CENTRAL_FILE_HEADER);)(S=new p({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(S);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var S=this.reader.lastIndexOfSignature(f.CENTRAL_DIRECTORY_END);if(S<0)throw this.isSignature(0,f.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(S);var m=S;if(this.checkSignature(f.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(S=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(S),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,f.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(f.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var _=m-d;if(0<_)this.isSignature(m,f.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(S){this.reader=A(S)},load:function(S){this.prepareReader(S),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Y.exports=T},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(N,Y,I){"use strict";var A=N("./reader/readerFor"),x=N("./utils"),f=N("./compressedObject"),p=N("./crc32"),b=N("./utf8"),T=N("./compressions"),S=N("./support");function m(d,_){this.options=d,this.loadOptions=_}m.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(d){var _,v;if(d.skip(22),this.fileNameLength=d.readInt(2),v=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(v),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(_=function(M){for(var w in T)if(Object.prototype.hasOwnProperty.call(T,w)&&T[w].magic===M)return T[w];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new f(this.compressedSize,this.uncompressedSize,this.crc32,_,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var _=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(_),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==d&&(this.dosPermissions=63&this.externalFileAttributes),3==d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=A(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var _,v,M,w=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<w;)_=d.readInt(2),v=d.readInt(2),M=d.readData(v),this.extraFields[_]={id:_,length:v,value:M};d.setIndex(w)},handleUTF8:function(){var d=S.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=b.utf8decode(this.fileName),this.fileCommentStr=b.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(null!==_)this.fileNameStr=_;else{var v=x.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var M=this.findExtraFieldUnicodeComment();if(null!==M)this.fileCommentStr=M;else{var w=x.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var _=A(d.value);return 1!==_.readInt(1)||p(this.fileName)!==_.readInt(4)?null:b.utf8decode(_.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var _=A(d.value);return 1!==_.readInt(1)||p(this.fileComment)!==_.readInt(4)?null:b.utf8decode(_.readData(d.length-5))}return null}},Y.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(N,Y,I){"use strict";function A(_,v,M){this.name=_,this.dir=M.dir,this.date=M.date,this.comment=M.comment,this.unixPermissions=M.unixPermissions,this.dosPermissions=M.dosPermissions,this._data=v,this._dataBinary=M.binary,this.options={compression:M.compression,compressionOptions:M.compressionOptions}}var x=N("./stream/StreamHelper"),f=N("./stream/DataWorker"),p=N("./utf8"),b=N("./compressedObject"),T=N("./stream/GenericWorker");A.prototype={internalStream:function(_){var v=null,M="string";try{if(!_)throw new Error("No output type specified.");var w="string"===(M=_.toLowerCase())||"text"===M;"binarystring"!==M&&"text"!==M||(M="string"),v=this._decompressWorker();var R=!this._dataBinary;R&&!w&&(v=v.pipe(new p.Utf8EncodeWorker)),!R&&w&&(v=v.pipe(new p.Utf8DecodeWorker))}catch(W){(v=new T("error")).error(W)}return new x(v,M,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof b&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var M=this._decompressWorker();return this._dataBinary||(M=M.pipe(new p.Utf8EncodeWorker)),b.createWorkerFrom(M,_,v)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof T?this._data:new f(this._data)}};for(var S=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<S.length;d++)A.prototype[S[d]]=m;Y.exports=A},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(N,Y,I){(function(A){"use strict";var x,f,p=A.MutationObserver||A.WebKitMutationObserver;if(p){var b=0,T=new p(_),S=A.document.createTextNode("");T.observe(S,{characterData:!0}),x=function(){S.data=b=++b%2}}else if(A.setImmediate||void 0===A.MessageChannel)x="document"in A&&"onreadystatechange"in A.document.createElement("script")?function(){var v=A.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},A.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var m=new A.MessageChannel;m.port1.onmessage=_,x=function(){m.port2.postMessage(0)}}var d=[];function _(){var v,M;f=!0;for(var w=d.length;w;){for(M=d,d=[],v=-1;++v<w;)M[v]();w=d.length}f=!1}Y.exports=function(v){1!==d.push(v)||f||x()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(N,Y,I){"use strict";var A=N("immediate");function x(){}var f={},p=["REJECTED"],b=["FULFILLED"],T=["PENDING"];function S(w){if("function"!=typeof w)throw new TypeError("resolver must be a function");this.state=T,this.queue=[],this.outcome=void 0,w!==x&&v(this,w)}function m(w,R,W){this.promise=w,"function"==typeof R&&(this.onFulfilled=R,this.callFulfilled=this.otherCallFulfilled),"function"==typeof W&&(this.onRejected=W,this.callRejected=this.otherCallRejected)}function d(w,R,W){A(function(){var ne;try{ne=R(W)}catch(B){return f.reject(w,B)}ne===w?f.reject(w,new TypeError("Cannot resolve promise with itself")):f.resolve(w,ne)})}function _(w){var R=w&&w.then;if(w&&("object"==typeof w||"function"==typeof w)&&"function"==typeof R)return function(){R.apply(w,arguments)}}function v(w,R){var W=!1;function ne(z){W||(W=!0,f.reject(w,z))}function B(z){W||(W=!0,f.resolve(w,z))}var V=M(function(){R(B,ne)});"error"===V.status&&ne(V.value)}function M(w,R){var W={};try{W.value=w(R),W.status="success"}catch(ne){W.status="error",W.value=ne}return W}(Y.exports=S).prototype.finally=function(w){if("function"!=typeof w)return this;var R=this.constructor;return this.then(function(W){return R.resolve(w()).then(function(){return W})},function(W){return R.resolve(w()).then(function(){throw W})})},S.prototype.catch=function(w){return this.then(null,w)},S.prototype.then=function(w,R){if("function"!=typeof w&&this.state===b||"function"!=typeof R&&this.state===p)return this;var W=new this.constructor(x);return this.state!==T?d(W,this.state===b?w:R,this.outcome):this.queue.push(new m(W,w,R)),W},m.prototype.callFulfilled=function(w){f.resolve(this.promise,w)},m.prototype.otherCallFulfilled=function(w){d(this.promise,this.onFulfilled,w)},m.prototype.callRejected=function(w){f.reject(this.promise,w)},m.prototype.otherCallRejected=function(w){d(this.promise,this.onRejected,w)},f.resolve=function(w,R){var W=M(_,R);if("error"===W.status)return f.reject(w,W.value);var ne=W.value;if(ne)v(w,ne);else{w.state=b,w.outcome=R;for(var B=-1,V=w.queue.length;++B<V;)w.queue[B].callFulfilled(R)}return w},f.reject=function(w,R){w.state=p,w.outcome=R;for(var W=-1,ne=w.queue.length;++W<ne;)w.queue[W].callRejected(R);return w},S.resolve=function(w){return w instanceof this?w:f.resolve(new this(x),w)},S.reject=function(w){var R=new this(x);return f.reject(R,w)},S.all=function(w){var R=this;if("[object Array]"!==Object.prototype.toString.call(w))return this.reject(new TypeError("must be an array"));var W=w.length,ne=!1;if(!W)return this.resolve([]);for(var B=new Array(W),V=0,z=-1,te=new this(x);++z<W;)ee(w[z],z);return te;function ee(q,Ce){R.resolve(q).then(function($){B[Ce]=$,++V!==W||ne||(ne=!0,f.resolve(te,B))},function($){ne||(ne=!0,f.reject(te,$))})}},S.race=function(w){if("[object Array]"!==Object.prototype.toString.call(w))return this.reject(new TypeError("must be an array"));var W=w.length,ne=!1;if(!W)return this.resolve([]);for(var B=-1,V=new this(x);++B<W;)this.resolve(w[B]).then(function(te){ne||(ne=!0,f.resolve(V,te))},function(te){ne||(ne=!0,f.reject(V,te))});return V}},{immediate:36}],38:[function(N,Y,I){"use strict";var A={};(0,N("./lib/utils/common").assign)(A,N("./lib/deflate"),N("./lib/inflate"),N("./lib/zlib/constants")),Y.exports=A},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(N,Y,I){"use strict";var A=N("./zlib/deflate"),x=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/messages"),b=N("./zlib/zstream"),T=Object.prototype.toString,S=0,m=-1,d=0,_=8;function v(w){if(!(this instanceof v))return new v(w);this.options=x.assign({level:m,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},w||{});var R=this.options;R.raw&&0<R.windowBits?R.windowBits=-R.windowBits:R.gzip&&0<R.windowBits&&R.windowBits<16&&(R.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new b,this.strm.avail_out=0;var W=A.deflateInit2(this.strm,R.level,R.method,R.windowBits,R.memLevel,R.strategy);if(W!==S)throw new Error(p[W]);if(R.header&&A.deflateSetHeader(this.strm,R.header),R.dictionary){var ne;if(ne="string"==typeof R.dictionary?f.string2buf(R.dictionary):"[object ArrayBuffer]"===T.call(R.dictionary)?new Uint8Array(R.dictionary):R.dictionary,(W=A.deflateSetDictionary(this.strm,ne))!==S)throw new Error(p[W]);this._dict_set=!0}}function M(w,R){var W=new v(R);if(W.push(w,!0),W.err)throw W.msg||p[W.err];return W.result}v.prototype.push=function(w,R){var W,ne,B=this.strm,V=this.options.chunkSize;if(this.ended)return!1;ne=R===~~R?R:!0===R?4:0,B.input="string"==typeof w?f.string2buf(w):"[object ArrayBuffer]"===T.call(w)?new Uint8Array(w):w,B.next_in=0,B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new x.Buf8(V),B.next_out=0,B.avail_out=V),1!==(W=A.deflate(B,ne))&&W!==S)return this.onEnd(W),!(this.ended=!0);0!==B.avail_out&&(0!==B.avail_in||4!==ne&&2!==ne)||this.onData("string"===this.options.to?f.buf2binstring(x.shrinkBuf(B.output,B.next_out)):x.shrinkBuf(B.output,B.next_out))}while((0<B.avail_in||0===B.avail_out)&&1!==W);return 4===ne?(W=A.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===S):2!==ne||(this.onEnd(S),!(B.avail_out=0))},v.prototype.onData=function(w){this.chunks.push(w)},v.prototype.onEnd=function(w){w===S&&(this.result="string"===this.options.to?this.chunks.join(""):x.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},I.Deflate=v,I.deflate=M,I.deflateRaw=function(w,R){return(R=R||{}).raw=!0,M(w,R)},I.gzip=function(w,R){return(R=R||{}).gzip=!0,M(w,R)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(N,Y,I){"use strict";var A=N("./zlib/inflate"),x=N("./utils/common"),f=N("./utils/strings"),p=N("./zlib/constants"),b=N("./zlib/messages"),T=N("./zlib/zstream"),S=N("./zlib/gzheader"),m=Object.prototype.toString;function d(v){if(!(this instanceof d))return new d(v);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},v||{});var M=this.options;M.raw&&0<=M.windowBits&&M.windowBits<16&&(M.windowBits=-M.windowBits,0===M.windowBits&&(M.windowBits=-15)),!(0<=M.windowBits&&M.windowBits<16)||v&&v.windowBits||(M.windowBits+=32),15<M.windowBits&&M.windowBits<48&&!(15&M.windowBits)&&(M.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new T,this.strm.avail_out=0;var w=A.inflateInit2(this.strm,M.windowBits);if(w!==p.Z_OK)throw new Error(b[w]);this.header=new S,A.inflateGetHeader(this.strm,this.header)}function _(v,M){var w=new d(M);if(w.push(v,!0),w.err)throw w.msg||b[w.err];return w.result}d.prototype.push=function(v,M){var w,R,W,ne,B,V,z=this.strm,te=this.options.chunkSize,ee=this.options.dictionary,q=!1;if(this.ended)return!1;R=M===~~M?M:!0===M?p.Z_FINISH:p.Z_NO_FLUSH,z.input="string"==typeof v?f.binstring2buf(v):"[object ArrayBuffer]"===m.call(v)?new Uint8Array(v):v,z.next_in=0,z.avail_in=z.input.length;do{if(0===z.avail_out&&(z.output=new x.Buf8(te),z.next_out=0,z.avail_out=te),(w=A.inflate(z,p.Z_NO_FLUSH))===p.Z_NEED_DICT&&ee&&(V="string"==typeof ee?f.string2buf(ee):"[object ArrayBuffer]"===m.call(ee)?new Uint8Array(ee):ee,w=A.inflateSetDictionary(this.strm,V)),w===p.Z_BUF_ERROR&&!0===q&&(w=p.Z_OK,q=!1),w!==p.Z_STREAM_END&&w!==p.Z_OK)return this.onEnd(w),!(this.ended=!0);z.next_out&&(0!==z.avail_out&&w!==p.Z_STREAM_END&&(0!==z.avail_in||R!==p.Z_FINISH&&R!==p.Z_SYNC_FLUSH)||("string"===this.options.to?(W=f.utf8border(z.output,z.next_out),ne=z.next_out-W,B=f.buf2string(z.output,W),z.next_out=ne,z.avail_out=te-ne,ne&&x.arraySet(z.output,z.output,W,ne,0),this.onData(B)):this.onData(x.shrinkBuf(z.output,z.next_out)))),0===z.avail_in&&0===z.avail_out&&(q=!0)}while((0<z.avail_in||0===z.avail_out)&&w!==p.Z_STREAM_END);return w===p.Z_STREAM_END&&(R=p.Z_FINISH),R===p.Z_FINISH?(w=A.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===p.Z_OK):R!==p.Z_SYNC_FLUSH||(this.onEnd(p.Z_OK),!(z.avail_out=0))},d.prototype.onData=function(v){this.chunks.push(v)},d.prototype.onEnd=function(v){v===p.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):x.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},I.Inflate=d,I.inflate=_,I.inflateRaw=function(v,M){return(M=M||{}).raw=!0,_(v,M)},I.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(N,Y,I){"use strict";var A=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";I.assign=function(p){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var T=b.shift();if(T){if("object"!=typeof T)throw new TypeError(T+"must be non-object");for(var S in T)T.hasOwnProperty(S)&&(p[S]=T[S])}}return p},I.shrinkBuf=function(p,b){return p.length===b?p:p.subarray?p.subarray(0,b):(p.length=b,p)};var x={arraySet:function(p,b,T,S,m){if(b.subarray&&p.subarray)p.set(b.subarray(T,T+S),m);else for(var d=0;d<S;d++)p[m+d]=b[T+d]},flattenChunks:function(p){var b,T,S,m,d,_;for(b=S=0,T=p.length;b<T;b++)S+=p[b].length;for(_=new Uint8Array(S),b=m=0,T=p.length;b<T;b++)_.set(d=p[b],m),m+=d.length;return _}},f={arraySet:function(p,b,T,S,m){for(var d=0;d<S;d++)p[m+d]=b[T+d]},flattenChunks:function(p){return[].concat.apply([],p)}};I.setTyped=function(p){p?(I.Buf8=Uint8Array,I.Buf16=Uint16Array,I.Buf32=Int32Array,I.assign(I,x)):(I.Buf8=Array,I.Buf16=Array,I.Buf32=Array,I.assign(I,f))},I.setTyped(A)},{}],42:[function(N,Y,I){"use strict";var A=N("./common"),x=!0,f=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{f=!1}for(var p=new A.Buf8(256),b=0;b<256;b++)p[b]=252<=b?6:248<=b?5:240<=b?4:224<=b?3:192<=b?2:1;function T(S,m){if(m<65537&&(S.subarray&&f||!S.subarray&&x))return String.fromCharCode.apply(null,A.shrinkBuf(S,m));for(var d="",_=0;_<m;_++)d+=String.fromCharCode(S[_]);return d}p[254]=p[254]=1,I.string2buf=function(S){var m,d,_,v,M,w=S.length,R=0;for(v=0;v<w;v++)55296==(64512&(d=S.charCodeAt(v)))&&v+1<w&&56320==(64512&(_=S.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),R+=d<128?1:d<2048?2:d<65536?3:4;for(m=new A.Buf8(R),v=M=0;M<R;v++)55296==(64512&(d=S.charCodeAt(v)))&&v+1<w&&56320==(64512&(_=S.charCodeAt(v+1)))&&(d=65536+(d-55296<<10)+(_-56320),v++),d<128?m[M++]=d:(d<2048?m[M++]=192|d>>>6:(d<65536?m[M++]=224|d>>>12:(m[M++]=240|d>>>18,m[M++]=128|d>>>12&63),m[M++]=128|d>>>6&63),m[M++]=128|63&d);return m},I.buf2binstring=function(S){return T(S,S.length)},I.binstring2buf=function(S){for(var m=new A.Buf8(S.length),d=0,_=m.length;d<_;d++)m[d]=S.charCodeAt(d);return m},I.buf2string=function(S,m){var d,_,v,M,w=m||S.length,R=new Array(2*w);for(d=_=0;d<w;)if((v=S[d++])<128)R[_++]=v;else if(4<(M=p[v]))R[_++]=65533,d+=M-1;else{for(v&=2===M?31:3===M?15:7;1<M&&d<w;)v=v<<6|63&S[d++],M--;1<M?R[_++]=65533:v<65536?R[_++]=v:(R[_++]=55296|(v-=65536)>>10&1023,R[_++]=56320|1023&v)}return T(R,_)},I.utf8border=function(S,m){var d;for((m=m||S.length)>S.length&&(m=S.length),d=m-1;0<=d&&128==(192&S[d]);)d--;return d<0||0===d?m:d+p[S[d]]>m?d:m}},{"./common":41}],43:[function(N,Y,I){"use strict";Y.exports=function(A,x,f,p){for(var b=65535&A|0,T=A>>>16&65535|0,S=0;0!==f;){for(f-=S=2e3<f?2e3:f;T=T+(b=b+x[p++]|0)|0,--S;);b%=65521,T%=65521}return b|T<<16|0}},{}],44:[function(N,Y,I){"use strict";Y.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(N,Y,I){"use strict";var A=function(){for(var x,f=[],p=0;p<256;p++){x=p;for(var b=0;b<8;b++)x=1&x?3988292384^x>>>1:x>>>1;f[p]=x}return f}();Y.exports=function(x,f,p,b){var T=A,S=b+p;x^=-1;for(var m=b;m<S;m++)x=x>>>8^T[255&(x^f[m])];return-1^x}},{}],46:[function(N,Y,I){"use strict";var A,x=N("../utils/common"),f=N("./trees"),p=N("./adler32"),b=N("./crc32"),T=N("./messages"),S=0,m=4,d=0,_=-2,v=-1,M=4,w=2,R=8,W=9,ne=286,B=30,V=19,z=2*ne+1,te=15,ee=3,q=258,Ce=q+ee+1,$=42,ae=113,C=1,pe=2,ze=3,le=4;function Ae(y,_e){return y.msg=T[_e],_e}function ve(y){return(y<<1)-(4<y?9:0)}function xe(y){for(var _e=y.length;0<=--_e;)y[_e]=0}function he(y){var _e=y.state,K=_e.pending;K>y.avail_out&&(K=y.avail_out),0!==K&&(x.arraySet(y.output,_e.pending_buf,_e.pending_out,K,y.next_out),y.next_out+=K,_e.pending_out+=K,y.total_out+=K,y.avail_out-=K,_e.pending-=K,0===_e.pending&&(_e.pending_out=0))}function me(y,_e){f._tr_flush_block(y,0<=y.block_start?y.block_start:-1,y.strstart-y.block_start,_e),y.block_start=y.strstart,he(y.strm)}function Je(y,_e){y.pending_buf[y.pending++]=_e}function Ge(y,_e){y.pending_buf[y.pending++]=_e>>>8&255,y.pending_buf[y.pending++]=255&_e}function Ue(y,_e){var K,G,U=y.max_chain_length,se=y.strstart,we=y.prev_length,Te=y.nice_match,de=y.strstart>y.w_size-Ce?y.strstart-(y.w_size-Ce):0,Ne=y.window,Ze=y.w_mask,Pe=y.prev,ct=y.strstart+q,en=Ne[se+we-1],Vt=Ne[se+we];y.prev_length>=y.good_match&&(U>>=2),Te>y.lookahead&&(Te=y.lookahead);do{if(Ne[(K=_e)+we]===Vt&&Ne[K+we-1]===en&&Ne[K]===Ne[se]&&Ne[++K]===Ne[se+1]){se+=2,K++;do{}while(Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&Ne[++se]===Ne[++K]&&se<ct);if(G=q-(ct-se),se=ct-q,we<G){if(y.match_start=_e,Te<=(we=G))break;en=Ne[se+we-1],Vt=Ne[se+we]}}}while((_e=Pe[_e&Ze])>de&&0!=--U);return we<=y.lookahead?we:y.lookahead}function qt(y){var _e,K,G,U,se,we,Te,de,Ne,Ze,Pe=y.w_size;do{if(U=y.window_size-y.lookahead-y.strstart,y.strstart>=Pe+(Pe-Ce)){for(x.arraySet(y.window,y.window,Pe,Pe,0),y.match_start-=Pe,y.strstart-=Pe,y.block_start-=Pe,_e=K=y.hash_size;G=y.head[--_e],y.head[_e]=Pe<=G?G-Pe:0,--K;);for(_e=K=Pe;G=y.prev[--_e],y.prev[_e]=Pe<=G?G-Pe:0,--K;);U+=Pe}if(0===y.strm.avail_in)break;if(Te=y.window,de=y.strstart+y.lookahead,Ze=void 0,(Ne=U)<(Ze=(we=y.strm).avail_in)&&(Ze=Ne),K=0===Ze?0:(we.avail_in-=Ze,x.arraySet(Te,we.input,we.next_in,Ze,de),1===we.state.wrap?we.adler=p(we.adler,Te,Ze,de):2===we.state.wrap&&(we.adler=b(we.adler,Te,Ze,de)),we.next_in+=Ze,we.total_in+=Ze,Ze),y.lookahead+=K,y.lookahead+y.insert>=ee)for(y.ins_h=y.window[se=y.strstart-y.insert],y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+1])&y.hash_mask;y.insert&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[se+ee-1])&y.hash_mask,y.prev[se&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=se,se++,y.insert--,!(y.lookahead+y.insert<ee)););}while(y.lookahead<Ce&&0!==y.strm.avail_in)}function Ve(y,_e){for(var K,G;;){if(y.lookahead<Ce){if(qt(y),y.lookahead<Ce&&_e===S)return C;if(0===y.lookahead)break}if(K=0,y.lookahead>=ee&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,K=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!==K&&y.strstart-K<=y.w_size-Ce&&(y.match_length=Ue(y,K)),y.match_length>=ee)if(G=f._tr_tally(y,y.strstart-y.match_start,y.match_length-ee),y.lookahead-=y.match_length,y.match_length<=y.max_lazy_match&&y.lookahead>=ee){for(y.match_length--;y.strstart++,y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,K=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart,0!=--y.match_length;);y.strstart++}else y.strstart+=y.match_length,y.match_length=0,y.ins_h=y.window[y.strstart],y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+1])&y.hash_mask;else G=f._tr_tally(y,0,y.window[y.strstart]),y.lookahead--,y.strstart++;if(G&&(me(y,!1),0===y.strm.avail_out))return C}return y.insert=y.strstart<ee-1?y.strstart:ee-1,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):y.last_lit&&(me(y,!1),0===y.strm.avail_out)?C:pe}function Ie(y,_e){for(var K,G,U;;){if(y.lookahead<Ce){if(qt(y),y.lookahead<Ce&&_e===S)return C;if(0===y.lookahead)break}if(K=0,y.lookahead>=ee&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,K=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),y.prev_length=y.match_length,y.prev_match=y.match_start,y.match_length=ee-1,0!==K&&y.prev_length<y.max_lazy_match&&y.strstart-K<=y.w_size-Ce&&(y.match_length=Ue(y,K),y.match_length<=5&&(1===y.strategy||y.match_length===ee&&4096<y.strstart-y.match_start)&&(y.match_length=ee-1)),y.prev_length>=ee&&y.match_length<=y.prev_length){for(U=y.strstart+y.lookahead-ee,G=f._tr_tally(y,y.strstart-1-y.prev_match,y.prev_length-ee),y.lookahead-=y.prev_length-1,y.prev_length-=2;++y.strstart<=U&&(y.ins_h=(y.ins_h<<y.hash_shift^y.window[y.strstart+ee-1])&y.hash_mask,K=y.prev[y.strstart&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=y.strstart),0!=--y.prev_length;);if(y.match_available=0,y.match_length=ee-1,y.strstart++,G&&(me(y,!1),0===y.strm.avail_out))return C}else if(y.match_available){if((G=f._tr_tally(y,0,y.window[y.strstart-1]))&&me(y,!1),y.strstart++,y.lookahead--,0===y.strm.avail_out)return C}else y.match_available=1,y.strstart++,y.lookahead--}return y.match_available&&(G=f._tr_tally(y,0,y.window[y.strstart-1]),y.match_available=0),y.insert=y.strstart<ee-1?y.strstart:ee-1,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):y.last_lit&&(me(y,!1),0===y.strm.avail_out)?C:pe}function Fe(y,_e,K,G,U){this.good_length=y,this.max_lazy=_e,this.nice_length=K,this.max_chain=G,this.func=U}function pt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(2*z),this.dyn_dtree=new x.Buf16(2*(2*B+1)),this.bl_tree=new x.Buf16(2*(2*V+1)),xe(this.dyn_ltree),xe(this.dyn_dtree),xe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(te+1),this.heap=new x.Buf16(2*ne+1),xe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(2*ne+1),xe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function nt(y){var _e;return y&&y.state?(y.total_in=y.total_out=0,y.data_type=w,(_e=y.state).pending=0,_e.pending_out=0,_e.wrap<0&&(_e.wrap=-_e.wrap),_e.status=_e.wrap?$:ae,y.adler=2===_e.wrap?0:1,_e.last_flush=S,f._tr_init(_e),d):Ae(y,_)}function Kt(y){var K,_e=nt(y);return _e===d&&((K=y.state).window_size=2*K.w_size,xe(K.head),K.max_lazy_match=A[K.level].max_lazy,K.good_match=A[K.level].good_length,K.nice_match=A[K.level].nice_length,K.max_chain_length=A[K.level].max_chain,K.strstart=0,K.block_start=0,K.lookahead=0,K.insert=0,K.match_length=K.prev_length=ee-1,K.match_available=0,K.ins_h=0),_e}function Ct(y,_e,K,G,U,se){if(!y)return _;var we=1;if(_e===v&&(_e=6),G<0?(we=0,G=-G):15<G&&(we=2,G-=16),U<1||W<U||K!==R||G<8||15<G||_e<0||9<_e||se<0||M<se)return Ae(y,_);8===G&&(G=9);var Te=new pt;return(y.state=Te).strm=y,Te.wrap=we,Te.gzhead=null,Te.w_bits=G,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=U+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+ee-1)/ee),Te.window=new x.Buf8(2*Te.w_size),Te.head=new x.Buf16(Te.hash_size),Te.prev=new x.Buf16(Te.w_size),Te.lit_bufsize=1<<U+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new x.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=_e,Te.strategy=se,Te.method=K,Kt(y)}A=[new Fe(0,0,0,0,function(y,_e){var K=65535;for(K>y.pending_buf_size-5&&(K=y.pending_buf_size-5);;){if(y.lookahead<=1){if(qt(y),0===y.lookahead&&_e===S)return C;if(0===y.lookahead)break}y.strstart+=y.lookahead,y.lookahead=0;var G=y.block_start+K;if((0===y.strstart||y.strstart>=G)&&(y.lookahead=y.strstart-G,y.strstart=G,me(y,!1),0===y.strm.avail_out)||y.strstart-y.block_start>=y.w_size-Ce&&(me(y,!1),0===y.strm.avail_out))return C}return y.insert=0,_e===m?(me(y,!0),0===y.strm.avail_out?ze:le):(y.strstart>y.block_start&&me(y,!1),C)}),new Fe(4,4,8,4,Ve),new Fe(4,5,16,8,Ve),new Fe(4,6,32,32,Ve),new Fe(4,4,16,16,Ie),new Fe(8,16,32,32,Ie),new Fe(8,16,128,128,Ie),new Fe(8,32,128,256,Ie),new Fe(32,128,258,1024,Ie),new Fe(32,258,258,4096,Ie)],I.deflateInit=function(y,_e){return Ct(y,_e,R,15,8,0)},I.deflateInit2=Ct,I.deflateReset=Kt,I.deflateResetKeep=nt,I.deflateSetHeader=function(y,_e){return y&&y.state?2!==y.state.wrap?_:(y.state.gzhead=_e,d):_},I.deflate=function(y,_e){var K,G,U,se;if(!y||!y.state||5<_e||_e<0)return y?Ae(y,_):_;if(G=y.state,!y.output||!y.input&&0!==y.avail_in||666===G.status&&_e!==m)return Ae(y,0===y.avail_out?-5:_);if(G.strm=y,K=G.last_flush,G.last_flush=_e,G.status===$)if(2===G.wrap)y.adler=0,Je(G,31),Je(G,139),Je(G,8),G.gzhead?(Je(G,(G.gzhead.text?1:0)+(G.gzhead.hcrc?2:0)+(G.gzhead.extra?4:0)+(G.gzhead.name?8:0)+(G.gzhead.comment?16:0)),Je(G,255&G.gzhead.time),Je(G,G.gzhead.time>>8&255),Je(G,G.gzhead.time>>16&255),Je(G,G.gzhead.time>>24&255),Je(G,9===G.level?2:2<=G.strategy||G.level<2?4:0),Je(G,255&G.gzhead.os),G.gzhead.extra&&G.gzhead.extra.length&&(Je(G,255&G.gzhead.extra.length),Je(G,G.gzhead.extra.length>>8&255)),G.gzhead.hcrc&&(y.adler=b(y.adler,G.pending_buf,G.pending,0)),G.gzindex=0,G.status=69):(Je(G,0),Je(G,0),Je(G,0),Je(G,0),Je(G,0),Je(G,9===G.level?2:2<=G.strategy||G.level<2?4:0),Je(G,3),G.status=ae);else{var we=R+(G.w_bits-8<<4)<<8;we|=(2<=G.strategy||G.level<2?0:G.level<6?1:6===G.level?2:3)<<6,0!==G.strstart&&(we|=32),we+=31-we%31,G.status=ae,Ge(G,we),0!==G.strstart&&(Ge(G,y.adler>>>16),Ge(G,65535&y.adler)),y.adler=1}if(69===G.status)if(G.gzhead.extra){for(U=G.pending;G.gzindex<(65535&G.gzhead.extra.length)&&(G.pending!==G.pending_buf_size||(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),he(y),U=G.pending,G.pending!==G.pending_buf_size));)Je(G,255&G.gzhead.extra[G.gzindex]),G.gzindex++;G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),G.gzindex===G.gzhead.extra.length&&(G.gzindex=0,G.status=73)}else G.status=73;if(73===G.status)if(G.gzhead.name){U=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),he(y),U=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.name.length?255&G.gzhead.name.charCodeAt(G.gzindex++):0,Je(G,se)}while(0!==se);G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),0===se&&(G.gzindex=0,G.status=91)}else G.status=91;if(91===G.status)if(G.gzhead.comment){U=G.pending;do{if(G.pending===G.pending_buf_size&&(G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),he(y),U=G.pending,G.pending===G.pending_buf_size)){se=1;break}se=G.gzindex<G.gzhead.comment.length?255&G.gzhead.comment.charCodeAt(G.gzindex++):0,Je(G,se)}while(0!==se);G.gzhead.hcrc&&G.pending>U&&(y.adler=b(y.adler,G.pending_buf,G.pending-U,U)),0===se&&(G.status=103)}else G.status=103;if(103===G.status&&(G.gzhead.hcrc?(G.pending+2>G.pending_buf_size&&he(y),G.pending+2<=G.pending_buf_size&&(Je(G,255&y.adler),Je(G,y.adler>>8&255),y.adler=0,G.status=ae)):G.status=ae),0!==G.pending){if(he(y),0===y.avail_out)return G.last_flush=-1,d}else if(0===y.avail_in&&ve(_e)<=ve(K)&&_e!==m)return Ae(y,-5);if(666===G.status&&0!==y.avail_in)return Ae(y,-5);if(0!==y.avail_in||0!==G.lookahead||_e!==S&&666!==G.status){var Te=2===G.strategy?function(de,Ne){for(var Ze;;){if(0===de.lookahead&&(qt(de),0===de.lookahead)){if(Ne===S)return C;break}if(de.match_length=0,Ze=f._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++,Ze&&(me(de,!1),0===de.strm.avail_out))return C}return de.insert=0,Ne===m?(me(de,!0),0===de.strm.avail_out?ze:le):de.last_lit&&(me(de,!1),0===de.strm.avail_out)?C:pe}(G,_e):3===G.strategy?function(de,Ne){for(var Ze,Pe,ct,en,Vt=de.window;;){if(de.lookahead<=q){if(qt(de),de.lookahead<=q&&Ne===S)return C;if(0===de.lookahead)break}if(de.match_length=0,de.lookahead>=ee&&0<de.strstart&&(Pe=Vt[ct=de.strstart-1])===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]){en=de.strstart+q;do{}while(Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&Pe===Vt[++ct]&&ct<en);de.match_length=q-(en-ct),de.match_length>de.lookahead&&(de.match_length=de.lookahead)}if(de.match_length>=ee?(Ze=f._tr_tally(de,1,de.match_length-ee),de.lookahead-=de.match_length,de.strstart+=de.match_length,de.match_length=0):(Ze=f._tr_tally(de,0,de.window[de.strstart]),de.lookahead--,de.strstart++),Ze&&(me(de,!1),0===de.strm.avail_out))return C}return de.insert=0,Ne===m?(me(de,!0),0===de.strm.avail_out?ze:le):de.last_lit&&(me(de,!1),0===de.strm.avail_out)?C:pe}(G,_e):A[G.level].func(G,_e);if(Te!==ze&&Te!==le||(G.status=666),Te===C||Te===ze)return 0===y.avail_out&&(G.last_flush=-1),d;if(Te===pe&&(1===_e?f._tr_align(G):5!==_e&&(f._tr_stored_block(G,0,0,!1),3===_e&&(xe(G.head),0===G.lookahead&&(G.strstart=0,G.block_start=0,G.insert=0))),he(y),0===y.avail_out))return G.last_flush=-1,d}return _e!==m?d:G.wrap<=0?1:(2===G.wrap?(Je(G,255&y.adler),Je(G,y.adler>>8&255),Je(G,y.adler>>16&255),Je(G,y.adler>>24&255),Je(G,255&y.total_in),Je(G,y.total_in>>8&255),Je(G,y.total_in>>16&255),Je(G,y.total_in>>24&255)):(Ge(G,y.adler>>>16),Ge(G,65535&y.adler)),he(y),0<G.wrap&&(G.wrap=-G.wrap),0!==G.pending?d:1)},I.deflateEnd=function(y){var _e;return y&&y.state?(_e=y.state.status)!==$&&69!==_e&&73!==_e&&91!==_e&&103!==_e&&_e!==ae&&666!==_e?Ae(y,_):(y.state=null,_e===ae?Ae(y,-3):d):_},I.deflateSetDictionary=function(y,_e){var K,G,U,se,we,Te,de,Ne,Ze=_e.length;if(!y||!y.state||2===(se=(K=y.state).wrap)||1===se&&K.status!==$||K.lookahead)return _;for(1===se&&(y.adler=p(y.adler,_e,Ze,0)),K.wrap=0,Ze>=K.w_size&&(0===se&&(xe(K.head),K.strstart=0,K.block_start=0,K.insert=0),Ne=new x.Buf8(K.w_size),x.arraySet(Ne,_e,Ze-K.w_size,K.w_size,0),_e=Ne,Ze=K.w_size),we=y.avail_in,Te=y.next_in,de=y.input,y.avail_in=Ze,y.next_in=0,y.input=_e,qt(K);K.lookahead>=ee;){for(G=K.strstart,U=K.lookahead-(ee-1);K.ins_h=(K.ins_h<<K.hash_shift^K.window[G+ee-1])&K.hash_mask,K.prev[G&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=G,G++,--U;);K.strstart=G,K.lookahead=ee-1,qt(K)}return K.strstart+=K.lookahead,K.block_start=K.strstart,K.insert=K.lookahead,K.lookahead=0,K.match_length=K.prev_length=ee-1,K.match_available=0,y.next_in=Te,y.input=de,y.avail_in=we,K.wrap=se,d},I.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(N,Y,I){"use strict";Y.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(N,Y,I){"use strict";Y.exports=function(A,x){var f,p,b,T,S,m,d,_,v,M,w,R,W,ne,B,V,z,te,ee,q,Ce,$,ae,C,pe;C=A.input,b=(p=A.next_in)+(A.avail_in-5),pe=A.output,S=(T=A.next_out)-(x-A.avail_out),m=T+(A.avail_out-257),d=(f=A.state).dmax,_=f.wsize,v=f.whave,M=f.wnext,w=f.window,R=f.hold,W=f.bits,ne=f.lencode,B=f.distcode,V=(1<<f.lenbits)-1,z=(1<<f.distbits)-1;e:do{W<15&&(R+=C[p++]<<W,R+=C[p++]<<(W+=8),W+=8),te=ne[R&V];t:for(;;){if(R>>>=ee=te>>>24,W-=ee,0==(ee=te>>>16&255))pe[T++]=65535&te;else{if(!(16&ee)){if(!(64&ee)){te=ne[(65535&te)+(R&(1<<ee)-1)];continue t}if(32&ee){f.mode=12;break e}A.msg="invalid literal/length code",f.mode=30;break e}q=65535&te,(ee&=15)&&(W<ee&&(R+=C[p++]<<W,W+=8),q+=R&(1<<ee)-1,R>>>=ee,W-=ee),W<15&&(R+=C[p++]<<W,R+=C[p++]<<(W+=8),W+=8),te=B[R&z];n:for(;;){if(R>>>=ee=te>>>24,W-=ee,!(16&(ee=te>>>16&255))){if(!(64&ee)){te=B[(65535&te)+(R&(1<<ee)-1)];continue n}A.msg="invalid distance code",f.mode=30;break e}if(Ce=65535&te,W<(ee&=15)&&(R+=C[p++]<<W,(W+=8)<ee&&(R+=C[p++]<<W,W+=8)),d<(Ce+=R&(1<<ee)-1)){A.msg="invalid distance too far back",f.mode=30;break e}if(R>>>=ee,W-=ee,(ee=T-S)<Ce){if(v<(ee=Ce-ee)&&f.sane){A.msg="invalid distance too far back",f.mode=30;break e}if(ae=w,($=0)===M){if($+=_-ee,ee<q){for(q-=ee;pe[T++]=w[$++],--ee;);$=T-Ce,ae=pe}}else if(M<ee){if($+=_+M-ee,(ee-=M)<q){for(q-=ee;pe[T++]=w[$++],--ee;);if($=0,M<q){for(q-=ee=M;pe[T++]=w[$++],--ee;);$=T-Ce,ae=pe}}}else if($+=M-ee,ee<q){for(q-=ee;pe[T++]=w[$++],--ee;);$=T-Ce,ae=pe}for(;2<q;)pe[T++]=ae[$++],pe[T++]=ae[$++],pe[T++]=ae[$++],q-=3;q&&(pe[T++]=ae[$++],1<q&&(pe[T++]=ae[$++]))}else{for($=T-Ce;pe[T++]=pe[$++],pe[T++]=pe[$++],pe[T++]=pe[$++],2<(q-=3););q&&(pe[T++]=pe[$++],1<q&&(pe[T++]=pe[$++]))}break}}break}}while(p<b&&T<m);p-=q=W>>3,R&=(1<<(W-=q<<3))-1,A.next_in=p,A.next_out=T,A.avail_in=p<b?b-p+5:5-(p-b),A.avail_out=T<m?m-T+257:257-(T-m),f.hold=R,f.bits=W}},{}],49:[function(N,Y,I){"use strict";var A=N("../utils/common"),x=N("./adler32"),f=N("./crc32"),p=N("./inffast"),b=N("./inftrees"),T=1,S=2,m=0,d=-2,_=1,v=852,M=592;function w($){return($>>>24&255)+($>>>8&65280)+((65280&$)<<8)+((255&$)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new A.Buf16(320),this.work=new A.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function W($){var ae;return $&&$.state?($.total_in=$.total_out=(ae=$.state).total=0,$.msg="",ae.wrap&&($.adler=1&ae.wrap),ae.mode=_,ae.last=0,ae.havedict=0,ae.dmax=32768,ae.head=null,ae.hold=0,ae.bits=0,ae.lencode=ae.lendyn=new A.Buf32(v),ae.distcode=ae.distdyn=new A.Buf32(M),ae.sane=1,ae.back=-1,m):d}function ne($){var ae;return $&&$.state?((ae=$.state).wsize=0,ae.whave=0,ae.wnext=0,W($)):d}function B($,ae){var C,pe;return $&&$.state?(pe=$.state,ae<0?(C=0,ae=-ae):(C=1+(ae>>4),ae<48&&(ae&=15)),ae&&(ae<8||15<ae)?d:(null!==pe.window&&pe.wbits!==ae&&(pe.window=null),pe.wrap=C,pe.wbits=ae,ne($))):d}function V($,ae){var C,pe;return $?(pe=new R,($.state=pe).window=null,(C=B($,ae))!==m&&($.state=null),C):d}var z,te,ee=!0;function q($){if(ee){var ae;for(z=new A.Buf32(512),te=new A.Buf32(32),ae=0;ae<144;)$.lens[ae++]=8;for(;ae<256;)$.lens[ae++]=9;for(;ae<280;)$.lens[ae++]=7;for(;ae<288;)$.lens[ae++]=8;for(b(T,$.lens,0,288,z,0,$.work,{bits:9}),ae=0;ae<32;)$.lens[ae++]=5;b(S,$.lens,0,32,te,0,$.work,{bits:5}),ee=!1}$.lencode=z,$.lenbits=9,$.distcode=te,$.distbits=5}function Ce($,ae,C,pe){var ze,le=$.state;return null===le.window&&(le.wsize=1<<le.wbits,le.wnext=0,le.whave=0,le.window=new A.Buf8(le.wsize)),pe>=le.wsize?(A.arraySet(le.window,ae,C-le.wsize,le.wsize,0),le.wnext=0,le.whave=le.wsize):(pe<(ze=le.wsize-le.wnext)&&(ze=pe),A.arraySet(le.window,ae,C-pe,ze,le.wnext),(pe-=ze)?(A.arraySet(le.window,ae,C-pe,pe,0),le.wnext=pe,le.whave=le.wsize):(le.wnext+=ze,le.wnext===le.wsize&&(le.wnext=0),le.whave<le.wsize&&(le.whave+=ze))),0}I.inflateReset=ne,I.inflateReset2=B,I.inflateResetKeep=W,I.inflateInit=function($){return V($,15)},I.inflateInit2=V,I.inflate=function($,ae){var C,pe,ze,le,Ae,ve,xe,he,me,Je,Ge,Ue,qt,Ve,Ie,Fe,pt,nt,Kt,Ct,y,_e,K,G,U=0,se=new A.Buf8(4),we=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!$||!$.state||!$.output||!$.input&&0!==$.avail_in)return d;12===(C=$.state).mode&&(C.mode=13),Ae=$.next_out,ze=$.output,le=$.next_in,pe=$.input,he=C.hold,me=C.bits,Je=ve=$.avail_in,Ge=xe=$.avail_out,_e=m;e:for(;;)switch(C.mode){case _:if(0===C.wrap){C.mode=13;break}for(;me<16;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(2&C.wrap&&35615===he){se[C.check=0]=255&he,se[1]=he>>>8&255,C.check=f(C.check,se,2,0),me=he=0,C.mode=2;break}if(C.flags=0,C.head&&(C.head.done=!1),!(1&C.wrap)||(((255&he)<<8)+(he>>8))%31){$.msg="incorrect header check",C.mode=30;break}if(8!=(15&he)){$.msg="unknown compression method",C.mode=30;break}if(me-=4,y=8+(15&(he>>>=4)),0===C.wbits)C.wbits=y;else if(y>C.wbits){$.msg="invalid window size",C.mode=30;break}C.dmax=1<<y,$.adler=C.check=1,C.mode=512&he?10:12,me=he=0;break;case 2:for(;me<16;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(C.flags=he,8!=(255&C.flags)){$.msg="unknown compression method",C.mode=30;break}if(57344&C.flags){$.msg="unknown header flags set",C.mode=30;break}C.head&&(C.head.text=he>>8&1),512&C.flags&&(se[0]=255&he,se[1]=he>>>8&255,C.check=f(C.check,se,2,0)),me=he=0,C.mode=3;case 3:for(;me<32;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.head&&(C.head.time=he),512&C.flags&&(se[0]=255&he,se[1]=he>>>8&255,se[2]=he>>>16&255,se[3]=he>>>24&255,C.check=f(C.check,se,4,0)),me=he=0,C.mode=4;case 4:for(;me<16;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.head&&(C.head.xflags=255&he,C.head.os=he>>8),512&C.flags&&(se[0]=255&he,se[1]=he>>>8&255,C.check=f(C.check,se,2,0)),me=he=0,C.mode=5;case 5:if(1024&C.flags){for(;me<16;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.length=he,C.head&&(C.head.extra_len=he),512&C.flags&&(se[0]=255&he,se[1]=he>>>8&255,C.check=f(C.check,se,2,0)),me=he=0}else C.head&&(C.head.extra=null);C.mode=6;case 6:if(1024&C.flags&&(ve<(Ue=C.length)&&(Ue=ve),Ue&&(C.head&&(y=C.head.extra_len-C.length,C.head.extra||(C.head.extra=new Array(C.head.extra_len)),A.arraySet(C.head.extra,pe,le,Ue,y)),512&C.flags&&(C.check=f(C.check,pe,Ue,le)),ve-=Ue,le+=Ue,C.length-=Ue),C.length))break e;C.length=0,C.mode=7;case 7:if(2048&C.flags){if(0===ve)break e;for(Ue=0;y=pe[le+Ue++],C.head&&y&&C.length<65536&&(C.head.name+=String.fromCharCode(y)),y&&Ue<ve;);if(512&C.flags&&(C.check=f(C.check,pe,Ue,le)),ve-=Ue,le+=Ue,y)break e}else C.head&&(C.head.name=null);C.length=0,C.mode=8;case 8:if(4096&C.flags){if(0===ve)break e;for(Ue=0;y=pe[le+Ue++],C.head&&y&&C.length<65536&&(C.head.comment+=String.fromCharCode(y)),y&&Ue<ve;);if(512&C.flags&&(C.check=f(C.check,pe,Ue,le)),ve-=Ue,le+=Ue,y)break e}else C.head&&(C.head.comment=null);C.mode=9;case 9:if(512&C.flags){for(;me<16;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(he!==(65535&C.check)){$.msg="header crc mismatch",C.mode=30;break}me=he=0}C.head&&(C.head.hcrc=C.flags>>9&1,C.head.done=!0),$.adler=C.check=0,C.mode=12;break;case 10:for(;me<32;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}$.adler=C.check=w(he),me=he=0,C.mode=11;case 11:if(0===C.havedict)return $.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=he,C.bits=me,2;$.adler=C.check=1,C.mode=12;case 12:if(5===ae||6===ae)break e;case 13:if(C.last){he>>>=7&me,me-=7&me,C.mode=27;break}for(;me<3;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}switch(C.last=1&he,me-=1,3&(he>>>=1)){case 0:C.mode=14;break;case 1:if(q(C),C.mode=20,6!==ae)break;he>>>=2,me-=2;break e;case 2:C.mode=17;break;case 3:$.msg="invalid block type",C.mode=30}he>>>=2,me-=2;break;case 14:for(he>>>=7&me,me-=7&me;me<32;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if((65535&he)!=(he>>>16^65535)){$.msg="invalid stored block lengths",C.mode=30;break}if(C.length=65535&he,me=he=0,C.mode=15,6===ae)break e;case 15:C.mode=16;case 16:if(Ue=C.length){if(ve<Ue&&(Ue=ve),xe<Ue&&(Ue=xe),0===Ue)break e;A.arraySet(ze,pe,le,Ue,Ae),ve-=Ue,le+=Ue,xe-=Ue,Ae+=Ue,C.length-=Ue;break}C.mode=12;break;case 17:for(;me<14;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(C.nlen=257+(31&he),me-=5,C.ndist=1+(31&(he>>>=5)),me-=5,C.ncode=4+(15&(he>>>=5)),he>>>=4,me-=4,286<C.nlen||30<C.ndist){$.msg="too many length or distance symbols",C.mode=30;break}C.have=0,C.mode=18;case 18:for(;C.have<C.ncode;){for(;me<3;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.lens[we[C.have++]]=7&he,he>>>=3,me-=3}for(;C.have<19;)C.lens[we[C.have++]]=0;if(C.lencode=C.lendyn,C.lenbits=7,_e=b(0,C.lens,0,19,C.lencode,0,C.work,K={bits:C.lenbits}),C.lenbits=K.bits,_e){$.msg="invalid code lengths set",C.mode=30;break}C.have=0,C.mode=19;case 19:for(;C.have<C.nlen+C.ndist;){for(;Fe=(U=C.lencode[he&(1<<C.lenbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(pt<16)he>>>=Ie,me-=Ie,C.lens[C.have++]=pt;else{if(16===pt){for(G=Ie+2;me<G;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(he>>>=Ie,me-=Ie,0===C.have){$.msg="invalid bit length repeat",C.mode=30;break}y=C.lens[C.have-1],Ue=3+(3&he),he>>>=2,me-=2}else if(17===pt){for(G=Ie+3;me<G;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}me-=Ie,y=0,Ue=3+(7&(he>>>=Ie)),he>>>=3,me-=3}else{for(G=Ie+7;me<G;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}me-=Ie,y=0,Ue=11+(127&(he>>>=Ie)),he>>>=7,me-=7}if(C.have+Ue>C.nlen+C.ndist){$.msg="invalid bit length repeat",C.mode=30;break}for(;Ue--;)C.lens[C.have++]=y}}if(30===C.mode)break;if(0===C.lens[256]){$.msg="invalid code -- missing end-of-block",C.mode=30;break}if(C.lenbits=9,_e=b(T,C.lens,0,C.nlen,C.lencode,0,C.work,K={bits:C.lenbits}),C.lenbits=K.bits,_e){$.msg="invalid literal/lengths set",C.mode=30;break}if(C.distbits=6,C.distcode=C.distdyn,_e=b(S,C.lens,C.nlen,C.ndist,C.distcode,0,C.work,K={bits:C.distbits}),C.distbits=K.bits,_e){$.msg="invalid distances set",C.mode=30;break}if(C.mode=20,6===ae)break e;case 20:C.mode=21;case 21:if(6<=ve&&258<=xe){$.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=he,C.bits=me,p($,Ge),Ae=$.next_out,ze=$.output,xe=$.avail_out,le=$.next_in,pe=$.input,ve=$.avail_in,he=C.hold,me=C.bits,12===C.mode&&(C.back=-1);break}for(C.back=0;Fe=(U=C.lencode[he&(1<<C.lenbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(Fe&&!(240&Fe)){for(nt=Ie,Kt=Fe,Ct=pt;Fe=(U=C.lencode[Ct+((he&(1<<nt+Kt)-1)>>nt)])>>>16&255,pt=65535&U,!(nt+(Ie=U>>>24)<=me);){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}he>>>=nt,me-=nt,C.back+=nt}if(he>>>=Ie,me-=Ie,C.back+=Ie,C.length=pt,0===Fe){C.mode=26;break}if(32&Fe){C.back=-1,C.mode=12;break}if(64&Fe){$.msg="invalid literal/length code",C.mode=30;break}C.extra=15&Fe,C.mode=22;case 22:if(C.extra){for(G=C.extra;me<G;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.length+=he&(1<<C.extra)-1,he>>>=C.extra,me-=C.extra,C.back+=C.extra}C.was=C.length,C.mode=23;case 23:for(;Fe=(U=C.distcode[he&(1<<C.distbits)-1])>>>16&255,pt=65535&U,!((Ie=U>>>24)<=me);){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(!(240&Fe)){for(nt=Ie,Kt=Fe,Ct=pt;Fe=(U=C.distcode[Ct+((he&(1<<nt+Kt)-1)>>nt)])>>>16&255,pt=65535&U,!(nt+(Ie=U>>>24)<=me);){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}he>>>=nt,me-=nt,C.back+=nt}if(he>>>=Ie,me-=Ie,C.back+=Ie,64&Fe){$.msg="invalid distance code",C.mode=30;break}C.offset=pt,C.extra=15&Fe,C.mode=24;case 24:if(C.extra){for(G=C.extra;me<G;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}C.offset+=he&(1<<C.extra)-1,he>>>=C.extra,me-=C.extra,C.back+=C.extra}if(C.offset>C.dmax){$.msg="invalid distance too far back",C.mode=30;break}C.mode=25;case 25:if(0===xe)break e;if(C.offset>(Ue=Ge-xe)){if((Ue=C.offset-Ue)>C.whave&&C.sane){$.msg="invalid distance too far back",C.mode=30;break}qt=Ue>C.wnext?C.wsize-(Ue-=C.wnext):C.wnext-Ue,Ue>C.length&&(Ue=C.length),Ve=C.window}else Ve=ze,qt=Ae-C.offset,Ue=C.length;for(xe<Ue&&(Ue=xe),xe-=Ue,C.length-=Ue;ze[Ae++]=Ve[qt++],--Ue;);0===C.length&&(C.mode=21);break;case 26:if(0===xe)break e;ze[Ae++]=C.length,xe--,C.mode=21;break;case 27:if(C.wrap){for(;me<32;){if(0===ve)break e;ve--,he|=pe[le++]<<me,me+=8}if($.total_out+=Ge-=xe,C.total+=Ge,Ge&&($.adler=C.check=C.flags?f(C.check,ze,Ge,Ae-Ge):x(C.check,ze,Ge,Ae-Ge)),Ge=xe,(C.flags?he:w(he))!==C.check){$.msg="incorrect data check",C.mode=30;break}me=he=0}C.mode=28;case 28:if(C.wrap&&C.flags){for(;me<32;){if(0===ve)break e;ve--,he+=pe[le++]<<me,me+=8}if(he!==(4294967295&C.total)){$.msg="incorrect length check",C.mode=30;break}me=he=0}C.mode=29;case 29:_e=1;break e;case 30:_e=-3;break e;case 31:return-4;default:return d}return $.next_out=Ae,$.avail_out=xe,$.next_in=le,$.avail_in=ve,C.hold=he,C.bits=me,(C.wsize||Ge!==$.avail_out&&C.mode<30&&(C.mode<27||4!==ae))&&Ce($,$.output,$.next_out,Ge-$.avail_out)?(C.mode=31,-4):(Ge-=$.avail_out,$.total_in+=Je-=$.avail_in,$.total_out+=Ge,C.total+=Ge,C.wrap&&Ge&&($.adler=C.check=C.flags?f(C.check,ze,Ge,$.next_out-Ge):x(C.check,ze,Ge,$.next_out-Ge)),$.data_type=C.bits+(C.last?64:0)+(12===C.mode?128:0)+(20===C.mode||15===C.mode?256:0),(0==Je&&0===Ge||4===ae)&&_e===m&&(_e=-5),_e)},I.inflateEnd=function($){if(!$||!$.state)return d;var ae=$.state;return ae.window&&(ae.window=null),$.state=null,m},I.inflateGetHeader=function($,ae){var C;return $&&$.state&&2&(C=$.state).wrap?((C.head=ae).done=!1,m):d},I.inflateSetDictionary=function($,ae){var C,pe=ae.length;return $&&$.state?0!==(C=$.state).wrap&&11!==C.mode?d:11===C.mode&&x(1,ae,pe,0)!==C.check?-3:Ce($,ae,pe,pe)?(C.mode=31,-4):(C.havedict=1,m):d},I.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(N,Y,I){"use strict";var A=N("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],p=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],b=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Y.exports=function(T,S,m,d,_,v,M,w){var R,W,ne,B,V,z,te,ee,q,Ce=w.bits,$=0,ae=0,C=0,pe=0,ze=0,le=0,Ae=0,ve=0,xe=0,he=0,me=null,Je=0,Ge=new A.Buf16(16),Ue=new A.Buf16(16),qt=null,Ve=0;for($=0;$<=15;$++)Ge[$]=0;for(ae=0;ae<d;ae++)Ge[S[m+ae]]++;for(ze=Ce,pe=15;1<=pe&&0===Ge[pe];pe--);if(pe<ze&&(ze=pe),0===pe)return _[v++]=20971520,_[v++]=20971520,w.bits=1,0;for(C=1;C<pe&&0===Ge[C];C++);for(ze<C&&(ze=C),$=ve=1;$<=15;$++)if(ve<<=1,(ve-=Ge[$])<0)return-1;if(0<ve&&(0===T||1!==pe))return-1;for(Ue[1]=0,$=1;$<15;$++)Ue[$+1]=Ue[$]+Ge[$];for(ae=0;ae<d;ae++)0!==S[m+ae]&&(M[Ue[S[m+ae]]++]=ae);if(z=0===T?(me=qt=M,19):1===T?(me=x,Je-=257,qt=f,Ve-=257,256):(me=p,qt=b,-1),$=C,V=v,Ae=ae=he=0,ne=-1,B=(xe=1<<(le=ze))-1,1===T&&852<xe||2===T&&592<xe)return 1;for(;;){for(te=$-Ae,q=M[ae]<z?(ee=0,M[ae]):M[ae]>z?(ee=qt[Ve+M[ae]],me[Je+M[ae]]):(ee=96,0),R=1<<$-Ae,C=W=1<<le;_[V+(he>>Ae)+(W-=R)]=te<<24|ee<<16|q|0,0!==W;);for(R=1<<$-1;he&R;)R>>=1;if(0!==R?(he&=R-1,he+=R):he=0,ae++,0==--Ge[$]){if($===pe)break;$=S[m+M[ae]]}if(ze<$&&(he&B)!==ne){for(0===Ae&&(Ae=ze),V+=C,ve=1<<(le=$-Ae);le+Ae<pe&&!((ve-=Ge[le+Ae])<=0);)le++,ve<<=1;if(xe+=1<<le,1===T&&852<xe||2===T&&592<xe)return 1;_[ne=he&B]=ze<<24|le<<16|V-v|0}}return 0!==he&&(_[V+he]=$-Ae<<24|64<<16|0),w.bits=ze,0}},{"../utils/common":41}],51:[function(N,Y,I){"use strict";Y.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(N,Y,I){"use strict";var A=N("../utils/common");function p(U){for(var se=U.length;0<=--se;)U[se]=0}var b=0,S=256,m=S+1+29,d=30,_=19,v=2*m+1,M=15,w=16,W=256,ne=16,B=17,V=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ce=new Array(2*(m+2));p(Ce);var $=new Array(2*d);p($);var ae=new Array(512);p(ae);var C=new Array(256);p(C);var pe=new Array(29);p(pe);var ze,le,Ae,ve=new Array(d);function xe(U,se,we,Te,de){this.static_tree=U,this.extra_bits=se,this.extra_base=we,this.elems=Te,this.max_length=de,this.has_stree=U&&U.length}function he(U,se){this.dyn_tree=U,this.max_code=0,this.stat_desc=se}function me(U){return U<256?ae[U]:ae[256+(U>>>7)]}function Je(U,se){U.pending_buf[U.pending++]=255&se,U.pending_buf[U.pending++]=se>>>8&255}function Ge(U,se,we){U.bi_valid>w-we?(U.bi_buf|=se<<U.bi_valid&65535,Je(U,U.bi_buf),U.bi_buf=se>>w-U.bi_valid,U.bi_valid+=we-w):(U.bi_buf|=se<<U.bi_valid&65535,U.bi_valid+=we)}function Ue(U,se,we){Ge(U,we[2*se],we[2*se+1])}function qt(U,se){for(var we=0;we|=1&U,U>>>=1,we<<=1,0<--se;);return we>>>1}function Ve(U,se,we){var Te,de,Ne=new Array(M+1),Ze=0;for(Te=1;Te<=M;Te++)Ne[Te]=Ze=Ze+we[Te-1]<<1;for(de=0;de<=se;de++){var Pe=U[2*de+1];0!==Pe&&(U[2*de]=qt(Ne[Pe]++,Pe))}}function Ie(U){var se;for(se=0;se<m;se++)U.dyn_ltree[2*se]=0;for(se=0;se<d;se++)U.dyn_dtree[2*se]=0;for(se=0;se<_;se++)U.bl_tree[2*se]=0;U.dyn_ltree[2*W]=1,U.opt_len=U.static_len=0,U.last_lit=U.matches=0}function Fe(U){8<U.bi_valid?Je(U,U.bi_buf):0<U.bi_valid&&(U.pending_buf[U.pending++]=U.bi_buf),U.bi_buf=0,U.bi_valid=0}function pt(U,se,we,Te){var de=2*se,Ne=2*we;return U[de]<U[Ne]||U[de]===U[Ne]&&Te[se]<=Te[we]}function nt(U,se,we){for(var Te=U.heap[we],de=we<<1;de<=U.heap_len&&(de<U.heap_len&&pt(se,U.heap[de+1],U.heap[de],U.depth)&&de++,!pt(se,Te,U.heap[de],U.depth));)U.heap[we]=U.heap[de],we=de,de<<=1;U.heap[we]=Te}function Kt(U,se,we){var Te,de,Ne,Ze,Pe=0;if(0!==U.last_lit)for(;Te=U.pending_buf[U.d_buf+2*Pe]<<8|U.pending_buf[U.d_buf+2*Pe+1],de=U.pending_buf[U.l_buf+Pe],Pe++,0===Te?Ue(U,de,se):(Ue(U,(Ne=C[de])+S+1,se),0!==(Ze=z[Ne])&&Ge(U,de-=pe[Ne],Ze),Ue(U,Ne=me(--Te),we),0!==(Ze=te[Ne])&&Ge(U,Te-=ve[Ne],Ze)),Pe<U.last_lit;);Ue(U,W,se)}function Ct(U,se){var we,Te,de,Ne=se.dyn_tree,Ze=se.stat_desc.static_tree,Pe=se.stat_desc.has_stree,ct=se.stat_desc.elems,en=-1;for(U.heap_len=0,U.heap_max=v,we=0;we<ct;we++)0!==Ne[2*we]?(U.heap[++U.heap_len]=en=we,U.depth[we]=0):Ne[2*we+1]=0;for(;U.heap_len<2;)Ne[2*(de=U.heap[++U.heap_len]=en<2?++en:0)]=1,U.depth[de]=0,U.opt_len--,Pe&&(U.static_len-=Ze[2*de+1]);for(se.max_code=en,we=U.heap_len>>1;1<=we;we--)nt(U,Ne,we);for(de=ct;we=U.heap[1],U.heap[1]=U.heap[U.heap_len--],nt(U,Ne,1),Te=U.heap[1],U.heap[--U.heap_max]=we,U.heap[--U.heap_max]=Te,Ne[2*de]=Ne[2*we]+Ne[2*Te],U.depth[de]=(U.depth[we]>=U.depth[Te]?U.depth[we]:U.depth[Te])+1,Ne[2*we+1]=Ne[2*Te+1]=de,U.heap[1]=de++,nt(U,Ne,1),2<=U.heap_len;);U.heap[--U.heap_max]=U.heap[1],function(Vt,Ui){var Ds,Ji,Ti,mn,Ms,yo,er=Ui.dyn_tree,Ja=Ui.max_code,_d=Ui.stat_desc.static_tree,vd=Ui.stat_desc.has_stree,yd=Ui.stat_desc.extra_bits,wc=Ui.stat_desc.extra_base,Jr=Ui.stat_desc.max_length,Qo=0;for(mn=0;mn<=M;mn++)Vt.bl_count[mn]=0;for(er[2*Vt.heap[Vt.heap_max]+1]=0,Ds=Vt.heap_max+1;Ds<v;Ds++)Jr<(mn=er[2*er[2*(Ji=Vt.heap[Ds])+1]+1]+1)&&(mn=Jr,Qo++),er[2*Ji+1]=mn,Ja<Ji||(Vt.bl_count[mn]++,Ms=0,wc<=Ji&&(Ms=yd[Ji-wc]),Vt.opt_len+=(yo=er[2*Ji])*(mn+Ms),vd&&(Vt.static_len+=yo*(_d[2*Ji+1]+Ms)));if(0!==Qo){do{for(mn=Jr-1;0===Vt.bl_count[mn];)mn--;Vt.bl_count[mn]--,Vt.bl_count[mn+1]+=2,Vt.bl_count[Jr]--,Qo-=2}while(0<Qo);for(mn=Jr;0!==mn;mn--)for(Ji=Vt.bl_count[mn];0!==Ji;)Ja<(Ti=Vt.heap[--Ds])||(er[2*Ti+1]!==mn&&(Vt.opt_len+=(mn-er[2*Ti+1])*er[2*Ti],er[2*Ti+1]=mn),Ji--)}}(U,se),Ve(Ne,en,U.bl_count)}function y(U,se,we){var Te,de,Ne=-1,Ze=se[1],Pe=0,ct=7,en=4;for(0===Ze&&(ct=138,en=3),se[2*(we+1)+1]=65535,Te=0;Te<=we;Te++)de=Ze,Ze=se[2*(Te+1)+1],++Pe<ct&&de===Ze||(Pe<en?U.bl_tree[2*de]+=Pe:0!==de?(de!==Ne&&U.bl_tree[2*de]++,U.bl_tree[2*ne]++):Pe<=10?U.bl_tree[2*B]++:U.bl_tree[2*V]++,Ne=de,en=(Pe=0)===Ze?(ct=138,3):de===Ze?(ct=6,3):(ct=7,4))}function _e(U,se,we){var Te,de,Ne=-1,Ze=se[1],Pe=0,ct=7,en=4;for(0===Ze&&(ct=138,en=3),Te=0;Te<=we;Te++)if(de=Ze,Ze=se[2*(Te+1)+1],!(++Pe<ct&&de===Ze)){if(Pe<en)for(;Ue(U,de,U.bl_tree),0!=--Pe;);else 0!==de?(de!==Ne&&(Ue(U,de,U.bl_tree),Pe--),Ue(U,ne,U.bl_tree),Ge(U,Pe-3,2)):Pe<=10?(Ue(U,B,U.bl_tree),Ge(U,Pe-3,3)):(Ue(U,V,U.bl_tree),Ge(U,Pe-11,7));Ne=de,en=(Pe=0)===Ze?(ct=138,3):de===Ze?(ct=6,3):(ct=7,4)}}p(ve);var K=!1;function G(U,se,we,Te){var de,Ne,Ze;Ge(U,(b<<1)+(Te?1:0),3),Ne=se,Ze=we,Fe(de=U),Je(de,Ze),Je(de,~Ze),A.arraySet(de.pending_buf,de.window,Ne,Ze,de.pending),de.pending+=Ze}I._tr_init=function(U){K||(function(){var se,we,Te,de,Ne,Ze=new Array(M+1);for(de=Te=0;de<28;de++)for(pe[de]=Te,se=0;se<1<<z[de];se++)C[Te++]=de;for(C[Te-1]=de,de=Ne=0;de<16;de++)for(ve[de]=Ne,se=0;se<1<<te[de];se++)ae[Ne++]=de;for(Ne>>=7;de<d;de++)for(ve[de]=Ne<<7,se=0;se<1<<te[de]-7;se++)ae[256+Ne++]=de;for(we=0;we<=M;we++)Ze[we]=0;for(se=0;se<=143;)Ce[2*se+1]=8,se++,Ze[8]++;for(;se<=255;)Ce[2*se+1]=9,se++,Ze[9]++;for(;se<=279;)Ce[2*se+1]=7,se++,Ze[7]++;for(;se<=287;)Ce[2*se+1]=8,se++,Ze[8]++;for(Ve(Ce,m+1,Ze),se=0;se<d;se++)$[2*se+1]=5,$[2*se]=qt(se,5);ze=new xe(Ce,z,S+1,m,M),le=new xe($,te,0,d,M),Ae=new xe(new Array(0),ee,0,_,7)}(),K=!0),U.l_desc=new he(U.dyn_ltree,ze),U.d_desc=new he(U.dyn_dtree,le),U.bl_desc=new he(U.bl_tree,Ae),U.bi_buf=0,U.bi_valid=0,Ie(U)},I._tr_stored_block=G,I._tr_flush_block=function(U,se,we,Te){var de,Ne,Ze=0;0<U.level?(2===U.strm.data_type&&(U.strm.data_type=function(Pe){var ct,en=4093624447;for(ct=0;ct<=31;ct++,en>>>=1)if(1&en&&0!==Pe.dyn_ltree[2*ct])return 0;if(0!==Pe.dyn_ltree[18]||0!==Pe.dyn_ltree[20]||0!==Pe.dyn_ltree[26])return 1;for(ct=32;ct<S;ct++)if(0!==Pe.dyn_ltree[2*ct])return 1;return 0}(U)),Ct(U,U.l_desc),Ct(U,U.d_desc),Ze=function(Pe){var ct;for(y(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),y(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),Ct(Pe,Pe.bl_desc),ct=_-1;3<=ct&&0===Pe.bl_tree[2*q[ct]+1];ct--);return Pe.opt_len+=3*(ct+1)+5+5+4,ct}(U),(Ne=U.static_len+3+7>>>3)<=(de=U.opt_len+3+7>>>3)&&(de=Ne)):de=Ne=we+5,we+4<=de&&-1!==se?G(U,se,we,Te):4===U.strategy||Ne===de?(Ge(U,2+(Te?1:0),3),Kt(U,Ce,$)):(Ge(U,4+(Te?1:0),3),function(Pe,ct,en,Vt){var Ui;for(Ge(Pe,ct-257,5),Ge(Pe,en-1,5),Ge(Pe,Vt-4,4),Ui=0;Ui<Vt;Ui++)Ge(Pe,Pe.bl_tree[2*q[Ui]+1],3);_e(Pe,Pe.dyn_ltree,ct-1),_e(Pe,Pe.dyn_dtree,en-1)}(U,U.l_desc.max_code+1,U.d_desc.max_code+1,Ze+1),Kt(U,U.dyn_ltree,U.dyn_dtree)),Ie(U),Te&&Fe(U)},I._tr_tally=function(U,se,we){return U.pending_buf[U.d_buf+2*U.last_lit]=se>>>8&255,U.pending_buf[U.d_buf+2*U.last_lit+1]=255&se,U.pending_buf[U.l_buf+U.last_lit]=255&we,U.last_lit++,0===se?U.dyn_ltree[2*we]++:(U.matches++,se--,U.dyn_ltree[2*(C[we]+S+1)]++,U.dyn_dtree[2*me(se)]++),U.last_lit===U.lit_bufsize-1},I._tr_align=function(U){var se;Ge(U,2,3),Ue(U,W,Ce),16===(se=U).bi_valid?(Je(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}},{"../utils/common":41}],53:[function(N,Y,I){"use strict";Y.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(N,Y,I){(function(A){!function(x,f){"use strict";if(!x.setImmediate){var p,b,T,S,m=1,d={},_=!1,v=x.document,M=Object.getPrototypeOf&&Object.getPrototypeOf(x);M=M&&M.setTimeout?M:x,p="[object process]"==={}.toString.call(x.process)?function(ne){process.nextTick(function(){R(ne)})}:function(){if(x.postMessage&&!x.importScripts){var ne=!0,B=x.onmessage;return x.onmessage=function(){ne=!1},x.postMessage("","*"),x.onmessage=B,ne}}()?(S="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",W,!1):x.attachEvent("onmessage",W),function(ne){x.postMessage(S+ne,"*")}):x.MessageChannel?((T=new MessageChannel).port1.onmessage=function(ne){R(ne.data)},function(ne){T.port2.postMessage(ne)}):v&&"onreadystatechange"in v.createElement("script")?(b=v.documentElement,function(ne){var B=v.createElement("script");B.onreadystatechange=function(){R(ne),B.onreadystatechange=null,b.removeChild(B),B=null},b.appendChild(B)}):function(ne){setTimeout(R,0,ne)},M.setImmediate=function(ne){"function"!=typeof ne&&(ne=new Function(""+ne));for(var B=new Array(arguments.length-1),V=0;V<B.length;V++)B[V]=arguments[V+1];return d[m]={callback:ne,args:B},p(m),m++},M.clearImmediate=w}function w(ne){delete d[ne]}function R(ne){if(_)setTimeout(R,0,ne);else{var B=d[ne];if(B){_=!0;try{!function(V){var z=V.callback,te=V.args;switch(te.length){case 0:z();break;case 1:z(te[0]);break;case 2:z(te[0],te[1]);break;case 3:z(te[0],te[1],te[2]);break;default:z.apply(f,te)}}(B)}finally{w(ne),_=!1}}}}function W(ne){ne.source===x&&"string"==typeof ne.data&&0===ne.data.indexOf(S)&&R(+ne.data.slice(S.length))}}(typeof self>"u"?void 0===A?this:A:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},9263:(Ye,N,Y)=>{var I=Y(9209),A=Y(966);function x(f){this._init(f)}x.prototype={_init:function(f){f=f||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f=A.createBuffer(8,I.TABLE_LENGTH),p=0;p<I.TABLE_LENGTH;p++)f[p]=I.BASE62TABLE.charCodeAt(p);return f},_onData:function(f,p){var b=A.bufferToString_fast(f,p);this._onDataCallback?this._onDataCallback(b):this._result+=b},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var f=2,p=this._data,b=this._offset,T=I.BUFFER_MAX;if(this._dataLen-b<T&&(T=this._dataLen-b),f>T)return!1;var _,v,M,w,R,S=b-I.WINDOW_BUFFER_MAX,m=p.substring(S,b+T),d=b+f-3-S;do{if(2===f){if(v=p.charAt(b)+p.charAt(b+1),!~(M=m.indexOf(v))||M>d)break}else 3===f?v+=p.charAt(b+2):v=p.substr(b,f);if(!~(w=I.STRING_LASTINDEXOF_BUG?p.substring(S,b+f-1).lastIndexOf(v):m.lastIndexOf(v,d)))break;R=w,_=S+w;do{if(p.charCodeAt(b+f)!==p.charCodeAt(_+f))break}while(++f<T);if(M===w){f++;break}}while(++f<T);return 2!==f&&(this._index=I.WINDOW_BUFFER_MAX-R,this._length=f-1,!0)},compress:function(f){if(null==f||0===f.length)return"";var p,b=this._createTable(),T=A.createWindow(),S=A.createBuffer(8,I.COMPRESS_CHUNK_SIZE),m=0;this._result="",this._offset=T.length,this._data=T+f,this._dataLen=this._data.length,T=f=null;for(var v,M,w,R,W,d=-1,_=-1;this._offset<this._dataLen;)this._search()?(this._index<I.BUFFER_MAX?(M=this._index,w=0):w=(this._index-(M=this._index%I.BUFFER_MAX))/I.BUFFER_MAX,2===this._length?(S[m++]=b[w+I.COMPRESS_FIXED_START],S[m++]=b[M]):(S[m++]=b[w+I.COMPRESS_START],S[m++]=b[M],S[m++]=b[this._length]),this._offset+=this._length,~_&&(_=-1)):(v=this._data.charCodeAt(this._offset++))<I.LATIN_BUFFER_MAX?(v<I.UNICODE_CHAR_MAX?(M=v,w=0,d=I.LATIN_INDEX):d=(w=(v-(M=v%I.UNICODE_CHAR_MAX))/I.UNICODE_CHAR_MAX)+I.LATIN_INDEX,_===d?S[m++]=b[M]:(S[m++]=b[d-I.LATIN_INDEX_START],S[m++]=b[M],_=d)):(v<I.UNICODE_BUFFER_MAX?(M=v,w=0,d=I.UNICODE_INDEX):d=(w=(v-(M=v%I.UNICODE_BUFFER_MAX))/I.UNICODE_BUFFER_MAX)+I.UNICODE_INDEX,M<I.UNICODE_CHAR_MAX?(R=M,W=0):W=(M-(R=M%I.UNICODE_CHAR_MAX))/I.UNICODE_CHAR_MAX,_===d?(S[m++]=b[R],S[m++]=b[W]):(S[m++]=b[I.CHAR_START],S[m++]=b[d-I.TABLE_LENGTH],S[m++]=b[R],S[m++]=b[W],_=d)),m>=I.COMPRESS_CHUNK_MAX&&(this._onData(S,m),m=0);return m>0&&this._onData(S,m),this._onEnd(),p=this._result,this._result=null,null===p?"":p}},Ye.exports=x},9209:(Ye,N)=>{var Y=N.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",I=!1,A=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(I=!0)}catch{}if(Y)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(A=!0)}catch{}N.CAN_CHARCODE_APPLY=I,N.CAN_CHARCODE_APPLY_TYPED=A;var x=N.APPLY_BUFFER_SIZE=65533;N.APPLY_BUFFER_SIZE_OK=null;var f=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(f=!0),N.STRING_LASTINDEXOF_BUG=f;var p=N.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=N.TABLE_LENGTH=p.length,T=Math.max(b,62)-Math.min(b,62);N.BUFFER_MAX=b-1;var S=N.WINDOW_MAX=1024;N.WINDOW_BUFFER_MAX=304;var m=N.COMPRESS_CHUNK_SIZE=x;N.COMPRESS_CHUNK_MAX=m-b;var d=N.DECOMPRESS_CHUNK_SIZE=x;N.DECOMPRESS_CHUNK_MAX=d+2*S,N.LATIN_BUFFER_MAX=132;var v=N.UNICODE_CHAR_MAX=40;N.UNICODE_BUFFER_MAX=v*(v+1),N.LATIN_INDEX=b+1,N.LATIN_INDEX_START=T+20,N.UNICODE_INDEX=b+5,N.DECODE_MAX=b-T-19;var M=N.LATIN_DECODE_MAX=v+7,w=N.CHAR_START=M+1,R=N.COMPRESS_START=w+1,W=N.COMPRESS_FIXED_START=R+5;N.COMPRESS_INDEX=W+5},9727:(Ye,N,Y)=>{var I=Y(9209),A=Y(966);function x(f){this._init(f)}x.prototype={_init:function(f){f=f||{},this._result=null,this._onDataCallback=f.onData,this._onEndCallback=f.onEnd},_createTable:function(){for(var f={},p=0;p<I.TABLE_LENGTH;p++)f[I.BASE62TABLE.charAt(p)]=p;return f},_onData:function(f){var p;if(this._onDataCallback){if(f)p=this._result,this._result=[];else{var b=I.DECOMPRESS_CHUNK_SIZE-I.WINDOW_MAX;p=this._result.slice(I.WINDOW_MAX,I.WINDOW_MAX+b),this._result=this._result.slice(0,I.WINDOW_MAX).concat(this._result.slice(I.WINDOW_MAX+b))}p.length>0&&this._onDataCallback(A.bufferToString_fast(p))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(f){if(null==f||0===f.length)return"";this._result=A.stringToArray(A.createWindow());for(var p,_,v,M,R,W,ne,B,V,z,b=this._createTable(),T=!1,S=null,m=f.length,d=0;d<m;d++)if(void 0!==(v=b[f.charAt(d)])){if(v<I.DECODE_MAX)R=T?b[f.charAt(++d)]*I.UNICODE_CHAR_MAX+v+I.UNICODE_BUFFER_MAX*S:S*I.UNICODE_CHAR_MAX+v,this._result[this._result.length]=R;else if(v<I.LATIN_DECODE_MAX)S=v-I.DECODE_MAX,T=!1;else if(v===I.CHAR_START)S=(M=b[f.charAt(++d)])-5,T=!0;else if(v<I.COMPRESS_INDEX){if(M=b[f.charAt(++d)],v<I.COMPRESS_FIXED_START?(W=(v-I.COMPRESS_START)*I.BUFFER_MAX+M,ne=b[f.charAt(++d)]):(W=(v-I.COMPRESS_FIXED_START)*I.BUFFER_MAX+M,ne=2),(B=this._result.slice(-W)).length>ne&&(B.length=ne),V=B.length,B.length>0)for(z=0;z<ne;)for(_=0;_<V&&(this._result[this._result.length]=B[_],!(++z>=ne));_++);S=null}this._result.length>=I.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(I.WINDOW_MAX),this._onData(!0),this._onEnd(),p=A.bufferToString_fast(this._result),this._result=null,p}},Ye.exports=x},8497:(Ye,N,Y)=>{var I=Y(9263),A=Y(9727);Y(1014),N.n=function(x,f){return new I(f).compress(x)},N.L=function(x,f){return new A(f).decompress(x)}},966:(Ye,N,Y)=>{var I=Y(9209),A=String.fromCharCode;N.createBuffer=function(b,T){if(!I.HAS_TYPED)return new Array(T);switch(b){case 8:return new Uint8Array(T);case 16:return new Uint16Array(T)}};var x=N.truncateBuffer=function(b,T){return b.length===T?b:b.subarray?b.subarray(0,T):(b.length=T,b)};N.bufferToString_fast=function(b,T){if(null==T?T=b.length:b=x(b,T),I.CAN_CHARCODE_APPLY&&I.CAN_CHARCODE_APPLY_TYPED){var S=b.length;if(S<I.APPLY_BUFFER_SIZE&&I.APPLY_BUFFER_SIZE_OK)return A.apply(null,b);if(null===I.APPLY_BUFFER_SIZE_OK)try{var m=A.apply(null,b);return S>I.APPLY_BUFFER_SIZE&&(I.APPLY_BUFFER_SIZE_OK=!0),m}catch{I.APPLY_BUFFER_SIZE_OK=!1}}return f(b)};var f=N.bufferToString_chunked=function(b){for(var d,T="",S=b.length,m=0;m<S;){if(d=b.subarray?b.subarray(m,m+I.APPLY_BUFFER_SIZE):b.slice(m,m+I.APPLY_BUFFER_SIZE),m+=I.APPLY_BUFFER_SIZE,!I.APPLY_BUFFER_SIZE_OK){if(null===I.APPLY_BUFFER_SIZE_OK)try{T+=A.apply(null,d),d.length>I.APPLY_BUFFER_SIZE&&(I.APPLY_BUFFER_SIZE_OK=!0);continue}catch{I.APPLY_BUFFER_SIZE_OK=!1}return p(b)}T+=A.apply(null,d)}return T},p=N.bufferToString_slow=function(b){for(var T="",S=b.length,m=0;m<S;m++)T+=A(b[m]);return T};N.stringToArray=function(b){for(var T=[],S=b&&b.length,m=0;m<S;m++)T[m]=b.charCodeAt(m);return T},N.createWindow=function(){for(var b=I.WINDOW_MAX>>7,T="        ";!(b&I.WINDOW_MAX);)T+=T,b<<=1;return T}},2391:(Ye,N,Y)=>{N.encode=Y(8048).encode,N.decode=Y(9175).decode,Y(7704),Y(8131),Y(1490),Y(9234)},2295:function(Ye){function N(Y){return Y&&Y.isBuffer&&Y}Ye.exports=N(typeof Buffer<"u"&&Buffer)||N(this.Buffer)||N(typeof window<"u"&&window.Buffer)||this.Buffer},7625:(Ye,N)=>{N.copy=function x(f,p,b,T){var S;b||(b=0),!T&&0!==T&&(T=this.length),p||(p=0);var m=T-b;if(f===this&&b<p&&p<T)for(S=m-1;S>=0;S--)f[S+p]=this[S+b];else for(S=0;S<m;S++)f[S+p]=this[S+b];return m},N.toString=function A(f,p,b){var T=this,S=0|p;b||(b=T.length);for(var m="",d=0;S<b;)(d=T[S++])<128?m+=String.fromCharCode(d):(192==(224&d)?d=(31&d)<<6|63&T[S++]:224==(240&d)?d=(15&d)<<12|(63&T[S++])<<6|63&T[S++]:240==(248&d)&&(d=(7&d)<<18|(63&T[S++])<<12|(63&T[S++])<<6|63&T[S++]),d>=65536?(d-=65536,m+=String.fromCharCode(55296+(d>>>10),56320+(1023&d))):m+=String.fromCharCode(d));return m},N.write=function I(f,p){for(var b=this,T=p||(p|=0),S=f.length,m=0,d=0;d<S;)(m=f.charCodeAt(d++))<128?b[T++]=m:m<2048?(b[T++]=192|m>>>6,b[T++]=128|63&m):m<55296||m>57343?(b[T++]=224|m>>>12,b[T++]=128|m>>>6&63,b[T++]=128|63&m):(m=65536+(m-55296<<10|f.charCodeAt(d++)-56320),b[T++]=240|m>>>18,b[T++]=128|m>>>12&63,b[T++]=128|m>>>6&63,b[T++]=128|63&m);return T-p}},1864:(Ye,N,Y)=>{var I=Y(6093),A=Ye.exports=x(0);function x(p){return new Array(p)}A.alloc=x,A.concat=I.concat,A.from=function f(p){if(!I.isBuffer(p)&&I.isView(p))p=I.Uint8Array.from(p);else if(I.isArrayBuffer(p))p=new Uint8Array(p);else{if("string"==typeof p)return I.from.call(A,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(p)}},1884:(Ye,N,Y)=>{var I=Y(6093),A=I.global,x=Ye.exports=I.hasBuffer?f(0):[];function f(b){return new A(b)}x.alloc=I.hasBuffer&&A.alloc||f,x.concat=I.concat,x.from=function p(b){if(!I.isBuffer(b)&&I.isView(b))b=I.Uint8Array.from(b);else if(I.isArrayBuffer(b))b=new Uint8Array(b);else{if("string"==typeof b)return I.from.call(x,b);if("number"==typeof b)throw new TypeError('"value" argument must not be a number')}return A.from&&1!==A.from.length?A.from(b):new A(b)}},5364:(Ye,N,Y)=>{var I=Y(7625);N.copy=b,N.slice=T,N.toString=function S(d,_,v){return(!f&&A.isBuffer(this)?this.toString:I.toString).apply(this,arguments)},N.write=function m(d){return function _(){return(this[d]||I[d]).apply(this,arguments)}}("write");var A=Y(6093),x=A.global,f=A.hasBuffer&&"TYPED_ARRAY_SUPPORT"in x,p=f&&!x.TYPED_ARRAY_SUPPORT;function b(d,_,v,M){var w=A.isBuffer(this),R=A.isBuffer(d);if(w&&R)return this.copy(d,_,v,M);if(p||w||R||!A.isView(this)||!A.isView(d))return I.copy.call(this,d,_,v,M);var W=v||null!=M?T.call(this,v,M):this;return d.set(W,_),W.length}function T(d,_){var v=this.slice||!p&&this.subarray;if(v)return v.call(this,d,_);var M=A.alloc.call(this,_-d);return b.call(this,M,0,d,_),M}},5321:(Ye,N,Y)=>{var I=Y(6093),A=Ye.exports=I.hasArrayBuffer?x(0):[];function x(p){return new Uint8Array(p)}A.alloc=x,A.concat=I.concat,A.from=function f(p){if(I.isView(p)){var b=p.byteOffset,T=p.byteLength;(p=p.buffer).byteLength!==T&&(p.slice?p=p.slice(b,b+T):(p=new Uint8Array(p)).byteLength!==T&&(p=Array.prototype.slice.call(p,b,b+T)))}else{if("string"==typeof p)return I.from.call(A,p);if("number"==typeof p)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(p)}},6093:(Ye,N,Y)=>{var I=N.global=Y(2295),A=N.hasBuffer=I&&!!I.isBuffer,x=N.hasArrayBuffer=typeof ArrayBuffer<"u",f=N.isArray=Y(6425);N.isArrayBuffer=x?function R(z){return z instanceof ArrayBuffer||w(z)}:B;var p=N.isBuffer=A?I.isBuffer:B,b=N.isView=x?ArrayBuffer.isView||V("ArrayBuffer","buffer"):B;N.alloc=v,N.concat=function M(z,te){te||(te=0,Array.prototype.forEach.call(z,function $(C){te+=C.length}));var q=v.call(this!==N&&this||z[0],te),Ce=0;return Array.prototype.forEach.call(z,function ae(C){Ce+=d.copy.call(C,q,Ce)}),q},N.from=function _(z){return"string"==typeof z?W.call(this,z):ne(this).from(z)};var T=N.Array=Y(1864),S=N.Buffer=Y(1884),m=N.Uint8Array=Y(5321),d=N.prototype=Y(5364);function v(z){return ne(this).alloc(z)}var w=V("ArrayBuffer");function W(z){var te=3*z.length,ee=v.call(this,te),q=d.write.call(ee,z);return te!==q&&(ee=d.slice.call(ee,0,q)),ee}function ne(z){return p(z)?S:b(z)?m:f(z)?T:A?S:x?m:T}function B(){return!1}function V(z,te){return z="[object "+z+"]",function(ee){return null!=ee&&{}.toString.call(te?ee[te]:ee)===z}}},5166:(Ye,N,Y)=>{var I=Y(6425);N.createCodec=S,N.install=function f(m){for(var d in m)x.prototype[d]=p(x.prototype[d],m[d])},N.filter=function T(m){return I(m)?function b(m){return m=m.slice(),function(_){return m.reduce(d,_)};function d(_,v){return v(_)}}(m):m};var A=Y(6093);function x(m){if(!(this instanceof x))return new x(m);this.options=m,this.init()}function p(m,d){return m&&d?function _(){return m.apply(this,arguments),d.apply(this,arguments)}:m||d}function S(m){return new x(m)}x.prototype.init=function(){var m=this.options;return m&&m.uint8array&&(this.bufferish=A.Uint8Array),this},N.preset=S({preset:!0})},9234:(Ye,N,Y)=>{Y(8334),Y(2732),Y(5166)},5333:(Ye,N,Y)=>{N.T=x;var I=Y(8334).preset;function x(f){if(!(this instanceof x))return new x(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}Y(6473).k.mixin(x.prototype),x.prototype.codec=I,x.prototype.fetch=function(){return this.codec.decode(this)}},9175:(Ye,N,Y)=>{N.decode=function A(x,f){var p=new I(f);return p.write(x),p.read()};var I=Y(5333).T},8131:(Ye,N,Y)=>{var A=Y(6654),x=Y(5333).T;function f(p){if(!(this instanceof f))return new f(p);x.call(this,p)}f.prototype=new x,A.mixin(f.prototype),f.prototype.decode=function(p){arguments.length&&this.write(p),this.flush()},f.prototype.push=function(p){this.emit("data",p)},f.prototype.end=function(p){this.decode(p),this.emit("end")}},8400:(Ye,N,Y)=>{N.F=x;var I=Y(2732).preset;function x(f){if(!(this instanceof x))return new x(f);if(f&&(this.options=f,f.codec)){var p=this.codec=f.codec;p.bufferish&&(this.bufferish=p.bufferish)}}Y(6473).I.mixin(x.prototype),x.prototype.codec=I,x.prototype.write=function(f){this.codec.encode(this,f)}},8048:(Ye,N,Y)=>{N.encode=function A(x,f){var p=new I(f);return p.write(x),p.read()};var I=Y(8400).F},7704:(Ye,N,Y)=>{var A=Y(6654),x=Y(8400).F;function f(p){if(!(this instanceof f))return new f(p);x.call(this,p)}f.prototype=new x,A.mixin(f.prototype),f.prototype.encode=function(p){this.write(p),this.emit("data",this.read())},f.prototype.end=function(p){arguments.length&&this.encode(p),this.flush(),this.emit("end")}},7846:(Ye,N,Y)=>{N.S=function A(x,f){if(!(this instanceof A))return new A(x,f);this.buffer=I.from(x),this.type=f};var I=Y(6093)},4106:(Ye,N,Y)=>{N.setExtPackers=function b(_){_.addExtPacker(14,Error,[d,T]),_.addExtPacker(1,EvalError,[d,T]),_.addExtPacker(2,RangeError,[d,T]),_.addExtPacker(3,ReferenceError,[d,T]),_.addExtPacker(4,SyntaxError,[d,T]),_.addExtPacker(5,TypeError,[d,T]),_.addExtPacker(6,URIError,[d,T]),_.addExtPacker(10,RegExp,[m,T]),_.addExtPacker(11,Boolean,[S,T]),_.addExtPacker(12,String,[S,T]),_.addExtPacker(13,Date,[Number,T]),_.addExtPacker(15,Number,[S,T]),typeof Uint8Array<"u"&&(_.addExtPacker(17,Int8Array,x),_.addExtPacker(18,Uint8Array,x),_.addExtPacker(19,Int16Array,x),_.addExtPacker(20,Uint16Array,x),_.addExtPacker(21,Int32Array,x),_.addExtPacker(22,Uint32Array,x),_.addExtPacker(23,Float32Array,x),typeof Float64Array<"u"&&_.addExtPacker(24,Float64Array,x),typeof Uint8ClampedArray<"u"&&_.addExtPacker(25,Uint8ClampedArray,x),_.addExtPacker(26,ArrayBuffer,x),_.addExtPacker(29,DataView,x)),I.hasBuffer&&_.addExtPacker(27,A,I.from)};var f,I=Y(6093),A=I.global,x=I.Uint8Array.from,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function T(_){return f||(f=Y(8048).encode),f(_)}function S(_){return _.valueOf()}function m(_){(_=RegExp.prototype.toString.call(_).split("/")).shift();var v=[_.pop()];return v.unshift(_.join("/")),v}function d(_){var v={};for(var M in p)v[M]=_[M];return v}},9146:(Ye,N,Y)=>{N.setExtUnpackers=function p(_){_.addExtUnpacker(14,[b,S(Error)]),_.addExtUnpacker(1,[b,S(EvalError)]),_.addExtUnpacker(2,[b,S(RangeError)]),_.addExtUnpacker(3,[b,S(ReferenceError)]),_.addExtUnpacker(4,[b,S(SyntaxError)]),_.addExtUnpacker(5,[b,S(TypeError)]),_.addExtUnpacker(6,[b,S(URIError)]),_.addExtUnpacker(10,[b,T]),_.addExtUnpacker(11,[b,m(Boolean)]),_.addExtUnpacker(12,[b,m(String)]),_.addExtUnpacker(13,[b,m(Date)]),_.addExtUnpacker(15,[b,m(Number)]),typeof Uint8Array<"u"&&(_.addExtUnpacker(17,m(Int8Array)),_.addExtUnpacker(18,m(Uint8Array)),_.addExtUnpacker(19,[d,m(Int16Array)]),_.addExtUnpacker(20,[d,m(Uint16Array)]),_.addExtUnpacker(21,[d,m(Int32Array)]),_.addExtUnpacker(22,[d,m(Uint32Array)]),_.addExtUnpacker(23,[d,m(Float32Array)]),typeof Float64Array<"u"&&_.addExtUnpacker(24,[d,m(Float64Array)]),typeof Uint8ClampedArray<"u"&&_.addExtUnpacker(25,m(Uint8ClampedArray)),_.addExtUnpacker(26,d),_.addExtUnpacker(29,[d,m(DataView)])),I.hasBuffer&&_.addExtUnpacker(27,m(A))};var x,I=Y(6093),A=I.global,f={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function b(_){return x||(x=Y(9175).decode),x(_)}function T(_){return RegExp.apply(null,_)}function S(_){return function(v){var M=new _;for(var w in f)M[w]=v[w];return M}}function m(_){return function(v){return new _(v)}}function d(_){return new Uint8Array(_).buffer}},1490:(Ye,N,Y)=>{Y(8334),Y(2732),Y(5166)},6473:(Ye,N,Y)=>{N.k=p,N.I=b;var I=Y(6093),f="BUFFER_SHORTAGE";function p(){if(!(this instanceof p))return new p}function b(){if(!(this instanceof b))return new b}function m(){throw new Error("method not implemented: write()")}function d(){throw new Error("method not implemented: fetch()")}function _(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function v(R){(this.buffers||(this.buffers=[])).push(R)}function M(){return(this.buffers||(this.buffers=[])).shift()}function w(R){return function W(ne){for(var B in R)ne[B]=R[B];return ne}}p.mixin=w(function T(){return{bufferish:I,write:function R(B){var V=this.offset?I.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=V?B?this.bufferish.concat([V,B]):V:B,this.offset=0},fetch:d,flush:function W(){for(;this.offset<this.buffer.length;){var V,B=this.offset;try{V=this.fetch()}catch(z){if(z&&z.message!=f)throw z;this.offset=B;break}this.push(V)}},push:v,pull:M,read:_,reserve:function ne(B){var V=this.offset,z=V+B;if(z>this.buffer.length)throw new Error(f);return this.offset=z,V},offset:0}}()),p.mixin(p.prototype),b.mixin=w(function S(){return{bufferish:I,write:m,fetch:function R(){var z=this.start;if(z<this.offset){var te=this.start=this.offset;return I.prototype.slice.call(this.buffer,z,te)}},flush:function W(){for(;this.start<this.offset;){var z=this.fetch();z&&this.push(z)}},push:v,pull:function ne(){var z=this.buffers||(this.buffers=[]),te=z.length>1?this.bufferish.concat(z):z[0];return z.length=0,te},read:_,reserve:function B(z){var te=0|z;if(this.buffer){var ee=this.buffer.length,q=0|this.offset,Ce=q+te;if(Ce<ee)return this.offset=Ce,q;this.flush(),z=Math.max(z,Math.min(2*ee,this.maxBufferSize))}return z=Math.max(z,this.minBufferSize),this.buffer=this.bufferish.alloc(z),this.start=0,this.offset=te,0},send:function V(z){var te=z.length;if(te>this.minBufferSize)this.flush(),this.push(z);else{var ee=this.reserve(te);I.prototype.copy.call(z,this.buffer,ee)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),b.mixin(b.prototype)},8334:(Ye,N,Y)=>{var I=Y(7846).S,A=Y(9146),x=Y(4613).readUint8,f=Y(1788),p=Y(5166);function T(){var d=this.options;return this.decode=function b(d){var _=f.getReadToken(d);return function v(M){var w=x(M),R=_[w];if(!R)throw new Error("Invalid type: "+(w&&"0x"+w.toString(16)));return R(M)}}(d),d&&d.preset&&A.setExtUnpackers(this),this}p.install({addExtUnpacker:function S(d,_){(this.extUnpackers||(this.extUnpackers=[]))[d]=p.filter(_)},getExtUnpacker:function m(d){return(this.extUnpackers||(this.extUnpackers=[]))[d]||function v(M){return new I(M,d)}},init:T}),N.preset=T.call(p.preset)},4613:(Ye,N,Y)=>{var I=Y(8461),A=Y(6256),x=A.Uint64BE,f=A.Int64BE;N.getReadFormat=function m(le){var ve=le&&le.int64;return{map:T&&le&&le.usemap?_:d,array:v,str:M,bin:p.hasArrayBuffer&&le&&le.binarraybuffer?R:w,ext:W,uint8:ne,uint16:V,uint32:te,uint64:q(8,ve?ae:Ce),int8:B,int16:z,int32:ee,int64:q(8,ve?C:$),float32:q(4,pe),float64:q(8,ze)}},N.readUint8=ne;var p=Y(6093),b=Y(5364),T=typeof Map<"u",S=!0;function d(le,Ae){var xe,ve={},he=new Array(Ae),me=new Array(Ae),Je=le.codec.decode;for(xe=0;xe<Ae;xe++)he[xe]=Je(le),me[xe]=Je(le);for(xe=0;xe<Ae;xe++)ve[he[xe]]=me[xe];return ve}function _(le,Ae){var xe,ve=new Map,he=new Array(Ae),me=new Array(Ae),Je=le.codec.decode;for(xe=0;xe<Ae;xe++)he[xe]=Je(le),me[xe]=Je(le);for(xe=0;xe<Ae;xe++)ve.set(he[xe],me[xe]);return ve}function v(le,Ae){for(var ve=new Array(Ae),xe=le.codec.decode,he=0;he<Ae;he++)ve[he]=xe(le);return ve}function M(le,Ae){var ve=le.reserve(Ae);return b.toString.call(le.buffer,"utf-8",ve,ve+Ae)}function w(le,Ae){var ve=le.reserve(Ae),he=b.slice.call(le.buffer,ve,ve+Ae);return p.from(he)}function R(le,Ae){var ve=le.reserve(Ae),he=b.slice.call(le.buffer,ve,ve+Ae);return p.Uint8Array.from(he).buffer}function W(le,Ae){var ve=le.reserve(Ae+1),xe=le.buffer[ve++],he=ve+Ae,me=le.codec.getExtUnpacker(xe);if(!me)throw new Error("Invalid ext type: "+(xe&&"0x"+xe.toString(16)));return me(b.slice.call(le.buffer,ve,he))}function ne(le){var Ae=le.reserve(1);return le.buffer[Ae]}function B(le){var Ae=le.reserve(1),ve=le.buffer[Ae];return 128&ve?ve-256:ve}function V(le){var Ae=le.reserve(2),ve=le.buffer;return ve[Ae++]<<8|ve[Ae]}function z(le){var Ae=le.reserve(2),ve=le.buffer,xe=ve[Ae++]<<8|ve[Ae];return 32768&xe?xe-65536:xe}function te(le){var Ae=le.reserve(4),ve=le.buffer;return 16777216*ve[Ae++]+(ve[Ae++]<<16)+(ve[Ae++]<<8)+ve[Ae]}function ee(le){var Ae=le.reserve(4),ve=le.buffer;return ve[Ae++]<<24|ve[Ae++]<<16|ve[Ae++]<<8|ve[Ae]}function q(le,Ae){return function(ve){var xe=ve.reserve(le);return Ae.call(ve.buffer,xe,S)}}function Ce(le){return new x(this,le).toNumber()}function $(le){return new f(this,le).toNumber()}function ae(le){return new x(this,le)}function C(le){return new f(this,le)}function pe(le){return I.read(this,le,!1,23,4)}function ze(le){return I.read(this,le,!1,52,8)}},1788:(Ye,N,Y)=>{var I=Y(4613);function x(S){var m,d=new Array(256);for(m=0;m<=127;m++)d[m]=p(m);for(m=128;m<=143;m++)d[m]=T(m-128,S.map);for(m=144;m<=159;m++)d[m]=T(m-144,S.array);for(m=160;m<=191;m++)d[m]=T(m-160,S.str);for(d[192]=p(null),d[193]=null,d[194]=p(!1),d[195]=p(!0),d[196]=b(S.uint8,S.bin),d[197]=b(S.uint16,S.bin),d[198]=b(S.uint32,S.bin),d[199]=b(S.uint8,S.ext),d[200]=b(S.uint16,S.ext),d[201]=b(S.uint32,S.ext),d[202]=S.float32,d[203]=S.float64,d[204]=S.uint8,d[205]=S.uint16,d[206]=S.uint32,d[207]=S.uint64,d[208]=S.int8,d[209]=S.int16,d[210]=S.int32,d[211]=S.int64,d[212]=T(1,S.ext),d[213]=T(2,S.ext),d[214]=T(4,S.ext),d[215]=T(8,S.ext),d[216]=T(16,S.ext),d[217]=b(S.uint8,S.str),d[218]=b(S.uint16,S.str),d[219]=b(S.uint32,S.str),d[220]=b(S.uint16,S.array),d[221]=b(S.uint32,S.array),d[222]=b(S.uint16,S.map),d[223]=b(S.uint32,S.map),m=224;m<=255;m++)d[m]=p(m-256);return d}function p(S){return function(){return S}}function b(S,m){return function(d){var _=S(d);return m(d,_)}}function T(S,m){return function(d){return m(d,S)}}N.getReadToken=function A(S){var m=I.getReadFormat(S);return S&&S.useraw?function f(S){var m,d=x(S).slice();for(d[217]=d[196],d[218]=d[197],d[219]=d[198],m=160;m<=191;m++)d[m]=T(m-160,S.bin);return d}(m):x(m)}},2732:(Ye,N,Y)=>{var I=Y(7846).S,A=Y(4106),x=Y(9118),f=Y(5166);function b(){var m=this.options;return this.encode=function p(m){var d=x.getWriteType(m);return function _(v,M){var w=d[typeof M];if(!w)throw new Error('Unsupported type "'+typeof M+'": '+M);w(v,M)}}(m),m&&m.preset&&A.setExtPackers(this),this}f.install({addExtPacker:function T(m,d,_){_=f.filter(_);var v=d.name;function R(W){return _&&(W=_(W)),new I(W,m)}v&&"Object"!==v?(this.extPackers||(this.extPackers={}))[v]=R:(this.extEncoderList||(this.extEncoderList=[])).unshift([d,R])},getExtPacker:function S(m){var d=this.extPackers||(this.extPackers={}),_=m.constructor,v=_&&_.name&&d[_.name];if(v)return v;for(var M=this.extEncoderList||(this.extEncoderList=[]),w=M.length,R=0;R<w;R++){var W=M[R];if(_===W[0])return W[1]}},init:b}),N.preset=b.call(f.preset)},3041:(Ye,N,Y)=>{var I=Y(8461),A=Y(6256),x=A.Uint64BE,f=A.Int64BE,p=Y(8323).w,b=Y(6093),T=b.global,m=b.hasBuffer&&"TYPED_ARRAY_SUPPORT"in T&&!T.TYPED_ARRAY_SUPPORT,d=b.hasBuffer&&T.prototype||{};function M(){var q=p.slice();return q[196]=R(196),q[197]=W(197),q[198]=ne(198),q[199]=R(199),q[200]=W(200),q[201]=ne(201),q[202]=B(202,4,d.writeFloatBE||te,!0),q[203]=B(203,8,d.writeDoubleBE||ee,!0),q[204]=R(204),q[205]=W(205),q[206]=ne(206),q[207]=B(207,8,V),q[208]=R(208),q[209]=W(209),q[210]=ne(210),q[211]=B(211,8,z),q[217]=R(217),q[218]=W(218),q[219]=ne(219),q[220]=W(220),q[221]=ne(221),q[222]=W(222),q[223]=ne(223),q}function R(q){return function(Ce,$){var ae=Ce.reserve(2),C=Ce.buffer;C[ae++]=q,C[ae]=$}}function W(q){return function(Ce,$){var ae=Ce.reserve(3),C=Ce.buffer;C[ae++]=q,C[ae++]=$>>>8,C[ae]=$}}function ne(q){return function(Ce,$){var ae=Ce.reserve(5),C=Ce.buffer;C[ae++]=q,C[ae++]=$>>>24,C[ae++]=$>>>16,C[ae++]=$>>>8,C[ae]=$}}function B(q,Ce,$,ae){return function(C,pe){var ze=C.reserve(Ce+1);C.buffer[ze++]=q,$.call(C.buffer,pe,ze,ae)}}function V(q,Ce){new x(this,Ce,q)}function z(q,Ce){new f(this,Ce,q)}function te(q,Ce){I.write(this,q,Ce,!1,23,4)}function ee(q,Ce){I.write(this,q,Ce,!1,52,8)}N.getWriteToken=function _(q){return q&&q.uint8array?function v(){var q=M();return q[202]=B(202,4,te),q[203]=B(203,8,ee),q}():m||b.hasBuffer&&q&&q.safe?function w(){var q=p.slice();return q[196]=B(196,1,T.prototype.writeUInt8),q[197]=B(197,2,T.prototype.writeUInt16BE),q[198]=B(198,4,T.prototype.writeUInt32BE),q[199]=B(199,1,T.prototype.writeUInt8),q[200]=B(200,2,T.prototype.writeUInt16BE),q[201]=B(201,4,T.prototype.writeUInt32BE),q[202]=B(202,4,T.prototype.writeFloatBE),q[203]=B(203,8,T.prototype.writeDoubleBE),q[204]=B(204,1,T.prototype.writeUInt8),q[205]=B(205,2,T.prototype.writeUInt16BE),q[206]=B(206,4,T.prototype.writeUInt32BE),q[207]=B(207,8,V),q[208]=B(208,1,T.prototype.writeInt8),q[209]=B(209,2,T.prototype.writeInt16BE),q[210]=B(210,4,T.prototype.writeInt32BE),q[211]=B(211,8,z),q[217]=B(217,1,T.prototype.writeUInt8),q[218]=B(218,2,T.prototype.writeUInt16BE),q[219]=B(219,4,T.prototype.writeUInt32BE),q[220]=B(220,2,T.prototype.writeUInt16BE),q[221]=B(221,4,T.prototype.writeUInt32BE),q[222]=B(222,2,T.prototype.writeUInt16BE),q[223]=B(223,4,T.prototype.writeUInt32BE),q}():M()}},9118:(Ye,N,Y)=>{var I=Y(6425),A=Y(6256),x=A.Uint64BE,f=A.Int64BE,p=Y(6093),b=Y(5364),T=Y(3041),S=Y(8323).w,m=Y(7846).S,d=typeof Uint8Array<"u",_=typeof Map<"u",v=[];v[1]=212,v[2]=213,v[4]=214,v[8]=215,v[16]=216,N.getWriteType=function M(w){var R=T.getWriteToken(w),W=w&&w.useraw,ne=d&&w&&w.binarraybuffer,B=ne?p.isArrayBuffer:p.isBuffer,V=ne?function me(Ve,Ie){he(Ve,new Uint8Array(Ie))}:he,te=_&&w&&w.usemap?function Ue(Ve,Ie){if(!(Ie instanceof Map))return Ge(Ve,Ie);var Fe=Ie.size;R[Fe<16?128+Fe:Fe<=65535?222:223](Ve,Fe);var nt=Ve.codec.encode;Ie.forEach(function(Kt,Ct,y){nt(Ve,Ct),nt(Ve,Kt)})}:Ge;return{boolean:function q(Ve,Ie){R[Ie?195:194](Ve,Ie)},function:ve,number:function Ce(Ve,Ie){var Fe=0|Ie;Ie===Fe?R[-32<=Fe&&Fe<=127?255&Fe:0<=Fe?Fe<=255?204:Fe<=65535?205:206:-128<=Fe?208:-32768<=Fe?209:210](Ve,Fe):R[203](Ve,Ie)},object:W?function Ae(Ve,Ie){if(B(Ie))return function qt(Ve,Ie){var Fe=Ie.length;R[Fe<32?160+Fe:Fe<=65535?218:219](Ve,Fe),Ve.send(Ie)}(Ve,Ie);le(Ve,Ie)}:le,string:function ze(Ve){return function Ie(Fe,pt){var nt=pt.length;Fe.offset=Fe.reserve(5+3*nt);var Ct=Fe.buffer,y=Ve(nt),_e=Fe.offset+y;nt=b.write.call(Ct,pt,_e);var K=Ve(nt);y!==K&&b.copy.call(Ct,Ct,_e+K-y,_e,_e+nt),R[1===K?160+nt:K<=3?215+K:219](Fe,nt),Fe.offset+=nt}}(W?function pe(Ve){return Ve<32?1:Ve<=65535?3:5}:function C(Ve){return Ve<32?1:Ve<=255?2:Ve<=65535?3:5}),symbol:ve,undefined:ve};function le(Ve,Ie){if(null===Ie)return ve(Ve,Ie);if(B(Ie))return V(Ve,Ie);if(I(Ie))return function xe(Ve,Ie){var Fe=Ie.length;R[Fe<16?144+Fe:Fe<=65535?220:221](Ve,Fe);for(var nt=Ve.codec.encode,Kt=0;Kt<Fe;Kt++)nt(Ve,Ie[Kt])}(Ve,Ie);if(x.isUint64BE(Ie))return function $(Ve,Ie){R[207](Ve,Ie.toArray())}(Ve,Ie);if(f.isInt64BE(Ie))return function ae(Ve,Ie){R[211](Ve,Ie.toArray())}(Ve,Ie);var Fe=Ve.codec.getExtPacker(Ie);if(Fe&&(Ie=Fe(Ie)),Ie instanceof m)return function Je(Ve,Ie){var Fe=Ie.buffer,pt=Fe.length;R[v[pt]||(pt<255?199:pt<=65535?200:201)](Ve,pt),S[Ie.type](Ve),Ve.send(Fe)}(Ve,Ie);te(Ve,Ie)}function ve(Ve,Ie){R[192](Ve,Ie)}function he(Ve,Ie){var Fe=Ie.length;R[Fe<255?196:Fe<=65535?197:198](Ve,Fe),Ve.send(Ie)}function Ge(Ve,Ie){var Fe=Object.keys(Ie),pt=Fe.length;R[pt<16?128+pt:pt<=65535?222:223](Ve,pt);var Kt=Ve.codec.encode;Fe.forEach(function(Ct){Kt(Ve,Ct),Kt(Ve,Ie[Ct])})}}},8323:(Ye,N)=>{for(var Y=N.w=new Array(256),I=0;I<=255;I++)Y[I]=A(I);function A(x){return function(f){var p=f.reserve(1);f.buffer[p]=x}}},1203:Ye=>{function N(x){var f="    ";if(isNaN(parseInt(x)))f=x;else switch(x){case 1:f=" ";break;case 2:f="  ";break;case 3:f="   ";break;case 4:f="    ";break;case 5:f="     ";break;case 6:f="      ";break;case 7:f="       ";break;case 8:f="        ";break;case 9:f="         ";break;case 10:f="          ";break;case 11:f="           ";break;case 12:f="            "}for(var p=["\n"],b=0;b<100;b++)p.push(p[b]+f);return p}function Y(){this.step="    ",this.shift=N(this.step)}function I(x,f){return f-(x.replace(/\(/g,"").length-x.replace(/\)/g,"").length)}function A(x,f){return x.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+f+f+"AND ").replace(/ BETWEEN /gi,"~::~"+f+"BETWEEN ").replace(/ CASE /gi,"~::~"+f+"CASE ").replace(/ ELSE /gi,"~::~"+f+"ELSE ").replace(/ END /gi,"~::~"+f+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+f+"ON ").replace(/ OR /gi,"~::~"+f+f+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+f+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+f).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+f+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}Y.prototype.xml=function(x,f){var p=x.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),b=p.length,T=!1,S=0,m="",d=0,_=f?N(f):this.shift;for(d=0;d<b;d++)p[d].search(/<!/)>-1?(m+=_[S]+p[d],T=!0,(p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1||p[d].search(/!DOCTYPE/)>-1)&&(T=!1)):p[d].search(/-->/)>-1||p[d].search(/\]>/)>-1?(m+=p[d],T=!1):/^<\w/.exec(p[d-1])&&/^<\/\w/.exec(p[d])&&/^<[\w:\-\.\,]+/.exec(p[d-1])==/^<\/[\w:\-\.\,]+/.exec(p[d])[0].replace("/","")?(m+=p[d],T||S--):p[d].search(/<\w/)>-1&&-1==p[d].search(/<\//)&&-1==p[d].search(/\/>/)?m=m+=T?p[d]:_[S++]+p[d]:p[d].search(/<\w/)>-1&&p[d].search(/<\//)>-1?m=m+=T?p[d]:_[S]+p[d]:p[d].search(/<\//)>-1?m=m+=T?p[d]:_[--S]+p[d]:p[d].search(/\/>/)>-1?m=m+=T?p[d]:_[S]+p[d]:p[d].search(/<\?/)>-1||p[d].search(/xmlns\:/)>-1||p[d].search(/xmlns\=/)>-1?m+=_[S]+p[d]:m+=p[d];return"\n"==m[0]?m.slice(1):m},Y.prototype.json=function(x,p){return p=p||this.step,typeof JSON>"u"?x:"string"==typeof x?JSON.stringify(JSON.parse(x),null,p):"object"==typeof x?JSON.stringify(x,null,p):x},Y.prototype.css=function(x,f){var p=x.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),b=p.length,T=0,S="",m=0,d=f?N(f):this.shift;for(m=0;m<b;m++)/\{/.exec(p[m])?S+=d[T++]+p[m]:/\}/.exec(p[m])?S+=d[--T]+p[m]:(/\*\\/.exec(p[m]),S+=d[T]+p[m]);return S.replace(/^\n{1,}/,"")},Y.prototype.sql=function(x,f){var p=x.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),b=p.length,T=[],S=0,m=this.step,v=0,M="",w=0,R=f?N(f):this.shift;for(w=0;w<b;w++)T=T.concat(w%2?p[w]:A(p[w],m));for(b=T.length,w=0;w<b;w++)v=I(T[w],v),/\s{0,}\s{0,}SELECT\s{0,}/.exec(T[w])&&(T[w]=T[w].replace(/\,/g,",\n"+m+m)),/\s{0,}\s{0,}SET\s{0,}/.exec(T[w])&&(T[w]=T[w].replace(/\,/g,",\n"+m+m)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(T[w])?M+=R[++S]+T[w]:/\'/.exec(T[w])?(v<1&&S&&S--,M+=T[w]):(M+=R[S]+T[w],v<1&&S&&S--);return M.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},Y.prototype.xmlmin=function(x,f){return(f?x:x.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},Y.prototype.jsonmin=function(x){return typeof JSON>"u"?x:JSON.stringify(JSON.parse(x),null,0)},Y.prototype.cssmin=function(x,f){return(f?x:x.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},Y.prototype.sqlmin=function(x){return x.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},Ye.exports=new Y},2480:()=>{},5861:(Ye,N,Y)=>{"use strict";function I(x,f,p,b,T,S,m){try{var d=x[S](m),_=d.value}catch(v){return void p(v)}d.done?f(_):Promise.resolve(_).then(b,T)}function A(x){return function(){var f=this,p=arguments;return new Promise(function(b,T){var S=x.apply(f,p);function m(_){I(S,b,T,m,d,"next",_)}function d(_){I(S,b,T,m,d,"throw",_)}m(void 0)})}}Y.d(N,{Z:()=>A})},1014:Ye=>{"use strict";Ye.exports={}}},Ye=>{Ye(Ye.s=8408)}]);